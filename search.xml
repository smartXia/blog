<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>WebRTC/WHIP åŒºåˆ«è¯¦è§£</title>
      <link href="/blog/2025/10/15/%E8%A7%86%E9%A2%91%E6%B5%81/WebRTC-WHIP-%E5%8C%BA%E5%88%AB/"/>
      <url>/blog/2025/10/15/%E8%A7%86%E9%A2%91%E6%B5%81/WebRTC-WHIP-%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h2><span id="æ¦‚è¿°">æ¦‚è¿°</span></h2><p>WebRTC å’Œ WHIP æ˜¯ä¸¤ç§ä¸åŒçš„æŠ€æœ¯ã€‚ç®€å•è¯´ï¼š</p><p>ğŸ§  <strong>WebRTC</strong> æ˜¯é€šä¿¡åè®®æ—<br>ğŸš€ <strong>WHIP</strong> æ˜¯ç”¨äºæ¨æµï¼ˆIngestï¼‰çš„ WebRTC æ ‡å‡†åŒ–å­åè®®</p><h2><span id="ä¸€-æ¦‚å¿µå¯¹æ¯”æ€»è§ˆ">ä¸€ã€æ¦‚å¿µå¯¹æ¯”æ€»è§ˆ</span></h2><table><thead><tr><th>é¡¹ç›®</th><th>WebRTC</th><th>WHIP</th></tr></thead><tbody><tr><td><strong>å…¨ç§°</strong></td><td>Web Real-Time Communication</td><td>WebRTC-HTTP Ingestion Protocol</td></tr><tr><td><strong>å®šä½</strong></td><td>ä¸€æ•´å¥—å®æ—¶éŸ³è§†é¢‘ä¼ è¾“åè®®ï¼ˆP2P å®æ—¶é€šä¿¡æ ‡å‡†ï¼‰</td><td>ç”¨ HTTP å°è£… WebRTC æ¨æµåˆ°æœåŠ¡å™¨çš„ç®€åŒ–åè®®</td></tr><tr><td><strong>æ ‡å‡†ç»„ç»‡</strong></td><td>W3C &#x2F; IETF</td><td>IETF (draft-ietf-wish-whip)</td></tr><tr><td><strong>ä½¿ç”¨åœºæ™¯</strong></td><td>æµè§ˆå™¨ä¸æµè§ˆå™¨ã€æµè§ˆå™¨ä¸æœåŠ¡ç«¯ä¹‹é—´çš„å®æ—¶é€šä¿¡</td><td>å®¢æˆ·ç«¯ï¼ˆå¦‚ OBSã€æµè§ˆå™¨ã€æ‘„åƒå¤´ï¼‰æ¨æµåˆ°åª’ä½“æœåŠ¡å™¨ï¼ˆå¦‚ Wowzaã€Janusã€LiveKitã€Millicastï¼‰</td></tr><tr><td><strong>ä¿¡ä»¤æœºåˆ¶</strong></td><td>è‡ªå®šä¹‰ï¼ˆå¼€å‘è€…è‡ªå·±å®ç°ä¿¡ä»¤ï¼‰</td><td>é€šè¿‡ HTTP POST&#x2F;DELETE æ ‡å‡†åŒ–ä¿¡ä»¤</td></tr><tr><td><strong>ä¼ è¾“åè®®</strong></td><td>SRTP + DTLS + ICE (UDP)</td><td>åŒ WebRTCï¼Œåº•å±‚ä¾ç„¶æ˜¯ SRTP + DTLS + ICE</td></tr><tr><td><strong>æ¨æµ&#x2F;æ‹‰æµè§’è‰²</strong></td><td>åŒæ–¹å¯¹ç­‰ï¼ˆpeer-to-peerï¼‰</td><td>å•å‘ï¼šPublisher â†’ Media Server</td></tr><tr><td><strong>å…¸å‹ç”¨é€”</strong></td><td>è§†é¢‘ä¼šè®®ã€å®æ—¶äº’åŠ¨</td><td>WebRTC ç›´æ’­æ¨æµï¼ˆä½å»¶è¿Ÿç›´æ’­ï¼‰</td></tr></tbody></table><h2><span id="äºŒ-whip-çš„è®¾è®¡èƒŒæ™¯">äºŒã€WHIP çš„è®¾è®¡èƒŒæ™¯</span></h2><p>WebRTC æœ¬èº«åªå®šä¹‰äº†éŸ³è§†é¢‘ä¼ è¾“å±‚ï¼ˆåª’ä½“ã€ç½‘ç»œã€åŠ å¯†ï¼‰ï¼Œä½†<strong>ä¸å®šä¹‰ä¿¡ä»¤å±‚</strong>ã€‚<br>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚ä½•äº¤æ¢ SDPï¼ˆSession Description Protocolï¼‰ã€å¦‚ä½•å»ºç«‹è¿æ¥ç”±å¼€å‘è€…è‡ªå·±å†³å®šã€‚</p><p>â†’ è¿™è®©â€æ¨æµåœºæ™¯â€å®ç°èµ·æ¥å¾ˆå¤æ‚ï¼Œæ¯ä¸ªå¹³å°ä¿¡ä»¤éƒ½ä¸ä¸€æ ·ã€‚</p><p>ğŸ’¡ æ‰€ä»¥ IETF æ¨å‡ºäº† <strong>WHIP</strong>ï¼ˆWebRTC-HTTP Ingestion Protocolï¼‰ï¼Œ<br>ç›®æ ‡æ˜¯è®© WebRTC åƒ RTMP ä¸€æ ·å®¹æ˜“æ¨æµï¼š</p><ol><li>ç”¨ä¸€ä¸ª <strong>HTTP POST</strong> å‘èµ·æ¨æµï¼ˆå‘é€ SDP offerï¼‰</li><li>æœåŠ¡å™¨è¿”å› <strong>SDP answer</strong></li><li>æ¨æµç«¯å¼€å§‹ä¼ è¾“åª’ä½“æµ</li><li>ç”¨ <strong>HTTP DELETE</strong> åœæ­¢æ¨æµ</li></ol><p>è¿™æ ·æµè§ˆå™¨ã€OBSã€GStreamer ç­‰å·¥å…·å¯ä»¥ç”¨ç»Ÿä¸€æ¥å£æ¨æµåˆ°ä»»æ„æ”¯æŒ WHIP çš„æœåŠ¡å™¨ã€‚</p><h2><span id="ä¸‰-whip-å·¥ä½œæµç¨‹ç¤ºä¾‹">ä¸‰ã€WHIP å·¥ä½œæµç¨‹ç¤ºä¾‹</span></h2><p>ğŸ‘‡ <strong>WHIP æ¨æµæ—¶åºå›¾</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[Client]                        [Media Server]</span><br><span class="line">   |                                  |</span><br><span class="line">   |  POST /whip-endpoint             |</span><br><span class="line">   |  Content-Type: application/sdp   |</span><br><span class="line">   |  Body: SDP offer                 |</span><br><span class="line">   |---------------------------------&gt;|</span><br><span class="line">   |                                  |</span><br><span class="line">   |       201 Created                |</span><br><span class="line">   |  Location: /resource/id          |</span><br><span class="line">   |  Body: SDP answer                |</span><br><span class="line">   |&lt;---------------------------------|</span><br><span class="line">   |                                  |</span><br><span class="line">   |------ ICE Candidate Exchange ----|</span><br><span class="line">   |                                  |</span><br><span class="line">   |  (Start sending RTP media)       |</span><br><span class="line">   |---------------------------------&gt;|</span><br><span class="line">   |                                  |</span><br><span class="line">   |  DELETE /resource/id             |</span><br><span class="line">   |---------------------------------&gt;|</span><br><span class="line">   |                                  |</span><br><span class="line">   |  (Stop streaming)                |</span><br></pre></td></tr></table></figure><h2><span id="å››-whip-ä¸ä¼ ç»Ÿ-rtmp-æ¨æµå¯¹æ¯”">å››ã€WHIP ä¸ä¼ ç»Ÿ RTMP æ¨æµå¯¹æ¯”</span></h2><table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>RTMP</th><th>WHIP</th></tr></thead><tbody><tr><td><strong>åè®®å±‚</strong></td><td>TCP</td><td>UDP (SRTP over ICE)</td></tr><tr><td><strong>å»¶è¿Ÿ</strong></td><td>ç§’çº§ï¼ˆ2~5sï¼‰</td><td>ä½äº 500ms</td></tr><tr><td><strong>æ¨æµæ¥å£</strong></td><td>ç»Ÿä¸€ï¼ˆrtmp:&#x2F;&#x2F;â€¦ï¼‰</td><td>æ ‡å‡†åŒ– HTTP (REST API)</td></tr><tr><td><strong>æ¨æµæ ¼å¼</strong></td><td>FLV</td><td>SDP + RTP</td></tr><tr><td><strong>æ˜¯å¦åŠ å¯†</strong></td><td>å¦ï¼ˆæˆ– TLSï¼‰</td><td>å¼ºåˆ¶ DTLS + SRTP</td></tr><tr><td><strong>ä¸»è¦ç”¨é€”</strong></td><td>ç‚¹æ’­ç›´æ’­</td><td>è¶…ä½å»¶è¿Ÿäº’åŠ¨ç›´æ’­</td></tr></tbody></table><h2><span id="äº”-whip-çš„åå‘åè®®whep">äº”ã€WHIP çš„åå‘åè®®ï¼šWHEP</span></h2><p><strong>WHIP</strong> æ˜¯ æ¨æµï¼ˆIngestï¼‰ï¼Œ<br>è€Œ <strong>WHEP</strong>ï¼ˆWebRTC-HTTP Egress Protocolï¼‰ æ˜¯ æ‹‰æµï¼ˆPlaybackï¼‰ æ ‡å‡†åŒ–åè®®ã€‚</p><p>äºŒè€…é…åˆå¯ä»¥æ›¿ä»£ RTMP + HLS çš„æ•´å¥—æµç¨‹ï¼š</p><table><thead><tr><th>æ–¹å‘</th><th>åè®®</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>æ¨æµ</td><td>WHIP</td><td>å®¢æˆ·ç«¯ â†’ æœåŠ¡ç«¯</td></tr><tr><td>æ‹‰æµ</td><td>WHEP</td><td>æœåŠ¡ç«¯ â†’ æ’­æ”¾ç«¯</td></tr></tbody></table><h2><span id="å…­-æ€»ç»“">å…­ã€æ€»ç»“</span></h2><p><strong>WebRTC</strong> æ˜¯åº•å±‚ä¼ è¾“æ ‡å‡†ï¼Œ<strong>WHIP</strong> æ˜¯åŸºäº WebRTC çš„ç»Ÿä¸€æ¨æµä¿¡ä»¤åè®®ã€‚<br>WHIP è®©â€WebRTC æ¨æµâ€åƒâ€RTMP æ¨æµâ€ä¸€æ ·ç®€å•ã€‚</p><h2><span id="ä¸ƒ-å®é™…åº”ç”¨">ä¸ƒã€å®é™…åº”ç”¨</span></h2><p>å¦‚æœä½ è¦åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨ï¼š</p><h3><span id="æœåŠ¡å™¨ç«¯">æœåŠ¡å™¨ç«¯</span></h3><p>å¯ä»¥ä½¿ç”¨æ”¯æŒ WHIP çš„åª’ä½“æœåŠ¡å™¨ï¼š</p><ul><li><strong>Janus</strong> - å¼€æºçš„ WebRTC ç½‘å…³</li><li><strong>LiveKit</strong> - ç°ä»£åŒ–çš„å®æ—¶éŸ³è§†é¢‘å¹³å°</li><li><strong>Wowza</strong> - å•†ä¸šæµåª’ä½“æœåŠ¡å™¨</li><li><strong>OvenMediaEngine</strong> - å¼€æºæµåª’ä½“æœåŠ¡å™¨</li></ul><h3><span id="å®¢æˆ·ç«¯">å®¢æˆ·ç«¯</span></h3><p>å¯ä»¥ç”¨ä»¥ä¸‹å·¥å…·ï¼š</p><ul><li>æµè§ˆå™¨åŸç”Ÿ <strong>WebRTC API</strong></li><li><strong>OBS</strong> æœ€æ–°ç‰ˆæœ¬çš„ â€œWHIP æ¨æµæ’ä»¶â€</li><li><strong>ffmpeg</strong> -f whipï¼ˆæœ€æ–°ç‰ˆä¹Ÿæ”¯æŒï¼‰</li></ul><hr><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šWHIP åè®®ç›®å‰è¿˜åœ¨ IETF è‰æ¡ˆé˜¶æ®µï¼Œä½†å·²ç»è¢«å¤šä¸ªä¸»æµåª’ä½“æœåŠ¡å™¨æ”¯æŒï¼Œæ˜¯æœªæ¥ WebRTC æ¨æµçš„æ ‡å‡†æ–¹å‘ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> è§†é¢‘æµæŠ€æœ¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WebRTC </tag>
            
            <tag> WHIP </tag>
            
            <tag> å®æ—¶é€šä¿¡ </tag>
            
            <tag> ç›´æ’­æŠ€æœ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8sä¸­å¦‚ä½•åšåˆ°åŠ¨æ€åˆ†é…ç½‘ç»œåŸŸå</title>
      <link href="/blog/2024/07/17/K8s/k8s-6-%E4%B8%AD%E5%A6%82%E4%BD%95%E5%81%9A%E5%88%B0%E5%8A%A8%E6%80%81%E5%88%86%E9%85%8D%E7%BD%91%E7%BB%9C%E5%9F%9F%E5%90%8D/"/>
      <url>/blog/2024/07/17/K8s/k8s-6-%E4%B8%AD%E5%A6%82%E4%BD%95%E5%81%9A%E5%88%B0%E5%8A%A8%E6%80%81%E5%88%86%E9%85%8D%E7%BD%91%E7%BB%9C%E5%9F%9F%E5%90%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script>]]></content>
      
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8sä¸­å…³äºæœåŠ¡ç½‘ç»œçš„ä½¿ç”¨</title>
      <link href="/blog/2024/07/17/K8s/k8s-5-%E4%B8%AD%E5%85%B3%E4%BA%8E%E6%9C%8D%E5%8A%A1%E7%BD%91%E7%BB%9C%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
      <url>/blog/2024/07/17/K8s/k8s-5-%E4%B8%AD%E5%85%B3%E4%BA%8E%E6%9C%8D%E5%8A%A1%E7%BD%91%E7%BB%9C%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script>]]></content>
      
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>golang Contextä¸Šä¸‹æ–‡</title>
      <link href="/blog/2024/07/15/GOLANG/GOLANG-%E7%AC%94%E8%AE%B08-Context%E4%B8%8A%E4%B8%8B%E6%96%87/"/>
      <url>/blog/2024/07/15/GOLANG/GOLANG-%E7%AC%94%E8%AE%B08-Context%E4%B8%8A%E4%B8%8B%E6%96%87/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p><img src="/blog/image.png" alt="alt text"></p><p><a href="https://zhuanlan.zhihu.com/p/68792989">https://zhuanlan.zhihu.com/p/68792989</a></p>]]></content>
      
      
      <categories>
          
          <category> GOLANG </category>
          
      </categories>
      
      
        <tags>
            
            <tag> golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8s-æœ‰çŠ¶æ€æœåŠ¡æ— çŠ¶æ€æœåŠ¡å’Œå¯¹å¤–è®¿é—®æœåŠ¡</title>
      <link href="/blog/2024/04/12/K8s/k8s-3-%E6%9C%89%E7%8A%B6%E6%80%81%E6%9C%8D%E5%8A%A1%E6%97%A0%E7%8A%B6%E6%80%81%E6%9C%8D%E5%8A%A1%E5%92%8C%E5%AF%B9%E5%A4%96%E8%AE%BF%E9%97%AE%E6%9C%8D%E5%8A%A1/"/>
      <url>/blog/2024/04/12/K8s/k8s-3-%E6%9C%89%E7%8A%B6%E6%80%81%E6%9C%8D%E5%8A%A1%E6%97%A0%E7%8A%B6%E6%80%81%E6%9C%8D%E5%8A%A1%E5%92%8C%E5%AF%B9%E5%A4%96%E8%AE%BF%E9%97%AE%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><ol><li>åŸºæœ¬æ¦‚å¿µ<br>æ— çŠ¶æ€æœåŠ¡<br>æ— çŠ¶æ€æœåŠ¡ä¸ä¼šåœ¨æœ¬åœ°å­˜å‚¨æŒä¹…åŒ–æ•°æ®.å¤šä¸ªæœåŠ¡å®ä¾‹å¯¹äºåŒä¸€ä¸ªç”¨æˆ·è¯·æ±‚çš„å“åº”ç»“æœæ˜¯å®Œå…¨ä¸€è‡´çš„.è¿™ç§å¤šæœåŠ¡å®ä¾‹ä¹‹é—´æ˜¯æ²¡æœ‰ä¾èµ–å…³ç³»,æ¯”å¦‚webåº”ç”¨,åœ¨k8sæ§åˆ¶å™¨ ä¸­åŠ¨æ€å¯åœæ— çŠ¶æ€æœåŠ¡çš„podå¹¶ä¸ä¼šå¯¹å…¶å®ƒçš„podäº§ç”Ÿå½±å“.</li></ol><p>æœ‰çŠ¶æ€æœåŠ¡<br>æœ‰çŠ¶æ€æœåŠ¡éœ€è¦åœ¨æœ¬åœ°å­˜å‚¨æŒä¹…åŒ–æ•°æ®,å…¸å‹çš„æ˜¯åˆ†å¸ƒå¼æ•°æ®åº“çš„åº”ç”¨,åˆ†å¸ƒå¼èŠ‚ç‚¹å®ä¾‹ä¹‹é—´æœ‰ä¾èµ–çš„æ‹“æ‰‘å…³ç³».æ¯”å¦‚,ä¸»ä»å…³ç³». å¦‚æœK8Såœæ­¢åˆ†å¸ƒå¼é›†ç¾¤ä¸­ä»» ä¸€å®ä¾‹pod,å°±å¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±æˆ–è€…é›†ç¾¤çš„crash.</p><ol start="2"><li>Deploymentéƒ¨ç½²çš„é—®é¢˜?</li></ol><p>Deploymentè¢«è®¾è®¡ç”¨æ¥ç®¡ç†æ— çŠ¶æ€æœåŠ¡çš„pod,æ¯ä¸ªpodå®Œå…¨ä¸€è‡´.ä»€ä¹ˆæ„æ€å‘¢?</p><p>æ— çŠ¶æ€æœåŠ¡å†…çš„å¤šä¸ªPodåˆ›å»ºçš„é¡ºåºæ˜¯æ²¡æœ‰é¡ºåºçš„.<br>æ— çŠ¶æ€æœåŠ¡å†…çš„å¤šä¸ªPodçš„åç§°æ˜¯éšæœºçš„.podè¢«é‡æ–°å¯åŠ¨è°ƒåº¦å,å®ƒçš„åç§°ä¸IPéƒ½ä¼šå‘ç”Ÿå˜åŒ–.<br>æ— çŠ¶æ€æœåŠ¡å†…çš„å¤šä¸ªPodèƒŒåæ˜¯å…±äº«å­˜å‚¨çš„.<br>2.1.æ–°çš„é—®é¢˜</p><p>å¯¹äºæ•°æ®åº“æœ‰çŠ¶æ€çš„æœåŠ¡å®¹å™¨ç¼–æ’,Deploymentè§£å†³æ–¹æ¡ˆå°±å˜å¾—æ— èƒ½ä¸ºåŠ›äº†.<br>æ¯”å¦‚,Redisæ˜¯ä¸»ä»çš„æ¶æ„,åªèƒ½å…è®¸é›†ç¾¤ä¸­å‡ºç°ä¸€ä¸ªä¸»èŠ‚ç‚¹æä¾›å†™,å…¶å®ƒèŠ‚ç‚¹æä¾›è¯»èƒ½åŠ›.å¦‚æœåŒæ—¶å‡ºç°äºŒä¸ªä¸»èŠ‚ç‚¹å,å¿…é¡»ä¼šå‡ºç°å¹¶å‘å†™çš„ æ“ä½œ,è¿›ä¸€æ­¥å¯¼è‡´é›†ç¾¤å†™æ•°æ®çš„ä¸ä¸€è‡´.<br>æ‰€ä»¥é—®é¢˜æ¥äº†,é’ˆå¯¹Redisè¿™ç§æœ‰çŠ¶æ€çš„æœåŠ¡,å®ƒç®¡ç†çš„å¤šä¸ªPod(ä»£è¡¨master&#x2F;slaveè§’è‰²)å¿…é¡»æœ‰è‡ªå·±ç‹¬ç«‹çš„æŒä¹…åŒ–å­˜å‚¨ç»„ä»¶.<br>æœ‰çŠ¶æ€çš„æœåŠ¡Podæ˜¯ç”¨æ¥è¿è¡Œæœ‰çŠ¶æ€åº”ç”¨çš„,å…¶åœ¨æ•°æ®å·ä¸Šå­˜å‚¨çš„æ•°æ®éå¸¸é‡è¦,å› ä¸ºStatefulå°±æ˜¯è¦ä¾èµ–å­˜å‚¨æ•°æ®å·ä¸Šå¯¹æ¯ä¸ªPodçš„çŠ¶æ€è¿›è¡Œå»ºæ¨¡ä¸å­˜å‚¨.<br>æ‰€ä»¥K8Sæä¾›äº†ä¸€ä¸ªæ–°çš„å·¥å…·â€”â€”StatefulSetæ¥ç»Ÿä¸€è§£å†³é—®é¢˜.</p><ol start="3"><li>Statefulå¦‚ä½•è§£å†³é—®é¢˜?<br>Deploymentç»„ä»¶æ˜¯ä¸ºæ— çŠ¶æ€æœåŠ¡è€Œè®¾è®¡çš„,å…¶ä¸­çš„Podåç§°,ä¸»æœºå,å­˜å‚¨éƒ½æ˜¯éšæœº,ä¸ç¨³å®šçš„,å¹¶ä¸”Podçš„åˆ›å»ºä¸é”€æ¯ä¹Ÿæ˜¯æ— åºçš„.è¿™ä¸ªè®¾è®¡å†³å®šäº†æ— çŠ¶æ€æœåŠ¡å¹¶ ä¸é€‚åˆæ•°æ®åº“é¢†åŸŸçš„åº”ç”¨.</li></ol><p>è€ŒStatefulç®¡ç†æœ‰çŠ¶æ€çš„åº”ç”¨,å®ƒçš„Podæœ‰å¦‚ä¸‹ç‰¹å¾:</p><p>å”¯ä¸€æ€§: æ¯ä¸ªPodä¼šè¢«åˆ†é…ä¸€ä¸ªå”¯ä¸€åºå·.<br>é¡ºåºæ€§: Podå¯åŠ¨,æ›´æ–°,é”€æ¯æ˜¯æŒ‰é¡ºåºè¿›è¡Œ.<br>ç¨³å®šçš„ç½‘ç»œæ ‡è¯†: Podä¸»æœºå,DNSåœ°å€ä¸ä¼šéšç€Podè¢«é‡æ–°è°ƒåº¦è€Œå‘ç”Ÿå˜åŒ–.<br>ç¨³å®šçš„æŒä¹…åŒ–å­˜å‚¨: Podè¢«é‡æ–°è°ƒåº¦å,ä»ç„¶èƒ½æŒ‚è½½åŸæœ‰çš„PV,ä»è€Œä¿è¯äº†æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§.</p><p>3.1. å¦‚ä½•ç†è§£ç¨³å®šç½‘ç»œæ ‡è¯†?</p><p>åˆ›å»ºåä¸ºtest-redis-podçš„Statefulæ¨¡å‹,æ ¹æ®ä½ é…ç½®çš„Replica&#x3D;3çš„è®¾ç½®,K8Sä¼šåˆ›å»ºä¸‰ä¸ªPod,ä¾æ¬¡å‘½åä¸º: test-redis-pod-0; test-redis-pod-1; test-redis-pod-2</p><p>K8Sä¸ºæœ‰çŠ¶æ€çš„æœåŠ¡Podåˆ†é…ç¨³å®šçš„ç½‘ç»œæ ‡è¯†,å…·ä½“å®ç°åŸºäºtest-redis-pod-0åç§°,å€ŸåŠ©Headless DNSè¿›è¡Œå¦‚ä¸‹è§£æ,è·å–åç«¯å…¶ä¸­ä¸€ä¸ªPodçš„åœ°å€.</p><p>$(pod name).$(service name).$(namespace).svc.cluster.local<br>ä¸‹é¢æ˜¯ä¸€ä¸ªé€šè¿‡Podåç§°è®¿é—®Redisé›†ç¾¤çš„MasterèŠ‚ç‚¹åœ°å€çš„æ–¹æ³•.</p><p>session.save_path &#x3D; â€œtcp:&#x2F;&#x2F;test-redis-pod-0.test-redis-service.default.svc.cluster.local:6379â€<br>ç°åœ¨å›ç­”å¦‚ä¸‹äºŒä¸ªé—®é¢˜:</p><p>åœ¨Redis Podå†…éƒ¨,ä¸»ä»èŠ‚ç‚¹ä¹‹é—´æ•°æ®åŒæ­¥çš„éœ€æ±‚,SlaveèŠ‚ç‚¹å¯¹åº”çš„é…ç½®æ–‡ä»¶ä¸­éœ€è¦ä¸€ä¸ªç¨³å®šçš„Masteråœ°å€.ä¸‹è¾¹è„šæœ¬å°±æ˜¯ç¨³å®šè®¿é—®test-redis-pod-0 åç§°æ¥é—´æ¥è·å¾—Redis MasterèŠ‚ç‚¹IPåœ°å€,ç„¶åå†™å…¥åˆ°Redis Slaveçš„é…ç½®æ–‡ä»¶ä¸­,è¿™æ ·åç»­SlaveèŠ‚ç‚¹ä¸MasterèŠ‚ç‚¹æ‰èƒ½å®Œæˆå¢é‡æ•°æ®çš„åŒæ­¥.<br>if [ â€œ${server_host}â€ !&#x3D; â€œtest-redis-pod-0â€ ];then<br>        #echo â€œserver-count: ${server_counts}â€ &gt;&gt; &#x2F;data&#x2F;test.log</p><pre><code>    while [ -z &quot;$&#123;master_address&#125;&quot; ];do        echo &quot;master_address is not available, $&#123;master_address&#125; waiting for redis master...&quot; &gt;&gt; /data/test.log        master_address=$(replication_master_address)        sleep 1s    donefiecho &quot;master_address: $(master_address)&quot; &gt;&gt; /data/test.logif [ ! -z &quot;$master_address&quot; ]; then    printf &quot;\nslaveof %s 6379\n&quot; &quot;$master_address&quot; &gt;&gt; $conffi</code></pre><p>åœ¨Redis Podå¤–éƒ¨, å¯ä»¥é€šè¿‡$(pod name).$(service name).$(namespace).svc.cluster.localæ–¹å¼æ¥è®¿é—®å…·ä½“çš„PodæœåŠ¡.<br>3.2. å¦‚ä½•ç†è§£ç¨³å®šæŒä¹…åŒ–å­˜å‚¨?</p><p>æ¯ä¸ªRedis Podå¯¹åº”ä¸€ä¸ªè‡ªå·±çš„PVC&#x2F;PV.å½“Podå‘ç”Ÿè°ƒåº¦æ—¶,éœ€è¦åœ¨åˆ«çš„èŠ‚ç‚¹å¯åŠ¨æ—¶,æ ¹æ®PodèƒŒåå…³è”çš„å­˜å‚¨ä¿¡æ¯ä¿è¯å…¶åç§°çš„ç¨³å®šæ€§.</p><p>Podè¿˜æ˜¯ä¼šattachæŒ‚è½½åˆ°åŸæ¥çš„PV&#x2F;PVCä¸­,ä»è€Œç¡®å®šæ¯ä¸ªPodæœ‰è‡ªå·±ä¸“ç”¨çš„å­˜å‚¨å·.</p><ol start="4"><li>æ€»ç»“<br>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†æ— çŠ¶æ€å’Œæœ‰çŠ¶æ€æœåŠ¡åœ¨K8Sä¸­çš„å…¸å‹åº”ç”¨åœºæ™¯.</li></ol><p>é€šè¿‡å¯¹Deploymentéƒ¨ç½²æ— çŠ¶æ€æœåŠ¡æ‰€é‡åˆ°é—®é¢˜çš„åˆ†æ,å¼•å‡ºäº†Statefulæ–°çš„éƒ¨ç½²ç»„ä»¶.å®ƒæ˜¯é€šè¿‡æ”¯æŒPodä¸€äº›ç‰¹æ€§(e.g. åç§°å”¯ä¸€æ€§,ç¨³å®šçš„ç½‘ç»œæ ‡è¯†, ç¨³å®šçš„æŒä¹…åŒ–å­˜å‚¨ç­‰)æ¥å®ç°åœ¨K8Sä¸­éƒ¨ç½²è¿ç»´æœ‰çŠ¶æ€æœåŠ¡.</p><p>ç‰¢è®°: Statefulæœ‰çŠ¶æ€æœåŠ¡,æ¯ä¸ªPodæœ‰ç‹¬ç«‹çš„PVC&#x2F;PVå­˜å‚¨ç»„ä»¶</p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8s-StorageClass PV PVC æ¦‚å¿µå’Œä½¿ç”¨</title>
      <link href="/blog/2024/04/12/K8s/k8s-4-StorageClass%20PV%20PVC/"/>
      <url>/blog/2024/04/12/K8s/k8s-4-StorageClass%20PV%20PVC/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>è´Ÿè´£æŠŠPVCç»‘å®šåˆ°PVçš„æ˜¯ä¸€ä¸ªæŒä¹…åŒ–å­˜å‚¨å·æ§åˆ¶å¾ªç¯ï¼Œè¿™ä¸ªæ§åˆ¶å™¨ä¹Ÿæ˜¯kube-manager-controllerçš„ä¸€éƒ¨åˆ†è¿è¡Œåœ¨masterä¸Šã€‚è€ŒçœŸæ­£æŠŠç›®å½•æŒ‚è½½åˆ°å®¹å™¨ä¸Šçš„æ“ä½œæ˜¯åœ¨PODæ‰€åœ¨ä¸»æœºä¸Šå‘ç”Ÿçš„ï¼Œæ‰€ä»¥é€šè¿‡kubeletæ¥å®Œæˆã€‚è€Œä¸”åˆ›å»ºPVä»¥åŠPVCçš„ç»‘å®šæ˜¯åœ¨PODè¢«è°ƒåº¦åˆ°æŸä¸€èŠ‚ç‚¹ä¹‹åè¿›è¡Œçš„ï¼Œå®Œæˆè¿™äº›æ“ä½œï¼ŒPODå°±å¯ä»¥è¿è¡Œäº†ã€‚ä¸‹é¢æ¢³ç†ä¸€ä¸‹æŒ‚è½½ä¸€ä¸ªPVçš„è¿‡ç¨‹ï¼š</p><p>ç”¨æˆ·æäº¤ä¸€ä¸ªåŒ…å«PVCçš„POD</p><p>è°ƒåº¦å™¨æŠŠæ ¹æ®å„ç§è°ƒåº¦ç®—æ³•æŠŠè¯¥PODåˆ†é…åˆ°æŸä¸ªèŠ‚ç‚¹ï¼Œæ¯”å¦‚node01</p><p>Node01ä¸Šçš„kubeletç­‰å¾…Volume Managerå‡†å¤‡å­˜å‚¨è®¾å¤‡</p><p>PVæ§åˆ¶å™¨è°ƒç”¨å­˜å‚¨æ’ä»¶åˆ›å»ºPVå¹¶ä¸PVCè¿›è¡Œç»‘å®š</p><p>Attach&#x2F;Detach Controlleræˆ–Volume Manageré€šè¿‡å­˜å‚¨æ’ä»¶å®ç°è®¾å¤‡çš„attachã€‚ï¼ˆè¿™ä¸€æ­¥æ˜¯é’ˆå¯¹å—è®¾å¤‡å­˜å‚¨ï¼‰</p><p>Volume Managerç­‰å¾…å­˜å‚¨è®¾å¤‡å˜ä¸ºå¯ç”¨åï¼ŒæŒ‚è½½è¯¥è®¾å¤‡åˆ°&#x2F;var&#x2F;lib&#x2F;kubelet&#x2F;pods&#x2F;&lt;Pod çš„ ID&gt;&#x2F;volumes&#x2F;kubernetes.io~&lt;Volume ç±»å‹ &gt;&#x2F;&lt;Volume åå­— &gt;ç›®å½•ä¸Š</p><p>Kubeletè¢«å‘ŠçŸ¥å·å·²ç»å‡†å¤‡å¥½ï¼Œå¼€å§‹å¯åŠ¨PODï¼Œé€šè¿‡æ˜ å°„æ–¹å¼æŒ‚è½½åˆ°å®¹å™¨ä¸­</p><p>æ€»ç»“ï¼šæœ¬åœ°å·ä¹Ÿå°±æ˜¯LPVä¸æ”¯æŒåŠ¨æ€ä¾›ç»™çš„æ–¹å¼ï¼Œå»¶è¿Ÿç»‘å®šï¼Œå°±æ˜¯ä¸ºäº†ç»¼åˆè€ƒè™‘æ‰€æœ‰å› ç´ å†è¿›è¡ŒPODè°ƒåº¦ã€‚å…¶æ ¹æœ¬åŸå› æ˜¯åŠ¨æ€ä¾›ç»™æ˜¯å…ˆè°ƒåº¦PODåˆ°èŠ‚ç‚¹ï¼Œç„¶ååŠ¨æ€åˆ›å»ºPVä»¥åŠç»‘å®šPVCæœ€åè¿è¡ŒPODï¼›è€ŒLPVæ˜¯å…ˆåˆ›å»ºä¸æŸä¸€èŠ‚ç‚¹å…³è”çš„PVï¼Œç„¶ååœ¨è°ƒåº¦çš„æ—¶å€™ç»¼åˆè€ƒè™‘å„ç§å› ç´ è€Œä¸”è¦åŒ…æ‹¬PVåœ¨å“ªä¸ªèŠ‚ç‚¹ï¼Œç„¶åå†è¿›è¡Œè°ƒåº¦ï¼Œåˆ°è¾¾è¯¥èŠ‚ç‚¹ååœ¨è¿›è¡ŒPVCçš„ç»‘å®šã€‚ä¹Ÿå°±è¯´åŠ¨æ€ä¾›ç»™ä¸è€ƒè™‘èŠ‚ç‚¹ï¼ŒLPVå¿…é¡»è€ƒè™‘èŠ‚ç‚¹ã€‚æ‰€ä»¥è¿™ä¸¤ç§æœºåˆ¶æœ‰å†²çªå¯¼è‡´æ— æ³•åœ¨åŠ¨æ€ä¾›ç»™ç­–ç•¥ä¸‹ä½¿ç”¨LPVã€‚æ¢å¥è¯è¯´åŠ¨æ€ä¾›ç»™æ˜¯PVè·Ÿç€PODèµ°ï¼Œè€ŒLPVæ˜¯PODè·Ÿç€PVèµ°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GOLANG-ç¬”è®°7-error.groupç”¨æ³•</title>
      <link href="/blog/2024/03/26/GOLANG/GOLANG-%E7%AC%94%E8%AE%B07-error-group%E7%94%A8%E6%B3%95/"/>
      <url>/blog/2024/03/26/GOLANG/GOLANG-%E7%AC%94%E8%AE%B07-error-group%E7%94%A8%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h4><span id="1-å…ˆçœ‹ä¸‹æ•°æ®ç»“æ„">1 .å…ˆçœ‹ä¸‹æ•°æ®ç»“æ„</span></h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Group <span class="keyword">struct</span> &#123;</span><br><span class="line">cancel <span class="function"><span class="keyword">func</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line">wg sync.WaitGroup</span><br><span class="line"></span><br><span class="line">sem <span class="keyword">chan</span> token</span><br><span class="line"></span><br><span class="line">errOnce sync.Once</span><br><span class="line">err     <span class="type">error</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4><span id="2åœ¨å¹¶å‘ç¼–ç¨‹é‡Œ-syncwaitgroup">2.åœ¨å¹¶å‘ç¼–ç¨‹é‡Œ sync.WaitGroup</span></h4><p>å¹¶å‘åŸè¯­çš„ä½¿ç”¨é¢‘ç‡éå¸¸é«˜ï¼Œå®ƒç»å¸¸ç”¨äºååŒç­‰å¾…çš„åœºæ™¯ gorouting éƒ½å®Œæˆåæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚</p><p>å¦‚æœåœ¨woker goroutineçš„æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°é”™è¯¯å¹¶æƒ³è¦å¤„ç†è¯¥æ€ä¹ˆåŠï¼Ÿ</p><p>WaitGroupå¹¶æ²¡æœ‰æä¾›ä¼ æ’­é”™è¯¯çš„åŠŸèƒ½ï¼Œé‡åˆ°è¿™ç§åœºæ™¯æˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼ŸGoè¯­è¨€åœ¨æ‰©å±•åº“æä¾›äº†ErrorGroupå¹¶å‘åŸè¯­æ­£å¥½é€‚åˆåœ¨è¿™ç§åœºæ™¯ä¸‹ä½¿ç”¨ï¼Œå®ƒåœ¨WaitGroupçš„åŸºç¡€ä¸Šè¿˜æä¾›äº†ï¼Œé”™è¯¯ä¼ æ’­ä»¥åŠä¸Šä¸‹æ–‡å–æ¶ˆçš„åŠŸèƒ½ã€‚</p><p>æ‰©å±•åº“é€šè¿‡errorgroup.Groupæä¾›ErrorGroupåŸè¯­çš„åŠŸèƒ½ï¼Œå®ƒæœ‰ä¸‰ä¸ªæ–¹æ³•å¯è°ƒç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">func WithContext(ctx context.Context) (*Group, context.Context)</span><br><span class="line">func (g *Group) Go(f func() error)</span><br><span class="line">func (g *Group) Wait() error</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ErrorGroupæœ‰ä¸€ä¸ªç‰¹ç‚¹æ˜¯ä¼šè¿”å›æ‰€ä»¥æ‰§è¡Œä»»åŠ¡çš„goroutineé‡åˆ°çš„ç¬¬ä¸€ä¸ªé”™è¯¯</span></span><br></pre></td></tr></table></figure><h4><span id="3æƒ³è®©ç¨‹åºé‡åˆ°é”™è¯¯å°±ç»ˆæ­¢å…¶ä»–å­ä»»åŠ¡">3.æƒ³è®©ç¨‹åºé‡åˆ°é”™è¯¯å°±ç»ˆæ­¢å…¶ä»–å­ä»»åŠ¡</span></h4><p>æœ€æ—©æ‰§è¡Œé‡åˆ°é”™è¯¯çš„goroutineè¾“å‡ºäº†Error: 98ä½†æ˜¯æ‰€æœ‰æœªæ‰§è¡Œå®Œçš„å…¶ä»–ä»»åŠ¡å¹¶æ²¡æœ‰åœæ­¢æ‰§è¡Œï¼Œé‚£ä¹ˆæƒ³è®©ç¨‹åºé‡åˆ°é”™è¯¯å°±ç»ˆæ­¢å…¶ä»–å­ä»»åŠ¡è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç”¨errgroup.Groupæä¾›çš„WithContextæ–¹æ³•åˆ›å»ºä¸€ä¸ªå¸¦å¯å–æ¶ˆä¸Šä¸‹æ–‡åŠŸèƒ½çš„ErrorGroupã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">ä½¿ç”¨errorgroup.Groupæ—¶æ³¨æ„å®ƒçš„ä¸¤ä¸ªç‰¹ç‚¹ï¼š</span><br><span class="line">- errgroup.Groupåœ¨å‡ºç°é”™è¯¯æˆ–è€…ç­‰å¾…ç»“æŸåéƒ½ä¼šè°ƒç”¨ Contextå¯¹è±¡ çš„ cancel æ–¹æ³•åŒæ­¥å–æ¶ˆä¿¡å·ã€‚</span><br><span class="line">- åªæœ‰ç¬¬ä¸€ä¸ªå‡ºç°çš„é”™è¯¯æ‰ä¼šè¢«è¿”å›ï¼Œå‰©ä½™çš„é”™è¯¯éƒ½ä¼šè¢«ç›´æ¥æŠ›å¼ƒã€‚</span><br><span class="line">*/</span><br><span class="line">func main() &#123;</span><br><span class="line">   eg, ctx := errgroup.WithContext(context.Background())</span><br><span class="line"></span><br><span class="line">   for i := 0; i &lt; 100; i++ &#123;</span><br><span class="line">      i := i</span><br><span class="line">      eg.Go(func() error &#123;</span><br><span class="line">         time.Sleep(2 * time.Second)</span><br><span class="line"></span><br><span class="line">         select &#123;</span><br><span class="line">         case &lt;-ctx.Done():</span><br><span class="line">            fmt.Println(&quot;Canceled:&quot;, i)</span><br><span class="line">            return nil</span><br><span class="line">         default:</span><br><span class="line">            if i &gt; 90 &#123;</span><br><span class="line">               fmt.Println(&quot;Error:&quot;, i)</span><br><span class="line">               return fmt.Errorf(&quot;Error: %d&quot;, i)</span><br><span class="line">            &#125;</span><br><span class="line">            fmt.Println(&quot;End:&quot;, i)</span><br><span class="line">            return nil</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">   &#125;</span><br><span class="line">   if err := eg.Wait(); err != nil &#123;</span><br><span class="line">      log.Fatal(err)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4><span id="4cancleåˆ°å…¶ä»–çš„å­ä»»åŠ¡">4.cancleåˆ°å…¶ä»–çš„å­ä»»åŠ¡</span></h4><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå­goroutineå‡ºç°é”™è¯¯åï¼Œä¼šcancleåˆ°å…¶ä»–çš„å­ä»»åŠ¡ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶æ²¡æœ‰çœ‹åˆ°è°ƒç”¨ctxçš„cancelæ–¹æ³•ï¼Œä¸‹é¢æˆ‘ä»¬çœ‹ä¸‹æºç ï¼Œçœ‹çœ‹å†…éƒ¨æ˜¯æ€ä¹ˆå¤„ç†çš„ã€‚<br> errgroup çš„è®¾è®¡éå¸¸ç²¾ç»ƒï¼Œå…¨éƒ¨ä»£ç å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">package errgroup</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">    &quot;context&quot;</span><br><span class="line">    &quot;sync&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// A Group is a collection of goroutines working on subtasks that are part of</span><br><span class="line">// the same overall task.</span><br><span class="line">//</span><br><span class="line">// A zero Group is valid and does not cancel on error.</span><br><span class="line">type Group struct &#123;</span><br><span class="line">    cancel func()</span><br><span class="line">    wg sync.WaitGroup</span><br><span class="line">    errOnce sync.Once</span><br><span class="line">    err     error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// WithContext returns a new Group and an associated Context derived from ctx.</span><br><span class="line">//</span><br><span class="line">// The derived Context is canceled the first time a function passed to Go</span><br><span class="line">// returns a non-nil error or the first time Wait returns, whichever occurs</span><br><span class="line">// first.</span><br><span class="line">func WithContext(ctx context.Context) (*Group, context.Context) &#123;</span><br><span class="line">    ctx, cancel := context.WithCancel(ctx)</span><br><span class="line">    return &amp;Group&#123;cancel: cancel&#125;, ctx</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Wait blocks until all function calls from the Go method have returned, then</span><br><span class="line">// returns the first non-nil error (if any) from them.</span><br><span class="line">func (g *Group) Wait() error &#123;</span><br><span class="line">    g.wg.Wait()</span><br><span class="line">    if g.cancel != nil &#123;</span><br><span class="line">        g.cancel()</span><br><span class="line">    &#125;</span><br><span class="line">    return g.err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Go calls the given function in a new goroutine.</span><br><span class="line">//</span><br><span class="line">// The first call to return a non-nil error cancels the group; its error will be</span><br><span class="line">// returned by Wait.</span><br><span class="line">func (g *Group) Go(f func() error) &#123;</span><br><span class="line">    g.wg.Add(1)</span><br><span class="line"></span><br><span class="line">    go func() &#123;</span><br><span class="line">        defer g.wg.Done()</span><br><span class="line"></span><br><span class="line">        if err := f(); err != nil &#123;</span><br><span class="line">            g.errOnce.Do(func() &#123;</span><br><span class="line">                g.err = err</span><br><span class="line">                if g.cancel != nil &#123;</span><br><span class="line">                    g.cancel()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;()</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œerrgroup çš„å®ç°ä¾é äºç»“æ„ä½“ Groupï¼Œå®ƒé€šè¿‡å°è£… sync.WaitGroupï¼Œç»§æ‰¿äº† WaitGroup çš„ç‰¹æ€§ï¼Œåœ¨ Go() æ–¹æ³•ä¸­æ–°èµ·ä¸€ä¸ªå­ä»»åŠ¡ goroutineï¼Œå¹¶åœ¨ Wait() æ–¹æ³•ä¸­é€šè¿‡ sync.WaitGroup çš„ Wait è¿›è¡Œé˜»å¡ç­‰å¾…ã€‚</p><p>åŒæ—¶ Group åˆ©ç”¨ sync.Once ä¿è¯äº†å®ƒæœ‰ä¸”ä»…ä¼šä¿ç•™ç¬¬ä¸€ä¸ªå­ goroutine é”™è¯¯ã€‚<br> Group é€šè¿‡åµŒå…¥ context.WithCancel æ–¹æ³•äº§ç”Ÿçš„ <code>cancel</code> å‡½æ•°ï¼ˆå¯¹äº Context ä¸ç†Ÿæ‚‰çš„è¯»è€…ï¼Œæ¨èé˜…è¯» <a href="https://links.jianshu.com/go?to=https://mp.weixin.qq.com/s?__biz=MzkyMzIyNjIxMQ==&mid=2247484553&idx=1&sn=ce4c7e052bacf69c38e27d71187726c8&scene=21%23wechat_redirect">ç†è§£Contextæœºåˆ¶</a> ä¸€æ–‡ï¼‰ï¼Œèƒ½å¤Ÿ<strong>åœ¨å­ goroutine å‘ç”Ÿé”™è¯¯æ—¶ï¼ŒåŠæ—¶é€šè¿‡è°ƒç”¨ cancle å‡½æ•°ï¼Œå°† Context çš„å–æ¶ˆä¿¡å·åŠæ—¶ä¼ æ’­å‡ºå»ã€‚</strong></p><h4><span id="5æ€»ç»“">5.æ€»ç»“:</span></h4><p>ä½¿ç”¨errorgroup.Groupæ—¶æ³¨æ„å®ƒçš„ç‰¹ç‚¹ï¼š</p><ul><li>ç»§æ‰¿äº† WaitGroup çš„åŠŸèƒ½</li><li>errgroup.Groupåœ¨å‡ºç°é”™è¯¯æˆ–è€…ç­‰å¾…ç»“æŸåéƒ½ä¼šè°ƒç”¨Contextå¯¹è±¡ çš„ cancel æ–¹æ³•åŒæ­¥å–æ¶ˆä¿¡å·ã€‚</li><li>åªæœ‰ç¬¬ä¸€ä¸ªå‡ºç°çš„é”™è¯¯æ‰ä¼šè¢«è¿”å›ï¼Œå‰©ä½™çš„é”™è¯¯éƒ½ä¼šè¢«ç›´æ¥æŠ›å¼ƒã€‚</li><li>context ä¿¡å·ä¼ æ’­ï¼šå¦‚æœå­ä»»åŠ¡ goroutine ä¸­æœ‰å¾ªç¯é€»è¾‘ï¼Œåˆ™å¯ä»¥æ·»åŠ  ctx.Done é€»è¾‘ï¼Œæ­¤æ—¶é€šè¿‡ context çš„å–æ¶ˆä¿¡å·ï¼Œæå‰ç»“æŸå­ä»»åŠ¡æ‰§è¡Œã€‚</li></ul><p>.</p>]]></content>
      
      
      <categories>
          
          <category> GOLANG </category>
          
      </categories>
      
      
        <tags>
            
            <tag> error.group </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8s-kubeadminå®‰è£…</title>
      <link href="/blog/2024/03/18/K8s/k8s-1-kubeadmin%E5%AE%89%E8%A3%85/"/>
      <url>/blog/2024/03/18/K8s/k8s-1-kubeadmin%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>é€šè¿‡kubeadmå·¥å…·ï¼Œéƒ¨ç½²k8sé›†ç¾¤ã€‚æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>å‡†å¤‡å·¥ä½œï¼š</p></li><li><ol><li>é…ç½®yumæºï¼Œrepo(é˜²è¢«å¢™)</li><li>å®‰è£…å¸¸ç”¨å·¥å…·ï¼ŒåŒæ­¥æ—¶é—´</li><li>å…³é—­é˜²ç«å¢™ï¼Œå°†SELinuxé…ç½®ä¸ºPermissiveæ¨¡å¼ï¼Œå…³é—­swap</li><li>åŠ è½½ipvsæ¨¡å—ï¼Œä¼˜åŒ–å†…æ ¸</li></ol></li><li><p>åœ¨æ‰€æœ‰æœºå™¨ä¸Šå®‰è£…docker</p></li><li><p>åœ¨æ‰€æœ‰æœºå™¨ä¸Šå®‰è£…kubeadm, kubelet, kubectl</p></li><li><p>éƒ¨ç½²é›†ç¾¤MasterèŠ‚ç‚¹</p></li><li><p>éƒ¨ç½²é›†ç¾¤å·¥ä½œèŠ‚ç‚¹</p></li><li><p>å®‰è£…CNIç½‘ç»œæ’ä»¶</p></li></ol><ul><li>ä¸€ä¸ªKubernetesé›†ç¾¤MasterèŠ‚ç‚¹ã€‚k8så®˜ç½‘ç°åœ¨å°†masterèŠ‚ç‚¹ç§°ä¸ºcontrol plane node(æ§åˆ¶å¹³é¢èŠ‚ç‚¹)</li><li>ä¸€ä¸ªKubernetesé›†ç¾¤SlaveèŠ‚ç‚¹ã€‚k8så®˜ç½‘å«worker node(å·¥ä½œèŠ‚ç‚¹)ã€‚ä¸‹æ–‡ä¸­SlaveèŠ‚ç‚¹å’Œå·¥ä½œèŠ‚ç‚¹å«ä¹‰å«ä¹‰ç›¸åŒã€‚</li></ul><table><thead><tr><th>hostname</th><th>ip</th><th>å¤‡æ³¨</th><th></th></tr></thead><tbody><tr><td>master</td><td>master.k8s</td><td>192.168.246.133</td><td>k8sä¸»èŠ‚ç‚¹(control plane node)</td></tr><tr><td>slave</td><td>slave.k8s</td><td>192.168.246.132</td><td>k8s å·¥ä½œèŠ‚ç‚¹(worker node)</td></tr></tbody></table><h2><span id="0-ç³»ç»Ÿè¦æ±‚">0. <strong>ç³»ç»Ÿè¦æ±‚</strong></span></h2><p>å®‰è£…ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ“ä½œç³»ç»Ÿæ»¡è¶³å¦‚ä¸‹è¦æ±‚ï¼š</p><ol><li>Linuxå†…æ ¸æ“ä½œç³»ç»Ÿï¼Œå¦‚CentOSï¼ŒUbuntuç­‰</li><li>è‡³å°‘2 CPUï¼Œ 2GB</li><li>é›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨ä¹‹é—´çš„ç½‘ç»œå¿…é¡»æ˜¯é€šçš„(å…¬å…±æˆ–ç§æœ‰ç½‘ç»œéƒ½å¯ä»¥)ã€‚</li><li>æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰å”¯ä¸€çš„ä¸»æœºåã€MACåœ°å€å’Œproduct_uuid</li><li>éƒ¨ç½²æ—¶è¦ä¿è¯èƒ½è¿å¤–ç½‘</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># æŸ¥çœ‹æ“ä½œç³»ç»Ÿ</span></span></span><br><span class="line">cat /proc/version</span><br><span class="line">hostnamectl</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># æŸ¥çœ‹IPå’ŒMACå‘½ä»¤</span></span></span><br><span class="line">ip link</span><br><span class="line">ifconfig -a</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># æŸ¥çœ‹product_uuid</span></span></span><br><span class="line">sudo cat /sys/class/dmi/id/product_uuid</span><br></pre></td></tr></table></figure><h2><span id="1-å‡†å¤‡å·¥ä½œ"><strong>1. å‡†å¤‡å·¥ä½œ</strong></span></h2><p><strong>åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šè¿è¡Œ</strong></p><h3><span id="11-é…ç½®yumæºrepo"><strong>1.1 é…ç½®yumæºï¼Œrepo</strong></span></h3><p>ç”±äºä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œä¸ºé˜²æ­¢åœ¨å®‰è£…æ—¶å‡ºç°èµ„æºä¸‹è½½å¤±è´¥çš„é—®é¢˜ï¼Œåœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šé…ç½®yumæºï¼Œrepoã€‚shellå¦‚ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yumæº</span></span><br><span class="line">curl -o /etc/yum.repos.d/Centos-7.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker repo</span></span><br><span class="line">curl -o /etc/yum.repos.d/docker-ce.repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubernetes repo</span></span><br><span class="line">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo</span><br><span class="line">[kubernetes]</span><br><span class="line">name=Kubernetes</span><br><span class="line">baseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">repo_gpgcheck=0</span><br><span class="line">gpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg</span><br><span class="line">       http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg</span><br><span class="line">EOF</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç¼“å­˜</span></span><br><span class="line">yum clean all &amp;&amp; yum makecache</span><br></pre></td></tr></table></figure><h3><span id="12-å®‰è£…å¸¸ç”¨çš„å·¥å…·åŒæ­¥æ—¶é—´"><strong>1.2 å®‰è£…å¸¸ç”¨çš„å·¥å…·ï¼ŒåŒæ­¥æ—¶é—´</strong></span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yum -y install tree vim wget bash-completion bash-completion-extras lrzsz net-tools sysstat iotop iftop htop unzip nc nmap telnet bc  psmisc httpd-tools ntpdate</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ—¶åŒºä¿®æ”¹,å¦‚æœ/etc/localtimeæœ‰è½¯è¿æ¥,ä¸æ˜¯Shanghai,å¯ä»¥ç›´æ¥åˆ é™¤,åœ¨è½¯é“¾æ¥</span></span><br><span class="line">ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br><span class="line">ntpdate ntp2.aliyun.com            # åŒæ­¥é˜¿é‡Œäº‘æœåŠ¡å™¨ä¸Šçš„æ—¶é—´.</span><br><span class="line">/sbin/hwclock --systohc            # å†™å…¥åˆ°biosç³»ç»Ÿ    </span><br></pre></td></tr></table></figure><h3><span id="13-æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦å…³é—­å°†selinuxé…ç½®ä¸ºpermissiveæ¨¡å¼å…³é—­swap"><strong>1.3 æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦å…³é—­ï¼Œå°†SELinuxé…ç½®ä¸ºPermissiveæ¨¡å¼ï¼Œå…³é—­swap</strong></span></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</span></span></span><br><span class="line">sudo firewall-cmd --state</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># å¦‚æœé˜²ç«å¢™æ˜¯runningï¼Œå…³é—­é˜²ç«å¢™</span></span></span><br><span class="line">sudo systemctl disable firewalld &amp;&amp; systemctl stop firewalld</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># Set SELinux to permissive mode.å°†SELinuxé…ç½®ä¸ºPermissiveæ¨¡å¼</span></span></span><br><span class="line">sudo setenforce 0</span><br><span class="line">sudo sed -i &#x27;s/^SELINUX=enforcing$/SELINUX=permissive/&#x27; /etc/selinux/config</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># ä¹Ÿå¯ä»¥ç›´æ¥å…³é—­SELinux</span></span> </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">sudo setenforce 0</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">sudo sed -ri <span class="string">&#x27;s#(SELINUX=).*#\1disabled#&#x27;</span> /etc/selinux/config</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸´æ—¶å…³é—­swapã€‚å¦‚æœä¸å…³é—­ï¼Œkubeletä¼šå¯åŠ¨å¤±è´¥</span></span><br><span class="line">sudo swapoff -a</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ°¸ä¹…é˜²æ­¢å¼€æœºè‡ªåŠ¨æŒ‚è½½swap</span></span><br><span class="line">sudo sed -i &#x27;/ swap / s/^\(.*\)$/#\1/g&#x27; /etc/fstab</span><br></pre></td></tr></table></figure><h3><span id="14-åŠ è½½ipvsæ¨¡å—ä¼˜åŒ–å†…æ ¸"><strong>1.4 åŠ è½½ipvsæ¨¡å—ï¼Œä¼˜åŒ–å†…æ ¸</strong></span></h3><p>å¦‚ä¸‹å‚æ•°ä¸ä¿®æ”¹ï¼Œä¼šå¯¼è‡´<code>kubeadm init</code>è¿è¡Œå¤±è´¥ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åŠ è½½ipvsæ¨¡å—</span></span><br><span class="line">modprobe br_netfilter</span><br><span class="line">modprobe -- ip_vs</span><br><span class="line">modprobe -- ip_vs_sh</span><br><span class="line">modprobe -- ip_vs_rr</span><br><span class="line">modprobe -- ip_vs_wrr</span><br><span class="line">modprobe -- nf_conntrack_ipv4</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">éªŒè¯ip_vsæ¨¡å—</span></span><br><span class="line">lsmod |grep ip_vs</span><br><span class="line">ip_vs_wrr              12697  0 </span><br><span class="line">ip_vs_rr               12600  0 </span><br><span class="line">ip_vs_sh               12688  0 </span><br><span class="line">ip_vs                 145458  6 ip_vs_rr,ip_vs_sh,ip_vs_wrr</span><br><span class="line">nf_conntrack          139264  2 ip_vs,nf_conntrack_ipv4</span><br><span class="line">libcrc32c              12644  3 xfs,ip_vs,nf_conntrack</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å†…æ ¸æ–‡ä»¶</span> </span><br><span class="line">cat &lt;&lt;EOF &gt;  /etc/sysctl.d/k8s.conf</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line">net.ipv4.ip_forward=1</span><br><span class="line">vm.max_map_count=262144</span><br><span class="line">EOF</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç”Ÿæ•ˆå¹¶éªŒè¯å†…æ ¸ä¼˜åŒ–</span></span><br><span class="line">sysctl -p /etc/sysctl.d/k8s.conf</span><br></pre></td></tr></table></figure><h2><span id="2-å®‰è£…docker"><strong>2. å®‰è£…docker</strong></span></h2><p><em>åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šè¿è¡Œ</em></p><h3><span id="21-å®‰è£…å¯åŠ¨docker"><strong>2.1 å®‰è£…å¯åŠ¨docker</strong></span></h3><p>æ³¨æ„ï¼šå®‰è£…dockeréœ€è¦rootæƒé™ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 1. yum å®‰è£…</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># è¿è¡Œsudo yum install docker-ce ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œdocker-ceä¾èµ–äº†docker-ce-cli, containerd.io, docker-buildx-plugin, docker-compose-pluginã€‚è¿™äº›ä¾èµ–ä¼šåŒæ­¥install</span></span></span><br><span class="line">yum install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 2. é…ç½®docker</span></span></span><br><span class="line">cat &lt;&lt;EOF &gt; /etc/docker/daemon.json</span><br><span class="line">&#123;</span><br><span class="line">    &quot;registry-mirrors&quot;: [</span><br><span class="line">        &quot;https://registry.hub.docker.com&quot;,</span><br><span class="line">        &quot;http://hub-mirror.c.163.com&quot;,</span><br><span class="line">        &quot;https://docker.mirrors.ustc.edu.cn&quot;,</span><br><span class="line">        &quot;https://registry.docker-cn.com&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125; </span><br><span class="line">EOF</span><br><span class="line">   </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 3. å¯åŠ¨docker</span></span></span><br><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure><p>éªŒè¯æ˜¯å¦å®‰è£…æ­£ç¡®</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 4. dockerè¿è¡Œæ­£å¸¸</span></span><br><span class="line">[shirley@master k8s_install]$ systemctl status docker</span><br><span class="line">â— docker.service - Docker Application Container Engine</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/docker.service; disabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Tue 2023-10-10 09:23:41 CST; 19s ago</span><br><span class="line">     Docs: https://docs.docker.com</span><br><span class="line"> Main PID: 16381 (dockerd)</span><br><span class="line">    Tasks: 8</span><br><span class="line">   Memory: 27.4M</span><br><span class="line">   CGroup: /system.slice/docker.service</span><br><span class="line">           â””â”€16381 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/con...</span><br><span class="line">[shirley@master k8s_install]$</span><br><span class="line"></span><br><span class="line"><span class="comment">## è¿è¡Œdockerå‘½ä»¤ï¼ŒéªŒè¯é•œåƒä¸‹è½½æ­£å¸¸ï¼Œå®¹å™¨è¿è¡Œæ­£å¸¸</span></span><br><span class="line">[shirley@slave k8s_install]$ sudo docker run hello-world</span><br><span class="line">Unable to find image <span class="string">&#x27;hello-world:latest&#x27;</span> locally</span><br><span class="line">latest: Pulling from library/hello-world</span><br><span class="line">719385e32844: Pull complete</span><br><span class="line">Digest: sha256:4f53e2564790c8e7856ec08e384732aa38dc43c52f02952483e3f003afbf23db</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> hello-world:latest</span><br><span class="line"></span><br><span class="line">Hello from Docker!</span><br><span class="line">This message shows that your installation appears to be working correctly.</span><br><span class="line">... ...</span><br></pre></td></tr></table></figure><h3><span id="22-é…ç½®containerdä¸­pauseé•œåƒåœ°å€"><strong>2.2 é…ç½®containerdä¸­pauseé•œåƒåœ°å€</strong></span></h3><p>ä¸ºäº†é˜²æ­¢å®‰è£…è¿‡ç¨‹ä¸­å‡ºç°pauseé•œåƒä¸‹è½½å¤±è´¥çš„é—®é¢˜ï¼Œå»ºè®®è¿è¡Œ<code>containerd config dump &gt; /etc/containerd/config.toml </code>å‘½ä»¤ï¼Œå°†å½“å‰é…ç½®å¯¼å‡ºåˆ°æ–‡ä»¶ï¼Œå¹¶ä¿®æ”¹<code>sandbox_image</code>é…ç½®ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># å¦‚æœæ²¡æœ‰/etc/containerd/config.tomlæ–‡ä»¶ï¼Œå°†é»˜è®¤é…ç½®å¯¼å‡ºåˆ°/etc/containerd/config.tomlã€‚</span></span></span><br><span class="line">containerd config default &gt; /etc/containerd/config.toml</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># ä¿®æ”¹é…ç½®æ–‡ä»¶/etc/containerd/config.tomlï¼Œ æ›´æ”¹sandbox_imageé…ç½®</span></span></span><br><span class="line">[plugins]</span><br><span class="line">  [plugins.&quot;io.containerd.grpc.v1.cri&quot;]</span><br><span class="line">    sandbox_image = &quot;registry.aliyuncs.com/google_containers/pause:3.9&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># PS: å¦‚æœç”Ÿæˆçš„/etc/containerd/config.tomlä¸­æ²¡æœ‰å¦‚ä¸Šé…ç½®é¡¹ï¼Œå¯ä»¥è¿è¡Œå¦‚ä¸‹å‘½ä»¤å¯¼å‡ºå½“å‰æ‰€æœ‰é…ç½®é¡¹åå†ä¿®æ”¹æ–‡ä»¶/etc/containerd/config.toml</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">containerd config dump &gt; /etc/containerd/config.toml</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># é‡å¯containerd</span></span></span><br><span class="line">systemctl restart containerd</span><br></pre></td></tr></table></figure><h2><span id="3-éƒ¨ç½²kubeadm-kubelet-kubectl"><strong>3. éƒ¨ç½²kubeadm, kubelet, kubectl</strong></span></h2><p>kubeadmï¼šå¯åŠ¨k8sé›†ç¾¤çš„å·¥å…·</p><p>kubelet: è¯¥ç»„ä»¶åœ¨é›†ç¾¤ä¸­çš„æ‰€æœ‰æœºå™¨ä¸Šè¿è¡Œï¼Œå¹¶æ‰§è¡Œå¯åŠ¨podå’Œå®¹å™¨ä¹‹ç±»çš„ä»»åŠ¡ã€‚</p><p>kubectl: ä¸é›†ç¾¤é€šä¿¡çš„å·¥å…·ã€‚å¯ä»¥åªåœ¨masterèŠ‚ç‚¹ä¸Šå®‰è£…ã€‚</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes</span><br><span class="line"></span><br><span class="line">## å¼€æœºå¯åŠ¨kubelet</span><br><span class="line">sudo systemctl enable --now kubelet</span><br></pre></td></tr></table></figure><p>éªŒè¯</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹kubeadmç‰ˆæœ¬</span></span><br><span class="line">[root@master ~]<span class="comment"># sudo kubeadm version</span></span><br><span class="line">kubeadm version: &amp;version.Info&#123;Major:<span class="string">&quot;1&quot;</span>, Minor:<span class="string">&quot;28&quot;</span>, GitVersion:<span class="string">&quot;v1.28.2&quot;</span>, GitCommit:<span class="string">&quot;89a4ea3e1e4ddd7f7572286090359983e0387b2f&quot;</span>, GitTreeState:<span class="string">&quot;clean&quot;</span>, BuildDate:<span class="string">&quot;2023-09-13T09:34:32Z&quot;</span>, GoVersion:<span class="string">&quot;go1.20.8&quot;</span>, Compiler:<span class="string">&quot;gc&quot;</span>, Platform:<span class="string">&quot;linux/amd64&quot;</span>&#125;</span><br></pre></td></tr></table></figure><h2><span id="4-åˆå§‹åŒ–masterèŠ‚ç‚¹kubeadm-init"><strong>4.</strong> åˆå§‹åŒ–MasterèŠ‚ç‚¹ï¼ˆkubeadm initï¼‰</span></h2><p><em>åœ¨MasterèŠ‚ç‚¹è¿è¡Œ</em></p><h3><span id="41-æ›´æ”¹é…ç½®æ–‡ä»¶"><strong>4.1. æ›´æ”¹é…ç½®æ–‡ä»¶</strong></span></h3><p><code>kubeadm init</code>å‘½ä»¤ç”¨äºåˆå§‹åŒ–masterèŠ‚ç‚¹ã€‚kubeadm init çš„å‚æ•°å¯ä»¥é€šè¿‡<strong>å‘½ä»¤è¡Œ</strong>æˆ–<strong>yamlæ–‡ä»¶</strong>è¿›è¡Œé…ç½®ã€‚æœ¬æ–‡ä»‹ç»å¦‚ä½•é€šè¿‡yamlæ–‡ä»¶è¿›è¡Œé…ç½®ã€‚å¯ä»¥é€šè¿‡<code>kubeadm config print init-defaults</code>å‘½ä»¤å¾—åˆ°ä¸€ä»½é»˜è®¤é…ç½®ï¼Œç„¶åå¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubeadm config <span class="built_in">print</span> init-defaults &gt; kubeadm.yaml</span><br></pre></td></tr></table></figure><p>å¯¹kubeadm.yamlè¿›è¡Œç¼–è¾‘ï¼Œä¿®æ”¹å†…å®¹å¦‚ä¸‹ï¼š</p><ol><li>ä¿®æ”¹<code>advertiseAddress</code>ä¸ºmaster IPåœ°å€</li><li><code>imageRepository</code>ä¿®æ”¹ä¸º<code>registry.aliyuncs.com/google_containers</code>ï¼Œé˜²æ­¢é•œåƒæ‹‰ä¸ä¸‹æ¥</li><li>å»ºè®®å°†<code>networking.podSubnet</code>ä¿®æ”¹ä¸º<code>10.244.0.0/16</code>ï¼Œ å’Œåç»­å®‰è£…çš„flannel CNI æ’ä»¶çš„é»˜è®¤é…ç½®ä¿æŒä¸€è‡´ã€‚</li></ol><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: kubeadm.k8s.io/v1beta3</span><br><span class="line">bootstrapTokens:</span><br><span class="line">- groups:</span><br><span class="line">  - system:bootstrappers:kubeadm:default-node-token</span><br><span class="line">  token: abcdef.0123456789abcdef</span><br><span class="line">  ttl: 24h0m0s</span><br><span class="line">  usages:</span><br><span class="line">  - signing</span><br><span class="line">  - authentication</span><br><span class="line">kind: InitConfiguration</span><br><span class="line">localAPIEndpoint:</span><br><span class="line">  advertiseAddress: 192.168.246.133    ## change the IP of apiserver.</span><br><span class="line">  bindPort: 6443</span><br><span class="line">nodeRegistration:</span><br><span class="line">  criSocket: unix:///var/run/containerd/containerd.sock</span><br><span class="line">  imagePullPolicy: IfNotPresent</span><br><span class="line">  name: node</span><br><span class="line">  taints: null</span><br><span class="line">---</span><br><span class="line">apiServer:</span><br><span class="line">  timeoutForControlPlane: 4m0s</span><br><span class="line">apiVersion: kubeadm.k8s.io/v1beta3</span><br><span class="line">certificatesDir: /etc/kubernetes/pki</span><br><span class="line">clusterName: kubernetes</span><br><span class="line">controllerManager: &#123;&#125;</span><br><span class="line">dns: &#123;&#125;</span><br><span class="line">etcd:</span><br><span class="line">  local:</span><br><span class="line">    dataDir: /var/lib/etcd</span><br><span class="line">imageRepository: registry.aliyuncs.com/google_containers   ## change imageRepository to aliyun.</span><br><span class="line">kind: ClusterConfiguration</span><br><span class="line">kubernetesVersion: 1.28.0</span><br><span class="line">networking:</span><br><span class="line">  dnsDomain: cluster.local</span><br><span class="line">  podSubnet: 10.244.0.0/16  ## add this line to config POD network. Same with CNI config.</span><br><span class="line">  serviceSubnet: 10.96.0.0/12</span><br><span class="line">scheduler: &#123;&#125;</span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šé…ç½®æ–‡ä»¶ç­‰ä»·äºå‘½ä»¤è¡Œï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kubeadm init \</span><br><span class="line">  --apiserver-advertise-address=192.168.246.133 \</span><br><span class="line">  --image-repository registry.aliyuncs.com/google_containers \</span><br><span class="line">  --kubernetes-version v1.28.0 \</span><br><span class="line">  --service-cidr=10.96.0.0/12 \</span><br><span class="line">  --pod-network-cidr=10.244.0.0/16 </span><br></pre></td></tr></table></figure><ul><li>â€“apiserver-advertise-address é›†ç¾¤é€šå‘Šåœ°å€</li><li>â€“image-repository ç”±äºé»˜è®¤æ‹‰å–é•œåƒåœ°å€<a href="https://link.zhihu.com/?target=http://k8s.gcr.io">http://k8s.gcr.io</a>å›½å†…æ— æ³•è®¿é—®ï¼Œè¿™é‡ŒæŒ‡å®šé˜¿é‡Œäº‘é•œåƒä»“åº“åœ°å€</li><li>â€“kubernetes-version K8sç‰ˆæœ¬ï¼Œä¸ä¸Šé¢å®‰è£…çš„ä¸€è‡´</li><li>â€“service-cidr é›†ç¾¤å†…éƒ¨è™šæ‹Ÿç½‘ç»œï¼ŒPodç»Ÿä¸€è®¿é—®å…¥å£</li><li>â€“pod-network-cidr Podç½‘ç»œï¼Œ<strong>ä¸ä¸‹é¢éƒ¨ç½²çš„CNIç½‘ç»œç»„ä»¶yamlä¸­ä¿æŒä¸€è‡´</strong></li></ul><h3><span id="42-æå‰pullé•œåƒå¯é€‰"><strong>4.2 æå‰pullé•œåƒï¼ˆå¯é€‰ï¼‰</strong></span></h3><p>ä¸ºäº†ä½¿åç»­å®‰è£…æ›´å¿«ï¼Œå»ºè®®å…ˆæŠŠå®‰è£…éœ€è¦çš„é•œåƒpullä¸‹æ¥ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## éªŒè¯é…ç½®æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®</span></span><br><span class="line">[shirley@master k8s_install]$ kubeadm config validate --config kubeadm.yaml</span><br><span class="line">ok</span><br><span class="line"></span><br><span class="line"><span class="comment">## æŸ¥çœ‹éœ€è¦ä¸‹è½½å“ªäº›é•œåƒã€‚éœ€è¦å…³æ³¨ä¸‹è½½çš„repositoryåœ°å€æ˜¯å¦æ­£ç¡®ã€‚</span></span><br><span class="line"><span class="comment">## å¦‚ä¸Šåœ¨kubeadm.yamlæ–‡ä»¶é…ç½®äº†imageRepositoryï¼šregistry.aliyuncs.com/google_containersï¼Œå› æ­¤imagesä¼šä»aliyunçš„repoä¸‹è½½ã€‚</span></span><br><span class="line">[shirley@master k8s_install]$ kubeadm config images list --config kubeadm.yaml</span><br><span class="line">registry.aliyuncs.com/google_containers/kube-apiserver:v1.28.0</span><br><span class="line">registry.aliyuncs.com/google_containers/kube-controller-manager:v1.28.0</span><br><span class="line">registry.aliyuncs.com/google_containers/kube-scheduler:v1.28.0</span><br><span class="line">registry.aliyuncs.com/google_containers/kube-proxy:v1.28.0</span><br><span class="line">registry.aliyuncs.com/google_containers/pause:3.9</span><br><span class="line">registry.aliyuncs.com/google_containers/etcd:3.5.9-0</span><br><span class="line">registry.aliyuncs.com/google_containers/coredns:v1.10.1</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="comment">## pullé•œåƒã€‚pullé•œåƒæœ‰ç‚¹æ…¢ï¼Œç¬¬ä¸€ä¸ªé•œåƒpullæˆåŠŸåæ‰æœ‰æ—¥å¿—è¾“å‡ºã€‚å‘½ä»¤è¿è¡Œåå‘ç°æ²¡æœ‰æ—¥å¿—ä¸è¦ç€æ€¥ï¼Œå¤šç­‰ä¸€ä¼šã€‚</span></span><br><span class="line">[shirley@master k8s_install]$ sudo kubeadm config images pull --config kubeadm.yaml</span><br><span class="line">[config/images] Pulled registry.aliyuncs.com/google_containers/kube-apiserver:v1.28.0</span><br><span class="line">[config/images] Pulled registry.aliyuncs.com/google_containers/kube-controller-manager:v1.28.0</span><br><span class="line">[config/images] Pulled registry.aliyuncs.com/google_containers/kube-scheduler:v1.28.0</span><br><span class="line">[config/images] Pulled registry.aliyuncs.com/google_containers/kube-proxy:v1.28.0</span><br><span class="line">[config/images] Pulled registry.aliyuncs.com/google_containers/pause:3.9</span><br><span class="line">[config/images] Pulled registry.aliyuncs.com/google_containers/etcd:3.5.9-0</span><br><span class="line">[config/images] Pulled registry.aliyuncs.com/google_containers/coredns:v1.10.1</span><br></pre></td></tr></table></figure><h3><span id="43-kubeadm-initåˆå§‹åŒ–"><strong>4.3 kubeadm initåˆå§‹åŒ–</strong></span></h3><p>è¿è¡Œ<code>kubeadm init --config kubeadm.yaml</code>ï¼Œ å½“çœ‹åˆ°<code>Your Kubernetes control-plane has initialized successfully!</code>æ—¶è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@master k8s_install]<span class="comment"># kubeadm init --config kubeadm.yaml</span></span><br><span class="line">... ...</span><br><span class="line">Your Kubernetes control-plane has initialized successfully!</span><br><span class="line"></span><br><span class="line">To start using your cluster, you need to run the following as a regular user:</span><br><span class="line"></span><br><span class="line">  <span class="built_in">mkdir</span> -p <span class="variable">$HOME</span>/.kube</span><br><span class="line">  sudo <span class="built_in">cp</span> -i /etc/kubernetes/admin.conf <span class="variable">$HOME</span>/.kube/config</span><br><span class="line">  sudo <span class="built_in">chown</span> $(<span class="built_in">id</span> -u):$(<span class="built_in">id</span> -g) <span class="variable">$HOME</span>/.kube/config</span><br><span class="line"></span><br><span class="line">Alternatively, <span class="keyword">if</span> you are the root user, you can run:</span><br><span class="line"></span><br><span class="line">  <span class="built_in">export</span> KUBECONFIG=/etc/kubernetes/admin.conf</span><br><span class="line"></span><br><span class="line">You should now deploy a pod network to the cluster.</span><br><span class="line">Run <span class="string">&quot;kubectl apply -f [podnetwork].yaml&quot;</span> with one of the options listed at:</span><br><span class="line">  https://kubernetes.io/docs/concepts/cluster-administration/addons/</span><br><span class="line"></span><br><span class="line">Then you can <span class="built_in">join</span> any number of worker nodes by running the following on each as root:</span><br><span class="line"></span><br><span class="line">kubeadm <span class="built_in">join</span> 192.168.246.133:6443 --token abcdef.0123456789abcdef \</span><br><span class="line">        --discovery-token-ca-cert-hash sha256:9f7d37c768e658119242dfb49675eaeb3cbdbb7d191526bfa197dd92373b40ab</span><br></pre></td></tr></table></figure><p><strong>PSï¼šæœ€å¥½å°†æœ€åä¸€è¡Œlogéœ€è¦è®°ä¸‹æ¥ï¼ŒworkerèŠ‚ç‚¹å®‰è£…ä¼šç”¨åˆ°ã€‚</strong></p><p>æ ¹æ®æç¤ºï¼Œé€€å‡ºrootè´¦æˆ·åè¿è¡Œå‘½ä»¤</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p <span class="variable">$HOME</span>/.kube</span><br><span class="line">sudo <span class="built_in">cp</span> -i /etc/kubernetes/admin.conf <span class="variable">$HOME</span>/.kube/config</span><br><span class="line">sudo <span class="built_in">chown</span> $(<span class="built_in">id</span> -u):$(<span class="built_in">id</span> -g) <span class="variable">$HOME</span>/.kube/config</span><br></pre></td></tr></table></figure><h3><span id="44-éªŒè¯"><strong>4.4 éªŒè¯</strong></span></h3><p>éªŒè¯masterèŠ‚ç‚¹æ˜¯å¦éƒ¨ç½²æˆåŠŸã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## kubectl è¿è¡Œæ­£å¸¸. STATUS=NotReadyæ˜¯å› ä¸ºCNIæ’ä»¶è¿˜æ²¡è£…ã€‚</span></span><br><span class="line">[shirley@master k8s_install]$ kubectl get node</span><br><span class="line">NAME   STATUS     ROLES           AGE   VERSION</span><br><span class="line">node   NotReady   control-plane   20m   v1.28.2</span><br><span class="line"></span><br><span class="line"><span class="comment">## é€šè¿‡crictlå‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ°è¿è¡Œçš„container</span></span><br><span class="line">[shirley@master k8s_install]$ sudo crictl ps -a</span><br><span class="line">CONTAINER           IMAGE               CREATED             STATE               NAME                      ATTEMPT             POD ID              POD</span><br><span class="line">955b0c87ad621       ea1030da44aa1       26 minutes ago      Running             kube-proxy                0                   78efbee65dfac       kube-proxy-kp9kw</span><br><span class="line">f69d8c3246904       73deb9a3f7025       26 minutes ago      Running             etcd                      0                   77180bc7ff0a8       etcd-node</span><br><span class="line">3efba65f263d3       f6f496300a2ae       26 minutes ago      Running             kube-scheduler            0                   f89fb4bb60e2e       kube-scheduler-node</span><br><span class="line">5dfb28390f30b       4be79c38a4bab       26 minutes ago      Running             kube-controller-manager   0                   b716cb4652e1c       kube-controller-manager-node</span><br><span class="line">b8cfce31fa842       bb5e0dde9054c       26 minutes ago      Running             kube-apiserver            0                   006db1ce43cfe       kube-apiserver-node</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰å¤§å®¶å¯èƒ½æœ‰ä¸ªç–‘æƒ‘ï¼Œä¸ºä»€ä¹ˆdocker psçœ‹ä¸åˆ°è¿è¡Œçš„å®¹å™¨</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## è¿è¡Œdockerå‘½ä»¤ï¼Œå‘ç°æ²¡æœ‰container</span></span><br><span class="line">[shirley@master k8s_install]$ sudo docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯å› ä¸ºkubernetesä½¿ç”¨çš„containerdä½œä¸ºå®¹å™¨è¿è¡Œæ—¶ï¼Œè€Œä¸æ˜¯Docker engine. kubernetesæ”¯æŒ4ä¸­å®¹å™¨è¿è¡Œæ—¶ï¼š</p><table><thead><tr><th>Runtime</th><th>Path to Unix domain socketï¼ˆCRI socketï¼‰</th></tr></thead><tbody><tr><td>containerd</td><td>unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;containerd&#x2F;containerd.sock</td></tr><tr><td>CRI-O</td><td>unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;crio&#x2F;crio.sock</td></tr><tr><td>Docker Engine (using cri-dockerd)</td><td>unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;cri-dockerd.sock</td></tr><tr><td>Mirantis Container Runtime (MCR)(using cri-dockerd)</td><td>unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;cri-dockerd.sock</td></tr></tbody></table><p>By default, Kubernetes uses the Container Runtime Interface (CRI) to interface with your chosen container runtime.</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œkubernetesä¼šç”¨CRIæ‰¾åˆ°é€‰æ‹©çš„å®¹å™¨è¿è¡Œæ—¶ã€‚åœ¨æˆ‘ä»¬å®‰è£…dockeræ—¶ï¼Œå®‰è£…äº†containerdï¼Œå› æ­¤k8sæ‰¾åˆ°äº†containerdä½œä¸ºå®¹å™¨è¿è¡Œæ—¶ã€‚åœ¨kubeadm.yamæ–‡ä»¶ä¸­ä¹Ÿèƒ½çœ‹åˆ°ç›¸åº”çš„é…ç½®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nodeRegistration:</span><br><span class="line">  criSocket: unix:///var/run/containerd/containerd.sock</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆk8sä¸é€‰ç”¨docker engineä½œä¸ºå®¹å™¨è¿è¡Œæ—¶ï¼Ÿå› ä¸ºå¦‚æœä½¿ç”¨docker engine, è¿˜éœ€è¦å®‰è£…cri-dockerdï¼Œæ‰èƒ½ä½œä¸ºå®¹å™¨æ—¶è¢«k8sè¯†åˆ«ã€‚è€Œå¦‚ä¸Šæ“ä½œå¹¶æœªå®‰è£…ã€‚</p><p>æ­¤å¤–ï¼Œk8sæ¨èç›´æ¥ä½¿ç”¨containerdä½œä¸ºå®¹å™¨è¿è¡Œæ—¶ã€‚</p><h2><span id="5-åˆå§‹åŒ–å·¥ä½œèŠ‚ç‚¹"><strong>5. åˆå§‹åŒ–å·¥ä½œèŠ‚ç‚¹</strong></span></h2><h3><span id="51-è¿è¡Œkubeadm-joinå°†å·¥ä½œèŠ‚ç‚¹åŠ å…¥é›†ç¾¤"><strong>5.1 è¿è¡Œkubeadm joinå°†å·¥ä½œèŠ‚ç‚¹åŠ å…¥é›†ç¾¤</strong></span></h3><p>åœ¨masterèŠ‚ç‚¹kubeadm initå®‰è£…å®Œæˆåï¼Œä¼šæœ‰å¦‚ä¸‹ç±»ä¼¼log</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.. ... </span><br><span class="line">Then you can <span class="built_in">join</span> any number of worker nodes by running the following on each as root:</span><br><span class="line"></span><br><span class="line">kubeadm <span class="built_in">join</span> 192.168.246.133:6443 --token abcdef.0123456789abcdef \</span><br><span class="line">        --discovery-token-ca-cert-hash sha256:9f7d37c768e658119242dfb49675eaeb3cbdbb7d191526bfa197dd92373b40ab</span><br></pre></td></tr></table></figure><p>å°†ä¸Šè¿°å‘½ä»¤ç²˜è´´åˆ°å·¥ä½œèŠ‚ç‚¹ï¼Œå°†å·¥ä½œèŠ‚ç‚¹æ·»åŠ åˆ°é›†ç¾¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@slave ~]# kubeadm join 192.168.246.133:6443 --token abcdef.0123456789abcdef \</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">        --discovery-token-ca-cert-hash sha256:9f7d37c768e658119242dfb49675eaeb3cbdbb7d191526bfa197dd92373b40ab</span></span><br><span class="line">[preflight] Running pre-flight checks</span><br><span class="line">        [WARNING Hostname]: hostname &quot;slave.k8s&quot; could not be reached</span><br><span class="line">        [WARNING Hostname]: hostname &quot;slave.k8s&quot;: lookup slave.k8s on 192.168.246.2:53: no such host</span><br><span class="line">[preflight] Reading configuration from the cluster...</span><br><span class="line">[preflight] FYI: You can look at this config file with &#x27;kubectl -n kube-system get cm kubeadm-config -o yaml&#x27;</span><br><span class="line">[kubelet-start] Writing kubelet configuration to file &quot;/var/lib/kubelet/config.yaml&quot;</span><br><span class="line">[kubelet-start] Writing kubelet environment file with flags to file &quot;/var/lib/kubelet/kubeadm-flags.env&quot;</span><br><span class="line">[kubelet-start] Starting the kubelet</span><br><span class="line">[kubelet-start] Waiting for the kubelet to perform the TLS Bootstrap...</span><br><span class="line"></span><br><span class="line">This node has joined the cluster:</span><br><span class="line">* Certificate signing request was sent to apiserver and a response was received.</span><br><span class="line">* The Kubelet was informed of the new secure connection details.</span><br><span class="line"></span><br><span class="line">Run &#x27;kubectl get nodes&#x27; on the control-plane to see this node join the cluster.</span><br></pre></td></tr></table></figure><h3><span id="52-éªŒè¯"><strong>5.2 éªŒè¯</strong></span></h3><p>åˆ°masterèŠ‚ç‚¹è¿è¡Œkubelet get node,å¯ä»¥çœ‹åˆ°åŠ è¿›æ¥çš„node</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[shirley@master k8s_install]$ kubectl get nodes</span><br><span class="line">NAME        STATUS     ROLES           AGE    VERSION</span><br><span class="line">node        NotReady   control-plane   121m   v1.28.2</span><br><span class="line">slave.k8s   NotReady   &lt;none&gt;          28s    v1.28.2</span><br></pre></td></tr></table></figure><p>å½“å‰STATUSéƒ½æ˜¯NotReadyï¼Œè¿™æ˜¯å› ä¸ºè¿˜æ²¡æœ‰å®‰è£…ç½‘ç»œæ’ä»¶CNI</p><h3><span id="53-å¿˜è®°tokenæ€ä¹ˆåŠ"><strong>5.3 å¿˜è®°tokenæ€ä¹ˆåŠ</strong></span></h3><p>å¦‚æœmasterèŠ‚ç‚¹å®‰è£…æ—¶ï¼Œæ²¡æœ‰è®°å½•ä¸‹tokenï¼Œæˆ–tokenè¶…æ—¶(é»˜è®¤24å°æ—¶)ï¼Œå¯ä»¥è¿è¡Œå¦‚ä¸‹å‘½ä»¤é‡æ–°ç”Ÿæˆ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[shirley@master k8s_install]$ kubeadm token create --print-join-command</span><br><span class="line">kubeadm join 192.168.246.133:6443 --token by8q23.65btteq9iud7ypso --discovery-token-ca-cert-hash sha256:9f7d37c768e658119242dfb49675eaeb3cbdbb7d191526bfa197dd92373b40ab</span><br></pre></td></tr></table></figure><h2><span id="6-å®‰è£…cniç½‘ç»œæ’ä»¶"><strong>6. å®‰è£…CNIç½‘ç»œæ’ä»¶</strong></span></h2><p>Kubernetes å®ƒéœ€è¦ç½‘ç»œæ’ä»¶æ¥æä¾›é›†ç¾¤å†…éƒ¨å’Œé›†ç¾¤å¤–éƒ¨çš„ç½‘ç»œé€šä¿¡ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ k8s ç½‘ç»œæ’ä»¶ï¼š</p><ul><li>Flannelï¼šFlannel æ˜¯æœ€å¸¸ç”¨çš„ k8s ç½‘ç»œæ’ä»¶ä¹‹ä¸€ï¼Œå®ƒä½¿ç”¨äº†è™šæ‹Ÿç½‘ç»œæŠ€æœ¯æ¥å®ç°å®¹å™¨ä¹‹é—´çš„é€šä¿¡ï¼Œæ”¯æŒå¤šç§ç½‘ç»œåç«¯ï¼Œå¦‚ VXLANã€UDP å’Œ Host-GWã€‚</li><li>Calicoï¼šCalico æ˜¯ä¸€ç§åŸºäº BGP çš„ç½‘ç»œæ’ä»¶ï¼Œå®ƒä½¿ç”¨è·¯ç”±è¡¨æ¥è·¯ç”±å®¹å™¨ä¹‹é—´çš„æµé‡ï¼Œæ”¯æŒå¤šç§ç½‘ç»œæ‹“æ‰‘ç»“æ„ï¼Œå¹¶æä¾›äº†å®‰å…¨æ€§å’Œç½‘ç»œç­–ç•¥åŠŸèƒ½ã€‚</li><li>Canalï¼šCanal æ˜¯ä¸€ä¸ªç»„åˆäº† Flannel å’Œ Calico çš„ç½‘ç»œæ’ä»¶ï¼Œå®ƒä½¿ç”¨ Flannel æ¥æä¾›å®¹å™¨ä¹‹é—´çš„é€šä¿¡ï¼ŒåŒæ—¶ä½¿ç”¨ Calico æ¥æä¾›ç½‘ç»œç­–ç•¥å’Œå®‰å…¨æ€§åŠŸèƒ½ã€‚</li><li>Weave Netï¼šWeave Net æ˜¯ä¸€ç§è½»é‡çº§çš„ç½‘ç»œæ’ä»¶ï¼Œå®ƒä½¿ç”¨è™šæ‹Ÿç½‘ç»œæŠ€æœ¯æ¥ä¸ºå®¹å™¨æä¾› IP åœ°å€ï¼Œå¹¶æ”¯æŒå¤šç§ç½‘ç»œåç«¯ï¼Œå¦‚ VXLANã€UDP å’Œ TCP&#x2F;IPï¼ŒåŒæ—¶è¿˜æä¾›äº†ç½‘ç»œç­–ç•¥å’Œå®‰å…¨æ€§åŠŸèƒ½ã€‚</li><li>Ciliumï¼šCilium æ˜¯ä¸€ç§åŸºäº eBPF (Extended Berkeley Packet Filter) æŠ€æœ¯çš„ç½‘ç»œæ’ä»¶ï¼Œå®ƒä½¿ç”¨ Linux å†…æ ¸çš„åŠ¨æ€æ’ä»¶æ¥æä¾›ç½‘ç»œåŠŸèƒ½ï¼Œå¦‚è·¯ç”±ã€è´Ÿè½½å‡è¡¡ã€å®‰å…¨æ€§å’Œç½‘ç»œç­–ç•¥ç­‰ã€‚</li><li>Contivï¼šContiv æ˜¯ä¸€ç§åŸºäº SDN æŠ€æœ¯çš„ç½‘ç»œæ’ä»¶ï¼Œå®ƒæä¾›äº†å¤šç§ç½‘ç»œåŠŸèƒ½ï¼Œå¦‚è™šæ‹Ÿç½‘ç»œã€ç½‘ç»œéš”ç¦»ã€è´Ÿè½½å‡è¡¡å’Œå®‰å…¨ç­–ç•¥ç­‰ã€‚</li><li>Antreaï¼šAntrea æ˜¯ä¸€ç§åŸºäº OVS (Open vSwitch) æŠ€æœ¯çš„ç½‘ç»œæ’ä»¶ï¼Œå®ƒæä¾›äº†å®¹å™¨ä¹‹é—´çš„é€šä¿¡ã€ç½‘ç»œç­–ç•¥å’Œå®‰å…¨æ€§ç­‰åŠŸèƒ½ï¼Œè¿˜æ”¯æŒå¤šç§ç½‘ç»œæ‹“æ‰‘ç»“æ„ã€‚</li></ul><table><thead><tr><th>æä¾›å•†</th><th>ç½‘ç»œæ¨¡å‹</th><th>è·¯çº¿åˆ†å‘</th><th>ç½‘ç»œç­–ç•¥</th><th>ç½‘æ ¼</th><th>å¤–éƒ¨æ•°æ®å­˜å‚¨</th><th>åŠ å¯†</th><th>Ingress&#x2F;Egress ç­–ç•¥</th></tr></thead><tbody><tr><td>Canal</td><td>å°è£… (VXLAN)</td><td>å¦</td><td>æ˜¯</td><td>å¦</td><td>K8s API</td><td>æ˜¯</td><td>æ˜¯</td></tr><tr><td>Flannel</td><td>å°è£… (VXLAN)</td><td>å¦</td><td>å¦</td><td>å¦</td><td>K8s API</td><td>æ˜¯</td><td>å¦</td></tr><tr><td>Calico</td><td>å°è£…ï¼ˆVXLANï¼ŒIPIPï¼‰æˆ–æœªå°è£…</td><td>æ˜¯</td><td>æ˜¯</td><td>æ˜¯</td><td>Etcd å’Œ K8s API</td><td>æ˜¯</td><td>æ˜¯</td></tr><tr><td>Weave</td><td>å°è£…</td><td>æ˜¯</td><td>æ˜¯</td><td>æ˜¯</td><td>å¦</td><td>æ˜¯</td><td>æ˜¯</td></tr><tr><td>Cilium</td><td>å°è£… (VXLAN)</td><td>æ˜¯</td><td>æ˜¯</td><td>æ˜¯</td><td>Etcd å’Œ K8s API</td><td>æ˜¯</td><td>æ˜¯</td></tr></tbody></table><p>Calico å’Œ Flanneléƒ½æ˜¯å¸¸ç”¨çš„CNIï¼Œå¦‚ä¸‹ä»‹ç»å¦‚ä½•å®‰è£…flannelç½‘ç»œæ’ä»¶</p><h3><span id="61-å®‰è£…flannelç½‘ç»œæ’ä»¶"><strong>6.1 å®‰è£…flannelç½‘ç»œæ’ä»¶</strong></span></h3><ol><li>ä¸‹è½½kube-flannel.yml</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 1. ä¸‹è½½kube-flannel.yml</span></span></span><br><span class="line">wget https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</span><br></pre></td></tr></table></figure><p><code>kube-flannel.yaml</code>æ–‡ä»¶ä¸­ï¼Œéœ€è¦æ³¨æ„ï¼Œnet-conf.jsoné‡Œçš„networkè¦å’Œkubeadm.yamlé‡Œé…ç½®çš„networking.podSubnetç›¸åŒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">... ...</span><br><span class="line">  net-conf.json: |</span><br><span class="line">    &#123;</span><br><span class="line">      ### è¿™é‡Œçš„networkå’Œkubeadm.yamlé‡Œé…ç½®çš„networking.podSubnetç›¸åŒ </span><br><span class="line">      &quot;Network&quot;: &quot;10.244.0.0/16&quot;,</span><br><span class="line">      &quot;Backend&quot;: &#123;</span><br><span class="line">        &quot;Type&quot;: &quot;vxlan&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">... ...</span><br></pre></td></tr></table></figure><ol start="2"><li>å®¹å™¨éƒ¨ç½²flannel</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[shirley@master k8s_install]$ kubectl apply -f kube-flannel.yml</span><br><span class="line">namespace/kube-flannel created</span><br><span class="line">clusterrole.rbac.authorization.k8s.io/flannel created</span><br><span class="line">clusterrolebinding.rbac.authorization.k8s.io/flannel created</span><br><span class="line">serviceaccount/flannel created</span><br><span class="line">configmap/kube-flannel-cfg created</span><br><span class="line">daemonset.apps/kube-flannel-ds created</span><br></pre></td></tr></table></figure><h3><span id="62-éªŒè¯cni"><strong>6.2 éªŒè¯CNI</strong></span></h3><p>å®‰è£…åï¼Œè¿è¡Œ<code>kubectl -n kube-system get pod -o wide</code>ï¼Œ å¯ä»¥çœ‹åˆ°åœ¨masterèŠ‚ç‚¹å’ŒslaveèŠ‚ç‚¹åˆ†åˆ«è¿è¡Œäº†ä¸€ä¸ªkube-proxy</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½è¿è¡Œäº†kube-proxy</span></span></span><br><span class="line">[shirley@master k8s_install]$ kubectl -n kube-system get pod -o wide</span><br><span class="line">NAME                           READY   STATUS    RESTARTS   AGE     IP                NODE        NOMINATED NODE   READINESS GATES</span><br><span class="line">coredns-66f779496c-d8rws       1/1     Running   0          4h40m   10.244.0.3        node        &lt;none&gt;           &lt;none&gt;</span><br><span class="line">coredns-66f779496c-fzmjm       1/1     Running   0          4h40m   10.244.0.2        node        &lt;none&gt;           &lt;none&gt;</span><br><span class="line">etcd-node                      1/1     Running   0          4h41m   192.168.246.133   node        &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kube-apiserver-node            1/1     Running   0          4h41m   192.168.246.133   node        &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kube-controller-manager-node   1/1     Running   0          4h41m   192.168.246.133   node        &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kube-proxy-bpv8d               1/1     Running   0          160m    192.168.246.132   slave.k8s   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kube-proxy-kp9kw               1/1     Running   0          4h40m   192.168.246.133   node        &lt;none&gt;           &lt;none&gt;</span><br><span class="line">kube-scheduler-node            1/1     Running   0          4h41m   192.168.246.133   node        &lt;none&gt;           &lt;none&gt;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># nodeçŠ¶æ€æ˜¾ç¤ºä¸ºReady</span></span></span><br><span class="line">[shirley@master k8s_install]$ kubectl get node</span><br><span class="line">NAME        STATUS   ROLES           AGE     VERSION</span><br><span class="line">node        Ready    control-plane   4h38m   v1.28.2</span><br><span class="line">slave.k8s   Ready    &lt;none&gt;          158m    v1.28.2</span><br></pre></td></tr></table></figure><p>è‡ªæ­¤ï¼Œé›†ç¾¤æ­å»ºå®Œæˆã€‚</p><h2><span id="å…¶ä»–è¯´æ˜"><strong>å…¶ä»–è¯´æ˜</strong></span></h2><p>å¦å¤–ï¼Œåœ¨åˆå§‹å®‰è£…çš„MasterèŠ‚ç‚¹ä¸Šä¹Ÿå¯åŠ¨äº†<code>kubelet</code>å’Œ<code>kube-proxy</code>ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹å¹¶ä¸å‚ä¸å·¥ä½œè´Ÿè½½çš„è°ƒåº¦ã€‚å¦‚æœå¸Œæœ›MasterèŠ‚ç‚¹ä¹Ÿä½œä¸ºNodeè§’è‰²ï¼Œåˆ™å¯ä»¥è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ˆåˆ é™¤MasterèŠ‚ç‚¹çš„ï¼š<code>node-role.kubernetes.io/control-plane:NoSchedule</code>ï¼‰ï¼Œè®©MasterèŠ‚ç‚¹ä¹Ÿæˆä¸ºä¸€ä¸ªNodeï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl taint nodes --all node-role.kubernetes.io/control-plane-</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8s-IPVSæ¦‚å¿µåŸç†ä»¥åŠåº”ç”¨</title>
      <link href="/blog/2024/03/18/K8s/K8s-2-IPVS%E6%A6%82%E5%BF%B5%E5%8E%9F%E7%90%86%E4%BB%A5%E5%8F%8A%E5%BA%94%E7%94%A8/"/>
      <url>/blog/2024/03/18/K8s/K8s-2-IPVS%E6%A6%82%E5%BF%B5%E5%8E%9F%E7%90%86%E4%BB%A5%E5%8F%8A%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h3><span id="ipvsçš„æ¦‚å¿µ-åŸç†åŠåº”ç”¨">IPVSçš„æ¦‚å¿µã€åŸç†åŠåº”ç”¨</span></h3><h3><span id="ä¸€-ä»€ä¹ˆæ˜¯ipvs">ä¸€ã€ä»€ä¹ˆæ˜¯IPVS</span></h3><p>LVSï¼ˆLinux è™šæ‹ŸæœåŠ¡å™¨ï¼‰å’Œ IPVSï¼ˆIP è™šæ‹ŸæœåŠ¡å™¨ï¼‰æ˜¯ Linux ä¸­ç”¨äºæ„å»ºå¯æ‰©å±•å’Œé«˜æ€§èƒ½ç½‘ç»œæœåŠ¡çš„ä¸¤ç§ç›¸å…³æŠ€æœ¯ã€‚</p><p>LVS æ˜¯ Linux ç³»ç»Ÿçš„å†…æ ¸çº§è´Ÿè½½å‡è¡¡è§£å†³æ–¹æ¡ˆã€‚ å®ƒå…è®¸æ‚¨åœ¨å¤šä¸ªæœåŠ¡å™¨ä¹‹é—´åˆ†é…ä¼ å…¥çš„ç½‘ç»œæµé‡ï¼Œåˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨é›†ç¾¤ï¼Œåœ¨å®¢æˆ·ç«¯çœ‹æ¥å°±åƒä¸€ä¸ªè™šæ‹ŸæœåŠ¡å™¨ã€‚ LVS ä¸­çš„è´Ÿè½½å‡è¡¡ç®—æ³•å¯ä»¥æ ¹æ®å„ç§å› ç´ ï¼ˆä¾‹å¦‚å¾ªç¯æ³•ã€æœ€å°‘è¿æ¥æ•°å’Œæº IP å“ˆå¸Œï¼‰æ¥åˆ†é…æµé‡ã€‚ </p><h3><span id="äºŒ-ipvsçš„å·¥ä½œåŸç†">äºŒã€IPVSçš„å·¥ä½œåŸç†</span></h3><p>IPVSçš„å·¥ä½œåŸç†åŸºäºç½‘ç»œåœ°å€è½¬æ¢ï¼ˆNetwork Address Translationï¼ŒNATï¼‰å’Œç«¯å£è½¬æ¢ï¼ˆPort Translationï¼‰ã€‚</p><p>å½“ä¸€ä¸ªç½‘ç»œè¯·æ±‚åˆ°è¾¾IPVSï¼ŒIPVSä¼šæ ¹æ®é¢„è®¾çš„è°ƒåº¦ç®—æ³•é€‰æ‹©ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œç„¶åä¿®æ”¹ç½‘ç»œè¯·æ±‚çš„ç›®æ ‡IPåœ°å€å’Œç«¯å£ï¼Œä½¿å…¶æŒ‡å‘é€‰æ‹©çš„åç«¯æœåŠ¡å™¨ã€‚</p><p>å½“åç«¯æœåŠ¡å™¨å¤„ç†å®Œè¯·æ±‚åï¼ŒIPVSä¼šå°†æœåŠ¡å™¨çš„å“åº”è½¬å‘å›åŸå§‹è¯·æ±‚çš„å®¢æˆ·ç«¯ã€‚</p><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯å¹¶ä¸çŸ¥é“å®é™…ä¸Šæ˜¯å“ªä¸ªåç«¯æœåŠ¡å™¨å¤„ç†äº†å®ƒçš„è¯·æ±‚ã€‚</p><h3><span id="ä¸‰-ipvsçš„ä¸»è¦ç‰¹æ€§">ä¸‰ã€IPVSçš„ä¸»è¦ç‰¹æ€§</span></h3><p>ä¸°å¯Œçš„è°ƒåº¦ç®—æ³•ï¼šIPVSæ”¯æŒå¤šç§è°ƒåº¦ç®—æ³•ï¼ŒåŒ…æ‹¬æœ€å°è¿æ¥ï¼ˆLeast-Connectionï¼‰ã€è½®è¯¢ï¼ˆRound-Robinï¼‰å’ŒåŠ æƒè½®è¯¢ï¼ˆWeighted Round-Robinï¼‰ç­‰ï¼Œæ»¡è¶³ä¸åŒåº”ç”¨åœºæ™¯çš„éœ€æ±‚ã€‚<br>å¥åº·æ£€æŸ¥ï¼šIPVSèƒ½å¤Ÿå®šæœŸå¯¹åç«¯æœåŠ¡å™¨è¿›è¡Œå¥åº·æ£€æŸ¥ï¼Œå½“æ£€æµ‹åˆ°æŸä¸ªæœåŠ¡å™¨æ•…éšœæ—¶ï¼Œå¯ä»¥å°†å…¶ä»æœåŠ¡åˆ—è¡¨ä¸­ç§»é™¤ï¼Œé˜²æ­¢å‘æ•…éšœæœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚<br>é«˜æ€§èƒ½ï¼šç”±äºIPVSæ˜¯Linuxå†…æ ¸çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤å¤„ç†ç½‘ç»œè¯·æ±‚çš„æ•ˆç‡éå¸¸é«˜ã€‚IPVSæ”¯æŒå¤§è§„æ¨¡å¹¶å‘è¿æ¥ï¼Œèƒ½å¤Ÿå¤„ç†æ¯ç§’æ•°ä»¥ä¸‡è®¡çš„ç½‘ç»œè¯·æ±‚ã€‚<br>æ˜“äºé›†æˆï¼šIPVSå¯ä»¥ä¸å…¶ä»–Linuxå†…æ ¸æ¨¡å—å’Œç”¨æˆ·ç©ºé—´å·¥å…·ä¸€èµ·ä½¿ç”¨ï¼Œå¦‚iptableså’Œkeepalivedç­‰ï¼Œæä¾›æ›´åŠ å¼ºå¤§å’Œçµæ´»çš„ç½‘ç»œæœåŠ¡ã€‚</p><h3><span id="å››-ipvsçš„åº”ç”¨åœºæ™¯">å››ã€IPVSçš„åº”ç”¨åœºæ™¯</span></h3><p>IPVSå¹¿æ³›åº”ç”¨äºå¤§è§„æ¨¡çš„äº’è”ç½‘æœåŠ¡ï¼Œå¦‚ç½‘ç«™ã€åœ¨çº¿è§†é¢‘å’Œæ¸¸æˆç­‰ï¼Œæä¾›é«˜å¯ç”¨æ€§å’Œé«˜æ€§èƒ½çš„ç½‘ç»œæœåŠ¡ã€‚</p><p>æ­¤å¤–ï¼ŒIPVSä¹Ÿåœ¨äº‘è®¡ç®—ã€å¤§æ•°æ®å’Œå®¹å™¨æŠ€æœ¯ç­‰é¢†åŸŸæœ‰å¹¿æ³›çš„åº”ç”¨ï¼Œä¾‹å¦‚åœ¨Kubernetesä¸­ï¼ŒIPVSä½œä¸ºæœåŠ¡ä»£ç†çš„ä¸€ç§æ¨¡å¼ï¼Œä¸ºé›†ç¾¤å†…çš„æœåŠ¡æä¾›è´Ÿè½½å‡è¡¡ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼ŒLVS æ˜¯ Linux ç³»ç»Ÿçš„ç»¼åˆè´Ÿè½½å‡è¡¡è§£å†³æ–¹æ¡ˆï¼Œè€Œ IPVS æ˜¯ LVS ä¸­ä¸“é—¨å¤„ç† IP è´Ÿè½½å‡è¡¡çš„ç»„ä»¶ã€‚ LVS åˆ©ç”¨ IPVS åœ¨å¤šä¸ªçœŸå®æœåŠ¡å™¨ä¹‹é—´åˆ†å‘æµé‡ï¼Œå¹¶ä¸ºå„ç§ç½‘ç»œæœåŠ¡æä¾›å¯æ‰©å±•æ€§å’Œå®¹é”™æ€§</p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP-ææ„å‡½æ•°-destruct</title>
      <link href="/blog/2024/03/12/PHP/PHP-%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0-destruct/"/>
      <url>/blog/2024/03/12/PHP/PHP-%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0-destruct/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><blockquote><p>phpStrom é‡Œalt+insert ä¼šå‡ºç°çš„ä¸€äº›å‡½æ•°</p></blockquote><h3><span id="ææ„å‡½æ•°destruct">ææ„å‡½æ•°destruct</span></h3><p><img src="http://s2-cdn.oneitfarm.com/d7f45961508248afb2f08e0bd137ca9c.png" alt="image.png"></p><p>ç®€å•ç†è§£ï¼šæ„é€ å‡½æ•°çš„å¯¹ç«‹é¢<br>æ„é€ å‡½æ•°ï¼š__construct()åœ¨åˆå§‹åŒ–å¯¹è±¡çš„æ—¶å€™é»˜è®¤æ‰§è¡Œçš„<br>ææ„å‡½æ•°ï¼š__destruct()åœ¨å¯¹è±¡é”€æ¯å›æ”¶æ—¶å€™é»˜è®¤æ‰§è¡Œçš„ï¼Œç±»ä¼¼äºwebæ¡†æ¶é‡Œé¢çš„é’©å­å‡½æ•°</p><p>è§¦å‘æ¡ä»¶ å½“å¯¹è±¡æˆ–è€…å˜é‡ æ¶ˆå¤±æ—¶å€™</p><p>å…³é”®è¯ï¼šunsetæˆ–è€…å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»“æŸ</p><p>phpStrom é‡Œalt+insert ä¼šå‡ºç°çš„ä¸€äº›å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">calss A&#123;</span><br><span class="line">    </span><br><span class="line">protected $data = [];</span><br><span class="line"></span><br><span class="line">public function insert($data)</span><br><span class="line">    &#123;</span><br><span class="line">        $data[&#x27;appkey&#x27;] = getAppkey();</span><br><span class="line">        $data[&#x27;channel&#x27;] = getChannel();</span><br><span class="line">        $this-&gt;data[] = $data;</span><br><span class="line">        //è¿™ä¸ª[]æ„æ€åœ¨å¤šä¸ªå¤šæ¬¡è°ƒç”¨çš„æ—¶å€™æ’å…¥æ•´ä¸ªæ•°ç»„å¾ˆå…³é”®ï¼Œå¯ä»¥çœ‹ä¸‹é¢å†…å®¹ è¯·æ±‚ä¸­ php å¦‚ä½•åˆ†é…phpfpm</span><br><span class="line">    &#125;</span><br><span class="line"> public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        if ($this-&gt;data) &#123;</span><br><span class="line">            $this-&gt;getDB()-&gt;insert_batch($this-&gt;table, $this-&gt;data);</span><br><span class="line">            $id = $this-&gt;getDB()-&gt;insert_id();</span><br><span class="line">            Ioc()-&gt;CallRecordModel-&gt;_delete([</span><br><span class="line">                &#x27;id &lt;&#x27; =&gt; $id - 50000</span><br><span class="line">            ], &#x27;&#x27;, 1000);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$zend=new A();</span><br><span class="line">$zend-&gt;insert([&quot;aaaaa&quot;]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GOLANG-ç¬”è®°-ArrayMapSlice</title>
      <link href="/blog/2024/03/12/GOLANG/GOLANG-%E7%AC%94%E8%AE%B03-nil-slice-map/"/>
      <url>/blog/2024/03/12/GOLANG/GOLANG-%E7%AC%94%E8%AE%B03-nil-slice-map/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">### 1. := = ==</span><br><span class="line"></span><br><span class="line">:= ç»™æŸå˜é‡çš„ç¬¬ä¸€æ¬¡èµ‹å€¼ï¼Œåˆå§‹åŒ–</span><br><span class="line"></span><br><span class="line">= å˜é‡çš„éç¬¬ä¸€æ¬¡èµ‹å€¼</span><br><span class="line"></span><br><span class="line">== ç­‰äºæ“ä½œç¬¦</span><br><span class="line"></span><br><span class="line">### 2. goä¸­nilçš„ä½¿ç”¨</span><br><span class="line"></span><br><span class="line">æŒ‡é’ˆã€åˆ‡ç‰‡ã€æ˜ å°„ã€é€šé“ã€å‡½æ•°å’Œæ¥å£çš„é›¶å€¼åˆ™æ˜¯ nilã€‚</span><br><span class="line"></span><br><span class="line">- nil æ ‡è¯†ç¬¦æ˜¯ä¸èƒ½æ¯”è¾ƒçš„</span><br><span class="line">- nil ä¸æ˜¯å…³é”®å­—æˆ–ä¿ç•™å­—</span><br><span class="line">- nil æ²¡æœ‰é»˜è®¤ç±»å‹</span><br><span class="line">- ä¸åŒç±»å‹ nil çš„æŒ‡é’ˆæ˜¯ä¸€æ ·çš„</span><br><span class="line">- ä¸åŒç±»å‹çš„ nil æ˜¯ä¸èƒ½æ¯”è¾ƒçš„</span><br><span class="line">- ä¸¤ä¸ªç›¸åŒç±»å‹çš„ nil å€¼ä¹Ÿå¯èƒ½æ— æ³•æ¯”è¾ƒ</span><br><span class="line">- nil æ˜¯ mapã€sliceã€pointerã€channelã€funcã€interface çš„é›¶å€¼</span><br><span class="line">- ä¸åŒç±»å‹çš„ nil å€¼å ç”¨çš„å†…å­˜å¤§å°å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„</span><br><span class="line"></span><br><span class="line">### 3.åˆ‡ç‰‡ slice</span><br><span class="line"></span><br><span class="line">ç±»ä¼¼äºpyæˆ–Javaçš„list ,æ˜¯æ•°ç»„çš„æŠ½è±¡,æ”¯æŒæ•°ç»„æ‰©å®¹ å®šä¹‰:</span><br><span class="line">slice1 := make([]type, len)</span><br><span class="line"></span><br><span class="line">len è·å–é•¿åº¦ cap è·å–å®¹é‡ append(slice1 ,v1,...) copy(new_slice,slice1)</span><br><span class="line"></span><br><span class="line">### 4.é›†åˆ map</span><br><span class="line"></span><br><span class="line">map æ— åºk-v ,å¿«é€Ÿæ ¹æ®k æ‰¾åˆ°v,ç±»ä¼¼äºç´¢å¼•,åœ¨åšå¾ªç¯æ‰“å°çš„æ—¶å€™ï¼Œæ— æ³•å›ºå®šè¿”å›é¡ºåºï¼Œå› ä¸ºmap ç”¨hashè¡¨æ¥å®ç°çš„</span><br><span class="line"></span><br><span class="line">- å£°æ˜å˜é‡ï¼Œé»˜è®¤ map æ˜¯ nil var map_val map[key_data_type]value_data_type</span><br><span class="line"></span><br><span class="line">- ä½¿ç”¨ make å‡½æ•° map_val := make(map[key_data_type]value_data_type)</span><br><span class="line"></span><br><span class="line">### å¹¶å‘</span><br><span class="line">goroutine </span><br><span class="line">go sync()</span><br><span class="line">### é€šé“ channel</span><br><span class="line">æ—¢ç„¶å·²ç»æœ‰äº†çº¿ç¨‹çš„æ¦‚å¿µï¼Œé‚£ä¹ˆå°±ä¼šå­˜åœ¨çº¿ç¨‹é—´çš„åŒæ­¥å’Œé€šè®¯é—®é¢˜ï¼ŒGo ä½¿ç”¨é€šé“ï¼ˆchannelï¼‰æ¥å®ç°ã€‚</span><br><span class="line"></span><br><span class="line">é€šé“å¯ç”¨äºä¸¤ä¸ª goroutine ä¹‹é—´é€šè¿‡ä¼ é€’ä¸€ä¸ªæŒ‡å®šç±»å‹çš„å€¼æ¥åŒæ­¥è¿è¡Œå’Œé€šè®¯ã€‚ä½¿ç”¨æ“ä½œç¬¦ &lt;-ï¼Œç¬¦å·å·¦è¾¹æ˜¯æ¥æ”¶è€…ï¼Œå³è¾¹æ˜¯å‘é€è€…ã€‚</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨ make åˆ›å»º channelï¼Œå¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line">â€‹```</span><br><span class="line">ch := make(chan int, 100) // make ç¬¬äºŒä¸ªå‚æ•° 100 æ˜¯è¯¥é€šé“çš„ç¼“å†²åŒºï¼Œæ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé‚£ä¹ˆå°±æ˜¯æ— ç¼“å†²çš„é€šé“</span><br><span class="line">ch &lt;- v    // æŠŠ v å‘é€åˆ°é€šé“ ch</span><br><span class="line">v := &lt;-ch  // ä» ch æ¥æ”¶æ•°æ®</span><br><span class="line">// å¹¶æŠŠå€¼èµ‹ç»™ v</span><br><span class="line">â€‹```</span><br><span class="line">é€šé“ä¸æ¶ˆæ¯é˜Ÿåˆ—æ˜¯ç­‰æ•ˆçš„ï¼Œå¦‚æœé€šé“ç¼“å†²åŒºæ»¡ï¼Œé‚£ä¹ˆå†å¾€é€šé“é‡Œå¡æ•°æ®ï¼Œå°±ä¼šé˜»å¡è¯¥ goroutineï¼›åŒæ ·ï¼Œå¦‚æœé€šé“ç¼“å†²åŒºæ²¡æœ‰æ•°æ®äº†ï¼Œå†æ¬¡æ¥æ”¶é€šé“æ•°æ®ï¼Œä¹Ÿä¼šé˜»å¡è¯¥ goroutineã€‚</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> GOLANG </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Slice </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>darp Docs</title>
      <link href="/blog/2022/03/16/darp-Docs/"/>
      <url>/blog/2022/03/16/darp-Docs/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>dapr æ–‡æ¡£è´¡çŒ®<br>dapr æ–‡æ¡£è´¡çŒ®è§„åˆ™ï¼š<a href="https://docs.dapr.io/zh-hans/contributing/contributing-docs/">https://docs.dapr.io/zh-hans/contributing/contributing-docs/</a></p><p>dapr æ–‡æ¡£ç½‘ç«™ä½¿ç”¨hugo å¼€å‘å·¥å…·ï¼š</p><p>Windowsï¼šå®‰è£…æµç¨‹<br>å®‰è£…scoope<br>powerSheel ï¼šæ‰§è¡Œå‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">set-executionpolicy remotesigned -scope currentuser</span><br><span class="line"></span><br><span class="line">iex (new-object net.webclient).downloadstring(&#x27;https://get.scoop.sh&#x27;)</span><br><span class="line"></span><br><span class="line">æ‰§è¡Œscoope help æŸ¥çœ‹æ˜¯å¦å®‰è£…æ­£å¸¸</span><br><span class="line"></span><br><span class="line">æ‰§è¡Œ   scoop install hugo</span><br><span class="line">      scoop install hugo-extended</span><br><span class="line">è¿™ä¸¤éƒ¨å³å¯ å®Œæˆå¯¹å…¶å®‰è£…</span><br><span class="line"></span><br><span class="line">æ–‡æ¡£ï¼šhttps://gohugo.io/getting-started/installing/</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3><span id="1æ‰§è¡Œdocä»“åº“ä¸‹è½½å’Œå®‰è£…ä¾èµ–">1.æ‰§è¡Œdocä»“åº“ä¸‹è½½å’Œå®‰è£…ä¾èµ–</span></h3><p>ä»“åº“ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">https://github.com.cnpmjs.org/dapr/docs.git</span><br><span class="line"></span><br><span class="line">æ‰§è¡Œï¼š</span><br><span class="line">git submodule update --init --recursive</span><br><span class="line"></span><br><span class="line">è¿™æ­¥å¯èƒ½é‡åˆ°ä¸‹è½½ä¸ä¸‹æ¥æƒ…å†µï¼Œå¯ä»¥æŒ‰ç…§æ­¤æ­¥éª¤è¿›è¡Œæ“ä½œ</span><br><span class="line"></span><br><span class="line">1.æ‰§è¡Œ git submodule update --init</span><br><span class="line">2.å».gitmodulesæ–‡ä»¶ è¿›è¡Œç¼–è¾‘å°†æ‰€æœ‰çš„https://github.com  åç¼€åŠ ä¸Š cnpmjs.org</span><br><span class="line">(è¿™ä¸ªåŸç†å¯ä»¥å‚è€ƒ:è°·æ­Œæ’ä»¶---GitHubåŠ é€Ÿ1.3.5)</span><br><span class="line">3.ç„¶ååˆ©ç”¨git submodule syncæ›´æ–°å­é¡¹ç›®å¯¹åº”çš„url</span><br><span class="line">4.git submodule update --init --recursiveï¼Œæœ€åæ‰§è¡Œ</span><br><span class="line"></span><br><span class="line">//s2-cdn.oneitfarm.com/6d3518411d074f9eae604f77da39da83.png</span><br></pre></td></tr></table></figure><p><img src="//s2-cdn.oneitfarm.com/a23f2220daff4375ba97522c7edc552c.png"></p><p>é”™è¯¯1.</p><p><img src="//s2-cdn.oneitfarm.com/c036d24abc364f00be0870faec874818.png" alt="image-20220316151455745"></p><p>è§£å†³æ–¹æ¡ˆï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨gitä»£ç†ï¼š</span><br><span class="line">git config *--global https.proxy*</span><br><span class="line">æ‰§è¡Œå‘½ä»¤åå–æ¶ˆä»£ç†</span><br><span class="line">git config --global --unset https.proxy</span><br></pre></td></tr></table></figure><p>é”™è¯¯2ï¼š</p><p><img src="//s2-cdn.oneitfarm.com/b933985e39524c7ea6763610f552ecd7.png" alt="//s2-cdn.oneitfarm.com/b933985e39524c7ea6763610f552ecd7.png"></p><p>è§£å†³æ–¹æ¡ˆï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿™ä¸ªæ˜¯å› ä¸ºæ²¡æœ‰æ‰§è¡Œgit moduleçš„ ä¸‹è½½</span><br></pre></td></tr></table></figure><h3><span id="2å®‰è£…ä¾èµ–">2.å®‰è£…ä¾èµ–</span></h3><p>æ­¤é¡¹ç›®ä½¿ç”¨çš„è¿˜æ˜¯npm </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install ï¼ˆå¾ˆæ…¢ï¼‰ </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> dapr </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>GOLANG-grpc-2</title>
      <link href="/blog/2021/12/09/GOLANG/GOLANG-%E7%AC%94%E8%AE%B013grpc-2/"/>
      <url>/blog/2021/12/09/GOLANG/GOLANG-%E7%AC%94%E8%AE%B013grpc-2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>è„‘å›¾ï¼š</p><p><a href="https://naotu.baidu.com/file/c80e753e20e8ab18a80cb573ac08e912?token=e89e127e95b325d5">https://naotu.baidu.com/file/c80e753e20e8ab18a80cb573ac08e912?token=e89e127e95b325d5</a></p><p>æœåŠ¡ç«¯çš„æ“ä½œï¼š</p><p>å–å‡ºserver</p><p>æŒ‚è½½æ–¹æ³•</p><p>æ³¨å†ŒæœåŠ¡</p><p>åˆ›å»ºç›‘å¬</p><p>å®¢æˆ·ç«¯ï¼š</p><p>åˆ›å»ºé“¾æ¥</p><p>new ä¸€ä¸ªclient</p><p>è°ƒç”¨clientæ–¹æ³•</p><p>è·å–è¿”å›å€¼</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>x86å’Œarmæ¶æ„åŒºåˆ«</title>
      <link href="/blog/2021/12/02/%E5%BB%BA%E7%AB%99/x86%E5%92%8Carm%E6%9E%B6%E6%9E%84%E5%8C%BA%E5%88%AB/"/>
      <url>/blog/2021/12/02/%E5%BB%BA%E7%AB%99/x86%E5%92%8Carm%E6%9E%B6%E6%9E%84%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h3><span id="ä»€ä¹ˆæ˜¯armæ¶æ„">ä»€ä¹ˆæ˜¯armæ¶æ„</span></h3><p>ARMæ¶æ„è¿‡å»ç§°ä¹‹ä¸ºè¿›é˜¶ç²¾ç®€æŒ‡ä»¤é›†æœºå™¨ï¼Œæ˜¯ä¸€ä¸ª32ä½çš„ç²¾ç®€æŒ‡ä»¤é›†ï¼ˆRISCï¼‰å¤„ç†å™¨æ¶æ„ï¼Œå…¶å¹¿æ³›çš„ä½¿ç”¨åœ¨åµŒå…¥å¼ç³»ç»Ÿè®¾è®¡ï¼Œç”±äºèŠ‚èƒ½çš„ç‰¹ç‚¹ï¼ŒARMéå¸¸é€‚åˆå¤„ç†ç§»åŠ¨é€šè®¯é¢†åŸŸï¼Œç¬¦åˆå…¶è®¾è®¡ç›®æ ‡ä½æ¶ˆè€— ç”µé‡çš„ç‰¹æ€§ï¼Œåœ¨ä»Šæ—¥ï¼ŒARMå®¶æ—å äº†æ‰€æœ‰32ä½åµŒå…¥å¼å¤„ç†å™¨75%çš„æ¯”ä¾‹ï¼Œä½¿å®ƒæˆä¸ºå å…¨ä¸–ç•Œæœ€å¤šæ•°çš„32ä½æ¶æ„ä¹‹ä¸€ã€‚ARMå¤„ç†å™¨å¯ä»¥åœ¨å¾ˆå¤šæ¶ˆè´¹æ€§ç”µå­äº§å“ä¸Šçœ‹åˆ°ï¼Œä»å¯æºå¼è£…ç½®ï¼ˆPDAã€ç§»åŠ¨ç”µè¯ã€å¤šåª’ä½“æ’­æ”¾å™¨ã€æŒä¸Šå‹ç”µå­æ¸¸æˆï¼Œå’Œè®¡ç®—æœºï¼‰åˆ°ç”µè„‘å¤–è®¾ï¼ˆç¡¬ç›˜ã€æ¡Œä¸Šå‹è·¯ç”±å™¨ï¼‰ç”šè‡³åœ¨å¯¼å¼¹çš„å¼¹è½½è®¡ç®—æœºç­‰å†›ç”¨è®¾æ–½ä¸­éƒ½æœ‰ä»–çš„å­˜åœ¨ã€‚åœ¨æ­¤è¿˜æœ‰ä¸€äº›åŸºäºARMè®¾è®¡çš„æ´¾ç”Ÿäº§å“ï¼Œé‡è¦äº§å“è¿˜åŒ…æ‹¬Marvellçš„XScaleæ¶æ„å’Œå¾·å·ä»ªå™¨çš„OMAPç³»åˆ—.</p><p>armæ¶æ„å›¾</p><p>ä¸‹å›¾æ‰€ç¤ºçš„æ˜¯ARMæ„æ¶å›¾ã€‚å®ƒç”±32ä½ALUã€è‹¥å¹²ä¸ª32ä½é€šç”¨å¯„å­˜å™¨ä»¥åŠçŠ¶æ€å¯„å­˜å™¨ã€32&TImes;8ä½ä¹˜æ³•å™¨ã€32&TImes;32ä½æ¡¶å½¢ç§»ä½å¯„å­˜å™¨ã€æŒ‡ä»¤è¯‘ç ä»¥åŠæ§åˆ¶é€»è¾‘ã€æŒ‡ä»¤æµæ°´çº¿å’Œæ•°æ®&#x2F;åœ°å€å¯„å­˜å™¨ç»„æˆ.</p><p><img src="http://file.elecfans.com/web1/M00/50/D9/o4YBAFr7zl2AGVr8AABPkxqzXZA667.jpg"></p><p>1ã€ALUï¼šå®ƒæœ‰ä¸¤ä¸ªæ“ä½œæ•°é”å­˜å™¨ã€åŠ æ³•å™¨ã€é€»è¾‘åŠŸèƒ½ã€ç»“æœä»¥åŠé›¶æ£€æµ‹é€»è¾‘æ„æˆã€‚</p><p>2ã€æ¡¶å½¢ç§»ä½å¯„å­˜å™¨ï¼šARMé‡‡ç”¨äº†32&TImes;32ä½çš„æ¡¶å½¢ç§»ä½å¯„å­˜å™¨ï¼Œè¿™æ ·å¯ä»¥ä½¿åœ¨å·¦ç§»&#x2F;å³ç§»nä½ã€ç¯ç§»nä½å’Œç®—æœ¯å³ç§»nä½ç­‰éƒ½å¯ä»¥ä¸€æ¬¡å®Œæˆã€‚</p><p>3ã€é«˜é€Ÿä¹˜æ³•å™¨ï¼šä¹˜æ³•å™¨ä¸€èˆ¬é‡‡ç”¨â€œåŠ ä¸€ç§»ä½â€çš„æ–¹æ³•æ¥å®ç°ä¹˜æ³•ã€‚ARMä¸ºäº†æé«˜è¿ç®—é€Ÿåº¦ï¼Œåˆ™é‡‡ç”¨ä¸¤ä½ä¹˜æ³•çš„æ–¹æ³•ï¼Œæ ¹æ®ä¹˜æ•°çš„2ä½æ¥å®ç°â€œåŠ ä¸€ç§»ä½â€è¿ç®—;ARMé«˜é€Ÿä¹˜æ³•å™¨é‡‡ç”¨32&TImes;8ä½çš„ç»“æ„ï¼Œè¿™æ ·ï¼Œå¯ä»¥é™ä½é›†æˆåº¦ï¼ˆå…¶ç›¸åº”èŠ¯ç‰‡é¢ç§¯ä¸åˆ°å¹¶è¡Œä¹˜æ³•å™¨çš„1&#x2F;3ï¼‰ã€‚</p><p>4ã€æµ®ç‚¹éƒ¨ä»¶ï¼šæµ®ç‚¹éƒ¨ä»¶æ˜¯ä½œä¸ºé€‰ä»¶ä¾›ARMæ„æ¶ä½¿ç”¨ã€‚FPA10æµ®ç‚¹åŠ é€Ÿå™¨æ˜¯ä½œä¸ºåå¤„ç†æ–¹å¼ä¸ARMç›¸è¿ï¼Œå¹¶é€šè¿‡åå¤„ç†æŒ‡ä»¤çš„è§£é‡Šæ¥æ‰§è¡Œã€‚</p><p>5ã€æ§åˆ¶å™¨ï¼šARMçš„æ§åˆ¶å™¨é‡‡ç”¨çš„æ˜¯ç¡¬æ¥çº¿çš„å¯ç¼–ç¨‹é€»è¾‘é˜µåˆ—PLAã€‚</p><p>6ã€å¯„å­˜å™¨</p><h2><span id="x86æ¶æ„"><strong>x86æ¶æ„</strong></span></h2><p><img src="http://file.elecfans.com/web1/M00/50/ED/pIYBAFr7zpSASlXUAABbDZ2xUGo091.jpg"></p><p>å½“ç„¶ï¼Œè¿™ä¸ªæ¶æ„å›¾å¹¶ä¸æ˜¯æ‰€æœ‰çš„éƒ½æ˜¯å¦‚æ­¤ï¼Œæ ¹æ®ä¸åŒçš„ä¸»æ¿ï¼Œå¹³å°ï¼Œæ¶æ„æ˜¯ç•¥æœ‰å·®åˆ«çš„æ¯”å¦‚è¯´ï¼Œç›®å‰å¾ˆå¤šä¸»æ¿å·²ç»å°†åŒ—æ¡¥é›†æˆåˆ°CPUå½“ä¸­ï¼Œå°†å—æ¡¥é›†æˆä¸ºPCHï¼Œä½†å¤§è‡´çš„æ¡†æ¶è¿˜æ˜¯å¦‚æ­¤çš„ã€‚ä¸‹é¢å¯¹è¿™ä¸ªæ¶æ„å›¾ä¸Šçš„å„ä¸ªå†…å®¹åˆ†åˆ«è¿›è¡Œä¸€äº›ç®€ä»‹:</p><p>   1ï¼šCPUï¼Œå¤§å®¶éƒ½ä¸é™Œç”Ÿçš„åè¯ï¼Œä¸­å¤®å¤„ç†å™¨ï¼Œè®¡ç®—æœºçš„æ ¸å¿ƒå¤§è„‘ã€‚</p><p>ã€€2ï¼š åŒ—æ¡¥ï¼ˆNorth Bridge Chipsetï¼‰ï¼šåŒ—æ¡¥æ˜¯ç”µè„‘ä¸»æ¿ä¸Šçš„ä¸€å—èŠ¯ç‰‡ï¼Œä½äºCPUæ’åº§è¾¹ï¼Œèµ·è¿æ¥ä½œç”¨ã€‚</p><p>ã€€3ï¼šå—æ¡¥èŠ¯ç‰‡ï¼ˆSouth Bridgeï¼‰æ˜¯ä¸»æ¿èŠ¯ç‰‡ç»„çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸€èˆ¬ä½äºä¸»æ¿ä¸Šç¦»CPUæ’æ§½è¾ƒè¿œçš„ä¸‹æ–¹ï¼ŒPCIæ’æ§½çš„é™„è¿‘ï¼Œè¿™ç§å¸ƒå±€æ˜¯è€ƒè™‘åˆ°å®ƒæ‰€è¿æ¥çš„I&#x2F;Oæ€»çº¿è¾ƒå¤šï¼Œç¦»å¤„ç†å™¨è¿œä¸€ç‚¹æœ‰åˆ©äºå¸ƒçº¿ã€‚</p><p>ã€€4ï¼š å†…å­˜æ˜¯è®¡ç®—æœºä¸­é‡è¦çš„éƒ¨ä»¶ä¹‹ä¸€ï¼Œå®ƒæ˜¯ä¸CPUè¿›è¡Œæ²Ÿé€šçš„æ¡¥æ¢ã€‚è®¡ç®—æœºä¸­æ‰€æœ‰ç¨‹åºçš„è¿è¡Œéƒ½æ˜¯åœ¨å†…å­˜ä¸­è¿›è¡Œçš„ï¼Œå› æ­¤å†…å­˜çš„æ€§èƒ½å¯¹è®¡ç®—æœºçš„å½±å“éå¸¸å¤§ã€‚</p><p>ã€€5ï¼šæ˜¾å¡ï¼ˆVideo cardï¼ŒGraphics cardï¼‰å…¨ç§°æ˜¾ç¤ºæ¥å£å¡ï¼Œåˆç§°æ˜¾ç¤ºé€‚é…å™¨ï¼Œæ˜¯è®¡ç®—æœºæœ€åŸºæœ¬é…ç½®ã€æœ€é‡è¦çš„é…ä»¶ä¹‹ä¸€ã€‚</p><p>ã€€6ï¼šæ˜¾ç¤ºjæ¥å£</p><p>ã€€7ï¼šç½‘å¡æ˜¯å·¥ä½œåœ¨é“¾è·¯å±‚çš„ç½‘ç»œç»„ä»¶ï¼Œæ˜¯å±€åŸŸç½‘ä¸­è¿æ¥è®¡ç®—æœºå’Œä¼ è¾“ä»‹è´¨çš„æ¥å£ï¼Œä¸ä»…èƒ½å®ç°ä¸å±€åŸŸç½‘ä¼ è¾“ä»‹è´¨ä¹‹é—´çš„ç‰©ç†è¿æ¥å’Œç”µä¿¡å·åŒ¹é…ï¼Œè¿˜æ¶‰åŠå¸§çš„å‘é€ä¸æ¥æ”¶ã€å¸§çš„å°è£…ä¸æ‹†å°ã€ä»‹è´¨è®¿é—®æ§åˆ¶ã€æ•°æ®çš„ç¼–ç ä¸è§£ç ä»¥åŠæ•°æ®ç¼“å­˜çš„åŠŸèƒ½ç­‰ã€‚</p><p>ã€€8ï¼šå£°å¡çš„åŸºæœ¬åŠŸèƒ½æ˜¯æŠŠæ¥è‡ªè¯ç­’ã€ç£å¸¦ã€å…‰ç›˜çš„åŸå§‹å£°éŸ³ä¿¡å·åŠ ä»¥è½¬æ¢ï¼Œè¾“å‡ºåˆ°è€³æœºã€æ‰¬å£°å™¨ã€æ‰©éŸ³æœºã€å½•éŸ³æœºç­‰å£°å“è®¾å¤‡ï¼Œæˆ–é€šè¿‡éŸ³ä¹è®¾å¤‡æ•°å­—æ¥å£ï¼ˆMIDIï¼‰ä½¿ä¹å™¨å‘å‡ºç¾å¦™çš„å£°éŸ³ã€‚</p><p>ã€€9ï¼šSATAï¼ˆSerial Advanced Technology Attachmentï¼Œä¸²è¡Œé«˜çº§æŠ€æœ¯é™„ä»¶ï¼‰æ˜¯ä¸€ç§åŸºäºè¡Œä¸šæ ‡å‡†çš„ä¸²è¡Œç¡¬ä»¶é©±åŠ¨å™¨æ¥å£ï¼Œæ˜¯ç”±Intelã€IBMã€Dellã€APTã€Maxtorå’ŒSeagateå…¬å¸å…±åŒæå‡ºçš„ç¡¬ç›˜æ¥å£è§„èŒƒã€‚</p><p>ã€€10ï¼šç¡¬ç›˜æ˜¯ç”µè„‘ä¸»è¦çš„å­˜å‚¨åª’ä»‹ä¹‹ä¸€ï¼Œç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªé“åˆ¶æˆ–è€…ç»ç’ƒåˆ¶çš„ç¢Ÿç‰‡ç»„æˆã€‚ç¢Ÿç‰‡å¤–è¦†ç›–æœ‰é“ç£æ€§ææ–™ã€‚</p><p>ã€€11ï¼šæ€»çº¿</p><h2><span id="armæ¶æ„å’Œx86æ¶æ„æœ‰ä»€ä¹ˆåŒºåˆ«"><strong>armæ¶æ„å’Œx86æ¶æ„æœ‰ä»€ä¹ˆåŒºåˆ«</strong></span></h2><p><strong>ä¸€ã€æ€§èƒ½</strong> </p><p>â€‹    X86ç»“æ„çš„ç”µè„‘æ— è®ºå¦‚ä½•éƒ½æ¯”ARMç»“æ„çš„ç³»ç»Ÿåœ¨æ€§èƒ½æ–¹é¢è¦å¿«å¾—å¤šã€å¼ºå¾—å¤šã€‚X86çš„CPUéšä¾¿å°±æ˜¯1Gä»¥ä¸Šã€åŒæ ¸ã€å››æ ¸å¤§è¡Œå…¶é“ï¼Œé€šå¸¸ä½¿ç”¨45nmï¼ˆç”šè‡³æ›´é«˜çº§ï¼‰åˆ¶ç¨‹çš„å·¥è‰ºè¿›è¡Œç”Ÿäº§ï¼›è€ŒARMæ–¹é¢ï¼šCPUé€šå¸¸æ˜¯å‡ ç™¾å…†ï¼Œæœ€è¿‘æ‰å‡ºç°1Gå·¦å³çš„CPUï¼Œåˆ¶ç¨‹é€šå¸¸ä½¿ç”¨ä¸åˆ°65nmåˆ¶ç¨‹çš„å·¥è‰ºï¼Œå¯ä»¥è¯´åœ¨æ€§èƒ½å’Œç”Ÿäº§å·¥è‰ºæ–¹é¢ARMæ ¹æœ¬ä¸æ˜¯X86ç»“æ„ç³»ç»Ÿçš„å¯¹æ‰‹ã€‚</p><p>ã€€ã€€ä½†ARMçš„ä¼˜åŠ¿ä¸åœ¨äºæ€§èƒ½å¼ºå¤§è€Œåœ¨äºæ•ˆç‡ï¼ŒARMé‡‡ç”¨RISCæµæ°´çº¿æŒ‡ä»¤é›†ï¼Œåœ¨å®Œæˆç»¼åˆæ€§å·¥ä½œæ–¹é¢æ ¹æœ¬å°±å¤„äºåŠ£åŠ¿ï¼Œè€Œåœ¨ä¸€äº›ä»»åŠ¡ç›¸å¯¹å›ºå®šçš„åº”ç”¨åœºåˆå…¶ä¼˜åŠ¿å°±èƒ½å‘æŒ¥å¾—æ·‹æ¼“å°½è‡´.</p><p><strong>äºŒã€æ‰©å±•èƒ½åŠ›</strong></p><p>â€‹    X86ç»“æ„çš„ç”µè„‘é‡‡ç”¨â€œæ¡¥â€çš„æ–¹å¼ä¸æ‰©å±•è®¾å¤‡ï¼ˆå¦‚ï¼šç¡¬ç›˜ã€å†…å­˜ç­‰ï¼‰è¿›è¡Œè¿æ¥ï¼Œè€Œä¸”x86ç»“æ„çš„ç”µè„‘å‡ºç°äº†è¿‘30å¹´ï¼Œå…¶é…å¥—æ‰©å±•çš„è®¾å¤‡ç§ç±»å¤šã€ä»·æ ¼ä¹Ÿæ¯”è¾ƒä¾¿å®œï¼Œæ‰€ä»¥x86ç»“æ„çš„ç”µè„‘èƒ½å¾ˆå®¹æ˜“è¿›è¡Œæ€§èƒ½æ‰©å±•ï¼Œå¦‚å¢åŠ å†…å­˜ã€ç¡¬ç›˜ç­‰.</p><p>ã€€ã€€ARMç»“æ„çš„ç”µè„‘æ˜¯é€šè¿‡ä¸“ç”¨çš„æ•°æ®æ¥å£ä½¿CPUä¸æ•°æ®å­˜å‚¨è®¾å¤‡è¿›è¡Œè¿æ¥ï¼Œæ‰€ä»¥ARMçš„å­˜å‚¨ã€å†…å­˜ç­‰æ€§èƒ½æ‰©å±•éš¾ä»¥è¿›è¡Œï¼ˆä¸€èˆ¬åœ¨äº§å“è®¾è®¡æ—¶å·²ç»å®šå¥½å…¶å†…å­˜åŠæ•°æ®å­˜å‚¨çš„å®¹é‡ï¼‰ï¼Œæ‰€ä»¥é‡‡ç”¨ARMç»“æ„çš„ç³»ç»Ÿï¼Œä¸€èˆ¬ä¸è€ƒè™‘æ‰©å±•ã€‚åŸºæœ¬å¥‰è¡Œâ€œå¤Ÿç”¨å°±å¥½â€çš„åŸåˆ™.</p><p> <strong>ä¸‰ã€æ“ä½œç³»ç»Ÿçš„å…¼å®¹æ€§</strong></p><p>â€‹    X86ç³»ç»Ÿç”±å¾®è½¯åŠIntelæ„å»ºçš„Wintelè”ç›Ÿä¸€ç»Ÿå¤©ä¸‹ï¼Œå„æ–­äº†ä¸ªäººç”µè„‘æ“ä½œç³»ç»Ÿè¿‘30å¹´ï¼Œå½¢æˆå·¨å¤§çš„ç”¨æˆ·ç¾¤ï¼Œä¹Ÿæ·±æ·±å›ºåŒ–äº†ä¼—å¤šç”¨æˆ·çš„ä½¿ç”¨ä¹ æƒ¯ï¼ŒåŒæ—¶x86ç³»ç»Ÿåœ¨ç¡¬ä»¶å’Œè½¯ä»¶å¼€å‘æ–¹é¢å·²ç»å½¢æˆç»Ÿä¸€çš„æ ‡å‡†ï¼Œå‡ ä¹æ‰€æœ‰x86ç¡¬ä»¶å¹³å°éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨å¾®è½¯çš„è§†çª—ç³»ç»ŸåŠç°åœ¨æµè¡Œçš„å‡ ä¹æ‰€æœ‰å·¥å…·è½¯ä»¶ï¼Œæ‰€ä»¥x86ç³»ç»Ÿåœ¨å…¼å®¹æ€§æ–¹é¢å…·æœ‰æ— å¯æ¯”æ‹Ÿçš„ä¼˜åŠ¿ã€‚</p><p>ã€€ã€€ARMç³»ç»Ÿå‡ ä¹éƒ½é‡‡ç”¨<strong>Linux</strong>çš„æ“ä½œç³»ç»Ÿï¼Œè€Œä¸”å‡ ä¹æ‰€æœ‰çš„ç¡¬ä»¶ç³»ç»Ÿéƒ½è¦å•ç‹¬æ„å»ºè‡ªå·±çš„ç³»ç»Ÿï¼Œä¸å…¶ä»–ç³»ç»Ÿä¸èƒ½å…¼å®¹ï¼Œè¿™ä¹Ÿå¯¼è‡´å…¶åº”ç”¨è½¯ä»¶ä¸èƒ½æ–¹ä¾¿ç§»æ¤ï¼Œè¿™ä¸€ç‚¹ä¸€ç›´ä¸¥é‡åˆ¶çº¦äº†ARMç³»ç»Ÿçš„å‘å±•å’Œåº”ç”¨ã€‚GOOGLEå¼€å‘äº†å¼€æ”¾å¼çš„<strong>Android</strong>ç³»ç»Ÿåï¼Œç»Ÿä¸€äº†ARMç»“æ„ç”µè„‘çš„æ“ä½œç³»ç»Ÿï¼Œä½¿æ–°æ¨å‡ºåŸºäºARMç»“æ„çš„ç”µè„‘ç³»ç»Ÿæœ‰äº†ç»Ÿä¸€çš„ã€å¼€æ”¾å¼çš„ã€å…è´¹çš„æ“ä½œç³»ç»Ÿï¼Œä¸ºARMçš„å‘å±•æä¾›äº†å¼ºå¤§çš„æ”¯æŒå’ŒåŠ¨åŠ›.</p><p><strong>å››ã€è½¯ä»¶å¼€å‘çš„æ–¹ä¾¿æ€§åŠå¯ä½¿ç”¨å·¥å…·çš„å¤šæ ·æ€§</strong></p><p>â€‹    X86ç»“æ„çš„ç³»ç»Ÿæ¨å‡ºå·²ç»è¿‘30å¹´ï¼Œåœ¨æ­¤æœŸé—´ï¼Œx86ç”µè„‘ç»è¿‡é£é€Ÿå‘å±•çš„é»„é‡‘æ—¶æœŸï¼Œç”¨æˆ·çš„åº”ç”¨ã€è½¯ä»¶é…å¥—ã€è½¯ä»¶å¼€å‘å·¥å…·çš„é…å¥—åŠå…¼å®¹ç­‰å·¥ä½œï¼Œå·²ç»åˆ°è¾¾éå¸¸æˆç†Ÿç”šè‡³å¯ä»¥è¯´æ˜¯å®Œç¾çš„å¢ƒç•Œã€‚æ‰€ä»¥ä½¿ç”¨X86ç”µè„‘ç³»ç»Ÿä¸ä»…æœ‰å¤§é‡çš„ç¬¬ä¸‰æ–¹è½¯ä»¶å¯ä¾›é€‰æ‹©ï¼Œä¹Ÿæœ‰å¤§é‡çš„è½¯ä»¶ç¼–ç¨‹å·¥å…·å¯ä»¥å¸®åŠ©æ‚¨å®Œæˆæ‚¨æ‰€å¸Œæœ›å®Œæˆçš„å·¥ä½œã€‚</p><p>ã€€ã€€Armç»“æ„çš„ç”µè„‘ç³»ç»Ÿå› ä¸ºç¡¬ä»¶æ€§èƒ½çš„åˆ¶çº¦ã€æ“ä½œç³»ç»Ÿçš„ç²¾ç®€ã€ä»¥åŠç³»ç»Ÿå…¼å®¹ç­‰é—®é¢˜çš„åˆ¶çº¦ï¼Œé€ æˆArmç»“æ„çš„ç”µè„‘ç³»ç»Ÿä¸å¯èƒ½åƒX86ç”µè„‘ç³»ç»Ÿé‚£æ ·æœ‰ä¼—å¤šçš„ç¼–ç¨‹å·¥å…·å’Œç¬¬ä¸‰æ–¹è½¯ä»¶å¯ä¾›é€‰æ‹©åŠä½¿ç”¨ï¼ŒARMçš„ç¼–ç¨‹è¯­è¨€å¤§å¤šé‡‡ç”¨Cå’ŒJAVAã€‚</p><p>ã€€ã€€å¯¹è¿™ä¸€ç‚¹çš„æ¯”è¾ƒï¼Œæ›´ç›´æ¥çš„ç»“è®ºæ˜¯ï¼šåŸºäºx86ç»“æ„ç”µè„‘ç³»ç»Ÿå¹³å°å¼€å‘è½¯ä»¶æ¯”armç»“æ„ç³»ç»Ÿæ›´å®¹æ˜“ã€æ›´ç®€å•ã€å®é™…æˆæœ¬ä¹Ÿæ›´ä½ï¼ŒåŒæ—¶æ›´å®¹æ˜“æ‰¾åˆ°ç¬¬ä¸‰æ–¹è½¯ä»¶ï¼ˆå…å»è‡ªå·±å¼€å‘çš„æ—¶é—´å’Œæˆæœ¬ï¼‰ï¼Œè€Œä¸”è½¯ä»¶ç§»æ¤æ›´å®¹æ˜“ã€‚</p><p>ã€€ã€€ä»ä»¥ä¸Šå¯¹æ¯”åˆ†æï¼Œç»™äº†æˆ‘ä»¬çš„ä¸€ä¸ªå¾ˆæ¸…æ™°çš„æ„Ÿè§‰ï¼ŒARMå’ŒX86ç»“æ„çš„ç”µè„‘æ ¹æœ¬å°±æ— æ³•å¯¹æ¯”ï¼ŒARMæ ¹æœ¬å°±ä¸æ˜¯X86ç”µè„‘çš„çš„å¯¹æ‰‹ã€‚æ˜¯çš„ï¼Œå¦‚æœåªè€ƒè™‘ä¸Šè¿°å‡ ä¸ªæ–¹é¢çš„è¦æ•°ï¼ŒARMç¡®å®æ— æ³•ä¸X86ç”µè„‘ç«äº‰ï¼Œç”šè‡³è¿æ¯”è¾ƒçš„èµ„æ ¼éƒ½æ²¡æœ‰ã€‚ä½†æ˜¯è¿‘1ã€2å¹´ï¼ŒARMçš„äº§å“åœ¨ç»ˆç«¯åº”ç”¨ç‰¹åˆ«æ˜¯æ‰‹æŒç»ˆç«¯åº”ç”¨é£é€Ÿå‘å±•ï¼ˆå¦‚ï¼šæ™ºèƒ½æ‰‹æœºã€å¹³æ¿ç”µè„‘ç­‰ï¼‰ï¼Œå…¶é”€å”®æ•°é‡å·²ç»è¿œè¿œè¶…å‡ºx86ç»“æ„çš„ç”µè„‘é”€å”®æ•°é‡ï¼Œå¯è§ARMæ˜¯å…·æœ‰å…¶ä¸X86ç»“æ„ç”µè„‘ä¸å¯å¯¹æ¯”çš„ä¼˜åŠ¿ã€‚è¯¥ä¼˜åŠ¿å°±æ˜¯ï¼š<strong>åŠŸè€—.</strong></p><p><strong>äº”ã€åŠŸè€—</strong> </p><p>X86ç”µè„‘å› è€ƒè™‘è¦é€‚åº”å„ç§åº”ç”¨çš„éœ€æ±‚ï¼Œå…¶å‘å±•æ€è·¯æ˜¯ï¼šæ€§èƒ½+é€Ÿåº¦ã€‚20å¤šå¹´æ¥x86ç”µè„‘çš„é€Ÿåº¦ä»åŸæ¥8088çš„å‡ Må‘å±•åˆ°ç°åœ¨éšä¾¿å°±æ˜¯å‡ Gï¼Œè€Œä¸”è¿˜æ˜¯å‡ æ ¸ï¼Œå…¶é€Ÿåº¦å’Œæ€§èƒ½å·²ç»æå‡äº†åƒã€ä¸‡å€ï¼ŒæŠ€æœ¯è¿›æ­¥ä½¿x86ç”µè„‘æˆä¸ºå¤§ä¼—ç”Ÿæ´»ä¸­ä¸å¯ç¼ºå°‘çš„ä¸€éƒ¨åˆ†ã€‚ä½†æ˜¯x86ç”µè„‘å‘å±•çš„æ–¹å‘å’Œæ¨¡å¼ï¼Œä½¿å…¶åŠŸè€—ä¸€ç›´å±…é«˜ä¸ä¸‹ï¼Œä¸€å°ç”µè„‘éšä¾¿å°±æ˜¯å‡ ç™¾ç“¦ï¼Œå³ä½¿æ˜¯å·ç§°ä½åŠŸè€—èŠ‚èƒ½çš„æ‰‹æç”µè„‘æˆ–ä¸Šç½‘æœ¬ï¼Œä¹Ÿæœ‰åå‡ ã€äºŒåå¤šç“¦çš„åŠŸè€—ï¼Œè¿™ä¸ARMç»“æ„çš„ç”µè„‘å°±æ— æ³•ç›¸æ¯”.</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>HTTP è¯·æ±‚æ–¹æ³•ä¹‹CONNECT method</title>
      <link href="/blog/2021/11/25/HTTP/HTTP-%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95%E4%B9%8BCONNECT-method/"/>
      <url>/blog/2021/11/25/HTTP/HTTP-%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95%E4%B9%8BCONNECT-method/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><blockquote><p>HTTP1.1 ä¸­çš„connect<br>1.httpè¯·æ±‚ä»£ç†å°±æ˜¯connectè¿™ä¸ªæ–¹æ³•ï¼Œconnectç½‘é¡µå¼€å‘ä¸­ä¸ä¼šä½¿ç”¨<br>2.connectçš„ä½œç”¨å°†æœåŠ¡å™¨ä½œä¸ºä»£ç†ï¼Œè®©æœåŠ¡å™¨æç”¨æˆ·è®¿é—®å…¶ä»–ç½‘é¡µï¼ˆç¿»å¢™ï¼‰ï¼Œä¹‹åå°†æ•°æ®è¿”å›ç”¨æˆ·<br>3.connectæ˜¯å°†é€šè¿‡TCPä»£ç†é“¾æ¥æœåŠ¡å™¨çš„ï¼Œå‡å¦‚æˆ‘æƒ³è®©ä»£ç†æœåŠ¡å™¨è®¿é—®ï¼Œ<a href="https://baidu.comç½‘ç«™,é¦–å…ˆè¦ç®€å†ä¸€æ¡å®¢æˆ·ç«¯åˆ°ä»£ç†æœåŠ¡å™¨çš„tcpçš„é“¾æ¥/">https://baidu.comç½‘ç«™ï¼Œé¦–å…ˆè¦ç®€å†ä¸€æ¡å®¢æˆ·ç«¯åˆ°ä»£ç†æœåŠ¡å™¨çš„tcpçš„é“¾æ¥</a><br>ç„¶åç»™ä»£ç†æœåŠ¡å™¨å‘é€ä¸€ä¸ªhttpæŠ¥æ–‡</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CONNECT https://www.jianshu.com/u/f67233ce6c0c:80 HTTP/1.1</span><br><span class="line">Host: www.web-tinker.com:80</span><br><span class="line">Proxy-Connection: Keep-Alive</span><br><span class="line">Proxy-Authorization: Basic *</span><br><span class="line">Content-Length: 0</span><br></pre></td></tr></table></figure><p>åœ¨å‘é€å®Œè¿™ä¸ªè¯·æ±‚ä¹‹åï¼Œä»£ç†æœåŠ¡å™¨ä¼šå“åº”è¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ª200çš„ä¿¡æ¯ï¼Œä½†è¿™ä¸ª200å¹¶ä¸åŒäºæˆ‘ä»¬å¹³æ—¶è§åˆ°çš„OKï¼Œè€Œæ˜¯Connection Established</p>]]></content>
      
      
      <categories>
          
          <category> HTTP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å¼±åŠ¿æ–‡åŒ–</title>
      <link href="/blog/2021/11/22/%E6%88%91%E7%9A%84%E6%97%A5%E8%AE%B0/%E5%BC%B1%E5%8A%BF%E6%96%87%E5%8C%96/"/>
      <url>/blog/2021/11/22/%E6%88%91%E7%9A%84%E6%97%A5%E8%AE%B0/%E5%BC%B1%E5%8A%BF%E6%96%87%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p><img src="https://pic1.zhimg.com/v2-bb213c477bc9d02350862acc72395838_720w.jpg?source=3af55fa1" alt="preview"></p><p>çŸ¥è¯†çš„å¿«é¤ï¼šæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦æ‡‚ç‚¹å“²å­¦<br>ä»€ä¹ˆæ˜¯å“²å­¦ï¼Œå“²å­¦å¯ä¸å¯ä»¥ç†è§£æˆä¸ºäººçš„è®¤çŸ¥çš„å·®å¼‚ï¼Œå“²å­¦é‡Œçš„æ–‡åŒ–å±æ€§åˆ°åº•ä»£è¡¨ç€ä»€ä¹ˆ</p><blockquote><p>é—²æš‡äº§ç”Ÿæ€è¾¨ï¼Œæ€è¾¨æ¶ˆè§£æ•™æ¡ä¸»ä¹‰å’Œé™ˆè…ä¹ ä¿—ï¼Œå‘å±•å‡ºæ•é”çš„æ„ŸçŸ¥ï¼Œè®©äººä¸§å¤±è¡ŒåŠ¨çš„å†³æ–­ã€‚</p><p>æ€æƒ³ï¼Œåœ¨åˆ†æè¿·å®«å†’é™©å‰è¡Œï¼Œå‘ç°ç¤¾ä¼šèƒŒåçš„ä¸ªä½“ï¼Œç»ç’ƒå…¶æ­£å¸¸çš„ç¤¾ä¼šåŠŸèƒ½ï¼Œè½¬å‘å†…åœ¨ï¼Œå‘ç°è‡ªæˆ‘</p><p>å…±åŒçš„åˆ©ç›Šï¼Œå’Œå…±åŒä½“çš„æ„è¯†è¡°é€€ï¼Œå¦‚ä»Šæ²¡æœ‰å…¬æ°‘åªæœ‰ä¸ªäºº</p><p>ä¸ªä½“é€šè¿‡æ€ç´¢æ„è¯†åˆ°è‡ªå·±æœ¬èº«å°±æ˜¯ç”Ÿå­˜çš„ç›®çš„ï¼Œä»–è¦æ±‚å›½é™…ä»æ­¤ä»¥å¾€åŠ å¼ºè€Œä¸æ˜¯åˆ©ç”¨ä»–çš„èƒ½åŠ›ï¼Œä»¥æ­¤ä¸ºä»£ä»·ï¼Œä¸ªäººå°†ç»´æŒå›½å®¶çš„æŒç»­</p></blockquote><p><strong>ç¤¾ä¼šç»æµçš„å‘å±•å¸¦æ¥çš„æˆ‘ä»¬ç‰©è´¨å’Œç”Ÿæ´»çš„å¢é•¿ï¼Œè¢«å† ä»¥ç€æ•°åå¹´æ¥é€šè¿‡ä¸ªä½“åŠªåŠ›çš„ç»“æœï¼Œäºæ˜¯å›½å®¶é€ å°±äº†å¼±åŠ¿æ–‡åŒ–çš„å…¸å‹æ€æƒ³:è¯¯ä»¥ä¸ºå°†è‡ªå·±çš„ç”Ÿæ´»æ°´å¹³çš„æé«˜ï¼Œæ˜¯é€šè¿‡è‡ªå·±å‹¤åŠ³è·å–çš„ï¼Œæ®Šä¸çŸ¥è¿™æ˜¯åƒç€å›½å®¶çš„çº¢åˆ©ï¼Œè€Œå¹¶éè‡ªå·±çœŸçš„å¯ä»¥é€šè¿‡çœŸæ­£çš„åŠªåŠ›è·å–çš„æ¸©é¥±</strong></p>]]></content>
      
      
      <categories>
          
          <category> diary </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>GOLANG-GPMçš„æ·±å…¥ç†è§£</title>
      <link href="/blog/2021/11/18/GOLANG/GOLANG-%E7%AC%94%E8%AE%B012-GPM%E7%9A%84%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/"/>
      <url>/blog/2021/11/18/GOLANG/GOLANG-%E7%AC%94%E8%AE%B012-GPM%E7%9A%84%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>æ·±å…¥golang runtimeçš„è°ƒåº¦</p><h3><span id="ç†è§£è°ƒåº¦å™¨çš„å¯åŠ¨">ç†è§£è°ƒåº¦å™¨çš„å¯åŠ¨</span></h3><p>runtimeï¼š</p><p>scheduler:</p><p>TLS:</p><p>spinning:</p><p>systemstack,mcall,asmcgocall</p><p>ä¸»è¦æºç æ–‡ä»¶:</p><p>è°ƒåº¦åŸºæœ¬ç»„ä»¶ï¼š</p><p>**G(goroutine)**ï¼šè°ƒåº¦å™¨çš„åŸºæœ¬å•ä½ï¼Œå­˜å‚¨çš„goroutineçš„æ‰§è¡Œstackä¿¡æ¯ï¼ŒçŠ¶æ€ä»¥åŠä»»åŠ¡å‡½æ•°</p><p>åœ¨gçš„çœ¼ä¸­åªæœ‰p,på°±æ˜¯è¿è¡Œçš„Gçš„â€œCPUâ€</p><p>ç›¸å½“äºä¸¤çº§çº¿ç¨‹</p><blockquote><p>gçš„ä»»åŠ¡å‡½æ•°</p></blockquote><p>æ¯ä¸ªgçš„å®ä¾‹éƒ½æœ‰ä»»åŠ¡å‡½æ•°ï¼Œå¦‚ä¸‹ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">userFun:=func()&#123;fmt.Println(&quot;111&quot;)&#125;</span><br><span class="line">go userFunc();</span><br></pre></td></tr></table></figure><p>goçš„å…³é”®è¯åˆ›å»ºäº†ä¸€ä¸ªgoroutine,æ­¤æ—¶gouroutineçš„ä»»åŠ¡å‡½æ•°userFun</p><p><strong>Pï¼ˆprocessorï¼‰</strong></p><p>pè¡¨ç¤ºé€»è¾‘processorï¼Œä»£è¡¨Mæ‰§è¡Œçš„ä¸Šä¸‹æ–‡</p><p>pçš„æœ€å¤§ä½œç”¨æ˜¯æ‹¥æœ‰å„ç§Gçš„å¯¹è±¡é˜Ÿåˆ—ï¼Œé“¾è¡¨ï¼Œcache,å’ŒçŠ¶æ€</p><p>pçš„æ•°é‡ä¹Ÿä»£è¡¨goçš„æ‰§è¡Œå¹¶å‘åº¦ï¼Œå³å¤šå°‘ä¸ªgoroutineå¯ä»¥åŒæ—¶æ‰§è¡Œ</p><p>è¿™é‡Œçš„pè™½ç„¶è¡¨ç¤ºé€»è¾‘å¤„ç†å™¨ï¼Œä½†æ˜¯på¹¶ä¸ä»£è¡¨ä»»ä½•æ‰§è¡Œä»£ç ï¼Œå¯¹äºgæ¥è¯´ï¼Œpç›¸å½“äºcpuçš„æ ¸ï¼Œgåªæœ‰ç»‘å®špæ‰èƒ½è°ƒåº¦ã€‚å¯¹äºMæ¥è¯´ï¼Œpæä¾›äº†æ‰§è¡Œç¯å¢ƒï¼ˆContextï¼‰ï¼Œå¦‚åˆ†é…å†…å­˜çŠ¶æ€ï¼ˆmcacheï¼‰,ä»»åŠ¡é˜Ÿåˆ—Gç­‰</p><p><strong>M(machine)</strong></p><p>Mä»£è¡¨çœŸæ­£çš„æ‰§è¡Œè®¡ç®—èµ„æºï¼Œå¯ä»¥ä»»åŠ¡ä»–å°±æ˜¯os thread(ç³»ç»Ÿçº¿ç¨‹)</p><p>Mæ˜¯çœŸæ­£çš„æ‰§è¡Œè€…ï¼Œæ¯ä¸ªMå°±åƒä¸€ä¸ªå‹¤åŠ³çš„å·¥ä½œè€…ï¼Œæ€»æ˜¯ä»å„ç§é˜Ÿåˆ—æ‰¾åˆ°å¯è¿è¡Œçš„G,è€Œä¸”è¿™æ ·çš„Mçš„å¯ä»¥åŒæ—¶å­˜åœ¨å¤šä¸ª</p><p>Måœ¨ç»‘å®šæœ‰æ•ˆPï¼Œå¯ä»¥è¿›è¡Œè°ƒåº¦å¾ªç¯ï¼Œè€Œä¸”Må¹¶ä¸ä¿ç•™GçŠ¶æ€ï¼Œè¿™ä¸ªæ˜¯gå¯ä»¥è·¨Mè°ƒåº¦çš„åŸºç¡€</p>]]></content>
      
      
      <categories>
          
          <category> GOLANG </category>
          
      </categories>
      
      
        <tags>
            
            <tag> golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GOLANG-çº¯çº¯çš„è¯­æ³•ä»”çš„æ²¡è½</title>
      <link href="/blog/2021/11/17/GOLANG/GOLANG-%E7%AC%94%E8%AE%B09-%E7%BA%AF%E7%BA%AF%E7%9A%84%E8%AF%AD%E6%B3%95%E4%BB%94%E7%9A%84%E6%B2%A1%E8%90%BD/"/>
      <url>/blog/2021/11/17/GOLANG/GOLANG-%E7%AC%94%E8%AE%B09-%E7%BA%AF%E7%BA%AF%E7%9A%84%E8%AF%AD%E6%B3%95%E4%BB%94%E7%9A%84%E6%B2%A1%E8%90%BD/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h2><span id="åŸºç¡€">åŸºç¡€</span></h2><h3><span id="1-å¯¹äºå·²ç»å…³é—­çš„channelçš„å¤„ç†">1. å¯¹äºå·²ç»å…³é—­çš„channelçš„å¤„ç†</span></h3><p>è¯»å·²ç»å…³é—­çš„channelï¼Œä¸€ç›´èƒ½è¯»åˆ°ä¸œè¥¿ï¼Œä½†æ˜¯è¯»åˆ°çš„ä¸œè¥¿æ ¹æ®é€šé“å†…å…³é—­å‰æ˜¯å¦æœ‰å…ƒç´ è€Œä¸åŒï¼Œ</p><ul><li>å…³é—­å‰ï¼Œbufferæœ‰è¿˜æœªè¯»å–çš„ï¼Œä¼šè¯»å–åˆ°chanå†…çš„å€¼ï¼Œä¸”è¿”å›æ˜¯å¦è¯»å–æˆåŠŸçš„boolå€¼ä¸ºtrue</li><li>å…³é—­å‰ï¼Œbufferçš„å€¼è¯»å®Œï¼Œchannelå…ƒç´ å€¼ä¸º0ï¼Œboolå€¼ä¸ºfalse</li></ul><p>å†™å…¥ï¼šç›´æ¥panic</p><h3><span id="2-makeå’ŒnewåŒºåˆ«">2. Makeå’ŒnewåŒºåˆ«</span></h3><p>makeï¼šè¿”å›ç‰¹å®šç±»å‹channelï¼Œslice,map</p><p>new: å¼€è¾Ÿæ–°å†…å­˜å’ŒæŒ‡é’ˆï¼Œæ³›åŒ–ç±»å‹</p><h3><span id="3-nil-åˆ‡ç‰‡å’Œç©ºåˆ‡ç‰‡ä¸€ä¸ä¸€æ ·">3. nil åˆ‡ç‰‡å’Œç©ºåˆ‡ç‰‡ä¸€ä¸ä¸€æ ·</span></h3><p>æŒ‡å‘çš„åœ°å€ä¸ä¸€æ ·ã€‚nillå¼•ç”¨æŒ‡é’ˆåœ°å€ä¸º0ï¼Œç©ºåˆ‡ç‰‡æ‰§è¡Œæ•°ç»„æŒ‡é’ˆåœ°å€ï¼Œä¸”ä¸ºä¸€ä¸ªå›ºå®šå€¼</p><p>æ•°æ®ç»“æ„ï¼šdata,len,cap</p><h3><span id="4-å­—ç¬¦ä¸²è½¬byteæ•°ç»„ä¼šå‘ç”Ÿå†…å­˜æ‹·è´å—">4. å­—ç¬¦ä¸²è½¬byteæ•°ç»„ï¼Œä¼šå‘ç”Ÿå†…å­˜æ‹·è´å—</span></h3><p>ä¸¥æ ¼æ¥è¯´ï¼Œåªè¦å‘ç”Ÿç±»å‹å¼ºè½¬ï¼Œéƒ½ä¼šå‘ç”Ÿå†…å­˜æ‹·è´ã€‚</p><p>é‚£ä¹ˆgoæœ‰ä¸ªå¾ˆå¼ºçš„åŒ…å« <code>unsafe</code> ã€‚å…ˆè·å–å˜é‡åœ°å€ï¼Œå­—ç¬¦ä¸²è½¬æˆåº•å±‚ç»“æ„ï¼Œé€šè¿‡unsafeåŒ…ï¼Œè½¬ä¸ºåˆ‡ç‰‡æ•°ç»„,å†é€šè¿‡æŒ‡é’ˆæŒ‡å‘å®é™…å†…å®¹</p><p>string æ•°æ®ç»“æ„ {data,len} </p><h3><span id="5-jsonåŒ…å˜é‡ä¸åŠ tagä¼šæ€ä¹ˆæ ·">5. jsonåŒ…å˜é‡ä¸åŠ tagä¼šæ€ä¹ˆæ ·</span></h3><p>å’Œkeyçš„å¤§å°å†™æœ‰å…³</p><h3><span id="6-gpm">6. GPM</span></h3><p>æŒ‡å‘å¦ä¸€ç¯‡è¯¦ç»†ï¼ˆï¼‰</p><h3><span id="7docker-çš„ç½‘ç»œé€šä¿¡æ¨¡å¼">7.Docker çš„ç½‘ç»œé€šä¿¡æ¨¡å¼ã€‚</span></h3><p>å››ç§ï¼š</p><p>1.hostæ¨¡å¼ï¼šå’Œå®¿ä¸»æœºå…¬ç”¨ä¸€ä¸ªnetwork NameSpace ã€‚å®¹å™¨ä¸ä¼šé…ç½®ä»»ä½•è‡ªå·±ç½‘å¡ï¼Œè€Œæ˜¯ä½¿ç”¨è‡ªå·±å®¿ä¸»æœºçš„IPå’Œç«¯å£</p><p>2.containeræ¨¡å¼ï¼šæŒ‡å®šå’Œå…¶ä»–å®¹å™¨å…±äº«network nameSpace,è€Œä¸æ˜¯å’Œå®¿ä¸»æœºå…±äº«</p><p>3.noneæ¨¡å¼ï¼šå‘Šè¯‰å®¹å™¨æ”¾åˆ°è‡ªå·±ç½‘ç«™å †é‡Œï¼Œä½†æ˜¯ä¸è¦é…ç½®ä»–çš„ç½‘ç»œ</p><p>4.bridegæ¨¡å¼ï¼šdockeré»˜è®¤çš„ç½‘ç»œæ¨¡å¼ï¼Œæ­¤æ¨¡å¼ä¼šå°†ä¸»æœºdockeré“¾æ¥åˆ°è™šæ‹Ÿç½‘æ¡¥ä¸Š</p><h3><span id="8è®¿é—®ç§æœ‰æˆå‘˜">8.è®¿é—®ç§æœ‰æˆå‘˜</span></h3><blockquote><p>è°ƒç”¨å…¶ä»–åŒ…å…±æœ‰ç»“æ„çš„ç§æœ‰æˆå‘˜å˜<strong>é‡</strong></p></blockquote><p><strong>ç»•è¿‡å°å†™ä¸å…¬å¼€</strong></p><p>ç”¨unsafeåŒ…ä¸­çš„unsafe.Pointerè·å–åˆ°ç»“æ„ä½“å¯¹è±¡çš„é¦–åœ°å€ï¼Œç„¶ååŠ ä¸Šæƒ³è®¿é—®çš„ç§æœ‰å˜é‡çš„åç§»åœ°å€å°±æ˜¯ç§æœ‰å˜é‡çš„åœ°å€</p><h3><span id="9-æ•°ç»„å’Œåˆ‡ç‰‡çš„åŒºåˆ«">9ã€æ•°ç»„å’Œåˆ‡ç‰‡çš„åŒºåˆ«</span></h3><p>é•¿åº¦ï¼Œå®¹é‡ï¼Œæ•°ç»„æŒ‡é’ˆ</p><p>åˆ‡ç‰‡æ˜¯æŒ‡é’ˆç±»å‹ï¼Œæ•°ç»„æ˜¯æ˜¯å€¼ç±»å‹</p><p>æ•°æ®é•¿åº¦å›ºå®šï¼Œåˆ‡ç‰‡ä¸å›ºå®š</p><p>åˆ‡ç‰‡æ¯”æ•°ç»„å¤šä¸ªå±æ€§ï¼ˆcapï¼‰,åˆ‡ç‰‡åº•å±‚æ˜¯æ•°ç»„</p><ul><li>æ‰©å®¹ï¼šå°äº1024 æ¯æ¬¡capç¿»å€ï¼Œè¶…è¿‡å˜æˆ1.25</li><li>æ‰©å®¹åæ²¡è§¦åŠåŸæ•°ç»„å®¹é‡ï¼Œé‚£ä¹ˆåˆ‡ç‰‡æŒ‡é’ˆæŒ‡å‘çš„ä½ç½®ï¼Œè¿˜æ˜¯åŸæ•°ç»„ï¼Œæ‰©å®¹åï¼Œè¶…è¿‡åŸæ•°ç»„å®¹é‡ï¼Œä¼šå¼€è¾Ÿä¸€å—æ–°å†…å­˜ï¼ŒåŸæ¥çš„å€¼æ‹·è´è¿‡æ¥ï¼Œä¹Ÿä¸ä¼šå½±å“åŸæ¥æ•°ç»„</li><li>append:</li></ul><h3><span id="10ä»‹ç»-rune-ç±»å‹">10.ä»‹ç» rune ç±»å‹</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package main</span><br><span class="line">import &quot;fmt&quot;</span><br><span class="line">func main() &#123;</span><br><span class="line">    var str = &quot;hello ä½ å¥½&quot;</span><br><span class="line">    fmt.Println(&quot;len(str):&quot;, len(str))</span><br><span class="line">    //12ä¸ª </span><br><span class="line">    //ä¸­æ–‡å­—ç¬¦åœ¨unicodeä¸‹å 2ä¸ªå­—èŠ‚ï¼Œåœ¨utf-8ç¼–ç ä¸‹å 3ä¸ªå­—èŠ‚ goé»˜è®¤utf-8 5+1+3*2</span><br><span class="line">    //é€šè¿‡runeç±»å‹å¤„ç†unicodeå­—ç¬¦</span><br><span class="line">    fmt.Println(&quot;rune:&quot;, len([]rune(str))) //8ä¸ª</span><br><span class="line">    fmt.Println(&quot;RuneCountInString:&quot;, utf8.RuneCountInString(str))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>byteç­‰åŒäºuint8ï¼Œè€Œä¸æ˜¯int8</p><p>rune ç­‰åŒäºint32,å¸¸ç”¨æ¥å¤„ç†unicodeæˆ–utf-8å­—ç¬¦</p><h3><span id="11-panic-defer-recover">11 panic defer recover</span></h3><p>panic() å‡½æ•°</p><p>å‡½æ•°ä¸­é‡åˆ°panicè¯­å¥ï¼Œä¼šç«‹å³ç»ˆæ­¢å½“å‰å‡½æ•°çš„æ‰§è¡Œï¼Œåœ¨panicæ‰€åœ¨å‡½æ•°å†…å¦‚æœå­˜åœ¨è¦æ‰§è¡Œçš„deferå‡½æ•°åˆ—è¡¨ï¼ŒæŒ‰ç…§deferçš„é€†åºæ‰§è¡Œ</p><p>recover() å‡½æ•°</p><p>recoverå‡½æ•°çš„è¿”å›å€¼æŠ¥å‘Šåç¨‹æ˜¯å¦æ­£åœ¨é­é‡panic</p><p>æœ‰å¼‚å¸¸æ—¶ï¼Œrecover()åªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œåé¢å†æ¬¡è°ƒç”¨åˆ™æ•è·ä¸åˆ°ä»»ä½•å¼‚å¸¸</p><p>é€šå¸¸åŠæ³•ï¼šgoä¸­å¯ä»¥æŠ›å‡ºä¸€ä¸ªpanicçš„å¼‚å¸¸ï¼Œç„¶ååœ¨deferä¸­é€šè¿‡recoveræ•è·è¿™ä¸ªå¼‚å¸¸ï¼Œç„¶åæ­£å¸¸å¤„ç†ï¼Œä»è€Œæ¢å¤æ­£å¸¸ä»£ç çš„æ‰§è¡Œ</p><h3><span id="12-è¯»å†™é”å’Œäº’æ–¥é”">12 è¯»å†™é”å’Œäº’æ–¥é”</span></h3><p>æ€»ç»“ï¼š</p><ol><li>1.åœ¨å•çº¯çš„åªæ˜¯è·å–é”å’Œé‡Šæ”¾é”æ—¶ï¼Œäº’æ–¥é”çš„ç”¨æ—¶è¦å°‘ä¸€äº›ï¼Œè¿™ä¸»è¦æ˜¯å› ä¸ºå¤šä¸ªçº¿ç¨‹åŒæ—¶è·å–è¯»å†™é”çš„æƒ…å†µæ¯”è¾ƒå°‘å‡ºç°ã€‚</li><li>golangåº•å±‚å®ç°ä¸Šï¼Œäº’æ–¥é”ç¡®å®è¦æ¯”è¯»å†™é”çš„æ€§èƒ½è¦å¥½ä¸€äº›ï¼Œè¿™ä¸»è¦æ˜¯å› ä¸ºè¯»å†™é”çš„åº•å±‚å®ç°å…¶å®æ˜¯äº’æ–¥é”åŠ ä¸Šè®¡æ•°å™¨</li><li>åœ¨ å¢ å¼º å ç¨‹ äº’ ç›¸ å†² çª çš„ æ•ˆ æœ å ï¼Œ è¯» å†™ é” çš„ æ€§ èƒ½ è¦ æ˜ æ˜¾ é«˜ äº äº’ æ–¥ é”</li></ol><h3><span id="13ç»“æ„ä½“æ˜¯å¦å¯ä»¥æ¯”è¾ƒ">13.ç»“æ„ä½“æ˜¯å¦å¯ä»¥æ¯”è¾ƒ</span></h3><p>å›åˆ°ä¸Šé¢çš„åˆ’é‡ç‚¹éƒ¨åˆ†ï¼Œåœ¨æ€»ç»“ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œgolangä¸­ <em>Slice</em>ï¼Œ<em>Map</em>ï¼Œ<em>Function</em> è¿™ä¸‰ç§æ•°æ®ç±»å‹æ˜¯ä¸å¯ä»¥ç›´æ¥æ¯”è¾ƒçš„ã€‚æˆ‘ä»¬å†çœ‹çœ‹Sç»“æ„ä½“ï¼Œè¯¥ç»“æ„ä½“å¹¶æ²¡æœ‰åŒ…å«ä¸å¯æ¯”è¾ƒçš„æˆå‘˜å˜é‡ï¼Œæ‰€ä»¥è¯¥ç»“æ„ä½“æ˜¯å¯ä»¥ç›´æ¥æ¯”è¾ƒçš„ã€‚</p><p> <em>reflect.DeepEqual å‡½æ•°</em> æ¥å¯¹ä¸¤ä¸ªå˜é‡è¿›è¡Œæ¯”è¾ƒã€‚</p><h3><span id="14golang-channelæ˜¯çº¿ç¨‹å®‰å…¨çš„å—">14.golang channelæ˜¯çº¿ç¨‹å®‰å…¨çš„å—</span></h3><p>å¦‚æœæŠŠçº¿ç¨‹å®‰å…¨å®šä¹‰ä¸ºå…è®¸å¤šä¸ªgoroutineåŒæ—¶å»è¯»å†™ï¼Œé‚£ä¹ˆgolang çš„channel æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä¸éœ€è¦åœ¨å¹¶å‘è¯»å†™åŒä¸€ä¸ªchanneæ—¶åŠ é”ã€‚</p><h3><span id="15channelæ•°æ®ç»“æ„">15.channelæ•°æ®ç»“æ„</span></h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> hchan <span class="keyword">struct</span> &#123;</span><br><span class="line">    qcount   <span class="type">uint</span>           <span class="comment">// total data in the queue</span></span><br><span class="line">    dataqsiz <span class="type">uint</span>           <span class="comment">// size of the circular queue</span></span><br><span class="line">    buf      unsafe.Pointer <span class="comment">// points to an array of dataqsiz elements</span></span><br><span class="line">    elemsize <span class="type">uint16</span></span><br><span class="line">    closed   <span class="type">uint32</span></span><br><span class="line">    elemtype *_type <span class="comment">// element type</span></span><br><span class="line">    sendx    <span class="type">uint</span>   <span class="comment">// send index</span></span><br><span class="line">    recvx    <span class="type">uint</span>   <span class="comment">// receive index</span></span><br><span class="line">    recvq    waitq  <span class="comment">// list of recv waiters</span></span><br><span class="line">    sendq    waitq  <span class="comment">// list of send waiters</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// lock protects all fields in hchan, as well as several</span></span><br><span class="line">    <span class="comment">// fields in sudogs blocked on this channel.</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// Do not change another G&#x27;s status while holding this lock</span></span><br><span class="line">    <span class="comment">// (in particular, do not ready a G), as this can deadlock</span></span><br><span class="line">    <span class="comment">// with stack shrinking.</span></span><br><span class="line">    lock mutex</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> waitq <span class="keyword">struct</span> &#123;</span><br><span class="line">    first *sudog</span><br><span class="line">    last  *sudog</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> GOLANG </category>
          
      </categories>
      
      
        <tags>
            
            <tag> golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GOLANG-grpc</title>
      <link href="/blog/2021/11/17/GOLANG/GOLANG-%E7%AC%94%E8%AE%B014grpc/"/>
      <url>/blog/2021/11/17/GOLANG/GOLANG-%E7%AC%94%E8%AE%B014grpc/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><blockquote><p>grpc å®˜ç½‘ï¼š<a href="https://grpc.io/docs/languages/go/basics/">https://grpc.io/docs/languages/go/basics/</a> ä¸­æ–‡ç¿»è¯‘ç‰ˆæœ¬ï¼š<a href="http://doc.oschina.net/grpc?t=56831">http://doc.oschina.net/grpc?t=56831</a></p></blockquote><p>1ã€ä¸‹è½½protobufçš„ç¼–è¯‘å™¨protoc</p><p>åœ°å€ï¼š</p><p>1ã€<code>https://github.com/google/protobuf/releases</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">windowï¼š</span><br><span class="line">  ä¸‹è½½: protoc-3.3.0-win32.zip</span><br><span class="line">  è§£å‹ï¼ŒæŠŠbinç›®å½•ä¸‹çš„protoc.exeå¤åˆ¶åˆ°GOPATH/binä¸‹ï¼ŒGOPATH/binåŠ å…¥ç¯å¢ƒå˜é‡ã€‚</span><br><span class="line">å½“ç„¶ä¹Ÿå¯æ”¾åœ¨å…¶ä»–ç›®å½•ï¼Œéœ€åŠ å…¥ç¯å¢ƒå˜é‡ï¼Œèƒ½è®©ç³»ç»Ÿæ‰¾åˆ°protoc.exe</span><br><span class="line"></span><br><span class="line">linuxï¼š</span><br><span class="line">    ä¸‹è½½ï¼šprotoc-3.3.0-linux-x86_64.zip æˆ– protoc-3.3.0-linux-x86_32.zip</span><br><span class="line">è§£å‹ï¼ŒæŠŠbinç›®å½•ä¸‹çš„protocå¤åˆ¶åˆ°GOPATH/binä¸‹ï¼ŒGOPATH/binåŠ å…¥ç¯å¢ƒå˜é‡ã€‚</span><br><span class="line">å¦‚æœå–œæ¬¢ç¼–è¯‘å®‰è£…çš„ï¼Œä¹Ÿå¯ä¸‹è½½æºç è‡ªè¡Œå®‰è£…ï¼Œæœ€åå°†å¯æ‰§è¡Œæ–‡ä»¶åŠ å…¥ç¯å¢ƒå˜é‡ã€‚</span><br></pre></td></tr></table></figure><p>2ã€è·å–protobufçš„ç¼–è¯‘å™¨æ’ä»¶<code>protoc-gen-go</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  è¿›å…¥GOPATHç›®å½•</span><br><span class="line">  è¿è¡Œ</span><br><span class="line">&gt; go get -u github.com/golang/protobuf/protoc-gen-go</span><br><span class="line">  å¦‚æœæˆåŠŸï¼Œä¼šåœ¨GOPATH/binä¸‹ç”Ÿæˆprotoc-gen-go.exeæ–‡ä»¶</span><br></pre></td></tr></table></figure><p>3ã€åˆ›å»ºä¸€ä¸ª<code>test.proto</code>æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">//æŒ‡å®šç‰ˆæœ¬</span><br><span class="line">//æ³¨æ„proto3ä¸proto2çš„å†™æ³•æœ‰äº›ä¸åŒ</span><br><span class="line">syntax = &quot;proto3&quot;;</span><br><span class="line"> </span><br><span class="line">//åŒ…åï¼Œé€šè¿‡protocç”Ÿæˆæ—¶goæ–‡ä»¶æ—¶</span><br><span class="line">package test;</span><br><span class="line"> </span><br><span class="line">//æ‰‹æœºç±»å‹</span><br><span class="line">//æšä¸¾ç±»å‹ç¬¬ä¸€ä¸ªå­—æ®µå¿…é¡»ä¸º0</span><br><span class="line">enum PhoneType &#123;</span><br><span class="line">    HOME = 0;</span><br><span class="line">    WORK = 1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">//æ‰‹æœº</span><br><span class="line">message Phone &#123;</span><br><span class="line">    PhoneType type = 1;</span><br><span class="line">    string number = 2;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">//äºº</span><br><span class="line">message Person &#123;</span><br><span class="line">    //åé¢çš„æ•°å­—è¡¨ç¤ºæ ‡è¯†å·</span><br><span class="line">    int32 id = 1;</span><br><span class="line">    string name = 2;</span><br><span class="line">    //repeatedè¡¨ç¤ºå¯é‡å¤</span><br><span class="line">    //å¯ä»¥æœ‰å¤šä¸ªæ‰‹æœº</span><br><span class="line">    repeated Phone phones = 3;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">//è”ç³»ç°¿</span><br><span class="line">message ContactBook &#123;</span><br><span class="line">    repeated Person persons = 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4ã€è¿è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; protoc --go_out=. *.proto</span><br><span class="line">ä¼šç”Ÿæˆä¸€ä¸ªtest.pb.goçš„æ–‡ä»¶ï¼Œå…·ä½“çš„æ–‡ä»¶å†…å®¹æˆ‘å°±ä¸æˆªå›¾äº†ã€‚</span><br></pre></td></tr></table></figure><p>5ã€åœ¨goè¯­è¨€ä¸­ä½¿ç”¨protobuf</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">package main;</span><br><span class="line"> </span><br><span class="line">import (</span><br><span class="line">    &quot;github.com/golang/protobuf/proto&quot;</span><br><span class="line">    &quot;protobuf/test&quot;</span><br><span class="line">    &quot;io/ioutil&quot;</span><br><span class="line">    &quot;os&quot;</span><br><span class="line">    &quot;fmt&quot;</span><br><span class="line">)</span><br><span class="line"> </span><br><span class="line">func write() &#123;</span><br><span class="line">    p1 := &amp;test.Person&#123;</span><br><span class="line">        Id:   1,</span><br><span class="line">        Name: &quot;å°å¼ &quot;,</span><br><span class="line">        Phones: []*test.Phone&#123;</span><br><span class="line">            &#123;test.PhoneType_HOME, &quot;111111111&quot;&#125;,</span><br><span class="line">            &#123;test.PhoneType_WORK, &quot;222222222&quot;&#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">    p2 := &amp;test.Person&#123;</span><br><span class="line">        Id:   2,</span><br><span class="line">        Name: &quot;å°ç‹&quot;,</span><br><span class="line">        Phones: []*test.Phone&#123;</span><br><span class="line">            &#123;test.PhoneType_HOME, &quot;333333333&quot;&#125;,</span><br><span class="line">            &#123;test.PhoneType_WORK, &quot;444444444&quot;&#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line"> </span><br><span class="line">    //åˆ›å»ºåœ°å€ç°¿</span><br><span class="line">    book := &amp;test.ContactBook&#123;&#125;;</span><br><span class="line">    book.Persons = append(book.Persons, p1);</span><br><span class="line">    book.Persons = append(book.Persons, p2);</span><br><span class="line"> </span><br><span class="line">    //ç¼–ç æ•°æ®</span><br><span class="line">    data, _ := proto.Marshal(book);</span><br><span class="line">    //æŠŠæ•°æ®å†™å…¥æ–‡ä»¶</span><br><span class="line">    ioutil.WriteFile(&quot;./test.txt&quot;, data, os.ModePerm);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">func read() &#123;</span><br><span class="line">    //è¯»å–æ–‡ä»¶æ•°æ®</span><br><span class="line">    data, _ := ioutil.ReadFile(&quot;./test.txt&quot;);</span><br><span class="line">    book := &amp;test.ContactBook&#123;&#125;;</span><br><span class="line">    //è§£ç æ•°æ®</span><br><span class="line">    proto.Unmarshal(data, book);</span><br><span class="line">    for _, v := range book.Persons &#123;</span><br><span class="line">        fmt.Println(v.Id, v.Name);</span><br><span class="line">        for _, vv := range v.Phones &#123;</span><br><span class="line">            fmt.Println(vv.Type, vv.Number);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">func main() &#123;</span><br><span class="line">    write();</span><br><span class="line">    read();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/5367714-2eb580ad8e2e7a93.png" alt="img"></p><p>image.png</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//go:generate protoc -I ../routeguide --go_out=plugins=grpc:../routeguide ../routeguide/route_guide.proto protoc</span><br></pre></td></tr></table></figure><p><code>-I</code> å‚æ•°ï¼šæŒ‡å®šimportè·¯å¾„ï¼Œå¯ä»¥æŒ‡å®šå¤šä¸ª-Iå‚æ•°ï¼Œç¼–è¯‘æ—¶æŒ‰é¡ºåºæŸ¥æ‰¾ï¼Œä¸æŒ‡å®šæ—¶é»˜è®¤æŸ¥æ‰¾å½“å‰ç›®å½•</p><p><code>--go_out</code> ï¼šgolangç¼–è¯‘æ”¯æŒï¼Œæ”¯æŒä»¥ä¸‹å‚æ•°<br>plugins&#x3D;plugin1+plugin2 - æŒ‡å®šæ’ä»¶ï¼Œç›®å‰åªæ”¯æŒgrpcï¼Œå³ï¼šplugins&#x3D;grpc</p>]]></content>
      
      
      <categories>
          
          <category> GOLANG </category>
          
      </categories>
      
      
        <tags>
            
            <tag> golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®å››å±‚ä¸ƒå±‚</title>
      <link href="/blog/2021/11/10/REDIS/%E6%95%B0%E6%8D%AE%E5%9B%9B%E5%B1%82%E4%B8%83%E5%B1%82/"/>
      <url>/blog/2021/11/10/REDIS/%E6%95%B0%E6%8D%AE%E5%9B%9B%E5%B1%82%E4%B8%83%E5%B1%82/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script>]]></content>
      
      
      <categories>
          
          <category> reids </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>golangé‡Œçš„è¿›ç¨‹çº¿ç¨‹æºç¨‹çš„è°ƒåº¦æ–¹å¼</title>
      <link href="/blog/2021/10/10/GOLANG/GOLANG-%E7%AC%94%E8%AE%B015-%E9%87%8C%E7%9A%84%E8%BF%9B%E7%A8%8B%E7%BA%BF%E7%A8%8B%E6%90%BA%E7%A8%8B%E7%9A%84%E8%B0%83%E5%BA%A6%E6%96%B9%E5%BC%8F/"/>
      <url>/blog/2021/10/10/GOLANG/GOLANG-%E7%AC%94%E8%AE%B015-%E9%87%8C%E7%9A%84%E8%BF%9B%E7%A8%8B%E7%BA%BF%E7%A8%8B%E6%90%BA%E7%A8%8B%E7%9A%84%E8%B0%83%E5%BA%A6%E6%96%B9%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>æ‰¾å·¥ä½œæœ¬æ¥æƒ³é å®åŠ›å’Œç»éªŒï¼Œå¥ˆä½•ä»éœ€èƒŒé¢è¯•é¢˜ï¼Œåˆ·ç®—æ³•ï¼Œå¯ä»¥è¯´æ˜¯å¯æ¶äº†<br>ä½œè€…ï¼šè…¾è®¯æŠ€æœ¯å·¥ç¨‹<br>é“¾æ¥ï¼š<a href="https://www.zhihu.com/question/20862617/answer/921061289">https://www.zhihu.com/question/20862617/answer/921061289</a><br>æ¥æºï¼šçŸ¥ä¹</p><h2><span id="goroutine-å®ç°">goroutine å®ç°:</span></h2><p><img src="https://pic1.zhimg.com/50/v2-5f7f337c089077babfbe296e8a82c88a_720w.jpg?source=1940ef5c" alt="img"></p><p>æˆ‘ä»¬å»çœ‹è°ƒåº¦çš„ä¸€ä¸ªè¿›åŒ–, ä»è¿›ç¨‹åˆ°çº¿ç¨‹å†åˆ°åç¨‹, å…¶å®æ˜¯ä¸€ä¸ªä¸æ–­å…±äº«, ä¸æ–­å‡å°‘åˆ‡æ¢æˆæœ¬çš„è¿‡ç¨‹. go å®ç°çš„åç¨‹ä¸ºæœ‰æ ˆåç¨‹, go åç¨‹çš„ç”¨æ³•å’Œçº¿ç¨‹çš„ç”¨æ³•åŸºæœ¬ç±»ä¼¼. å¾ˆå¤šäººä¼šç–‘é—®, åç¨‹åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿? ç”¨æˆ·æ€çš„è°ƒåº¦æ„Ÿè§‰å¾ˆé™Œç”Ÿ, å¾ˆæŠ½è±¡, åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿?</p><p>æˆ‘è§‰å¾—è¦ç†è§£è°ƒåº¦, è¦ç†è§£ä¸¤ä¸ªæ¦‚å¿µ: è¿è¡Œå’Œé˜»å¡. ç‰¹åˆ«æ˜¯åœ¨åç¨‹ä¸­, è¿™ä¸¤ä¸ªæ¦‚å¿µä¸å®¹æ˜“è¢«æ­£ç¡®ç†è§£. æˆ‘ä»¬ç†è§£æ¦‚å¿µæ—¶å¾€å¾€ä¼šä»£å…¥è‡ªèº«æ„Ÿå—, è§‰å¾—çº¿ç¨‹æˆ–åç¨‹è¿è¡Œå°±æ˜¯åƒæˆ‘ä»¬å­å“§å­å“§çš„å¤„ç†äº‹æƒ…, çº¿ç¨‹æˆ–åç¨‹é˜»å¡å°±æ˜¯åšäº‹æƒ…æ—¶æˆ‘ä»¬éœ€è¦ç­‰å¾…å…¶ä»–äºº. ç„¶åå°±åœ¨è¿™ç­‰ç€äº†. è¦æ˜¯å…¶ä»–äººæå¥½äº†, é‚£æˆ‘ä»¬å°±ç»§ç»­åšå½“å‰çš„äº‹.</p><p>å…¶å®ä¸»ä½“å¯¹è±¡æé”™äº†.æ­£ç¡®çš„ç†è§£åº”è¯¥æ˜¯æˆ‘ä»¬å¤„ç†äº‹æƒ…æ—¶å°±åƒ CPU, è€Œä¸æ˜¯åƒçº¿ç¨‹æˆ–è€…åç¨‹. å‡å¦‚æˆ‘å½“å‰åœ¨å†™æŸä¸ªæœåŠ¡, å‘ç°ä¾èµ–åˆ«äººçš„å‡½æ•°è¿˜æ²¡æœ‰ ready, é‚£å°±æŠŠå†™æœåŠ¡è¿™ä»¶äº‹æ”¾ä¸€è¾¹. ç‚¹å¼€ä¼ä¸šå¾®ä¿¡, æˆ‘å»å’Œäº§å“æ²Ÿé€šä¸€äº›é—®é¢˜äº†. æˆ‘å’Œäº§å“æ²Ÿé€šäº†ä¸€ä¼šå, æ£€æŸ¥ä¸€ä¸‹, å‘ç°åˆ«äººå·²ç»æŠŠä¾èµ–çš„å‡½æ•°æäº¤äº†, ç„¶åæˆ‘å°±æœ€å°åŒ–ä¼ä¸šå¾®ä¿¡, åˆ‡åˆ° IDE, ç»§ç»­å†™æœåŠ¡ A äº†.</p><p>å¯¹æ“ä½œç³»ç»Ÿæœ‰è¿‡ä¸€äº›äº†è§£, çŸ¥é“ linux ä¸‹çš„çº¿ç¨‹å…¶å®æ˜¯ task_struct ç»“æ„, çº¿ç¨‹å…¶å®å¹¶ä¸æ˜¯çœŸæ­£è¿è¡Œçš„å®ä½“, çº¿ç¨‹åªæ˜¯ä»£è¡¨ä¸€ä¸ªæ‰§è¡Œæµå’Œå…¶çŠ¶æ€.çœŸæ­£è¿è¡Œé©±åŠ¨æµç¨‹å¾€å‰çš„å…¶å®æ˜¯ CPU. CPU åœ¨æ—¶é’Ÿçš„é©±åŠ¨ä¸‹, æ ¹æ® PC å¯„å­˜å™¨ä»ç¨‹åºä¸­å–æŒ‡ä»¤å’Œæ“ä½œæ•°, ä» RAM ä¸­å–æ•°æ®, è¿›è¡Œè®¡ç®—, å¤„ç†, è·³è½¬, é©±åŠ¨æ‰§è¡Œæµå¾€å‰. CPU å¹¶ä¸å…³æ³¨å¤„ç†çš„æ˜¯çº¿ç¨‹è¿˜æ˜¯åç¨‹, åªéœ€è¦è®¾ç½® PC å¯„å­˜å™¨, è®¾ç½®æ ˆæŒ‡é’ˆç­‰(è¿™äº›ç§°ä¸ºä¸Šä¸‹æ–‡), é‚£ä¹ˆ CPU å°±å¯ä»¥æ¬¢å¿«çš„è¿è¡Œè¿™ä¸ªçº¿ç¨‹æˆ–è€…è¿™ä¸ªåç¨‹äº†.</p><p>çº¿ç¨‹çš„è¿è¡Œ, å…¶å®æ˜¯è¢«è¿è¡Œ.å…¶é˜»å¡, å…¶å®æ˜¯åˆ‡æ¢å‡ºè°ƒåº¦é˜Ÿåˆ—, ä¸å†å»è°ƒåº¦æ‰§è¡Œè¿™ä¸ªæ‰§è¡Œæµ. å…¶ä»–æ‰§è¡Œæµæ»¡è¶³å…¶æ¡ä»¶, ä¾¿ä¼šæŠŠè¢«ç§»å‡ºè°ƒåº¦é˜Ÿåˆ—çš„æ‰§è¡Œæµé‡æ–°æ”¾å›è°ƒåº¦é˜Ÿåˆ—.åç¨‹åŒç†, åç¨‹å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„, è®°å½•äº†è¦è¿è¡Œä»€ä¹ˆå‡½æ•°, è¿è¡Œåˆ°å“ªé‡Œäº†.<br>go åœ¨ç”¨æˆ·æ€å®ç°è°ƒåº¦, æ‰€ä»¥ go è¦æœ‰ä»£è¡¨åç¨‹è¿™ç§æ‰§è¡Œæµçš„ç»“æ„ä½“, ä¹Ÿè¦æœ‰ä¿å­˜å’Œæ¢å¤ä¸Šä¸‹æ–‡çš„å‡½æ•°, è¿è¡Œé˜Ÿåˆ—. ç†è§£äº†é˜»å¡çš„çœŸæ­£å«ä¹‰, ä¹Ÿå°±çŸ¥é“èƒ½å¤Ÿæ¯”è¾ƒå®¹æ˜“ç†è§£, ä¸ºä»€ä¹ˆ go çš„é”, channel è¿™äº›ä¸é˜»å¡çº¿ç¨‹.</p><p>å¯¹äºå®ç°çš„åŒæ­¥æ‰§è¡Œæµæ•ˆæœ, åˆä¸é˜»å¡çº¿ç¨‹çš„ç½‘ç»œ, æ¥ä¸‹æ¥ä¹Ÿä¼šä»‹ç».</p><h3><span id="åç¨‹ç»“æ„ä½“å’Œåˆ‡æ¢å‡½æ•°"><strong>åç¨‹ç»“æ„ä½“å’Œåˆ‡æ¢å‡½æ•°</strong></span></h3><p><img src="https://pic1.zhimg.com/50/v2-85a56b6e215d2b427ac4f5252ce3c619_720w.jpg?source=1940ef5c" alt="img"></p><p>æˆ‘ä»¬ go ä¸€ä¸ª func æ—¶ä¸€èˆ¬è¿™æ ·å†™</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go func1(arg1 type1,arg2 type2)&#123;....&#125;(a1,a2)</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªåç¨‹ä»£è¡¨äº†ä¸€ä¸ªæ‰§è¡Œæµ, æ‰§è¡Œæµæœ‰éœ€è¦æ‰§è¡Œçš„å‡½æ•°(å¯¹åº”ä¸Šé¢çš„ func1), æœ‰å‡½æ•°çš„å…¥å‚(a1, a2), æœ‰å½“å‰æ‰§è¡Œæµçš„çŠ¶æ€å’Œè¿›åº¦(å¯¹åº” CPU çš„ PC å¯„å­˜å™¨å’Œ SP å¯„å­˜å™¨), å½“ç„¶ä¹Ÿéœ€è¦æœ‰ä¿å­˜çŠ¶æ€çš„åœ°æ–¹, ç”¨äºæ‰§è¡Œæµæ¢å¤.</p><p>çœŸæ­£ä»£è¡¨åç¨‹çš„æ˜¯ runtime.g ç»“æ„ä½“. æ¯ä¸ª go func éƒ½ä¼šç¼–è¯‘æˆ runtime.newproc å‡½æ•°, æœ€ç»ˆæœ‰ä¸€ä¸ª runtime.g å¯¹è±¡æ”¾å…¥è°ƒåº¦é˜Ÿåˆ—. ä¸Šé¢çš„ func1 å‡½æ•°çš„æŒ‡é’ˆè®¾ç½®åœ¨ runtime.g çš„ startfunc å­—æ®µ, å‚æ•°ä¼šåœ¨ newproc å‡½æ•°é‡Œæ‹·è´åˆ° stack ä¸­, sched ç”¨äºä¿å­˜åç¨‹åˆ‡æ¢æ—¶çš„ pc ä½ç½®å’Œæ ˆä½ç½®.</p><p>åç¨‹åˆ‡æ¢å‡ºå»å’Œæ¢å¤å›æ¥éœ€è¦ä¿å­˜ä¸Šä¸‹æ–‡, æ¢å¤ä¸Šä¸‹æ–‡, è¿™äº›ç”±ä»¥ä¸‹ä¸¤ä¸ªæ±‡ç¼–å‡½æ•°å®ç°. ä»¥ä¸Šå°±èƒ½å®ç°åç¨‹è¿™ç§æ‰§è¡Œæµ, å¹¶èƒ½è¿›è¡Œåˆ‡æ¢å’Œæ¢å¤.(ä¸‹å›¾ä¸­çš„ struct å’Œå‡½æ•°éƒ½åšäº†ç²¾ç®€)</p><h3><span id="gm-æ¨¡å‹åŠ-gpm-æ¨¡å‹"><strong>GM æ¨¡å‹åŠ GPM æ¨¡å‹</strong></span></h3><p><img src="https://pic3.zhimg.com/50/v2-836e26770ed9489f835605529e608c37_720w.jpg?source=1940ef5c" alt="img"></p><p>æœ‰äº†åç¨‹çš„è¿™ç§æ‰§è¡Œæµå½¢å¼, é‚£å¾…è¿è¡Œçš„åç¨‹æ”¾åœ¨å“ªå‘¢?<br>åœ¨ Go1.0 çš„æ—¶å€™:</p><ol><li>è°ƒåº¦é˜Ÿåˆ— schedt æ˜¯å…¨å±€çš„, å¯¹è¯¥é˜Ÿåˆ—çš„æ“ä½œå‡éœ€è¦ç«äº‰åŒä¸€æŠŠé”, å¯¼è‡´ä¼¸ç¼©æ€§ä¸å¥½.</li><li>æ–°ç”Ÿæˆçš„åç¨‹ä¹Ÿä¼šæ”¾å…¥å…¨å±€çš„é˜Ÿåˆ—, å¤§æ¦‚ç‡æ˜¯è¢«å…¶ä»– m(å¯ä»¥ç†è§£ä¸ºåº•å±‚çº¿ç¨‹çš„ä¸€ä¸ªè¡¨ç¤º)è¿è¡Œäº†, å†…å­˜äº²å’Œæ€§ä¸å¥½. å½“å‰åç¨‹ A æ–°ç”Ÿæˆäº†åç¨‹ B, ç„¶ååç¨‹ A æ¯”è¾ƒå¤§æ¦‚ç‡ä¼šç»“æŸæˆ–è€…é˜»å¡, è¿™æ · m ç›´æ¥å»æ‰§è¡Œåç¨‹ B, å†…å­˜çš„äº²å’Œæ€§ä¹Ÿä¼šå¥½å¾ˆå¤š.</li><li>å› ä¸º mcache ä¸ m ç»‘å®š, åœ¨ä¸€äº›åº”ç”¨ä¸­(æ¯”å¦‚æ–‡ä»¶æ“ä½œæˆ–å…¶ä»–å¯èƒ½ä¼šé˜»å¡çº¿ç¨‹çš„ç³»ç»Ÿè°ƒç”¨æ¯”è¾ƒå¤š), m çš„ä¸ªæ•°å¯èƒ½ä¼šè¿œè¶…è¿‡æ´»è·ƒçš„ m ä¸ªæ•°, å¯¼è‡´æ¯”è¾ƒå¤§çš„å†…å­˜æµªè´¹.</li></ol><p>é‚£æ˜¯ä¸æ˜¯å¯ä»¥ç»™ m åˆ†é…ä¸€ä¸ªé˜Ÿåˆ—, æŠŠé˜»å¡çš„ m çš„ mcache ç»™æ‰§è¡Œ go ä»£ç çš„ m ä½¿ç”¨? Go 1.1 åŠä»¥åå°±æ˜¯è¿™æ ·åšçš„.</p><p><img src="https://pic1.zhimg.com/50/v2-a06db1f245421b17c64d7bc4f338b71e_720w.jpg?source=1940ef5c" alt="img"></p><p>å† 1.1 ä¸­è°ƒåº¦æ¨¡å‹æ›´æ”¹ä¸º GPM æ¨¡å‹, å¼•å…¥é€»è¾‘ Process çš„æ¦‚å¿µ, è¡¨ç¤ºæ‰§è¡Œ Go ä»£ç æ‰€éœ€è¦çš„èµ„æº, åŒæ—¶ä¹Ÿæ˜¯æ‰§è¡Œ Go ä»£ç çš„æœ€å¤§çš„å¹¶è¡Œåº¦.</p><p>è¿™ä¸ªæ¦‚å¿µå¯èƒ½å¾ˆå¤šäººä¸çŸ¥é“æ€ä¹ˆç†è§£. P æ¶‰åŠåˆ°å‡ ç‚¹, é˜Ÿåˆ—å’Œ mcache, è¿˜æœ‰ P çš„ä¸ªæ•°çš„é€‰å–.</p><p>é¦–å…ˆä¸ºä»€ä¹ˆæŠŠå…¨å±€é˜Ÿåˆ—æ‰“æ•£, ä»¥åŠ mcache ä¸ºä»€ä¹ˆè·Ÿéš P, è¿™ä¸ªåœ¨ GM æ¨¡å‹é‚£ä¸€é¡µå°±è®²çš„æ¯”è¾ƒæ¸…æ¥šäº†.ç„¶åä¸ºä»€ä¹ˆ P çš„ä¸ªæ•°é»˜è®¤æ˜¯ CPU æ ¸æ•°: Go å°½é‡æå‡æ€§èƒ½, é‚£ä¹ˆåœ¨ä¸€ä¸ª n æ ¸æœºå™¨ä¸Š, å¦‚ä½•èƒ½å¤Ÿæœ€å¤§åˆ©ç”¨ CPU æ€§èƒ½å‘¢? å½“ç„¶æ˜¯åŒæ—¶æœ‰ n ä¸ªçº¿ç¨‹åœ¨å¹¶è¡Œè¿è¡Œä¸­, æŠŠ CPU å–‚é¥±, å³æ‰€æœ‰æ ¸ä¸Šä¸€ç›´éƒ½æœ‰ä»£ç åœ¨è¿è¡Œ.</p><p>åœ¨ go é‡Œé¢, ä¸€ä¸ªåç¨‹è¿è¡Œåˆ°é˜»å¡ç³»ç»Ÿè°ƒç”¨, é‚£ä¹ˆè¿™ä¸ªåç¨‹å’Œè¿è¡Œå®ƒçš„çº¿ç¨‹ m, è‡ªç„¶æ˜¯ä¸å†éœ€è¦ CPU çš„, ä¹Ÿä¸éœ€è¦åˆ†é… go å±‚é¢çš„å†…å­˜. åªæœ‰ä¸€ç›´åœ¨å¹¶è¡Œè¿è¡Œçš„ go ä»£ç æ‰éœ€è¦è¿™äº›èµ„æº, å³åŒæ—¶æœ‰ n ä¸ª go åç¨‹åœ¨å¹¶è¡Œæ‰§è¡Œ, é‚£ä¹ˆå°±èƒ½æœ€å¤§çš„åˆ©ç”¨ CPU, è¿™ä¸ªæ—¶å€™éœ€è¦çš„ P çš„ä¸ªæ•°å°±æ˜¯ CPU æ ¸æ•°. (æ³¨æ„å¹¶è¡Œå’Œå¹¶å‘çš„åŒºåˆ«)</p><h2><span id="åç¨‹çŠ¶æ€åŠæµè½¬"><strong>åç¨‹çŠ¶æ€åŠæµè½¬</strong></span></h2><p><img src="https://pica.zhimg.com/50/v2-95c62d2ff20b8a75e0ec2eddddaf4bd2_720w.jpg?source=1940ef5c" alt="img"></p><p>åç¨‹çš„çŠ¶æ€å…¶å®å’Œçº¿ç¨‹çŠ¶æ€ç±»ä¼¼,çŠ¶æ€è½¬æ¢å’Œå‘ç”ŸçŠ¶æ€è½¬æ¢çš„æ—¶æœºå¦‚å›¾æ‰€ç¤º. è¿˜æ˜¯éœ€è¦æ³¨æ„: åç¨‹åªæ˜¯ä¸€ä¸ªæ‰§è¡Œæµ, å¹¶ä¸æ˜¯è¿è¡Œå®ä½“.</p><h2><span id="è°ƒåº¦"><strong>è°ƒåº¦</strong></span></h2><p><img src="https://pica.zhimg.com/50/v2-0328b09cc3dd5537bd463e10ef17db6e_720w.jpg?source=1940ef5c" alt="img"></p><p>å¹¶æ²¡æœ‰ä¸€ä¸ªä¸€ç›´åœ¨è¿è¡Œè°ƒåº¦çš„è°ƒåº¦å™¨å®ä½“. å½“ä¸€ä¸ªåç¨‹åˆ‡æ¢å‡ºå»æˆ–æ–°ç”Ÿæˆçš„ m, go çš„è¿è¡Œæ—¶ä» stw ä¸­æ¢å¤ç­‰æƒ…å†µæ—¶, é‚£ä¹ˆæ¥ä¸‹æ¥å°±éœ€è¦å‘ç”Ÿè°ƒåº¦. go çš„è°ƒåº¦æ˜¯é€šè¿‡çº¿ç¨‹(m)æ‰§è¡Œ runtime.schedule å‡½æ•°æ¥å®Œæˆçš„.</p><h2><span id="sysmon-åç¨‹"><strong>sysmon åç¨‹</strong></span></h2><p><img src="https://pic2.zhimg.com/50/v2-28f751cb1c56fcc275bc545d7f82d869_720w.jpg?source=1940ef5c" alt="img"></p><p>åœ¨ linux å†…æ ¸ä¸­æœ‰ä¸€äº›æ‰§è¡Œå®šæ—¶ä»»åŠ¡çš„çº¿ç¨‹, æ¯”å¦‚å®šæ—¶å†™å›è„é¡µçš„ pdflush, å®šæœŸå›æ”¶å†…å­˜çš„ kswapd0, ä»¥åŠæ¯ä¸ª cpu ä¸Šéƒ½æœ‰ä¸€ä¸ªè´Ÿè´£è´Ÿè½½å‡è¡¡çš„ migration çº¿ç¨‹ç­‰.åœ¨ go è¿è¡Œæ—¶ä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„åç¨‹, sysmon.åŠŸèƒ½æ¯”è¾ƒå¤š: å®šæ—¶ä» netpoll ä¸­è·å– ready çš„åç¨‹, è¿›è¡ŒæŠ¢å , å®šæ—¶ GC,æ‰“å°è°ƒåº¦ä¿¡æ¯,å½’è¿˜å†…å­˜ç­‰å®šæ—¶ä»»åŠ¡.</p><h2><span id="åä½œå¼æŠ¢å "><strong>åä½œå¼æŠ¢å </strong></span></h2><p><img src="https://pica.zhimg.com/50/v2-d8baadb9a783032443d3d2fd6b0b5227_720w.jpg?source=1940ef5c" alt="img"></p><p>go ç›®å‰(1.12)è¿˜æ²¡æœ‰å®ç°éåä½œçš„æŠ¢å . åŸºæœ¬æµç¨‹æ˜¯ sysmon åç¨‹æ ‡è®°æŸä¸ªåç¨‹è¿è¡Œè¿‡ä¹…, éœ€è¦åˆ‡æ¢å‡ºå», è¯¥åç¨‹åœ¨è¿è¡Œå‡½æ•°æ—¶ä¼šæ£€æŸ¥æ ˆæ ‡è®°, ç„¶åè¿›è¡Œåˆ‡æ¢.</p><h2><span id="åŒæ­¥æ‰§è¡Œæµä¸é˜»å¡çº¿ç¨‹çš„ç½‘ç»œçš„å®ç°"><strong>åŒæ­¥æ‰§è¡Œæµä¸é˜»å¡çº¿ç¨‹çš„ç½‘ç»œçš„å®ç°</strong></span></h2><p><img src="https://pic3.zhimg.com/50/v2-7bed4181eb6bbcba7be4a6b43a604c3e_720w.jpg?source=1940ef5c" alt="img"></p><p>go å†™åå°æœ€èˆ’æœçš„å°±æ˜¯èƒ½å¤Ÿä»¥åŒæ­¥å†™ä»£ç çš„æ–¹å¼æ“ä½œç½‘ç»œ, ä½†æ˜¯ç½‘ç»œæ“ä½œä¸é˜»å¡çº¿ç¨‹.ä¸»è¦æ˜¯ç»“åˆäº†éé˜»å¡çš„ fd, epoll ä»¥åŠåç¨‹çš„åˆ‡æ¢å’Œæ¢å¤.linux æä¾›äº†ç½‘ç»œ fd çš„éé˜»å¡æ¨¡å¼, å¯¹äºæ²¡æœ‰ ready çš„éé˜»å¡ fd æ‰§è¡Œç½‘ç»œæ“ä½œæ—¶, linux å†…æ ¸ä¸é˜»å¡çº¿ç¨‹, ä¼šç›´æ¥è¿”å› EAGAIN, è¿™ä¸ªæ—¶å€™å°†åç¨‹çŠ¶æ€è®¾ç½®ä¸º wait, ç„¶å m å»è°ƒåº¦å…¶ä»–åç¨‹.</p><p>go åœ¨åˆå§‹åŒ–ä¸€ä¸ªç½‘ç»œ fd çš„æ—¶å€™, å°±ä¼šæŠŠè¿™ä¸ª fd ä½¿ç”¨ epollctl åŠ å…¥åˆ°å…¨å±€çš„ epoll èŠ‚ç‚¹ä¸­. åŒæ—¶æ”¾å…¥ epoll ä¸­çš„è¿˜æœ‰ polldesc çš„æŒ‡é’ˆ.</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">func netpollopen(fd uintptr, pd *pollDesc) int32 &#123;</span><br><span class="line">    var ev epollevent</span><br><span class="line">    ev.events = _EPOLLIN | _EPOLLOUT | _EPOLLRDHUP | _EPOLLET</span><br><span class="line">    *(**pollDesc)(unsafe.Pointer(&amp;ev.data)) = pd</span><br><span class="line">    return -epollctl(epfd, _EPOLL_CTL_ADD, int32(fd), &amp;ev)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ sysmon ä¸­, schedule å‡½æ•°ä¸­, start the world ä¸­ç­‰æƒ…å†µä¸‹, ä¼šæ‰§è¡Œ netpoll è°ƒç”¨ epollwait ç³»ç»Ÿè°ƒç”¨, æŠŠ ready çš„ç½‘ç»œäº‹ä»¶ä» epoll ä¸­å–å‡ºæ¥, æ¯ä¸ªç½‘ç»œäº‹ä»¶å¯ä»¥é€šè¿‡å‰é¢ä¼ å…¥çš„ polldesc è·å–åˆ°é˜»å¡åœ¨å…¶ä¸Šçš„åç¨‹, ä»¥æ­¤æ¢å¤åç¨‹ä¸º runnable.</p><h2><span id="è°ƒåº¦ç›¸å…³ç»“æ„ä½“"><strong>è°ƒåº¦ç›¸å…³ç»“æ„ä½“</strong></span></h2><p><img src="https://pic1.zhimg.com/50/v2-85359486219d4ce31b93fa450b592083_720w.jpg?source=1940ef5c" alt="img"></p><h2><span id="è°ƒåº¦ç»¼è¿°"><strong>è°ƒåº¦ç»¼è¿°</strong></span></h2><p><img src="https://pic2.zhimg.com/50/v2-7f7ea37737a8e4ac2809a8122ba62c1c_720w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://pic1.zhimg.com/50/v2-8d5f447993ab105b88eac9fb827b2a3c_720w.jpg?source=1940ef5c" alt="img"></p><h2><span id="å†…å­˜åˆ†é…"><strong>å†…å­˜åˆ†é…</strong></span></h2><h2><span id="å†…å­˜åˆ†é…ç®€ä»‹"><strong>å†…å­˜åˆ†é…ç®€ä»‹</strong></span></h2><p><img src="https://pica.zhimg.com/50/v2-eb6d4ba5968ebe8a0a86318c2ef35ca6_720w.jpg?source=1940ef5c" alt="img"></p><p>Go çš„åˆ†é…é‡‡ç”¨äº†ç±»ä¼¼ tcmalloc çš„ç»“æ„.ç‰¹ç‚¹: ä½¿ç”¨ä¸€å°å—ä¸€å°å—çš„è¿ç»­å†…å­˜é¡µ, è¿›è¡Œåˆ†é…æŸä¸ªèŒƒå›´å¤§å°çš„å†…å­˜éœ€æ±‚. æ¯”å¦‚æŸä¸ªè¿ç»­ 8KB ä¸“é—¨ç”¨äºåˆ†é… 17-24 å­—èŠ‚,ä»¥æ­¤å‡å°‘å†…å­˜ç¢ç‰‡. çº¿ç¨‹æ‹¥æœ‰ä¸€å®šçš„ cache, å¯ç”¨äºæ— é”åˆ†é….</p><p>åŒæ—¶ Go å¯¹äº GC åå›æ”¶çš„å†…å­˜é¡µ, å¹¶ä¸æ˜¯é©¬ä¸Šå½’è¿˜ç»™æ“ä½œç³»ç»Ÿ, è€Œæ˜¯ä¼šå»¶è¿Ÿå½’è¿˜, ç”¨äºæ»¡è¶³æœªæ¥çš„å†…å­˜éœ€æ±‚.</p><h2><span id="å†…å­˜ç©ºé—´ç»“æ„"><strong>å†…å­˜ç©ºé—´ç»“æ„</strong></span></h2><p><img src="https://pic3.zhimg.com/50/v2-c1b2977bf1d33669bb9c2774c7b6d8d8_720w.jpg?source=1940ef5c" alt="img"></p><p>åœ¨ 1.10 ä»¥å‰ go çš„å †åœ°å€ç©ºé—´æ˜¯çº¿æ€§è¿ç»­æ‰©å±•çš„, æ¯”å¦‚åœ¨ 1.10(linux amd64)ä¸­, æœ€å¤§å¯æ‰©å±•åˆ° 512GB. å› ä¸º go åœ¨ gc çš„æ—¶å€™ä¼šæ ¹æ®æ‹¿åˆ°çš„æŒ‡é’ˆåœ°å€æ¥åˆ¤æ–­æ˜¯å¦ä½äº go çš„ heap çš„, ä»¥åŠæ‰¾åˆ°å…¶å¯¹åº”çš„ span, å…¶åˆ¤æ–­æœºåˆ¶éœ€è¦ gc heap æ˜¯è¿ç»­çš„. ä½†æ˜¯è¿ç»­æ‰©å±•æœ‰ä¸ªé—®é¢˜, cgo ä¸­çš„ä»£ç (å°¤å…¶æ˜¯ 32 ä½ç³»ç»Ÿä¸Š)å¯èƒ½ä¼šå ç”¨æœªæ¥ä¼šç”¨äº go heap çš„å†…å­˜. è¿™æ ·åœ¨æ‰©å±• go heap æ—¶, mmap å‡ºç°ä¸è¿ç»­çš„åœ°å€, å¯¼è‡´è¿è¡Œæ—¶ throw.</p><p>åœ¨ 1.11 ä¸­, æ”¹ç”¨äº†ç¨€ç–ç´¢å¼•çš„æ–¹å¼æ¥ç®¡ç†æ•´ä½“çš„å†…å­˜. å¯ä»¥è¶…è¿‡ 512G å†…å­˜, ä¹Ÿå¯ä»¥å…è®¸å†…å­˜ç©ºé—´æ‰©å±•æ—¶ä¸è¿ç»­.åœ¨å…¨å±€çš„ mheap struct ä¸­æœ‰ä¸ª arenas äºŒé˜¶æ•°ç»„, åœ¨ linux amd64 ä¸Š,ä¸€é˜¶åªæœ‰ä¸€ä¸ª slot, äºŒé˜¶æœ‰ 4M ä¸ª slot, æ¯ä¸ª slot æŒ‡å‘ä¸€ä¸ª heapArena ç»“æ„, æ¯ä¸ª heapArena ç»“æ„å¯ä»¥ç®¡ç† 64M å†…å­˜, æ‰€ä»¥åœ¨æ–°çš„ç‰ˆæœ¬ä¸­, go å¯ä»¥ç®¡ç† 4M*64M&#x3D;256TB å†…å­˜, å³ç›®å‰ 64 ä½æœºå™¨ä¸­ 48bit çš„å¯»å€æ€»çº¿å…¨éƒ¨ 256TB å†…å­˜.</p><h2><span id="span-æœºåˆ¶"><strong>span æœºåˆ¶</strong></span></h2><p><img src="https://pic3.zhimg.com/50/v2-84e72feda2d2cd49aaad59bb6f72837c_720w.jpg?source=1940ef5c" alt="img"></p><p>å‰é¢æåˆ°äº† go çš„å†…å­˜åˆ†é…ç±»ä¼¼äº tcmalloc, é‡‡ç”¨äº† span æœºåˆ¶æ¥å‡å°‘å†…å­˜ç¢ç‰‡. æ¯ä¸ª span ç®¡ç† 8KB æ•´æ•°å€çš„å†…å­˜, ç”¨äºåˆ†é…ä¸€å®šèŒƒå›´çš„å†…å­˜éœ€æ±‚.</p><h2><span id="å†…å­˜åˆ†é…å…¨æ™¯"><strong>å†…å­˜åˆ†é…å…¨æ™¯</strong></span></h2><p><img src="https://pic2.zhimg.com/50/v2-11756712c78ee841873eb9aa22198f3c_720w.jpg?source=1940ef5c" alt="img"></p><p>å¤šå±‚æ¬¡çš„åˆ†é… Cache, æ¯ä¸ª P ä¸Šæœ‰ä¸€ä¸ª mcache, mcache ä¼šä¸ºæ¯ä¸ª size æœ€å¤šç¼“å­˜ä¸€ä¸ª span, ç”¨äºæ— é”åˆ†é…. å…¨å±€æ¯ä¸ª size çš„ span éƒ½æœ‰ä¸€ä¸ª mcentral, é”çš„ç²’åº¦ç›¸å¯¹äºå…¨å±€çš„ heap å°å¾ˆå¤š, æ¯ä¸ª mcentral å¯ä»¥çœ‹æˆæ˜¯æ¯ä¸ª size çš„ span çš„ä¸€ä¸ªå…¨å±€åå¤‡ cache.</p><p>åœ¨ gc å®Œæˆå, ä¼šæŠŠ P ä¸­çš„ span éƒ½ flush åˆ° mcentral ä¸­, ç”¨äºæ¸…æ‰«åå†åˆ†é…. P æœ‰éœ€è¦ span æ—¶, ä»å¯¹åº” size çš„ mcentral è·å–. è·å–ä¸åˆ°å†ä¸Šå‡åˆ°å…¨å±€çš„ heap.</p><h2><span id="å‡ ç§ç‰¹æ®Šçš„åˆ†é…å™¨"><strong>å‡ ç§ç‰¹æ®Šçš„åˆ†é…å™¨</strong></span></h2><p><img src="https://pic2.zhimg.com/50/v2-e35ffea692133cbe86898cdf3eb55352_720w.jpg?source=1940ef5c" alt="img"></p><p>å¯¹äºå¾ˆå°çš„å¯¹è±¡åˆ†é…, go åšäº†ä¸ªä¼˜åŒ–, æŠŠå°å¯¹è±¡åˆå¹¶, ä»¥ç§»åŠ¨æŒ‡é’ˆçš„æ–¹å¼åˆ†é….å¯¹äºæ ˆå†…å­˜æœ‰ stackcache åˆ†é…, ä¹Ÿæœ‰å¤šä¸ªå±‚æ¬¡çš„åˆ†é…, åŒæ—¶ stack ä¹Ÿæœ‰å¤šä¸ªä¸åŒ size. ç”¨äºåˆ†é… stack çš„å†…å­˜ä¹Ÿæ˜¯ä½äº go gc heap, ç”¨ mspan ç®¡ç†, ä¸è¿‡è¿™ä¸ª span çš„çŠ¶æ€å’Œç”¨äºåˆ†é…å¯¹è±¡çš„ mspan çŠ¶æ€ä¸å¤ªä¸€æ ·, ä¸º mSpanManual.</p><p>æˆ‘ä»¬å¯ä»¥æ€è€ƒä¸€ä¸ªé—®é¢˜, go çš„å¯¹è±¡æ˜¯åˆ†é…åœ¨ go gc heap ä¸­, å¹¶ç”± mcache, mspan, mcentral è¿™äº›ç»“æ„ç®¡ç†, é‚£ä¹ˆ mcache, mspan, mcentral è¿™äº›ç»“æ„åˆæ˜¯å“ªé‡Œç®¡ç†å’Œåˆ†é…çš„å‘¢? è‚¯å®šä¸æ˜¯è‡ªå·±ç®¡ç†è‡ªå·±. è¿™äº›éƒ½æ˜¯ç”±ç‰¹æ®Šçš„åˆ†é… fixalloc åˆ†é…çš„, æ¯ç§ç±»å‹æœ‰ä¸€ä¸ª fixalloc, å¤§è‡´åŸç†å°±æ˜¯é€šè¿‡ mmap ä»è¿›ç¨‹ç©ºé—´è·å–ä¸€å°å—å†…å­˜(ç™¾ KB çš„æ ·å­), ç„¶åç”¨æ¥åˆ†é…è¿™ä¸ªå›ºå®šå¤§å°çš„ç»“æ„.</p><h2><span id="å†…å­˜åˆ†é…ç»¼åˆ"><strong>å†…å­˜åˆ†é…ç»¼åˆ</strong></span></h2><p><img src="https://pic1.zhimg.com/50/v2-1a3d04db061c92d10bed0e5ab0df1c16_720w.jpg?source=1940ef5c" alt="img"></p><h2><span id="gc"><strong>GC</strong></span></h2><h2><span id="golang-gc-ç®€è¿°"><strong>Golang GC ç®€è¿°</strong></span></h2><p><img src="https://pic2.zhimg.com/50/v2-7eb346f748153072b454b9b78759e067_720w.jpg?source=1940ef5c" alt="img"></p><h2><span id="gc-ç®€ä»‹"><strong>GC ç®€ä»‹</strong></span></h2><p><img src="https://pic1.zhimg.com/50/v2-ecebbf99b365d076f7076b31a30fc3e8_720w.jpg?source=1940ef5c" alt="img"></p><p>GC å¹¶ä¸æ˜¯ä¸ªæ–°äº‹ç‰©, ä½¿å¾— GC å¤§æ”¾å…‰å½©çš„æ˜¯ Java è¯­è¨€.</p><p><img src="https://pica.zhimg.com/50/v2-05266f76d410fe9d90fd1dbd23570953_720w.jpg?source=1940ef5c" alt="img"></p><p><img src="https://pic3.zhimg.com/50/v2-291b501f005c3958111daf30bcec1a2b_720w.jpg?source=1940ef5c" alt="img"></p><h2><span id="golang-gc-å‘å±•"><strong>Golang GC å‘å±•</strong></span></h2><p><img src="https://pic1.zhimg.com/50/v2-558037836bb253c0777a4a822516d27e_720w.jpg?source=1940ef5c" alt="img"></p><p>ä¸Šé¢æ˜¯å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„ç‰ˆæœ¬.å·¦å›¾æ˜¯æ ¹æ® twitter å·¥ç¨‹å¸ˆçš„æ•°æ®ç»˜åˆ¶çš„(å †æ¯”è¾ƒå¤§), ä» 1.4 çš„ç™¾ ms çº§åˆ«çš„åœé¡¿åˆ° 1.8 ä»¥åçš„å°äº 1ms.å³å›¾æ˜¯æˆ‘å¯¹çº¿ä¸ŠæœåŠ¡(Go 1.11 ç¼–è¯‘)æµ‹è¯•çš„ä¸€ä¸ªç»“æœ, æ˜¯ä¸€ä¸ªæ‰¹é‡æ‹‰å–æ•°æ®çš„æœåŠ¡, å¤§æ¦‚ 3000qps, æœåŠ¡ä¸­å‘èµ·çš„ rpc è°ƒç”¨å¤§æ¦‚åœ¨ 2w&#x2F;s. å¯ä»¥çœ‹åˆ°å¤§éƒ¨åˆ†æƒ…å†µä¸‹ GC åœé¡¿å°äº 1ms, å¶å°”è¶…è¿‡ä¸€ç‚¹ç‚¹.</p><p>æ•´ä½“æ¥è¯´ golang gc ç”¨èµ·æ¥æ˜¯å¾ˆèˆ’å¿ƒçš„, å‡ ä¹ä¸ç”¨ä½ å…³å¿ƒ.</p><h2><span id="ä¸‰è‰²æ ‡è®°"><strong>ä¸‰è‰²æ ‡è®°</strong></span></h2><p><img src="https://pic1.zhimg.com/50/v2-652acc8ca5d0f04c455c68d1084cd309_720w.jpg?source=1940ef5c" alt="img"></p><p>go é‡‡ç”¨çš„æ˜¯å¹¶å‘ä¸‰è‰²æ ‡è®°æ¸…é™¤æ³•. å›¾å±•ç¤ºçš„æ˜¯ä¸€ä¸ªç®€å•çš„åŸç†.æœ‰å‡ ä¸ªé—®é¢˜å¯ä»¥æ€è€ƒä¸€ä¸‹:</p><ul><li>å¹¶å‘æƒ…å†µä¸‹, ä¼šä¸ä¼šæ¼æ ‡è®°å¯¹è±¡?</li><li>å¯¹è±¡çš„ä¸‰è‰²çŠ¶æ€å­˜æ”¾åœ¨å“ª?</li><li>å¦‚ä½•æ ¹æ®ä¸€ä¸ªå¯¹è±¡æ¥æ‰¾åˆ°å®ƒå¼•ç”¨çš„å¯¹è±¡?</li></ul><h3><span id="å†™å±éšœ"><strong>å†™å±éšœ</strong></span></h3><p><img src="https://pic3.zhimg.com/50/v2-8c43a67a0eba214a81f56c873504c884_720w.jpg?source=1940ef5c" alt="img"></p><p>GC æœ€åŸºæœ¬çš„å°±æ˜¯æ­£ç¡®æ€§: ä¸æ¼æ ‡è®°å¯¹è±¡, ç¨‹åºè¿˜åœ¨ç”¨çš„å¯¹è±¡éƒ½è¢«æ¸…é™¤äº†, é‚£ç¨‹åºå°±é”™è¯¯äº†. æœ‰ä¸€ç‚¹æµ®åŠ¨åƒåœ¾æ˜¯å…è®¸çš„.<br>åœ¨å¹¶å‘æƒ…å†µä¸‹, å¦‚æœæ²¡æœ‰ä¸€äº›æªæ–½æ¥ä¿éšœ, é‚£å¯èƒ½ä¼šæœ‰ä»€ä¹ˆé—®é¢˜å‘¢?</p><p>çœ‹å·¦è¾¹çš„ä»£ç å’Œå›¾ç¤º, ç¬¬ 2 æ­¥æ ‡è®°å®Œ A å¯¹è±¡, A åˆæ²¡æœ‰å¼•ç”¨å¯¹è±¡, é‚£ A å˜æˆé»‘è‰²å¯¹è±¡. åœ¨ç¬¬ 3 æ­¥çš„æ—¶å€™, muator(ç¨‹åº)è¿è¡Œ, æŠŠå¯¹è±¡ C ä» B è½¬åˆ°äº† A, ç¬¬ 4 æ­¥, GC ç»§ç»­æ ‡è®°, æ‰«æ B, æ­¤æ—¶ B æ²¡æœ‰å¼•ç”¨å¯¹è±¡, å˜æˆäº†é»‘è‰²å¯¹è±¡. æˆ‘ä»¬ä¼šå‘ç° C å¯¹è±¡è¢«æ¼æ ‡è®°äº†.</p><p>å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜? go ä½¿ç”¨äº†å†™å±éšœ, è¿™é‡Œçš„å†™å±éšœæ˜¯æŒ‡ç”±ç¼–è¯‘å™¨ç”Ÿæˆçš„ä¸€å°æ®µä»£ç . åœ¨ gc æ—¶å¯¹æŒ‡é’ˆæ“ä½œå‰æ‰§è¡Œçš„ä¸€å°æ®µä»£ç , å’Œ CPU ä¸­ç»´æŠ¤å†…å­˜ä¸€è‡´æ€§çš„å†™å±éšœä¸å¤ªä¸€æ ·å“ˆ.æ‰€ä»¥æœ‰äº†å†™å±éšœå, ç¬¬ 3 æ­¥, A.obj&#x3D;C æ—¶, ä¼šæŠŠ C åŠ å…¥å†™å±éšœ buf. æœ€ç»ˆè¿˜æ˜¯ä¼šè¢«æ‰«æçš„.</p><p><img src="https://pic3.zhimg.com/50/v2-69b05d315557f599251e091a0d4a00d9_720w.jpg?source=1940ef5c" alt="img"></p><p>è¿™é‡Œæ„Ÿå—ä¸€ä¸‹å†™å±éšœå…·ä½“ç”Ÿæˆçš„ä»£ç . æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨å†™å…¥æŒ‡é’ˆ slot æ—¶, å¯¹å†™å±éšœæ˜¯å¦å¼€å¯åšäº†åˆ¤æ–­, å¦‚æœå¼€å¯äº†, ä¼šè·³è½¬åˆ°å†™å±éšœå‡½æ•°, æ‰§è¡ŒåŠ å…¥å†™å±éšœ buf çš„é€»è¾‘. 1.8 ä¸­å†™å±éšœç”± Dijkstra å†™å±éšœæ”¹æˆäº†æ··åˆå¼å†™å±éšœ, ä½¿å¾— GC åœé¡¿è¾¾åˆ°äº† 1ms ä»¥ä¸‹.</p><h3><span id="ä¸‰è‰²çŠ¶æ€"><strong>ä¸‰è‰²çŠ¶æ€</strong></span></h3><p><img src="https://pic2.zhimg.com/50/v2-4dd9c75a72c82eaf3690386dcf286cdb_720w.jpg?source=1940ef5c" alt="img"></p><p>å¹¶æ²¡æœ‰è¿™æ ·ä¸€ä¸ªé›†åˆæŠŠä¸åŒçŠ¶æ€å¯¹è±¡æ”¾åˆ°å¯¹åº”é›†åˆä¸­. åªæ˜¯ä¸€ä¸ªé€»è¾‘ä¸Šçš„æ„ä¹‰.</p><h3><span id="æ‰«æå’Œå…ƒä¿¡æ¯"><strong>æ‰«æå’Œå…ƒä¿¡æ¯</strong></span></h3><p><img src="https://pica.zhimg.com/50/v2-ee14e9737cbb929bc95ec3af883e5474_720w.jpg?source=1940ef5c" alt="img"></p><p>gc æ‹¿åˆ°ä¸€ä¸ªæŒ‡é’ˆ, å¦‚ä½•æŠŠè¿™ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡å…¶å¼•ç”¨çš„å­å¯¹è±¡éƒ½åŠ åˆ°æ‰«æé˜Ÿåˆ—å‘¢? è€Œä¸” go è¿˜å…è®¸å†…éƒ¨æŒ‡é’ˆ, ä¼¼ä¹æ›´éº»çƒ¦äº†. æˆ‘ä»¬åˆ†æä¸€ä¸‹, è¦çŸ¥é“å¯¹è±¡å¼•ç”¨çš„å­å¯¹è±¡, ä»å¯¹è±¡å¼€å§‹åˆ°å¯¹è±¡ç»“å°¾, æŠŠå¯¹è±¡é‚£ä¸€å—å†…å­˜ä¸Šæ˜¯æŒ‡é’ˆçš„æ”¾åˆ°æ‰«æé˜Ÿåˆ—å°±å¥½äº†. é‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¾—çŸ¥é“å¯¹è±¡æœ‰å¤šå¤§, ä»å“ªå¼€å§‹åˆ°å“ªç»“æŸ, åŒæ—¶è¦çŸ¥é“å†…å­˜ä¸Šçš„ 8 ä¸ªå­—èŠ‚, å“ªé‡Œæ˜¯æŒ‡é’ˆ, å“ªé‡Œæ˜¯æ™®é€šçš„æ•°æ®.</p><p>é¦–å…ˆ go çš„å¯¹è±¡æ˜¯ mspan ç®¡ç†çš„, æˆ‘ä»¬å¦‚æœèƒ½çŸ¥é“å¯¹è±¡å±äºå“ªä¸ª mspan, å°±çŸ¥é“å¯¹è±¡å¤šå¤§, ä»å“ªå¼€å§‹, åˆ°å“ªç»“æŸäº†. å‰é¢æˆ‘ä»¬è®²åˆ°äº† areans ç»“æ„, å¯ä»¥é€šè¿‡æŒ‡é’ˆåŠ ä¸Šä¸€å®šå¾—åç§»é‡, å°±çŸ¥é“å±äºå“ªä¸ª heap arean 64M å—. å†é€šè¿‡å¯¹ 64M æ±‚ä½™, ç»“åˆ spans æ•°ç»„, å³å¯çŸ¥é“å±äºå“ªä¸ª mspan äº†.</p><p>ç»“åˆ heapArean çš„ bitmap å’Œæ¯ 8 ä¸ªå­—èŠ‚åœ¨ heapArean ä¸­çš„åç§», å°±å¯çŸ¥é“å¯¹è±¡æ¯ 8 ä¸ªå­—èŠ‚æ˜¯æŒ‡é’ˆè¿˜æ˜¯æ™®é€šæ•°æ®(è¿™é‡Œçš„ bitmap æ˜¯åœ¨åˆ†é…å¯¹è±¡æ—¶æ ¹æ® type ä¿¡æ¯å°±è®¾ç½®äº†, type ä¿¡æ¯æ¥æºäºç¼–è¯‘å™¨ç”Ÿæˆ)</p><h2><span id="gc-æµç¨‹"><strong>GC æµç¨‹</strong></span></h2><p><img src="https://pic1.zhimg.com/50/v2-e0eef1afbfa873db4b0faa21a4741c5f_720w.jpg?source=1940ef5c" alt="img"></p><p>1.5 å’Œ 1.12 çš„ GC å¤§è‡´æµç¨‹ç›¸åŒ. ä¸Šå›¾æ˜¯ golang å®˜æ–¹çš„ ppt é‡Œçš„å›¾, ä¸‹å›¾æ˜¯æˆ‘æ ¹æ® 1.12 æºç ç»˜åˆ¶çš„.ä»æœ€åå¯èƒ½ä¼šæœ‰ç™¾ ms çš„ gc åœé¡¿åˆ°èƒ½å¤Ÿç¨³å®šåœ¨ 1ms ä»¥ä¸‹, è¿™ä¹‹é—´ GC åšäº†å¾ˆå¤šæ”¹è¿›. å³è¾¹æ˜¯æˆ‘æ ¹æ®å®˜æ–¹ issues æ•´ç†çš„ä¸€äº›æ¯”è¾ƒé‡è¦çš„æ”¹è¿›. 1.6 çš„åˆ†å¸ƒå¼æ£€æµ‹, 1.7 å°†æ ˆæ”¶ç¼©æ”¾åˆ°äº†å¹¶å‘æ‰«æé˜¶æ®µ, 1.8 çš„æ··åˆå†™å±éšœ, 1.12 æ›´æ”¹äº† mark termination æ£€æµ‹ç®—æ³•, mcache flush ç§»é™¤å‡º mark termination ç­‰ç­‰.</p><h2><span id="golang-gc-pacer"><strong>Golang GC Pacer</strong></span></h2><p><img src="https://pica.zhimg.com/50/v2-e5d325ee3dbdf9b2911520651798a872_720w.jpg?source=1940ef5c" alt="img"></p><p>å¤§å®¶å¯¹å¹¶å‘ GC é™¤äº†æ€ä¹ˆä¿è¯ä¸æ¼æŒ‡é’ˆæœ‰ç–‘é—®å¤–, å¯èƒ½è¿˜ä¼šç–‘é—®, å¹¶å‘ GC å¦‚ä½•ä¿è¯èƒ½å¤Ÿè·Ÿå¾—ä¸Šåº”ç”¨ç¨‹åºçš„åˆ†é…é€Ÿåº¦? ä¼šä¸ä¼šåˆ†é…å¤ªå¿«äº†, GC å®Œå…¨è·Ÿä¸ä¸Š, ç„¶å OOM?</p><p>è¿™ä¸ªå°±æ˜¯ Golang GC Pacer çš„ä½œç”¨.</p><p>Go çš„ GC æ˜¯ä¸€ç§æ¯”ä¾‹ GC, ä¸‹ä¸€æ¬¡ GC ç»“æŸæ—¶çš„å †å¤§å°å’Œä¸Šä¸€æ¬¡ GC å­˜æ´»å †å¤§å°æˆæ¯”ä¾‹. ç”± GOGC æ§åˆ¶, é»˜è®¤ 100, å³ 2 å€çš„å…³ç³», 200 å°±æ˜¯ 3 å€, ä»¥æ­¤ç±»æ¨.</p><p>å‡å¦‚ä¸Šä¸€æ¬¡ GC å®Œæˆæ—¶, å­˜æ´»å¯¹è±¡ 1000M, é»˜è®¤ GOGC 100, é‚£ä¹ˆä¸‹æ¬¡ GC ä¼šåœ¨æ¯”è¾ƒæ¥è¿‘ä½†å°äº 2000M çš„æ—¶å€™(æ¯”å¦‚ 1900M)å¼€å§‹, äº‰å–åœ¨å †å¤§å°è¾¾åˆ° 2000M çš„æ—¶å€™ç»“æŸ. è¿™ä¹‹é—´ç•™æœ‰ä¸€å®šçš„è£•åº¦, ä¼šè®¡ç®—å¾…æ‰«æå¯¹è±¡å¤§å°(æ ¹æ®å†å²æ•°æ®è®¡ç®—)ä¸å¯åˆ†é…çš„è£•åº¦çš„æ¯”ä¾‹, åº”ç”¨ç¨‹åºåˆ†é…å†…å­˜æ ¹æ®è¯¥æ¯”ä¾‹è¿›è¡Œè¾…åŠ© GC, å¦‚æœåº”ç”¨ç¨‹åºåˆ†é…å¤ªå¿«äº†, å¯¼è‡´ credit ä¸å¤Ÿ, é‚£ä¹ˆä¼šè¢«é˜»å¡, ç›´åˆ°åå°çš„ mark è·Ÿä¸Šæ¥äº†,è¯¥æ¯”ä¾‹ä¼šéšç€ GC è¿›è¡Œä¸æ–­è°ƒæ•´.</p><p>GC ç»“æŸå, ä¼šæ ¹æ®è¿™ä¸€æ¬¡ GC çš„æƒ…å†µæ¥è¿›è¡Œè´Ÿåé¦ˆè®¡ç®—, è®¡ç®—ä¸‹ä¸€æ¬¡ GC å¼€å§‹çš„é˜ˆå€¼.</p><p>å¦‚ä½•ä¿è¯æŒ‰æ—¶å®Œæˆ GC å‘¢? GC å®Œäº†å, æ‰€æœ‰çš„ mspan éƒ½éœ€è¦ sweep, ç±»ä¼¼äº GC çš„æ¯”ä¾‹, ä» GC ç»“æŸåˆ°ä¸‹ä¸€æ¬¡ GC å¼€å§‹ä¹‹é—´æœ‰ä¸€å®šçš„å †åˆ†é…è£•åº¦, ä¼šæ ¹æ®è¿˜æœ‰å¤šå°‘çš„å†…å­˜éœ€è¦æ¸…æ‰«, æ¥è®¡ç®—åˆ†é…å†…å­˜æ—¶éœ€è¦æ¸…æ‰«çš„ span æ•°è¿™æ ·çš„ä¸€ä¸ªæ¯”ä¾‹.</p><p><img src="https://pic2.zhimg.com/50/v2-92218cc498cc9ae159ba9e95df29f4c9_720w.jpg?source=1940ef5c" alt="img"></p><h2><span id="å®è·µä¸æ€»ç»“"><strong>å®è·µä¸æ€»ç»“</strong></span></h2><h2><span id="è§‚å¯Ÿè°ƒåº¦"><strong>è§‚å¯Ÿè°ƒåº¦</strong></span></h2><p><img src="https://pic3.zhimg.com/50/v2-78cd3a12e7aecf54c56eabca2c879f78_720w.jpg?source=1940ef5c" alt="img"></p><p>è§‚å¯Ÿä¸€ä¸‹è°ƒåº¦, åŠ ä¸€äº›è¯·æ±‚. æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è™½ç„¶æœ‰ 1000 ä¸ªè¿æ¥, ä½†æ˜¯ go åªç”¨äº†å‡ ä¸ªçº¿ç¨‹å°±èƒ½å¤„ç†äº†, è¡¨æ˜ go çš„ç½‘ç»œçš„ç¡®æ˜¯ç”± epoll ç®¡ç†çš„. runqueue è¡¨ç¤ºçš„æ˜¯å…¨å±€é˜Ÿåˆ—å¾…è¿è¡Œåç¨‹æ•°é‡, åé¢çš„æ•°å­—è¡¨ç¤ºæ¯ä¸ª P ä¸Šçš„å¾…è¿è¡Œåç¨‹æ•°. å¯ä»¥çœ‹åˆ°å¾…å¤„ç†çš„ä»»åŠ¡å¹¶æ²¡æœ‰å¢åŠ , è¡¨ç¤ºè™½ç„¶è¯·æ±‚å¾ˆå¤š, ä½†å®Œå…¨èƒ½ hold ä½.</p><p>åŒæ—¶å¯ä»¥çœ‹åˆ°, ä¸åŒ P ä¸Šæœ‰çš„æ—¶å€™å¯èƒ½ä»»åŠ¡ä¸å‡è¡¡, ä½†æ˜¯ä¸€ä¼šå, ä»»åŠ¡åˆå‡è¡¡äº†, è¡¨ç¤º go çš„ work stealing æ˜¯æœ‰æ•ˆçš„.</p><h2><span id="è§‚å¯Ÿ-gc"><strong>è§‚å¯Ÿ GC</strong></span></h2><p><img src="https://pic1.zhimg.com/50/v2-596836ab3923ed21c32a4a961264d7d8_720w.jpg?source=1940ef5c" alt="img"></p><p>å…¶ä¸­ä¸€äº›æ•°æ®çš„å«ä¹‰, åœ¨åˆ†äº«çš„æ—¶å€™æ²¡æœ‰æ€ä¹ˆè§£é‡Š, ä¸è¿‡ç½‘ä¸Šçš„è§£é‡Šå‡ ä¹æ²¡æœ‰èƒ½å®Œå…¨è§£é‡Šæ­£ç¡®. æˆ‘è¿™é‡Œæ•²ä¸€ä¸‹.<br>å…¶å®ä¸€èˆ¬å…³æ³¨å †å¤§å°å’Œä¸¤ä¸ª stw çš„ wall time å³å¯.</p><p>gc 8913(ç¬¬ 8913 æ¬¡ gc) @2163.341s(åœ¨ç¨‹åºè¿è¡Œçš„ç¬¬ 2163s) 1%(gc æ‰€æœ‰ work æ¶ˆè€—çš„å†å²ç´¯è®¡ CPU æ¯”ä¾‹, æ‰€ä»¥å…¶å®è¿™ä¸ªæ•°æ®æ²¡å¤ªå¤§æ„ä¹‰) 0.13(ç¬¬ä¸€ä¸ª stw çš„ wall time)+14(å¹¶å‘ mark çš„ wall time)+0.20(ç¬¬äºŒä¸ª stw çš„ wall time) ms clock, 1.1(ç¬¬ä¸€ä¸ª stw æ¶ˆè€—çš„ CPU æ—¶é—´)+21(ç”¨æˆ·ç¨‹åºè¾…åŠ©æ‰«ææ¶ˆè€—çš„ cpu æ—¶é—´)&#x2F;22(åˆ†é…ç”¨äº mark çš„ P æ¶ˆè€—çš„ cpu æ—¶é—´)&#x2F;0(ç©ºé—²çš„ P ç”¨äº mark çš„ cpu æ—¶é—´)+1.6ms(ç¬¬ 2 ä¸ª stw çš„ cpu æ—¶é—´) cpu, 147(gc å¼€å§‹æ—¶çš„å †å¤§å°)-&gt;149(gc ç»“æŸçš„å †å¤§å°)-&gt;75MB(gc ç»“æŸæ—¶çš„å­˜æ´»å †å¤§å°), 151 MB goal(æœ¬æ¬¡ gc é¢„è®¡ç»“æŸçš„å †å¤§å°), 8P(8 ä¸ª P).</p><h2><span id="ä¼˜åŒ–"><strong>ä¼˜åŒ–</strong></span></h2><p><img src="https://pic1.zhimg.com/50/v2-dd28c6e140bbcd27d737f61e980b562b_720w.jpg?source=1940ef5c" alt="img"></p><p>ä¸ªäººå»ºè®®, æ²¡äº‹ä¸è¦æ€»æƒ³ç€ä¼˜åŒ–, å¥½å¥½ curd å°±å¥½.</p><p><img src="https://pica.zhimg.com/50/v2-2e0bbec8ffca844876195af2e970e8a6_720w.jpg?source=1940ef5c" alt="img"></p><p>å½“ç„¶è¿˜æ˜¯æœ‰ä¸€äº›ä¼˜åŒ–æ–¹æ³•çš„.</p><h2><span id="ä¸€ç‚¹å®è·µ"><strong>ä¸€ç‚¹å®è·µ</strong></span></h2><p><img src="https://pica.zhimg.com/50/v2-827fe7197304383f74f774d3c23d8df7_720w.jpg?source=1940ef5c" alt="img"></p><p>æˆ‘ä»¬å°† pprof çš„å¼€å¯é›†æˆåˆ°æ¨¡æ¿ä¸­, å¹¶è‡ªåŠ¨é€‰æ‹©ç«¯å£, å¹¶é›†æˆäº† gops å·¥å…·, æ–¹ä¾¿æŸ¥è¯¢ runtime ä¿¡æ¯, åŒæ—¶åœ¨æµè§ˆå™¨ä¸Šå¯ç›´æ¥ç‚¹å‡»ç”Ÿæˆç«ç„°å›¾, pprof å›¾, éå¸¸çš„æ–¹ä¾¿, ä¹Ÿä¸éœ€è¦ä½¿ç”¨è€…å…³å¿ƒ.</p><h2><span id="é—®é¢˜æ’æŸ¥çš„ä¸€ç‚¹æ€è·¯"><strong>é—®é¢˜æ’æŸ¥çš„ä¸€ç‚¹æ€è·¯</strong></span></h2><p><img src="https://pic1.zhimg.com/50/v2-eb8dc800c3390a55be87d142cee862f2_720w.jpg?source=1940ef5c" alt="img"></p><h2><span id="ä¸€æ¬¡æœ‰æ„æ€çš„é—®é¢˜æ’æŸ¥"><strong>ä¸€æ¬¡æœ‰æ„æ€çš„é—®é¢˜æ’æŸ¥</strong></span></h2><p><img src="https://pic2.zhimg.com/50/v2-8360b4e634560ca5ac314b7b76181b98_720w.jpg?source=1940ef5c" alt="img"></p><p>è´Ÿè½½, ä¾èµ–æœåŠ¡éƒ½å¾ˆæ­£å¸¸, CPU åˆ©ç”¨ç‡ä¹Ÿä¸é«˜, è¯·æ±‚ä¹Ÿä¸å¤š, å°±æ˜¯æœ‰å¾ˆå¤šè¶…æ—¶.</p><p><img src="https://pic1.zhimg.com/50/v2-8a0e06b128b6f2316d8462b9dbc30e0b_720w.jpg?source=1940ef5c" alt="img"></p><p>è¯¥æœåŠ¡åœ¨çº¿ä¸Šæ‰“å°äº† debug æ—¥å¿—, å› ä¸ºæ—©æœŸçš„æœåŠ¡æ¨¡æ¿å¼€å¯äº† gctrace, æ¡†æ¶æŠŠ stdout é‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶äº†. è€Œè¾“å‡º gctrace æ—¶æœ¬æ¥æ˜¯åˆ° console çš„, è¾“å‡ºåˆ°æ–‡ä»¶äº†, è€Œç£ç›˜è·Ÿä¸ä¸Š, å¯¼è‡´ gctrace æ—¥å¿—è¢«é˜»å¡äº†.</p><p>è¿™é‡Œæ›´æ­£ä¸€ä¸‹ ppt ä¸­çš„å†…å®¹, å¹¶ä¸æ˜¯å› ä¸º gc æ²¡å®Œæˆè€Œå¯¼è‡´å…¶ä»–åç¨‹ä¸èƒ½è¿è¡Œ, è€Œæ˜¯åç»­ gc æ— æ³•å¼€å¯, å¯¼è‡´å®è´¨ä¸Šçš„ stw.<br>æ‰“å° gc trace æ—¥å¿—æ—¶, å·²ç» start the world äº†, å…¶ä»–åç¨‹å¯ä»¥å¼€å§‹è¿è¡Œäº†. ä½†æ˜¯åœ¨æ‰“å° gctrace æ—¥å¿—æ—¶, è¿˜ä¿æŒç€å¼€å¯ gc éœ€è¦çš„é”, æ‰€ä»¥, æ‰“å° gc trace æ—¥å¿—ä¸€ç›´æ²¡å®Œæˆ, è€Œ gc åˆæ¯”è¾ƒé¢‘ç¹, æ¯”å¦‚ 0.1s ä¸€æ¬¡, è¿™æ ·ä¼šå¯¼è‡´ä¸‹ä¸€æ¬¡ gc å¼€å§‹æ—¶æ— æ³•è·å–é”, æ¯ä¸€ä¸ªè¿›å…¥ gc æ£€æŸ¥çš„ p é˜»å¡, å®é™…ä¸Šå°±é€ æˆäº† stw.</p><h2><span id="runtime-çš„ä¸€ç‚¹ä¸ªäººæ€»ç»“"><strong>Runtime çš„ä¸€ç‚¹ä¸ªäººæ€»ç»“</strong></span></h2><p><img src="https://pic3.zhimg.com/50/v2-2c598eec44a5909786868950c5224a6c_720w.jpg?source=1940ef5c" alt="img"></p><p>å¹¶è¡Œ, çºµå‘å¤šå±‚æ¬¡, æ¨ªå‘å¤šä¸ª class, ç¼“å­˜, ç¼“å†², å‡è¡¡.</p><h2><span id="å‚è€ƒæ–‡æ¡£"><strong>å‚è€ƒæ–‡æ¡£</strong></span></h2><p><img src="https://pic1.zhimg.com/50/v2-406faead2e6957e16a50c5b42f58053a_720w.jpg?source=1940ef5c" alt="img"></p><p><strong>æœ¬æ–‡å®Œæ•´ PPT å¯ç‚¹å‡»ä¸‹æ–¹å›¾ç‰‡è·å¾—ã€‚</strong></p>]]></content>
      
      
      <categories>
          
          <category> GOLANG </category>
          
      </categories>
      
      
        <tags>
            
            <tag> golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼€å‘ç©ºé—´ä½¿ç”¨æ–‡æ¡£</title>
      <link href="/blog/2021/09/01/Wiki/%E5%BC%80%E5%8F%91%E7%A9%BA%E9%97%B4%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/"/>
      <url>/blog/2021/09/01/Wiki/%E5%BC%80%E5%8F%91%E7%A9%BA%E9%97%B4%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h2><span id="å¼€å‘ç©ºé—´ä½¿ç”¨æ–‡æ¡£">å¼€å‘ç©ºé—´ä½¿ç”¨æ–‡æ¡£</span></h2><h3><span id="é¡¹ç›®è®¾ç½®">é¡¹ç›®è®¾ç½®</span></h3><h4><span id="é¡¹ç›®ä¸»é¡µ">é¡¹ç›®ä¸»é¡µ</span></h4><p>é¡¹ç›®åç§°ï¼šé»˜è®¤åˆ›å»ºçš„æ—¶å€™çš„åç§°ï¼Œå¯ä»¥åœ¨è¿™é‡Œä¿®æ”¹</p><p>å°é¢ï¼šé¡¹ç›®çš„å°é¢ï¼Œå¯ä»¥ç”¨æ¥å‘å¸ƒï¼Œå›¾ç‰‡å°ºå¯¸ç¬¦åˆé¡µé¢æç¤ºå†…å®¹</p><p>ç®€ä»‹ï¼šé¡¹ç›®çš„ä¸€äº›ç®€å•ä»‹ç»</p><h4><span id="ä»£ç ä»“åº“">ä»£ç ä»“åº“</span></h4><p>ä»£ç ä»“åº“é»˜è®¤åˆ†ä¸ºè¯­è¨€ç±»å‹çš„gitä»“åº“ï¼Œæ‰€å¸¦æœ‰çš„æ¡†æ¶é»˜è®¤æ”¯æŒæ‰“åŒ…ï¼Œå’Œæ”¯æŒä¸­å°çš„åŸºæœ¬æ¡†æ¶</p><p>å‰ç«¯ä»“åº“ï¼švue idgç­‰</p><p>åç«¯ä»“åº“ï¼šgolang java php node ç­‰ </p><p>ios,android,ä¸­å°å°ç¨‹åºï¼Œå¾®ä¿¡å°ç¨‹åºï¼Œh5ï¼Œæµè§ˆå™¨æ’ä»¶ï¼Œpcï¼Œè·¨æ®µåº”ç”¨ï¼Œ</p><p>å‹¤åŠ¡ä»“åº“ï¼Œå’ŒåŒºå—é“¾ä¸“ç”¨ä»“åº“ï¼Œå¹¶æ”¯æŒå¤åˆ¶å…¶ä»–ä»“åº“</p><h5><span id="ä»“åº“ä½¿ç”¨">ä»“åº“ä½¿ç”¨ï¼š</span></h5><p>é»˜è®¤å¼€å‘è€…ä¸ºä¸»masteråˆ†æ”¯ç®¡ç†å‘˜</p><p>åˆ†æ”¯:</p><p>åˆå¹¶è¯·æ±‚ï¼šå¯ä»¥åˆå¹¶å…¶ä»–ç”¨æˆ·æäº¤çš„åˆå¹¶è¯·æ±‚</p><p>æ ‡ç­¾ï¼šåˆ©ç”¨æ­¤æ ‡ç­¾å¯ä»¥ç”¨æ¥æ‰“åŒ…é›†æˆå„ç±»å‹çš„èµ„äº§åŒ…å’Œé•œåƒ</p><p>æˆå‘˜ï¼šå¯ä»¥æ·»åŠ æˆå‘˜</p><h4><span id="é•œåƒç®¡ç†">é•œåƒç®¡ç†</span></h4><p>å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼šé•œåƒï¼ˆå¯ä»¥ç›´æ¥æ”¾åœ¨æœåŠ¡å™¨è¿è¡Œçš„ï¼‰åŒ…ç®¡ç†ï¼ˆå¯ä»¥æ”¯æŒå…¶ä»–æœåŠ¡å¼•å…¥çš„ï¼‰</p><p>é•œåƒæ ¹æ®ä»“åº“ç±»å‹é‡Œçš„tagç„¶åè¿›è¡Œæ‰“åŒ…ï¼š</p><p>åŒ…æ‹¬ï¼šphp(5-*7)ç±»å‹ï¼Œgolang(13-15)java å’Œå…¶ä»–ç±»å‹æ‰“åŒ… vueç±»å‹é•œåƒ</p><p>åŒ…æ ¹æ®ä»“åº“é‡Œçš„tagè¿›è¡Œæ‰“åŒ…ï¼š</p><p>åŒ…æ‹¬:npm android ios composer h5ç­‰ç±»å‹dab</p><h4><span id="æˆå‘˜ç®¡ç†">æˆå‘˜ç®¡ç†</span></h4><p>æ­¤å¤„ç”¨æ¥æ·»åŠ ç”¨æˆ·ï¼Œå…¶ä¸­é¡¹ç›®æˆå‘˜åŸºæœ¬æƒé™è¦æœ‰ï¼šé¡¹ç›®è´Ÿè´£äººæˆ–è€…é¡¹ç›®å‚ä¸è€…ã€‚æ”¯æŒæ‰¹é‡æ·»åŠ ç”¨æˆ·è§’è‰²</p><h4><span id="éƒ¨ç½²è®¾ç½®">éƒ¨ç½²è®¾ç½®</span></h4><p>béƒ¨ç½²è®¾ç½®æ”¾åœ¨æ­¤å¤„æ¯”è¾ƒæ—©ï¼Œéœ€è¦åç«¯æˆ–è€…é¡¹ç›®è´Ÿè´£äººæ·»åŠ ã€‚</p><p>å…¶ä¸­åŒ…æ‹¬ï¼šå¯¹é¡¹ç›®æ‰€éœ€è¦çš„å®¹å™¨èµ„æºç±»å‹è¿›è¡Œé…ç½®ï¼Œå’Œèµ„æºæ¨¡æ¿é…ç½®ï¼Œcpu membery port ç­‰</p><h3><span id="äº§å“å®šä¹‰">äº§å“å®šä¹‰</span></h3><ul><li>æ¨¡å—åˆ—è¡¨ï¼šé»˜è®¤æœ‰ä¸»æ¨¡å—ã€‚ä¸»æ¨¡å—æƒé™å±äºç¬¬ä¸€ä¸ªä½¿ç”¨äº§å“å®šä¹‰çš„äººï¼Œå¹¶éåˆ›å»ºè€…ã€‚</li></ul><p>å¯ä»¥é€‰æ‹©æ–°å¢æ¨¡å—ï¼Œå¡«å†™æ¨¡å—åç§°å’Œæè¿°ï¼Œæ¨¡å—æ ‡ç­¾</p><p>æ¨¡å—ä¹‹é—´æ”¯æŒçš„åŠŸèƒ½ï¼šåˆ©ç”¨å¯†é’¥æ¥å®ç°å¤åˆ¶ï¼ˆå†…å®¹å¤åˆ¶ï¼‰å’Œåˆ†äº«ï¼ˆé€šé“åˆ†äº«ï¼‰</p><p>æ¨¡å—ä¹‹é—´å¯ä»¥æ·»åŠ ç”¨æˆ·ï¼Œç»™ç”¨æˆ·èµ‹äºˆæ¨¡å—è´Ÿè´£äººã€æ¨¡å—å‚ä¸è€…ï¼ˆåªæœ‰æµè§ˆæƒé™ï¼‰</p><ul><li><p>ä»»åŠ¡åˆ—è¡¨ï¼š</p><p>åŒ…æ‹¬äº§å“ã€åç«¯ã€è®¾è®¡ä½¿ç”¨çš„åŸºæœ¬å·¥å…·å’Œæ–‡æ¡£</p><p>éœ€æ±‚å®šä¹‰ï¼šäº§å“éœ€è¦å†™çš„ä¸€äº›åŸºæœ¬åŠŸèƒ½æä¾›ã€‚é¡¹ç›®åˆ›ç«‹ä¹‹åˆçš„ä¸€äº›ä¿¡æ¯æ”¶é›†ï¼Œå’ŒåŸºæœ¬çš„ä½œå›¾ï¼Œè®¾è®¡ç”¨ä¾‹ï¼Œæ•°æ®æ¨¡å‹ç­‰åŠŸèƒ½çš„æ”¯æŒ</p><p>è®¾è®¡æ–‡æ¡£ï¼šä¸€äº›åŸºæœ¬çš„è®¾è®¡å›¾ç‰‡æ–‡ç¨¿ï¼Œç«å“åˆ†æï¼Œè®¾è®¡ç”¨çš„å›¾ç‰‡ä¸”æ”¯æŒå›¾ç‰‡æ‹–åŠ¨æ‰§è¡Œ</p><p>æŠ€æœ¯å®šä¹‰ï¼šåç«¯çš„ä¸€äº›åŸºæœ¬apiæ–‡æ¡£å¡«å†™</p><p>æ•°æ®å®šä¹‰ï¼šæ•°æ®åº“ç›¸å…³çš„åŸºæœ¬ä½¿ç”¨</p><p>æ¯ä¸ªåˆ†ç±»ä¸‹åˆ†ä¸ºå„ç§çš„ç±»å‹ä½¿ç”¨ï¼Œç§ç±»ç¹å¤šï¼Œæ»¡è¶³é¡¹ç›®åˆ›ç«‹ä¹‹åˆæ‰€æœ‰çš„ä½¿ç”¨</p></li></ul><h3><span id="å¤šè¯­è¨€ç®¡ç†">å¤šè¯­è¨€ç®¡ç†</span></h3><h4><span id="é¡¹ç›®å¤šè¯­è¨€">é¡¹ç›®å¤šè¯­è¨€</span></h4><p>æ”¯æ’‘é¡¹ç›®å†…å…³é”®è¯ï¼Œå„ä¸ªå›½å®¶è¯­è¨€çš„ç¿»è¯‘ä½¿ç”¨</p><h3><span id="ä¼šè®®è®°å½•">ä¼šè®®è®°å½•</span></h3><p>è®°å½•é¡¹ç›®æˆå‘˜æ¯æ¬¡å¼€ä¼šä½¿ç”¨çš„åŸºæœ¬ä»»åŠ¡</p><h3><span id="æ¥å…¥ç®¡ç†">æ¥å…¥ç®¡ç†</span></h3><p>ä¸­å°æ ¸å¿ƒå†…å®¹ï¼šæ”¯æŒå¼€å‘è€…åˆ›å»ºå¼€å‘å®¹å™¨ï¼Œæ”¯æŒå®ä¾‹æ•°æ®å¡«å†™ACLæƒé™ç®¡æ§ï¼Œæ”¯æŒç”¨æˆ·è´­ä¹°</p><h3><span id="èµ„æºç®¡ç†">èµ„æºç®¡ç†</span></h3><p>å®¹å™¨äº‘æ‰€éœ€çš„èµ„æºè´­ä¹°å’Œèµ„æºé…ç½®</p><h3><span id="éƒ¨ç½²ç©ºé—´">éƒ¨ç½²ç©ºé—´</span></h3><p>ä¸­å°æ ¸å¿ƒå†…å®¹ï¼šæ”¯æŒå¼€å‘è€…åˆ›å»ºå¼€å‘å®¹å™¨ï¼Œæ”¯æŒå®ä¾‹æ•°æ®å¡«å†™ACLæƒé™ç®¡æ§ï¼Œæ”¯æŒç”¨æˆ·è´­ä¹°</p><h3><span id="é¡¹ç›®ç®¡ç†">é¡¹ç›®ç®¡ç†</span></h3><p>é¡¹ç›®issueé…ç½®</p><h3><span id="cicd">CICD</span></h3><p>é¡¹ç›®è‡ªåŠ¨åŒ–æµ‹è¯•</p><h3><span id="å‘å¸ƒç®¡ç†">å‘å¸ƒç®¡ç†</span></h3><p>é¡¹ç›®å‘å¸ƒåˆ°å¸‚åœº</p><h3><span id="guiç®¡ç†">GUIç®¡ç†</span></h3><p>guiå‰ç«¯ç•Œé¢è‡ªåŠ¨åŒ–æ·»åŠ </p><h3><span id="wiki">WIKI</span></h3><p>é¡¹ç›®Wikiè®°å½•</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>GOLGANG-ç¬”è®°6-å­¦ä¹ æ—¥å¿—ä½è¿ç®—ç¬¦</title>
      <link href="/blog/2021/08/27/GOLANG/GOLANG-%E7%AC%94%E8%AE%B06-%E5%AD%A6%E4%B9%A0%E6%97%A5%E5%BF%97/"/>
      <url>/blog/2021/08/27/GOLANG/GOLANG-%E7%AC%94%E8%AE%B06-%E5%AD%A6%E4%B9%A0%E6%97%A5%E5%BF%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>ä½è¿ç®—ï¼šä½è¿ç®—ç¬¦å¯¹æ•´æ•°åœ¨å†…å­˜ä¸­çš„äºŒè¿›åˆ¶ä½è¿›è¡Œæ“ä½œã€‚</p><p> &amp;, |, å’Œ ^ </p><p>ã€‹ã€‹ã€‹ ã€Šã€Šã€Š</p><p>æ•°ç»„</p><p>var a ã€5ã€‘string</p><p>a:&#x3D;[5]string[â€œ2â€,â€3â€,â€4â€,â€2â€,â€3â€]</p><p>a:&#x3D;[â€¦.]string[â€œ2â€,â€3â€,â€4â€,â€2â€,â€3â€]</p><p>ç©ºæŒ‡é’ˆï¼šæŒ‡é’ˆå®šä¹‰åæ²¡æœ‰åˆ†é…åˆ°ä»»ä½•å˜é‡å°±ä¼šé”™</p><p>æ—§çš„ï¼š</p><p>uh49y8vwmxp5rsiqthfjm62ynxbajofc  edc8af2cfdaf438e9e1dc301234e13b9  747  opygwmeutz6kt15umavlwyrcjqqok0ni  topocpzejlq4huin6cmhieqxxn8fep7n  263</p><p>æ–°çš„ï¼š</p><p>uh49y8vwmxp5rsiqthfjm62ynxbajofc  edc8af2cfdaf438e9e1dc301234e13b9  747  opygwmeutz6kt15umavlwyrcjqqok0ni  8191a23b9783477599b9f01f53f5bab7 37</p>]]></content>
      
      
      <categories>
          
          <category> GOLANG </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è®¡ç®—æœºåŸºç¡€-è½¬ä¹‰å­—ç¬¦</title>
      <link href="/blog/2021/06/22/Wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6/"/>
      <url>/blog/2021/06/22/Wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h3><span id="ä»€ä¹ˆæ˜¯è½¬ä¹‰å­—ç¬¦æœ‰ä»€ä¹ˆç”¨">ä»€ä¹ˆæ˜¯è½¬ä¹‰å­—ç¬¦ï¼Ÿæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</span></h3><p>è½¬ä¹‰å­—ç¬¦æ˜¯ä¸€ç§ç‰¹æ®Šçš„å­—ç¬¦å¸¸é‡</p>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºåŸºç¡€çŸ¥è¯† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è½¬ä¹‰å­—ç¬¦ </tag>
            
            <tag> wiki </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­£åˆ™è¡¨è¾¾å¼-ä¿®é¥°ç¬¦</title>
      <link href="/blog/2021/06/07/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F-%E4%BF%AE%E9%A5%B0%E7%AC%A6/"/>
      <url>/blog/2021/06/07/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F-%E4%BF%AE%E9%A5%B0%E7%AC%A6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><ul><li><p>æ ‡è®°ä¹Ÿç§°ä¸ºä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼çš„æ ‡è®°ç”¨äºæŒ‡å®šé¢å¤–çš„åŒ¹é…ç­–ç•¥ã€‚</p></li><li><p>æ ‡è®°ä¸å†™åœ¨æ­£åˆ™è¡¨è¾¾å¼é‡Œï¼Œæ ‡è®°ä½äºè¡¨è¾¾å¼ä¹‹å¤–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/pattern/flags</span><br></pre></td></tr></table></figure></li></ul><table><thead><tr><th align="left">ä¿®é¥°ç¬¦</th><th align="left">å«ä¹‰</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">i</td><td align="left">ignore - ä¸åŒºåˆ†å¤§å°å†™</td><td align="left">å°†åŒ¹é…è®¾ç½®ä¸ºä¸åŒºåˆ†å¤§å°å†™ï¼Œæœç´¢æ—¶ä¸åŒºåˆ†å¤§å°å†™: A å’Œ a æ²¡æœ‰åŒºåˆ«ã€‚</td></tr><tr><td align="left">g</td><td align="left">global - å…¨å±€åŒ¹é…</td><td align="left">æŸ¥æ‰¾æ‰€æœ‰çš„åŒ¹é…é¡¹ã€‚</td></tr><tr><td align="left">m</td><td align="left">multi line - å¤šè¡ŒåŒ¹é…</td><td align="left">ä½¿è¾¹ç•Œå­—ç¬¦ <strong>^</strong> å’Œ <strong>$</strong> åŒ¹é…æ¯ä¸€è¡Œçš„å¼€å¤´å’Œç»“å°¾ï¼Œè®°ä½æ˜¯å¤šè¡Œï¼Œè€Œä¸æ˜¯æ•´ä¸ªå­—ç¬¦ä¸²çš„å¼€å¤´å’Œç»“å°¾ã€‚</td></tr><tr><td align="left">s</td><td align="left">ç‰¹æ®Šå­—ç¬¦åœ†ç‚¹ <strong>.</strong> ä¸­åŒ…å«æ¢è¡Œç¬¦ <strong>\n</strong></td><td align="left">é»˜è®¤æƒ…å†µä¸‹çš„åœ†ç‚¹ <strong>.</strong> æ˜¯ åŒ¹é…é™¤æ¢è¡Œç¬¦ <strong>\n</strong> ä¹‹å¤–çš„ä»»ä½•å­—ç¬¦ï¼ŒåŠ ä¸Š <strong>s</strong> ä¿®é¥°ç¬¦ä¹‹å, <strong>.</strong> ä¸­åŒ…å«æ¢è¡Œç¬¦ \nã€‚</td></tr></tbody></table><h4><span id="å…ƒå­—ç¬¦">å…ƒå­—ç¬¦</span></h4><h4><span id="è¿ç®—ç¬¦ä¼˜å…ˆçº§">è¿ç®—ç¬¦ä¼˜å…ˆçº§</span></h4><p>æ­£åˆ™è¡¨è¾¾å¼ä»å·¦åˆ°å³è¿›è¡Œè®¡ç®—ï¼Œå¹¶éµå¾ªä¼˜å…ˆçº§é¡ºåºï¼Œè¿™ä¸ç®—æœ¯è¡¨è¾¾å¼éå¸¸ç±»ä¼¼ã€‚</p><p>ç›¸åŒä¼˜å…ˆçº§çš„ä»å·¦åˆ°å³è¿›è¡Œè¿ç®—ï¼Œä¸åŒä¼˜å…ˆçº§çš„è¿ç®—å…ˆé«˜åä½ã€‚ä¸‹è¡¨ä»æœ€é«˜åˆ°æœ€ä½è¯´æ˜äº†å„ç§æ­£åˆ™è¡¨è¾¾å¼è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§é¡ºåºï¼š</p><table><thead><tr><th align="left">è¿ç®—ç¬¦</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">\</td><td align="left">è½¬ä¹‰ç¬¦</td></tr><tr><td align="left">(), (?:), (?&#x3D;), []</td><td align="left">åœ†æ‹¬å·å’Œæ–¹æ‹¬å·</td></tr><tr><td align="left">*, +, ?, {n}, {n,}, {n,m}</td><td align="left">é™å®šç¬¦</td></tr><tr><td align="left">^, $, \ä»»ä½•å…ƒå­—ç¬¦ã€ä»»ä½•å­—ç¬¦</td><td align="left">å®šä½ç‚¹å’Œåºåˆ—ï¼ˆå³ï¼šä½ç½®å’Œé¡ºåºï¼‰</td></tr><tr><td align="left">|</td><td align="left">æ›¿æ¢ï¼Œâ€æˆ–â€æ“ä½œ å­—ç¬¦å…·æœ‰é«˜äºæ›¿æ¢è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ï¼Œä½¿å¾—â€m|foodâ€åŒ¹é…â€mâ€æˆ–â€foodâ€ã€‚è‹¥è¦åŒ¹é…â€moodâ€æˆ–â€foodâ€ï¼Œè¯·ä½¿ç”¨æ‹¬å·åˆ›å»ºå­è¡¨è¾¾å¼ï¼Œä»è€Œäº§ç”Ÿâ€(m|f)oodâ€ã€‚</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> regex </category>
          
      </categories>
      
      
        <tags>
            
            <tag> regex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­£åˆ™è¡¨è¾¾å¼-è¯­æ³•</title>
      <link href="/blog/2021/06/07/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F-%E8%AF%AD%E6%B3%95/"/>
      <url>/blog/2021/06/07/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F-%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p><a href="https://github.com/ziishaned/learn-regex/blob/master/translations/README-cn.md">https://github.com/ziishaned/learn-regex/blob/master/translations/README-cn.md</a></p><h4><span id="1æ™®é€šå­—ç¬¦1-9-a-z-a-z-æ ‡ç‚¹ç¬¦å·å’Œä¸€äº›å…¶ä»–ç¬¦å·">1.æ™®é€šå­—ç¬¦ï¼š1-9 a-z A-Z æ ‡ç‚¹ç¬¦å·å’Œä¸€äº›å…¶ä»–ç¬¦å·ã€‚</span></h4><p><img src="//s2-cdn.oneitfarm.com/eab92d4dcdab496abde257a6adf121c8.png"></p><table><thead><tr><th>key</th><th>val</th><th>desc</th><th>exp</th></tr></thead><tbody><tr><td>&#x2F;*&#x2F;</td><td></td><td>åŸºç¡€è¯­æ³•åŒºéš”ï¼Œè½¬ä¹‰ç¬¦å·</td><td></td></tr><tr><td>^</td><td></td><td>å¼€å§‹ä½ç½®</td><td></td></tr><tr><td>$</td><td></td><td>ç»“æŸä½ç½®</td><td></td></tr><tr><td>[0-9]</td><td></td><td>åŒ¹é…æ•°å­—</td><td></td></tr><tr><td>[a-z]</td><td></td><td>å°å†™å­—æ¯</td><td></td></tr><tr><td>[A-Z]</td><td></td><td>å¤§å†™å­—æ¯</td><td></td></tr><tr><td>+</td><td>runoo+b</td><td>åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ª</td><td></td></tr><tr><td>-</td><td></td><td>è¿æ¥å­—ç¬¦</td><td></td></tr><tr><td>{}</td><td>{3,5}</td><td>å­—ç¬¦é•¿åº¦3-5</td><td>^[a-z0-9_-]{3,15}$</td></tr><tr><td>ï¼Ÿ</td><td>colou?r</td><td>åŒ¹é… color æˆ–è€… colour</td><td></td></tr><tr><td>â€¦</td><td>[â€¦]</td><td>åŒ¹é…æ‰€æœ‰å­—ç¬¦</td><td></td></tr><tr><td>( )</td><td>(  )</td><td>å­è¡¨è¾¾å¼çš„å¼€å§‹å’Œç»“æŸä½ç½®</td><td></td></tr></tbody></table><h4><span id="2éæ‰“å°å­—ç¬¦">2.éæ‰“å°å­—ç¬¦</span></h4>]]></content>
      
      
      <categories>
          
          <category> regex </category>
          
      </categories>
      
      
        <tags>
            
            <tag> regex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œåè®®</title>
      <link href="/blog/2021/06/07/HTTP/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/"/>
      <url>/blog/2021/06/07/HTTP/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><!-- toc --><ul><li><a href="#10-%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AEtcp-trancemission-control-protocol">1.0 ç½‘ç»œåè®®ï¼ˆTCP Trancemission Control Protocolï¼‰</a></li><li><a href="#11-%E8%AF%B7%E6%B1%82%E5%A4%B4">1.1 è¯·æ±‚å¤´</a></li><li><a href="#12-%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B">1.2 ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹</a></li><li><a href="#13-%E6%8A%A5%E6%96%87%E6%8A%93%E5%8F%96%E5%B7%A5%E5%85%B7">1.3 æŠ¥æ–‡æŠ“å–å·¥å…·</a></li></ul><ul><li><a href="#20-http-hypertext-transfer-protocol">2.0 HTTP (HyperText Transfer protocol)</a><ul><li><a href="#21-%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87">2.1 è¯·æ±‚æŠ¥æ–‡</a></li><li><a href="#22-%E5%93%8D%E5%BA%94%E6%8A%A5%E6%96%87">2.2 å“åº”æŠ¥æ–‡</a></li><li><a href="#23-http-%E6%8A%93%E5%8F%96%E5%B7%A5%E5%85%B7">2.3 HTTP æŠ“å–å·¥å…·</a></li><li><a href="#24-session-cookie">2.4 Session Cookie</a></li><li><a href="#25-tcpudphttp%E7%9A%84%E5%8C%BA%E5%88%AB%E5%92%8C%E8%81%94%E7%B3%BB">2.5 TCP&#x2F;UDP&#x2F;HTTPçš„åŒºåˆ«å’Œè”ç³»</a></li></ul></li><li><a href="#30-%E6%80%BB%E7%BB%93">3.0 æ€»ç»“</a></li></ul><!-- tocstop --><h4><span id="10-ç½‘ç»œåè®®tcp-trancemission-control-protocol">1.0 ç½‘ç»œåè®®ï¼ˆTCP Trancemission Control Protocolï¼‰</span></h4><ul><li><p>TCP ä¸ƒå±‚ç½‘ç»œæ¨¡å‹<br>ä¸»æœºå±‚ï¼š<br>åª’ä»‹å±‚ï¼š</p><p><img src="http://s2-cdn.oneitfarm.com/767fb54c00ef41d1b15f28a8c33f3d16.png"></p></li></ul><h4><span id="11-è¯·æ±‚å¤´">1.1 è¯·æ±‚å¤´</span></h4><h4><span id="12-ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹">1.2 ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹</span></h4><h4><span id="13-æŠ¥æ–‡æŠ“å–å·¥å…·">1.3 æŠ¥æ–‡æŠ“å–å·¥å…·</span></h4><h3><span id="20-http-hypertext-transfer-protocol">2.0 HTTP (HyperText Transfer protocol)</span></h3><p><img src="//s2-cdn.oneitfarm.com/205566ffbffc4786af2443e348192532.png"></p><h4><span id="21-è¯·æ±‚æŠ¥æ–‡">2.1 è¯·æ±‚æŠ¥æ–‡</span></h4><h4><span id="22-å“åº”æŠ¥æ–‡">2.2 å“åº”æŠ¥æ–‡</span></h4><h4><span id="23-http-æŠ“å–å·¥å…·">2.3 HTTP æŠ“å–å·¥å…·</span></h4><h4><span id="24-session-cookie">2.4 Session Cookie</span></h4><h4><span id="25-tcpx2fudpx2fhttpçš„åŒºåˆ«å’Œè”ç³»">2.5 TCP&#x2F;UDP&#x2F;HTTPçš„åŒºåˆ«å’Œè”ç³»</span></h4><p>ä¸€ã€<br>TPC&#x2F;IPåè®®æ˜¯ä¼ è¾“å±‚åè®®ï¼Œä¸»è¦è§£å†³æ•°æ®å¦‚ä½•åœ¨ç½‘ç»œä¸­ä¼ è¾“ï¼Œ<br>è€ŒHTTPæ˜¯åº”ç”¨å±‚åè®®ï¼Œä¸»è¦è§£å†³å¦‚ä½•åŒ…è£…æ•°æ®ã€‚<br>å…³äºTCP&#x2F;IPå’ŒHTTPåè®®çš„å…³ç³»ï¼Œç½‘ç»œæœ‰ä¸€æ®µæ¯”è¾ƒå®¹æ˜“ç†è§£çš„ä»‹ç»ï¼š</p><p>â€œæˆ‘ä»¬åœ¨ä¼ è¾“æ•°æ®æ—¶ï¼Œå¯ä»¥åªä½¿ç”¨ï¼ˆä¼ è¾“å±‚ï¼‰TCP&#x2F;IPåè®®ï¼Œä½†æ˜¯é‚£æ ·çš„è¯ï¼Œå¦‚æœæ²¡æœ‰åº”ç”¨å±‚ï¼Œä¾¿æ— æ³•è¯†åˆ«æ•°æ®å†…å®¹ï¼Œå¦‚æœæƒ³è¦ä½¿ä¼ è¾“çš„æ•°æ®æœ‰æ„ä¹‰ï¼Œåˆ™å¿…é¡»ä½¿ç”¨åˆ°åº”ç”¨å±‚åè®®ï¼Œåº”ç”¨å±‚åè®®æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚HTTPã€FTPã€TELNETç­‰ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰åº”ç”¨å±‚åè®®ã€‚WEBä½¿ç”¨HTTPåè®®ä½œåº”ç”¨å±‚åè®®ï¼Œä»¥å°è£…HTTP æ–‡æœ¬ä¿¡æ¯ï¼Œç„¶åä½¿ç”¨TCP&#x2F;IPåšä¼ è¾“å±‚åè®®å°†å®ƒå‘åˆ°ç½‘ç»œä¸Šã€‚â€<br>æœ¯è¯­TCP&#x2F;IPä»£è¡¨ä¼ è¾“æ§åˆ¶åè®®&#x2F;ç½‘é™…åè®®ï¼ŒæŒ‡çš„æ˜¯ä¸€ç³»åˆ—åè®®ã€‚</p><p>â€œIPâ€ä»£è¡¨ç½‘é™…åè®®ï¼ŒTCPå’ŒUDPä½¿ç”¨è¯¥åè®®ä»ä¸€ä¸ªç½‘ç»œä¼ é€æ•°æ®åŒ…åˆ°å¦ä¸€ä¸ªç½‘ç»œã€‚æŠŠIPæƒ³åƒæˆä¸€ç§é«˜é€Ÿå…¬è·¯ï¼Œå®ƒå…è®¸å…¶å®ƒåè®®åœ¨ä¸Šé¢è¡Œé©¶å¹¶æ‰¾åˆ°åˆ°å…¶å®ƒç”µè„‘çš„å‡ºå£ã€‚TCPå’ŒUDPæ˜¯é«˜é€Ÿå…¬è·¯ä¸Šçš„â€œå¡è½¦â€ï¼Œå®ƒä»¬æºå¸¦çš„è´§ç‰©å°±æ˜¯åƒHTTPï¼Œæ–‡ä»¶ä¼ è¾“åè®®FTPè¿™æ ·çš„åè®®ç­‰ã€‚ </p><p>ä½ åº”è¯¥èƒ½ç†è§£ï¼ŒTCPå’ŒUDPæ˜¯FTPï¼ŒHTTPå’ŒSMTPä¹‹ç±»ä½¿ç”¨çš„ä¼ è¾“å±‚åè®®ã€‚è™½ç„¶TCPå’ŒUDPéƒ½æ˜¯ç”¨æ¥ä¼ è¾“å…¶ä»–åè®®çš„ï¼Œå®ƒä»¬å´æœ‰ä¸€ä¸ªæ˜¾è‘—çš„ä¸åŒï¼šTCPæä¾›æœ‰ä¿è¯çš„æ•°æ®ä¼ è¾“ï¼Œè€ŒUDPä¸æä¾›ã€‚è¿™æ„å‘³ç€TCPæœ‰ä¸€ä¸ªç‰¹æ®Šçš„æœºåˆ¶æ¥ç¡®ä¿æ•°æ®å®‰å…¨çš„ä¸å‡ºé”™çš„ä»ä¸€ä¸ªç«¯ç‚¹ä¼ åˆ°å¦ä¸€ä¸ªç«¯ç‚¹ï¼Œè€ŒUDPä¸æä¾›ä»»ä½•è¿™æ ·çš„ä¿è¯ã€‚<br>HTTP(è¶…æ–‡æœ¬ä¼ è¾“åè®®)æ˜¯åˆ©ç”¨TCPåœ¨ä¸¤å°ç”µè„‘(é€šå¸¸æ˜¯WebæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯)ä¹‹é—´ä¼ è¾“ä¿¡æ¯çš„åè®®ã€‚å®¢æˆ·ç«¯ä½¿ç”¨Webæµè§ˆå™¨å‘èµ·HTTPè¯·æ±‚ç»™WebæœåŠ¡å™¨ï¼ŒWebæœåŠ¡å™¨å‘é€è¢«è¯·æ±‚çš„ä¿¡æ¯ç»™å®¢æˆ·ç«¯ã€‚</p><p>1ã€HTTPåè®®çš„å‡ ä¸ªé‡è¦æ¦‚å¿µ</p><p> 1.è¿æ¥(Connection)ï¼šä¸€ä¸ªä¼ è¾“å±‚çš„å®é™…ç¯æµï¼Œå®ƒæ˜¯å»ºç«‹åœ¨ä¸¤ä¸ªç›¸äº’é€šè®¯çš„åº”ç”¨ç¨‹åºä¹‹é—´ã€‚</p><p> 2.æ¶ˆæ¯(Message)ï¼šHTTPé€šè®¯çš„åŸºæœ¬å•ä½ï¼ŒåŒ…æ‹¬ä¸€ä¸ªç»“æ„åŒ–çš„å…«å…ƒç»„åºåˆ—å¹¶é€šè¿‡è¿æ¥ä¼ è¾“ã€‚</p><p> 3.è¯·æ±‚(Request)ï¼šä¸€ä¸ªä»å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„è¯·æ±‚ä¿¡æ¯åŒ…æ‹¬åº”ç”¨äºèµ„æºçš„æ–¹æ³•ã€èµ„æºçš„æ ‡è¯†ç¬¦å’Œåè®®çš„ç‰ˆæœ¬å·</p><p> 4.å“åº”(Response)ï¼šä¸€ä¸ªä»æœåŠ¡å™¨è¿”å›çš„ä¿¡æ¯åŒ…æ‹¬HTTPåè®®çš„ç‰ˆæœ¬å·ã€è¯·æ±‚çš„çŠ¶æ€(ä¾‹å¦‚â€œæˆåŠŸâ€æˆ–â€œæ²¡æ‰¾åˆ°â€)å’Œæ–‡æ¡£çš„MIMEç±»å‹ã€‚</p><p> 5.èµ„æº(Resource)ï¼šç”±URIæ ‡è¯†çš„ç½‘ç»œæ•°æ®å¯¹è±¡æˆ–æœåŠ¡ã€‚</p><p> 6.å®ä½“(Entity)ï¼šæ•°æ®èµ„æºæˆ–æ¥è‡ªæœåŠ¡èµ„æºçš„å›æ˜ çš„ä¸€ç§ç‰¹æ®Šè¡¨ç¤ºæ–¹æ³•ï¼Œå®ƒå¯èƒ½è¢«åŒ…å›´åœ¨ä¸€ä¸ªè¯·æ±‚æˆ–å“åº”ä¿¡æ¯ä¸­ã€‚ä¸€ä¸ªå®ä½“åŒ…æ‹¬å®ä½“å¤´ä¿¡æ¯å’Œå®ä½“çš„æœ¬èº«å†…å®¹ã€‚</p><p> 7.å®¢æˆ·æœº(Client)ï¼šä¸€ä¸ªä¸ºå‘é€è¯·æ±‚ç›®çš„è€Œå»ºç«‹è¿æ¥çš„åº”ç”¨ç¨‹åºã€‚</p><p> 8.ç”¨æˆ·ä»£ç†(Useragent)ï¼šåˆå§‹åŒ–ä¸€ä¸ªè¯·æ±‚çš„å®¢æˆ·æœºã€‚å®ƒä»¬æ˜¯æµè§ˆå™¨ã€ç¼–è¾‘å™¨æˆ–å…¶å®ƒç”¨æˆ·å·¥å…·ã€‚</p><p> 9.æœåŠ¡å™¨(Server)ï¼šä¸€ä¸ªæ¥å—è¿æ¥å¹¶å¯¹è¯·æ±‚è¿”å›ä¿¡æ¯çš„åº”ç”¨ç¨‹åºã€‚</p><p> 10.æºæœåŠ¡å™¨(Originserver)ï¼šæ˜¯ä¸€ä¸ªç»™å®šèµ„æºå¯ä»¥åœ¨å…¶ä¸Šé©»ç•™æˆ–è¢«åˆ›å»ºçš„æœåŠ¡å™¨ã€‚</p><p> 11.ä»£ç†(Proxy)ï¼šä¸€ä¸ªä¸­é—´ç¨‹åºï¼Œå®ƒå¯ä»¥å……å½“ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥å……å½“ä¸€ä¸ªå®¢æˆ·æœºï¼Œä¸ºå…¶å®ƒå®¢æˆ·æœºå»ºç«‹è¯·æ±‚ã€‚è¯·æ±‚æ˜¯é€šè¿‡å¯èƒ½çš„ç¿»è¯‘åœ¨å†…éƒ¨æˆ–ç»è¿‡ä¼ é€’åˆ°å…¶å®ƒçš„æœåŠ¡å™¨ä¸­ã€‚ä¸€ä¸ªä»£ç†åœ¨å‘é€è¯·æ±‚ä¿¡æ¯ä¹‹å‰ï¼Œå¿…é¡»è§£é‡Šå¹¶ä¸”å¦‚æœå¯èƒ½é‡å†™å®ƒã€‚</p><p> ä»£ç†ç»å¸¸ä½œä¸ºé€šè¿‡é˜²ç«å¢™çš„å®¢æˆ·æœºç«¯çš„é—¨æˆ·ï¼Œä»£ç†è¿˜å¯ä»¥ä½œä¸ºä¸€ä¸ªå¸®åŠ©åº”ç”¨æ¥é€šè¿‡åè®®å¤„ç†æ²¡æœ‰è¢«ç”¨æˆ·ä»£ç†å®Œæˆçš„è¯·æ±‚ã€‚</p><p> 12.ç½‘å…³(Gateway)ï¼šä¸€ä¸ªä½œä¸ºå…¶å®ƒæœåŠ¡å™¨ä¸­é—´åª’ä»‹çš„æœåŠ¡å™¨ã€‚ä¸ä»£ç†ä¸åŒçš„æ˜¯ï¼Œç½‘å…³æ¥å—è¯·æ±‚å°±å¥½è±¡å¯¹è¢«è¯·æ±‚çš„èµ„æºæ¥è¯´å®ƒå°±æ˜¯æºæœåŠ¡å™¨ï¼›å‘å‡ºè¯·æ±‚çš„å®¢æˆ·æœºå¹¶æ²¡æœ‰æ„è¯†åˆ°å®ƒåœ¨åŒç½‘å…³æ‰“äº¤é“ã€‚</p><p> ç½‘å…³ç»å¸¸ä½œä¸ºé€šè¿‡é˜²ç«å¢™çš„æœåŠ¡å™¨ç«¯çš„é—¨æˆ·ï¼Œç½‘å…³è¿˜å¯ä»¥ä½œä¸ºä¸€ä¸ªåè®®ç¿»è¯‘å™¨ä»¥ä¾¿å­˜å–é‚£äº›å­˜å‚¨åœ¨éHTTPç³»ç»Ÿä¸­çš„èµ„æºã€‚</p><p> 13.é€šé“(Tunnel)ï¼šæ˜¯ä½œä¸ºä¸¤ä¸ªè¿æ¥ä¸­ç»§çš„ä¸­ä»‹ç¨‹åºã€‚ä¸€æ—¦æ¿€æ´»ï¼Œé€šé“ä¾¿è¢«è®¤ä¸ºä¸å±äºHTTPé€šè®¯ï¼Œå°½ç®¡é€šé“å¯èƒ½æ˜¯è¢«ä¸€ä¸ªHTTPè¯·æ±‚åˆå§‹åŒ–çš„ã€‚å½“è¢«ä¸­ç»§çš„è¿æ¥ä¸¤ç«¯å…³é—­æ—¶ï¼Œé€šé“ä¾¿æ¶ˆå¤±ã€‚å½“ä¸€ä¸ªé—¨æˆ·(Portal)å¿…é¡»å­˜åœ¨æˆ–ä¸­ä»‹(Intermediary)ä¸èƒ½è§£é‡Šä¸­ç»§çš„é€šè®¯æ—¶é€šé“è¢«ç»å¸¸ä½¿ç”¨ã€‚</p><p> 14.ç¼“å­˜(Cache)ï¼šååº”ä¿¡æ¯çš„å±€åŸŸå­˜å‚¨ã€‚</p><p> 2.å‘é€è¯·æ±‚</p><p>æ‰“å¼€ä¸€ä¸ªè¿æ¥åï¼Œå®¢æˆ·æœºæŠŠè¯·æ±‚æ¶ˆæ¯é€åˆ°æœåŠ¡å™¨çš„åœç•™ç«¯å£ä¸Šï¼Œå®Œæˆæå‡ºè¯·æ±‚åŠ¨ä½œã€‚</p><p> HTTP&#x2F;1.0 è¯·æ±‚æ¶ˆæ¯çš„æ ¼å¼ä¸ºï¼š</p><p> è¯·æ±‚æ¶ˆæ¯&#x3D;è¯·æ±‚è¡Œ(é€šç”¨ä¿¡æ¯|è¯·æ±‚å¤´|å®ä½“å¤´)CRLF[å®ä½“å†…å®¹]</p><p> è¯·æ±‚ è¡Œ&#x3D;æ–¹æ³• è¯·æ±‚URL HTTPç‰ˆæœ¬å· CRLF</p><p> æ–¹ æ³•&#x3D;GET|HEAD|POST|æ‰©å±•æ–¹æ³•</p><p> U R L&#x3D;åè®®åç§°+å®¿ä¸»å+ç›®å½•ä¸æ–‡ä»¶å</p><p> è¯·æ±‚è¡Œä¸­çš„æ–¹æ³•æè¿°æŒ‡å®šèµ„æºä¸­åº”è¯¥æ‰§è¡Œçš„åŠ¨ä½œï¼Œå¸¸ç”¨çš„æ–¹æ³•æœ‰GETã€HEADå’ŒPOSTã€‚ä¸åŒçš„è¯·æ±‚å¯¹è±¡å¯¹åº”GETçš„ç»“æœæ˜¯ä¸åŒçš„ï¼Œå¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š</p><p> å¯¹è±¡ GETçš„ç»“æœ</p><p> æ–‡ä»¶ æ–‡ä»¶çš„å†…å®¹</p><p> ç¨‹åº è¯¥ç¨‹åºçš„æ‰§è¡Œç»“æœ</p><p> æ•°æ®åº“æŸ¥è¯¢ æŸ¥è¯¢ç»“æœ</p><p> HEAD??è¦æ±‚æœåŠ¡å™¨æŸ¥æ‰¾æŸå¯¹è±¡çš„å…ƒä¿¡æ¯ï¼Œè€Œä¸æ˜¯å¯¹è±¡æœ¬èº«ã€‚</p><p> POST??ä»å®¢æˆ·æœºå‘æœåŠ¡å™¨ä¼ é€æ•°æ®ï¼Œåœ¨è¦æ±‚æœåŠ¡å™¨å’ŒCGIåšè¿›ä¸€æ­¥å¤„ç†æ—¶ä¼šç”¨åˆ°POSTæ–¹æ³•ã€‚POSTä¸»è¦ç”¨äºå‘é€HTMLæ–‡æœ¬ä¸­FORMçš„å†…å®¹ï¼Œè®©CGIç¨‹åºå¤„ç†ã€‚</p><p> ä¸€ä¸ªè¯·æ±‚çš„ä¾‹å­ä¸ºï¼š</p><p> GET<a href="http://networking.zju.edu.cn/zju/index.htmHTTP/1.0">http://networking.zju.edu.cn/zju/index.htmHTTP/1.0</a> networking.zju.edu.cn&#x2F;zju&#x2F;index.htmHTTP&#x2F;1.0 å¤´ä¿¡æ¯åˆç§°ä¸ºå…ƒä¿¡æ¯ï¼Œå³ä¿¡æ¯çš„ä¿¡æ¯ï¼Œåˆ©ç”¨å…ƒä¿¡æ¯å¯ä»¥å®ç°æœ‰æ¡ä»¶çš„è¯·æ±‚æˆ–åº”ç­”ã€‚</p><p> è¯·æ±‚å¤´??å‘Šè¯‰æœåŠ¡å™¨æ€æ ·è§£é‡Šæœ¬æ¬¡è¯·æ±‚ï¼Œä¸»è¦åŒ…æ‹¬ç”¨æˆ·å¯ä»¥æ¥å—çš„æ•°æ®ç±»å‹ã€å‹ç¼©æ–¹æ³•å’Œè¯­è¨€ç­‰ã€‚</p><p> å®ä½“å¤´??å®ä½“ä¿¡æ¯ç±»å‹ã€é•¿åº¦ã€å‹ç¼©æ–¹æ³•ã€æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´ã€æ•°æ®æœ‰æ•ˆæœŸç­‰ã€‚</p><p> å®ä½“??è¯·æ±‚æˆ–åº”ç­”å¯¹è±¡æœ¬èº«ã€‚</p><p> 3.å‘é€å“åº”</p><p> æœåŠ¡å™¨åœ¨å¤„ç†å®Œå®¢æˆ·çš„è¯·æ±‚ä¹‹åï¼Œè¦å‘å®¢æˆ·æœºå‘é€å“åº”æ¶ˆæ¯ã€‚</p><p> HTTP&#x2F;1.0çš„å“åº”æ¶ˆæ¯æ ¼å¼å¦‚ä¸‹ï¼š</p><p> å“åº”æ¶ˆæ¯&#x3D;çŠ¶æ€è¡Œ(é€šç”¨ä¿¡æ¯å¤´|å“åº”å¤´|å®ä½“å¤´) CRLF ã€”å®ä½“å†…å®¹ã€•</p><p> çŠ¶æ€è¡Œ&#x3D;HTTPç‰ˆæœ¬å· çŠ¶æ€ç  åŸå› å™è¿°</p><p> çŠ¶æ€ç è¡¨ç¤ºå“åº”ç±»å‹</p><p> 1Ã—Ã— ä¿ç•™</p><p> 2Ã—Ã— è¡¨ç¤ºè¯·æ±‚æˆåŠŸåœ°æ¥æ”¶</p><p> 3Ã—Ã— ä¸ºå®Œæˆè¯·æ±‚å®¢æˆ·éœ€è¿›ä¸€æ­¥ç»†åŒ–è¯·æ±‚</p><p> 4Ã—Ã— å®¢æˆ·é”™è¯¯</p><p> 5Ã—Ã— æœåŠ¡å™¨é”™è¯¯</p><p> å“åº”å¤´çš„ä¿¡æ¯åŒ…æ‹¬ï¼šæœåŠ¡ç¨‹åºåï¼Œé€šçŸ¥å®¢æˆ·è¯·æ±‚çš„URLéœ€è¦è®¤è¯ï¼Œè¯·æ±‚çš„èµ„æºä½•æ—¶èƒ½ä½¿ç”¨ã€‚</p><p> 4.å…³é—­è¿æ¥</p><p>å®¢æˆ·å’ŒæœåŠ¡å™¨åŒæ–¹éƒ½å¯ä»¥é€šè¿‡å…³é—­å¥—æ¥å­—æ¥ç»“æŸTCP&#x2F;IPå¯¹è¯</p><p>äºŒã€TCPï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰ï¼š</p><p>ä¸€ã€TCPæ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ä¼ è¾“å±‚åè®®ï¼›</p><pre><code>  TCPåè®®å»ºç«‹åœ¨ä¸å¯é çš„ç½‘ç»œå±‚ IP åè®®ä¹‹ä¸Šï¼ŒIPåè®®å¹¶ä¸èƒ½æä¾›ä»»ä½•å¯é æ€§æœºåˆ¶ï¼ŒTCPçš„å¯é æ€§å®Œå…¨ç”±è‡ªå·±å®ç°ï¼›  TCPé‡‡ç”¨çš„æœ€åŸºæœ¬çš„å¯é æ€§æŠ€æœ¯æ˜¯ï¼šç¡®è®¤ä¸è¶…æ—¶é‡ä¼ æœºåˆ¶ã€æµé‡æ§åˆ¶æœºåˆ¶ï¼›         </code></pre><p>1.è¶…æ—¶é‡ä¼ æ˜¯TCPåè®®ä¿è¯æ•°æ®å¯é æ€§çš„ä¸€ä¸ªé‡è¦æœºåˆ¶ï¼Œå…¶åŸç†æ˜¯åœ¨å‘é€æŸä¸€ä¸ªæ•°æ®ä»¥åå°±å¼€å¯ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œåœ¨ä¸€å®šæ—¶é—´å†…å¦‚æœæ²¡æœ‰å¾—åˆ°å‘é€çš„æ•°æ®æŠ¥çš„ACKæŠ¥æ–‡ï¼Œé‚£ä¹ˆå°±é‡æ–°å‘é€æ•°æ®ï¼Œç›´åˆ°å‘é€æˆåŠŸä¸ºæ­¢ã€‚</p><p>2.æµé‡æ§åˆ¶å°±æ˜¯è®©å‘é€é€Ÿç‡ä¸è¦è¿‡å¿«ï¼Œè®©æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶ã€‚åˆ©ç”¨æ»‘åŠ¨çª—å£æœºåˆ¶å°±å¯ä»¥å®æ–½æµé‡æ§åˆ¶ã€‚</p><p>Image</p><p>1.æºç«¯å£å’Œç›®çš„ç«¯å£å­—æ®µâ€”â€” socketï¼ˆIP+ç«¯å£å·ï¼‰ã€‚TCPçš„åŒ…æ˜¯æ²¡æœ‰IPåœ°å€çš„ï¼Œé‚£æ˜¯IPå±‚ä¸Šçš„äº‹ã€‚ä½†æ˜¯æœ‰æºç«¯å£å’Œç›®æ ‡ç«¯å£ã€‚</p><ol start="2"><li><p>åºåˆ—å· SEQ â€”â€”å½“å‰æŠ¥æ–‡æ®µçš„åºå·ã€‚</p></li><li><p>ç¡®è®¤åº”ç­”å· AN â€”â€”æœŸæœ›æ”¶åˆ°å¯¹æ–¹çš„ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·ï¼›</p></li><li><p>ç´§æ€¥  URG â€”â€”å½“  URG  &#x3D;  1  æ—¶ï¼Œè¡¨æ˜ç´§æ€¥æŒ‡é’ˆå­—æ®µæœ‰æ•ˆã€‚å®ƒå‘Šè¯‰ç³»ç»Ÿæ­¤æŠ¥æ–‡æ®µä¸­æœ‰ç´§æ€¥æ•°æ®ï¼Œåº”å°½å¿«ä¼ é€(ç›¸å½“äºé«˜ä¼˜å…ˆçº§çš„æ•°æ®)ï¼›</p></li><li><p>ç¡®è®¤ ACK â€”â€”å½“ ACK &#x3D; 1 æ—¶ã€‚è¡¨ç¤ºç¡®è®¤åº”ç­”å· AN æœ‰æ•ˆã€‚</p></li><li><p>æ¨é€  PSH  (PuSH) â€”â€” æ¥æ”¶  TCP  æ”¶åˆ°  PSH  &#x3D;  1  çš„æŠ¥æ–‡æ®µï¼Œå°±å°½å¿«åœ°äº¤ä»˜æ¥æ”¶åº”ç”¨è¿›ç¨‹ï¼Œè€Œä¸å†ç­‰åˆ°æ•´ä¸ªç¼“å­˜éƒ½å¡«æ»¡äº†åå†å‘ä¸Šäº¤ä»˜ï¼›</p></li><li><p>å¤ä½  RST  (ReSeT) â€”â€” å½“  RST  &#x3D;  1  æ—¶ï¼Œè¡¨æ˜  TCP  è¿æ¥ä¸­å‡ºç°ä¸¥é‡å·®é”™ï¼ˆå¦‚ç”±äºä¸»æœºå´©æºƒæˆ–å…¶ä»–åŸå› ï¼‰ï¼Œå¿…é¡»é‡Šæ”¾è¿æ¥ï¼Œç„¶åå†é‡æ–°å»ºç«‹ä¼ è¾“è¿æ¥ï¼›</p></li><li><p>åŒæ­¥ SYN â€”â€” åŒæ­¥  SYN  &#x3D;  1  è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡ã€‚</p></li><li><p>ç»ˆæ­¢ FIN (Finish) â€”â€” ç”¨æ¥é‡Šæ”¾ä¸€ä¸ªè¿æ¥ã€‚FIN&#x3D;  1  è¡¨æ˜å‘é€ç«¯çš„æ•°æ®å·²å‘é€å®Œæ¯•ï¼Œå¹¶è¦æ±‚é‡Šæ”¾ä¼ è¾“è¿æ¥ï¼›</p></li><li><p>çª—å£å­—æ®µ â€”â€” å  2 å­—èŠ‚ï¼Œç”¨æ¥è®©å¯¹æ–¹è®¾ç½®å‘é€çª—å£çš„ä¾æ®ï¼Œå•ä½ä¸ºå­—èŠ‚ã€‚çª—å£å€¼æ˜¯[ 0, 216-1 ]ä¹‹é—´çš„æ•´æ•°ï¼›</p></li><li><p>æ£€éªŒå’Œ â€”â€” å  2 å­—èŠ‚ã€‚æ£€éªŒå’Œå­—æ®µæ£€éªŒçš„èŒƒå›´åŒ…æ‹¬é¦–éƒ¨å’Œæ•°æ®è¿™ä¸¤éƒ¨åˆ†ã€‚åœ¨è®¡ç®—æ£€éªŒå’Œæ—¶ï¼Œè¦åœ¨TCP æŠ¥æ–‡æ®µçš„å‰é¢åŠ ä¸Š 12 å­—èŠ‚çš„ä¼ªéƒ¨(åè®®å­—æ®µä¸º6ï¼Œè¡¨ç¤ºTCP)ï¼›</p></li><li><p>ç´§æ€¥æŒ‡é’ˆå­—æ®µ â€”â€” å  16 ä½ï¼ŒæŒ‡å‡ºåœ¨æœ¬æŠ¥æ–‡æ®µä¸­ç´§æ€¥æ•°æ®å…±æœ‰å¤šå°‘ä¸ªå­—èŠ‚(ç´§æ€¥æ•°æ®æ”¾åœ¨æœ¬æŠ¥æ–‡æ®µæ•°æ®çš„æœ€å‰é¢)ï¼›</p></li><li><p>é€‰é¡¹å­—æ®µ â€”â€” é•¿åº¦å¯å˜ã€‚â‘  æœ€å¤§æŠ¥æ–‡æ®µé•¿åº¦ MSSï¼šMSSæ˜¯æŒ‡åœ¨TCPè¿æ¥å»ºç«‹æ—¶ï¼Œæ”¶å‘åŒå‘åå•†çš„é€šä¿¡æ—¶æ¯ä¸€ä¸ªæŠ¥æ–‡æ®µæ‰€èƒ½æ‰¿è½½çš„æ•°æ®å­—æ®µçš„æœ€å¤§é•¿åº¦ï¼ˆå¹¶ä¸æ˜¯TCPæŠ¥æ–‡æ®µçš„æœ€å¤§é•¿åº¦ï¼Œè€Œæ˜¯ï¼šMSS&#x3D;TCPæŠ¥æ–‡æ®µé•¿åº¦-TCPé¦–éƒ¨é•¿åº¦ï¼‰ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼ˆåŒæ–¹æä¾›çš„MSSä¸­çš„æœ€å°å€¼ï¼Œä¸ºæœ¬æ¬¡è¿æ¥çš„æœ€å¤§MSSå€¼ï¼‰ï¼›â‘¡ çª—å£æ‰©å¤§é€‰é¡¹ï¼›â‘¢ æ—¶é—´æˆ³é€‰é¡¹ï¼›â‘£ é€‰æ‹©ç¡®è®¤é€‰é¡¹ï¼›</p></li></ol><p>äºŒã€TCPä¸‰æ¬¡æ¡æ‰‹ï¼ˆéå¸¸é‡è¦ï¼‰</p><ul><li><pre><code>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æŠ¥æ–‡æ®µï¼Œå…¶ä¸­åŒæ­¥ä½SYN=1ï¼Œåºå·SEQ=xï¼ˆè¡¨æ˜ä¼ é€æ•°æ®æ—¶çš„ç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚çš„åºå·æ˜¯xï¼‰ï¼Œç­‰å¾…æœåŠ¡å™¨ç¡®è®¤ï¼›</code></pre></li><li><pre><code>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚ï¼Œå¦‚æœåŒæ„å»ºç«‹è¿æ¥ï¼Œå°±å‘å›ä¸€ä¸ªç¡®è®¤æŠ¥æ–‡æ®µï¼Œè¯¥æŠ¥æ–‡æ®µä¸­åŒæ­¥ä½SYN=1ï¼Œç¡®è®¤å·ACK=x+1ï¼Œåºå·SEQ=yï¼›</code></pre></li><li><pre><code>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„ç¡®è®¤æŠ¥æ–‡æ®µåï¼Œè¿˜éœ€è¦å‘æœåŠ¡å™¨ç»™å‡ºç¡®è®¤ï¼Œå‘å…¶å‘é€ç¡®è®¤åŒ…ACK(ack=y+1)ï¼Œè¿›è€Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹ã€‚</code></pre></li></ul><p>é€šè¿‡è¿™æ ·çš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å»ºç«‹èµ·å¯é çš„åŒå·¥çš„è¿æ¥ï¼Œå¼€å§‹ä¼ é€æ•°æ®ã€‚</p><p>ä¸ºäº†ä¿è¯æœåŠ¡ç«¯èƒ½æ”¶æ¥å—åˆ°å®¢æˆ·ç«¯çš„ä¿¡æ¯å¹¶èƒ½åšå‡ºæ­£ç¡®çš„åº”ç­”è€Œè¿›è¡Œå‰ä¸¤æ¬¡(ç¬¬ä¸€æ¬¡å’Œç¬¬äºŒæ¬¡)æ¡æ‰‹ï¼Œä¸ºäº†ä¿è¯å®¢æˆ·ç«¯èƒ½å¤Ÿæ¥æ”¶åˆ°æœåŠ¡ç«¯çš„ä¿¡æ¯å¹¶èƒ½åšå‡ºæ­£ç¡®çš„åº”ç­”è€Œè¿›è¡Œåä¸¤æ¬¡(ç¬¬äºŒæ¬¡å’Œç¬¬ä¸‰æ¬¡)æ¡æ‰‹ã€‚</p><p>ä¸‰ã€ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆç”¨æˆ·æŠ¥æ–‡åè®®ï¼‰UDP</p><p>   UDPæ˜¯ä¸€ç§æ— è¿æ¥çš„ã€ä¸å¯é çš„ä¼ è¾“å±‚åè®®ï¼›</p><p>   æä¾›äº†æœ‰é™çš„å·®é”™æ£€éªŒåŠŸèƒ½ï¼›</p><p>   ç›®çš„æ˜¯å¸Œæœ›ä»¥æœ€å°çš„å¼€é”€æ¥è¾¾åˆ°ç½‘ç»œç¯å¢ƒä¸­çš„è¿›ç¨‹é€šä¿¡ç›®çš„ï¼›</p><p>éšç€ç½‘ç»œæŠ€æœ¯é£é€Ÿå‘å±•ï¼Œç½‘é€Ÿå·²ä¸å†æ˜¯ä¼ è¾“çš„ç“¶é¢ˆï¼ŒUDPåè®®ä»¥å…¶ç®€å•ã€ä¼ è¾“å¿«çš„ä¼˜åŠ¿ï¼Œåœ¨è¶Šæ¥è¶Šå¤šåœºæ™¯ä¸‹å–ä»£äº†TCPï¼Œå¦‚ç½‘é¡µæµè§ˆã€æµåª’ä½“ã€å®æ—¶æ¸¸æˆã€ç‰©è”ç½‘ã€‚</p><p>1.ç½‘é€Ÿçš„æå‡ç»™UDPç¨³å®šæ€§æä¾›å¯é ç½‘ç»œä¿éšœ</p><p>CDNæœåŠ¡å•†Akamaiï¼ˆNASDAQ: AKAMï¼‰æŠ¥å‘Šä»2008å¹´åˆ°2015å¹´7å¹´æ—¶é—´ï¼Œå„ä¸ªå›½å®¶ç½‘ç»œå¹³å‡é€Ÿç‡ç”±1.5Mbpsæå‡ä¸º5.1Mbpsï¼Œç½‘é€Ÿæå‡è¿‘4å€ã€‚ç½‘ç»œç¯å¢ƒå˜å¥½ï¼Œç½‘ç»œä¼ è¾“çš„å»¶è¿Ÿã€ç¨³å®šæ€§ä¹Ÿéšä¹‹æ”¹å–„ï¼ŒUDPçš„ä¸¢åŒ…ç‡ä½äº5%ï¼Œå¦‚æœå†ä½¿ç”¨åº”ç”¨å±‚é‡ä¼ ï¼Œèƒ½å¤Ÿå®Œå…¨ç¡®ä¿ä¼ è¾“çš„å¯é æ€§ã€‚</p><p>2.å¯¹æ¯”æµ‹è¯•ç»“æœUDPæ€§èƒ½ä¼˜äºTCP</p><p>ä¸ºäº†æå‡æµè§ˆé€Ÿåº¦ï¼ŒGoogleåŸºäºTCPæå‡ºäº†SPDYåè®®ä»¥åŠHTTP&#x2F;2ã€‚Googleåœ¨Chromeä¸Šå®éªŒåŸºäºUDPçš„QUICåè®®ï¼Œä¼ è¾“é€Ÿç‡å‡å°‘åˆ°100msä»¥å†…ã€‚</p><p>Googleé‡‡ç”¨QUICåè¿æ¥é€Ÿç‡èƒ½æœ‰æ•ˆæå‡75%ã€‚</p><p>Googleæœç´¢é‡‡ç”¨QUICåé¡µé¢åŠ è½½æ€§èƒ½æå‡3%ã€‚</p><p>YouTubeé‡‡ç”¨QUICåé‡æ–°ç¼“å†²æ¬¡æ•°å‡å°‘äº†30%ã€‚</p><p>3.TCPè®¾è®¡è¿‡äºå†—ä½™ï¼Œé€Ÿåº¦éš¾ä»¥è¿›ä¸€æ­¥æå‡</p><p>TCPä¸ºäº†å®ç°ç½‘ç»œé€šä¿¡çš„å¯é æ€§ï¼Œä½¿ç”¨äº†å¤æ‚çš„æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œå»ºç«‹äº†ç¹ççš„æ¡æ‰‹è¿‡ç¨‹ä»¥åŠé‡ä¼ ç­–ç•¥ã€‚ç”±äºTCPå†…ç½®åœ¨ç³»ç»Ÿåè®®æ ˆä¸­ï¼Œæéš¾å¯¹å…¶è¿›è¡Œæ”¹è¿›ã€‚</p><p>4.UDPåè®®ä»¥å…¶ç®€å•ã€ä¼ è¾“å¿«çš„ä¼˜åŠ¿ï¼Œåœ¨è¶Šæ¥è¶Šå¤šåœºæ™¯ä¸‹å–ä»£äº†TCP</p><p>4.1 ç½‘é¡µæµè§ˆ</p><p>ä½¿ç”¨UDPåè®®æœ‰ä¸‰ä¸ªä¼˜ç‚¹ ï¼š</p><p>èƒ½å¤Ÿå¯¹æ¡æ‰‹è¿‡ç¨‹è¿›è¡Œç²¾ç®€ï¼Œå‡å°‘ç½‘ç»œé€šä¿¡å¾€è¿”æ¬¡æ•°ï¼›</p><p>èƒ½å¤Ÿå¯¹TLSåŠ è§£å¯†è¿‡ç¨‹è¿›è¡Œä¼˜åŒ–ï¼›</p><p>æ”¶å‘å¿«é€Ÿï¼Œæ— é˜»å¡ã€‚</p><p>4.2 æµåª’ä½“<br>é‡‡ç”¨TCPï¼Œä¸€æ—¦å‘ç”Ÿä¸¢åŒ…ï¼ŒTCPä¼šå°†åç»­åŒ…ç¼“å­˜èµ·æ¥ï¼Œç­‰å‰é¢çš„åŒ…é‡ä¼ å¹¶æ¥æ”¶åˆ°åå†ç»§ç»­å‘é€ï¼Œå»¶è¿Ÿä¼šè¶Šæ¥è¶Šå¤§ã€‚åŸºäºUDPçš„åè®®å¦‚WebRTCæ˜¯æä½³çš„é€‰æ‹©ã€‚<br>2010å¹´google é€šè¿‡æ”¶è´­ Global IP Solutionsï¼Œè·å¾—äº†WebRTCï¼ˆç½‘é¡µå®æ—¶é€šä¿¡ï¼ŒWeb Real-Time Communicationï¼‰æŠ€æœ¯ï¼Œç”¨äºæå‡ç½‘é¡µè§†é¢‘é€Ÿç‡ã€‚<br>4.3 å®æ—¶æ¸¸æˆ</p><p>å¯¹å®æ—¶è¦æ±‚è¾ƒä¸ºä¸¥æ ¼çš„æƒ…å†µä¸‹ï¼Œé‡‡ç”¨è‡ªå®šä¹‰çš„å¯é UDPåè®®ï¼Œæ¯”å¦‚Enetã€RakNetï¼ˆç”¨æˆ·æœ‰sony online gameã€minecraftï¼‰ç­‰ï¼Œè‡ªå®šä¹‰é‡ä¼ ç­–ç•¥ï¼Œèƒ½å¤ŸæŠŠä¸¢åŒ…äº§ç”Ÿçš„å»¶è¿Ÿé™åˆ°æœ€ä½ï¼Œå°½é‡å‡å°‘ç½‘ç»œé—®é¢˜å¯¹æ¸¸æˆæ€§é€ æˆçš„å½±å“ã€‚</p><p>é‡‡ç”¨UDPçš„ç»å…¸æ¸¸æˆå¦‚FPSæ¸¸æˆQuakeã€CSï¼Œè‘—åçš„æ¸¸æˆå¼•æ“Unity3Dé‡‡ç”¨çš„ä¹Ÿæ˜¯RakNet</p><p>å››ã€TCPä¸UDPçš„ä¸åŒ</p><ol><li>æ˜¯å¦éœ€è¦å»ºç«‹è¿æ¥ï¼šUDPåœ¨ä¼ é€æ•°æ®ä¹‹å‰ä¸éœ€è¦å…ˆå»ºç«‹è¿æ¥ï¼›TCPåˆ™æä¾›é¢å‘è¿æ¥çš„æœåŠ¡ï¼›</li><li>æ˜¯å¦éœ€è¦ç»™å‡ºç¡®è®¤ï¼šå¯¹æ–¹çš„ä¼ è¾“å±‚åœ¨æ”¶åˆ°UDPæŠ¥æ–‡åï¼Œä¸éœ€è¦ç»™å‡ºä»»ä½•ç¡®è®¤ï¼Œè€Œ TCPéœ€è¦ç»™å‡ºç¡®è®¤æŠ¥æ–‡ï¼Œè¦æä¾›å¯é çš„ã€é¢å‘è¿æ¥çš„ä¼ è¾“æœåŠ¡ã€‚</li><li>è™½ç„¶UDPä¸æä¾›å¯é äº¤ä»˜ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹UDPæ˜¯ä¸€ç§æœ€æœ‰æ•ˆçš„å·¥ä½œæ–¹å¼ï¼›ã€UDPå–ä»£TCPã€‘</li><li>å’ŒIPå±‚çš„è”ç³»ï¼šIPå±‚åªè´Ÿè´£æŠŠæ•°æ®é€åˆ°èŠ‚ç‚¹ï¼Œè€Œä¸èƒ½åŒºåˆ†ä¸Šé¢çš„ä¸åŒåº”ç”¨ï¼Œæ‰€ä»¥TCPå’ŒUDPåè®®åœ¨å…¶åŸºç¡€ä¸ŠåŠ å…¥äº†ç«¯å£çš„ä¿¡æ¯ï¼Œæ¯ä¸ªç«¯å£æ ‡è¯†çš„æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„ä¸€ä¸ªåº”ç”¨ã€‚é™¤äº†å¢åŠ ç«¯å£ä¿¡æ¯ï¼ŒUPDåè®®åŸºæœ¬å°±æ²¡æœ‰å¯¹IPå±‚çš„æ•°æ®è¿›è¡Œä»»ä½•çš„å¤„ç†äº†ã€‚è€ŒTCPåè®®è¿˜åŠ å…¥äº†æ›´åŠ å¤æ‚çš„ä¼ è¾“æ§åˆ¶ï¼Œæ¯”å¦‚æ»‘åŠ¨çš„æ•°æ®å‘é€çª—å£ï¼Œä»¥åŠæ¥æ”¶ç¡®è®¤å’Œé‡å‘æœºåˆ¶ï¼Œä»¥è¾¾åˆ°æ•°æ®çš„å¯é ä¼ é€ã€‚ä¸ç®¡åº”ç”¨å±‚çœ‹åˆ°çš„æ˜¯æ€æ ·ä¸€ä¸ªç¨³å®šçš„TCPæ•°æ®æµï¼Œä¸‹é¢ä¼ é€çš„éƒ½æ˜¯ä¸€ä¸ªä¸ªçš„IPæ•°æ®åŒ…ï¼Œéœ€è¦ç”±TCPåè®®æ¥è¿›è¡Œæ•°æ®é‡ç»„ã€‚</li></ol><p>äº”ã€TCPä¸UDPçš„é€‚ç”¨åœºæ™¯ã€‚</p><ol><li><p>TCPç”¨äºåœ¨ä¼ è¾“å±‚æœ‰å¿…è¦å®ç°å¯é ä¼ è¾“çš„æƒ…å†µã€‚</p></li><li><p>UDPä¸»è¦ç”¨äºé‚£äº›å¯¹é«˜é€Ÿä¼ è¾“å’Œå®æ—¶æ€§æœ‰è¾ƒé«˜è¦æ±‚çš„é€šä¿¡æˆ–å¹¿æ’­é€šä¿¡ã€‚</p><p> ä¸¾ä¸€ä¸ªé€šè¿‡ IP ç”µè¯è¿›è¡Œé€šè¯çš„ä¾‹å­ã€‚å¦‚æœä½¿ç”¨ TCPï¼Œæ•°æ®åœ¨ä¼ é€é€”ä¸­å¦‚æœä¸¢å¤±å°±ä¼šè¢«é‡å‘ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´æ— æ³•æµç•…åœ°ä¼ è¾“é€šè¯äººçš„å£°éŸ³ã€‚è€Œé‡‡ç”¨UDPï¼Œå®ƒä¸ä¼šè¿›è¡Œé‡å‘å¤„ç†ï¼Œä»è€Œä¹Ÿå°±ä¸ä¼šæœ‰å£°éŸ³å¤§å¹…åº¦å»¶è¿Ÿåˆ°è¾¾çš„é—®é¢˜ï¼Œå³ä½¿æœ‰éƒ¨åˆ†æ•°æ®ä¸¢å¤±ï¼Œä¹Ÿåªæ˜¯ä¼šå½±å“æŸä¸€å°éƒ¨åˆ†çš„é€šè¯ã€‚</p></li></ol><h3><span id="30-æ€»ç»“">3.0 æ€»ç»“</span></h3>]]></content>
      
      
      <categories>
          
          <category> HTTP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>The MIT License</title>
      <link href="/blog/2021/05/27/Wiki/%E5%85%B6%E4%BB%96-MIT%20%E8%AE%B8%E5%8F%AF%E5%8D%8F%E8%AE%AE/"/>
      <url>/blog/2021/05/27/Wiki/%E5%85%B6%E4%BB%96-MIT%20%E8%AE%B8%E5%8F%AF%E5%8D%8F%E8%AE%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><blockquote><p>MITè®¸å¯è¯ï¼ˆThe MIT Licenseï¼‰æ˜¯è®¸å¤šè½¯ä»¶æˆæƒæ¡æ¬¾ä¸­ï¼Œè¢«å¹¿æ³›ä½¿ç”¨çš„å…¶ä¸­ä¸€ç§ã€‚ä¸å…¶ä»–å¸¸è§çš„è½¯ä»¶æˆæƒæ¡æ¬¾ï¼ˆå¦‚GPLã€LGPLã€BSDï¼‰ç›¸æ¯”ï¼ŒMITæ˜¯ç›¸å¯¹å®½æ¾çš„è½¯ä»¶æˆæƒæ¡æ¬¾ã€‚</p></blockquote><h3><span id="1æ¡æ¬¾å†…å®¹">1.æ¡æ¬¾å†…å®¹</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Copyright (C) &lt;year&gt; &lt;copyright holders&gt;</span><br><span class="line">Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the &quot;Software&quot;), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</span><br><span class="line">The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</span><br><span class="line">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span><br></pre></td></tr></table></figure><h3><span id="2mitä¸å…¶ä»–å¼€æºè®¸å¯è¯çš„åŒºåˆ«">2.MITä¸å…¶ä»–å¼€æºè®¸å¯è¯çš„åŒºåˆ«</span></h3><p><img src="//s2-cdn.oneitfarm.com/2bec9f7690a945a499ebc95fd84a0cb5.png" alt="image.png"></p>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å­”ä¹™å·±å’Œé˜¿Q</title>
      <link href="/blog/2021/05/26/%E6%88%91%E7%9A%84%E6%97%A5%E8%AE%B0/%E5%AD%94%E4%B9%99%E5%B7%B1%E5%92%8C%E9%98%BFQ/"/>
      <url>/blog/2021/05/26/%E6%88%91%E7%9A%84%E6%97%A5%E8%AE%B0/%E5%AD%94%E4%B9%99%E5%B7%B1%E5%92%8C%E9%98%BFQ/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>å­”ä¹™å·±åŸä¸ºé²è¿…ç¬”ä¸‹çš„ä¸€ä¸ªæ—§æ—¶ä»£çš„äººç‰©ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•ç†è§£ä¸ºä¸€ä¸ªè‡­è¯»ä¹¦çš„<br>é˜¿Qæˆ‘ä»¬å¬åˆ°çš„æœ€å¤šçš„æ˜¯é˜¿Qç²¾ç¥ï¼šè‡ªæ‹ä¸è‡ªçŸ¥çš„å°äººç‰©<br>è¿™äº›éƒ½æ˜¯é²è¿…ç¬”ä¸‹çš„å°äººç‰©ï¼Œä¹‹å‰ä¸å¤§æ˜ç™½é²è¿…ä¸ºä½•å–œæ¬¢å†™è¿™äº›æˆ‘ä»¬ç°åœ¨çœ‹èµ·æ¥æŠ¨å‡»å°äººç‰©çš„çŸ­ç‰‡å°è¯´ï¼Œ<br>åŒ…æ‹¬å¯¹é—°åœŸ é˜¿Q å­”ä¹™å·± ç¥¥æ—å«‚ èŒƒçˆ±å†œç­‰ç­‰è¿™äº›ç°åœ¨çœ‹èµ·æ¥å¾ˆç¦»è°±çš„äº‹æƒ…ï¼Œè¿™è¦æ˜¯æ”¾åˆ°ç°åœ¨ä¸å¾—ä¸è¯´æ˜¯ä¸€è‚¡å¥‡è‘©çš„åŠ›é‡<br>åœ¨å¾®åšè´¡çŒ®ï¼Œå› ä¸ºæœ¬äººä¹Ÿæ˜¯ä¸ªå†²æµªçš„é”®ç›˜ä¾ ã€‚<br>ä½†äº†è§£è¿‡é²è¿…å¤§å¤§è¯´è¿‡ä¸€å¥å¾ˆç»å…¸çš„è¯ï¼šå­¦åŒ»æ•‘ä¸äº†ä¸­å›½äºº<br>å½“æ—¶æ˜¯æ°‘å›½ æƒ³æƒ³è¿™å¥è¯åˆ°åº•æœ‰å‡ ä¸ªå‘³é“å¤§å®¶ä¾¿çŸ¥é“äº†<br>ç°åœ¨æèµ·æ¥ä¸­å›½äººï¼Œä½ èµ°åˆ°å“ªé‡Œéƒ½æ˜¯è‡ªè±ªçš„ï¼Œé™¤äº†èœœæ±è‡ªä¿¡å‘¢çš„ç¾å¸ï¼Œæœ€èµ·ç åœ¨å›½å¤–æ˜¯æ²¡é—®é¢˜çš„ï¼Œå¯¹äºä¸€ä¸ªé•¿æ—¶é—´è¢«ä¸­å¤®äººæ°‘å¹¿æ’­ç”µå°ç†é™¶çš„å¹´é’äººæ˜¯è¿™æ ·çš„</p><p>å½“æ—¶ä¸­å›½æ˜¯è¢«ä¾µç•¥ï¼Œè¢«åå‡ ä¸ªäººæ‰“ï¼Œæƒ³æƒ³é‚£ç”»é¢ï¼Œä¸æ•¢è¿˜æ‰‹ï¼Œå¯¹äºå›½å®¶è‡³æ­¤ï¼Œä½•å†µè€ç™¾å§“ã€‚<br>å…¶å®é²è¿…ç¬”ä¸‹ä»»åŠ¡ç”¨çš„æœ€å¤šä¸ºå°å°çš„åº•å±‚ä»»åŠ¡å¯¹ç¤¾ä¼šï¼Œè°ˆä¸ä¸Šç¤¾ä¼šï¼Œè€Œæ˜¯å¯¹è‡ªå·±çš„ç”Ÿæ´»åœˆå­é‡Œé€ æˆçš„å½±å“ï¼Œå¯æœ‰å¯æ— çš„é‚£ç§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> diary </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ä»æ­£åˆ™è¡¨è¾¾å¼çš„iUsè¯´è¯´æ¨¡å¼ä¿®æ­£ç¬¦</title>
      <link href="/blog/2021/05/25/PHP/PHP-%E4%BB%8E%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84iUs%E8%AF%B4%E8%AF%B4%E6%A8%A1%E5%BC%8F%E4%BF%AE%E6%AD%A3%E7%AC%A6/"/>
      <url>/blog/2021/05/25/PHP/PHP-%E4%BB%8E%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84iUs%E8%AF%B4%E8%AF%B4%E6%A8%A1%E5%BC%8F%E4%BF%AE%E6%AD%A3%E7%AC%A6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>æœ¬æƒ³åšä¸ªç®€å•çš„é‡‡é›†ç¨‹åºï¼Œå‘ç°è¢«æŠ“é¡µé¢ä»£ç çš„è§„å¾‹åå‘ç°æŠ“ä¸‹æ¥çš„å†…å®¹æ²¡æœ‰æ”¾åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œè€Œæ˜¯æ”¾åœ¨ä¸€ä¸ªå…ƒç´ ä¸­ï¼Œæ— å¥ˆæ‰¾éèµ„æ–™å‘ç°åœ¨æ­£åˆ™è¡¨è¾¾å¼ååŠ ä¸Šâ€&#x2F;iUsâ€åç«Ÿç„¶å¯ä»¥äº†ã€‚<br>hexo<br>ç½‘ä¸Šå…³äºiUsçš„è¯´æ˜å¤šæ•°éƒ½æ˜¯æŠ„è¢­çš„ï¼Œæ²¡æœ‰åšè¿‡å¤šçš„è§£é‡Šï¼Œå¯¹äºä¸€ä¸ªå°å­¦æ¯•ä¸šè¯æ˜¯ä¹°æ¥çš„äººæ¥è¯´æ˜¯åœ¨æ˜¯ä¸å¥½ç†è§£ã€‚ä¸è¿‡å¹¸äºGoogleè®©æˆ‘æ‰¾åˆ°ç­”æ¡ˆã€‚</p><p>â€œiUsâ€ åœ¨è¿™é‡Œå«â€œæ¨¡å¼ä¿®æ­£ç¬¦â€ã€‚æ¨¡å¼ä¿®æ­£ç¬¦å…¶å®å°±æ˜¯å‡ ä¸ªå­—æ¯ï¼Œå¯ä»¥ä¸€æ¬¡ä½¿ç”¨ä¸€ä¸ªä¹Ÿå¯ä»¥ä¸€æ¬¡ä½¿ç”¨å¤šä¸ªï¼Œæ¯ä¸€ä¸ªéƒ½å…·æœ‰ä¸€å®šçš„æ„ä¹‰ï¼Œæ¨¡å¼ä¿®æ­£ç¬¦æ˜¯å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„æ‰©å±•ï¼›â€œ&#x2F;æ¨¡å¼ä¿®æ­£ç¬¦â€ï¼Œå…¶ä¸­æ­£æ–œçº¿â€œ&#x2F;â€ä¸ºè¾¹ç•Œç¬¦ã€‚ä¸‹è¡¨åˆ—å‡ºæ¥æœ‰é‚£äº›æ¨¡å¼ä¿®æ­£ç¬¦ï¼š</p><p>æ¨¡å¼ä¿®æ­£ç¬¦è¯´æ˜<br>iè¡¨ç¤ºåœ¨å’Œæ¨¡å¼è¿›è¡ŒåŒ¹é…è¿›ä¸åŒºåˆ†å¤§å°å†™<br>må°†æ¨¡å¼è§†ä¸ºå¤šè¡Œï¼Œä½¿ç”¨^å’Œ$è¡¨ç¤ºä»»ä½•ä¸€è¡Œéƒ½å¯ä»¥ä»¥æ­£åˆ™è¡¨è¾¾å¼å¼€å§‹æˆ–ç»“æŸ<br>så¦‚æœæ²¡æœ‰ä½¿ç”¨è¿™ä¸ªæ¨¡å¼ä¿®æ­£ç¬¦å·ï¼Œå…ƒå­—ç¬¦ä¸­çš„â€.â€é»˜è®¤ä¸èƒ½è¡¨ç¤ºæ¢è¡Œç¬¦å·,å°†å­—ç¬¦ä¸²è§†ä¸ºå•è¡Œ<br>xè¡¨ç¤ºæ¨¡å¼ä¸­çš„ç©ºç™½å¿½ç•¥ä¸è®¡<br>eæ­£åˆ™è¡¨è¾¾å¼å¿…é¡»ä½¿ç”¨åœ¨preg_replaceæ›¿æ¢å­—ç¬¦ä¸²çš„å‡½æ•°ä¸­æ—¶æ‰å¯ä»¥ä½¿ç”¨(è®²è¿™ä¸ªå‡½æ•°æ—¶å†è¯´)<br>Aä»¥æ¨¡å¼å­—ç¬¦ä¸²å¼€å¤´ï¼Œç›¸å½“äºå…ƒå­—ç¬¦^<br>Zä»¥æ¨¡å¼å­—ç¬¦ä¸²ç»“å°¾ï¼Œç›¸å½“äºå…ƒå­—ç¬¦$<br>Uæ­£åˆ™è¡¨è¾¾å¼çš„ç‰¹ç‚¹ï¼šå°±æ˜¯æ¯”è¾ƒâ€œè´ªå©ªâ€ï¼Œä½¿ç”¨è¯¥æ¨¡å¼ä¿®æ­£ç¬¦å¯ä»¥å–æ¶ˆè´ªå©ªæ¨¡å¼</p><h3><span id="1æ¨¡å¼ä¿®æ­£ç¬¦m">1ï¼Œæ¨¡å¼ä¿®æ­£ç¬¦mã€‚</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$pattern = â€˜/^abc/mâ€™;</span><br><span class="line">$string = â€˜bcd</span><br><span class="line">abc</span><br><span class="line">cbaâ€™;</span><br><span class="line">if (preg_match($pattern, $string, $arr)) &#123;</span><br><span class="line">echo â€œæ­£åˆ™è¡¨è¾¾å¼&lt;b&gt;&#123;$pattern&#125;&lt;/b&gt;å’Œå­—ç¬¦ä¸²&lt;b&gt;&#123;$string&#125;&lt;/b&gt;åŒ¹é…æˆåŠŸ&lt;br&gt;â€;</span><br><span class="line">print_r($arr);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">echo â€œ&lt;font color=â€™redâ€™&gt;æ­£åˆ™è¡¨è¾¾å¼&#123;$pattern&#125;å’Œå­—ç¬¦ä¸²&#123;$string&#125;åŒ¹é…å¤±è´¥&lt;/font&gt;â€;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>åŒ¹é…ç»“æœæ˜¯æˆåŠŸçš„ã€‚æ³¨æ„ï¼šæˆ‘ä»¬åœ¨ä½¿ç”¨æ¨¡å¼ä¿®æ­£ç¬¦mçš„æ—¶å€™ï¼Œå°†åŒ¹é…å­—ç¬¦ä¸²çœ‹æˆæ˜¯å¤šè¡Œè€Œä¸æ˜¯é»˜è®¤çš„å•è¡Œï¼Œæ‰€ä»¥ä»»ä½•ä¸€è¡Œåªè¦æ˜¯ä»¥abcå¼€å¤´ï¼Œå°±åŒ¹é…æˆåŠŸã€‚ä½†æ˜¯ï¼Œå¦‚æœèƒ½åŒ¹é…çš„è¡Œå‰é¢æœ‰ç©ºæ ¼çš„è¯ï¼Œå°±ä¸èƒ½åŒ¹é…äº†!é™¤éä¿®æ”¹æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ¨¡å¼ã€‚</p><h3><span id="2æ¨¡å¼ä¿®æ­£ç¬¦s">2ï¼Œæ¨¡å¼ä¿®æ­£ç¬¦sã€‚</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$pattern = â€˜/a.*c/sâ€™;</span><br><span class="line">$string = â€˜adsadsa</span><br><span class="line">câ€™;</span><br><span class="line">if (preg_match($pattern, $string, $arr)) &#123;</span><br><span class="line">echo â€œæ­£åˆ™è¡¨è¾¾å¼&lt;b&gt;&#123;$pattern&#125;&lt;/b&gt;å’Œå­—ç¬¦ä¸²&lt;b&gt;&#123;$string&#125;&lt;/b&gt;åŒ¹é…æˆåŠŸ&lt;br&gt;â€;</span><br><span class="line">print_r($arr);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">echo â€œ&lt;font color=â€™redâ€™&gt;æ­£åˆ™è¡¨è¾¾å¼&#123;$pattern&#125;å’Œå­—ç¬¦ä¸²&#123;$string&#125;åŒ¹é…å¤±è´¥&lt;/font&gt;â€;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¿™æ¬¡çš„åŒ¹é…è®°è¿‡ä¹Ÿæ˜¯æˆåŠŸçš„ã€‚å¦‚æœä½ å°†ä¸Šä¾‹ä¸­çš„æ¨¡å¼ä¿®æ­£ç¬¦så»æ‰çš„è¯ï¼ŒåŒ¹é…å°±ä¼šå¤±è´¥ã€‚å› ä¸ºæ¨¡å¼ä¿®æ­£ç¬¦så°†åŒ¹é…å­—ç¬¦ä¸²çœ‹ä½œæ˜¯å•è¡Œçš„ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ï¼Œå…ƒå­—ç¬¦ä¸­çš„â€.â€å°±å¯ä»¥è¡¨ç¤ºæ¢è¡Œç¬¦å·äº†ã€‚</p><h3><span id="3æ¨¡å¼ä¿®æ­£ç¬¦x">3ï¼Œæ¨¡å¼ä¿®æ­£ç¬¦xã€‚</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$pattern = â€˜/a c/xâ€™;</span><br><span class="line">$string = â€˜a câ€™;</span><br><span class="line">if (preg_match($pattern, $string, $arr)) &#123;</span><br><span class="line">echo â€œæ­£åˆ™è¡¨è¾¾å¼&lt;b&gt;&#123;$pattern&#125;&lt;/b&gt;å’Œå­—ç¬¦ä¸²&lt;b&gt;&#123;$string&#125;&lt;/b&gt;åŒ¹é…æˆåŠŸ&lt;br&gt;â€;</span><br><span class="line">print_r($arr);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">echo â€œ&lt;font color=â€™redâ€™&gt;æ­£åˆ™è¡¨è¾¾å¼&#123;$pattern&#125;å’Œå­—ç¬¦ä¸²&#123;$string&#125;åŒ¹é…å¤±è´¥&lt;/font&gt;â€;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¿™æ¬¡çš„åŒ¹é…ç»“æœæ˜¯å¤±è´¥çš„ã€‚å› ä¸ºæˆ‘ä»¬ä½¿ç”¨æ¨¡å¼ä¿®æ­£ç¬¦xå–æ¶ˆäº†æ¨¡å¼ä¸­çš„ç©ºæ ¼ã€‚æ³¨æ„ï¼šæˆ‘ä»¬æ— æ³•ä½¿ç”¨æ¨¡å¼ä¿®æ­£ç¬¦å–æ¶ˆ\sè¡¨ç¤ºçš„ç©ºç™½ã€‚</p><h3><span id="4æ¨¡å¼ä¿®æ­£ç¬¦a">4ï¼Œæ¨¡å¼ä¿®æ­£ç¬¦Aã€‚</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$pattern = â€˜/ac/Aâ€™;</span><br><span class="line">$string = â€˜acahgyghvbmâ€™;</span><br><span class="line">if (preg_match($pattern, $string, $arr)) &#123;</span><br><span class="line">echo â€œæ­£åˆ™è¡¨è¾¾å¼&lt;b&gt;&#123;$pattern&#125;&lt;/b&gt;å’Œå­—ç¬¦ä¸²&lt;b&gt;&#123;$string&#125;&lt;/b&gt;åŒ¹é…æˆåŠŸ&lt;br&gt;â€;</span><br><span class="line">print_r($arr);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">echo â€œ&lt;font color=â€™redâ€™&gt;æ­£åˆ™è¡¨è¾¾å¼&#123;$pattern&#125;å’Œå­—ç¬¦ä¸²&#123;$string&#125;åŒ¹é…å¤±è´¥&lt;/font&gt;â€;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ­£åˆ™è¡¨è¾¾å¼è¡¨ç¤ºçš„å«ä¹‰æ˜¯åŒ¹é…ä»¥acå¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œç»“æœæˆåŠŸã€‚</p><p>æ¨¡å¼ä¿®æ­£ç¬¦Zè¡¨ç¤ºçš„æ˜¯ä»¥å­—ç¬¦ä¸²ç»“å°¾çš„åŒ¹é…ï¼Œå’ŒAçš„ç”¨æ³•æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬ä¸å†è¿›è¡Œæ¼”ç¤ºã€‚</p><h3><span id="5æ¨¡å¼ä¿®æ­£ç¬¦u">5ï¼Œæ¨¡å¼ä¿®æ­£ç¬¦Uã€‚</span></h3><p>è¿™ä¸ªæ¨¡å¼ä¿®æ­£ç¬¦æ˜¯ååˆ†é‡è¦çš„!åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå…¶æœ¬èº«æ˜¯â€œè´ªå©ªâ€çš„ã€‚é‚£ä»€ä¹ˆæ˜¯è´ªå©ªæ¨¡å¼å‘¢?è´ªå©ªæ¨¡å¼çš„æ„æ€å°±æ˜¯è¯´ï¼Œæ­£åˆ™è¡¨è¾¾å¼é»˜è®¤ä¼šåœ¨æŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…åï¼Œç»§ç»­å°è¯•åé¢çš„åŒ¹é…ï¼Œå¦‚æœèƒ½æ‰¾åˆ°åŒ¹é…ï¼Œåˆ™åŒ¹é…æœ€å¤§çš„èŒƒå›´å­—ç¬¦ä¸²ã€‚ä½†æœ‰çš„æ—¶å€™è¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å–æ¶ˆè´ªå©ªæ¨¡å¼ã€‚</p><p>æˆ‘ä»¬è¿˜æ˜¯å…ˆçœ‹ä¸€ä¸ªè´ªå©ªæ¨¡å¼çš„ä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$pattern = â€˜/&lt;b&gt;.*&lt;\/b&gt;/â€™;</span><br><span class="line">$string = â€˜&lt;b&gt;welcome&lt;/b&gt; &lt;b&gt;to&lt;/b&gt; &lt;b&gt;phpfuns&lt;/b&gt;â€™;</span><br><span class="line">if (preg_match($pattern, $string, $arr)) &#123;</span><br><span class="line">echo â€œæ­£åˆ™è¡¨è¾¾å¼&lt;b&gt;&#123;$pattern&#125;&lt;/b&gt;å’Œå­—ç¬¦ä¸²&lt;b&gt;&#123;$string&#125;&lt;/b&gt;åŒ¹é…æˆåŠŸ&lt;br&gt;â€;</span><br><span class="line">print_r($arr);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">echo â€œ&lt;font color=â€™redâ€™&gt;æ­£åˆ™è¡¨è¾¾å¼&#123;$pattern&#125;å’Œå­—ç¬¦ä¸²&#123;$string&#125;åŒ¹é…å¤±è´¥&lt;/font&gt;â€;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå®ä¾‹çš„æœ¬æ„æ˜¯åŒ¹é…welcomeï¼Œä½†æ˜¯ç»“æœå´åŒ¹é…äº†welcome to phpfunsæ•´ä¸ªå­—ç¬¦ä¸²(æ³¨æ„æˆ‘ä»¬çš„å­—ç¬¦ä¸²â€™welcome to phpfunsâ€™ï¼Œå…¶å¼€å¤´å’Œç»“å°¾æ­£å¥½æ„æˆäº†æ­£åˆ™è¡¨è¾¾å¼çš„æ¨¡å¼åŒ¹é…ï¼Œæ‰€ä»¥åŒ¹é…æˆåŠŸ)ï¼Œè¿™å°±æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„è´ªå©ªæ¨¡å¼ã€‚å½“ç„¶ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬è¦çš„ç»“æœã€‚</p><p>å–æ¶ˆè´ªå©ªæ¨¡å¼<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¨¡å¼ä¿®æ­£ç¬¦Uå’Œå…ƒå­—ç¬¦?ä¸¤ç§æ–¹å¼å–æ¶ˆæ­£åˆ™è¡¨è¾¾å¼çš„è´ªå©ªæ¨¡å¼ã€‚</p><p>æ¨¡å¼ä¿®æ­£ç¬¦Uå–æ¶ˆè´ªå©ªæ¨¡å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$pattern = â€˜/&lt;b&gt;.*&lt;\/b&gt;/Uâ€™;</span><br><span class="line">$string = â€˜&lt;b&gt;welcome&lt;/b&gt; &lt;b&gt;to&lt;/b&gt; &lt;b&gt;phpfuns&lt;/b&gt;â€™;</span><br><span class="line">if (preg_match($pattern, $string, $arr)) &#123;</span><br><span class="line">echo â€œæ­£åˆ™è¡¨è¾¾å¼&lt;b&gt;&#123;$pattern&#125;&lt;/b&gt;å’Œå­—ç¬¦ä¸²&lt;b&gt;&#123;$string&#125;&lt;/b&gt;åŒ¹é…æˆåŠŸ&lt;br&gt;â€;</span><br><span class="line">print_r($arr);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">echo â€œ&lt;font color=â€™redâ€™&gt;æ­£åˆ™è¡¨è¾¾å¼&#123;$pattern&#125;å’Œå­—ç¬¦ä¸²&#123;$string&#125;åŒ¹é…å¤±è´¥&lt;/font&gt;â€;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>å…ƒå­—ç¬¦?å–æ¶ˆè´ªå©ªæ¨¡å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$pattern = â€˜/&lt;b&gt;.*?&lt;\/b&gt;/â€™;</span><br><span class="line">$string = â€˜&lt;b&gt;welcome&lt;/b&gt; &lt;b&gt;to&lt;/b&gt; &lt;b&gt;phpfuns&lt;/b&gt;dsadsadasâ€™;</span><br><span class="line">if (preg_match($pattern, $string, $arr)) &#123;</span><br><span class="line">echo â€œæ­£åˆ™è¡¨è¾¾å¼&lt;b&gt;&#123;$pattern&#125;&lt;/b&gt;å’Œå­—ç¬¦ä¸²&lt;b&gt;&#123;$string&#125;&lt;/b&gt;åŒ¹é…æˆåŠŸ&lt;br&gt;â€;</span><br><span class="line">print_r($arr);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">echo â€œ&lt;font color=â€™redâ€™&gt;æ­£åˆ™è¡¨è¾¾å¼&#123;$pattern&#125;å’Œå­—ç¬¦ä¸²&#123;$string&#125;åŒ¹é…å¤±è´¥&lt;/font&gt;â€;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æ³¨æ„å…ƒå­—ç¬¦çš„ä½ç½®ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨â€œâ€ä¹‹å‰ç»“æŸè´ªå©ªæ¨¡å¼ï¼Œæ‰èƒ½è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„</p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å…³äº URL ä¸­åè®®çš„çœç•¥</title>
      <link href="/blog/2021/05/25/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86/%E5%85%B3%E4%BA%8E-URL-%E4%B8%AD%E5%8D%8F%E8%AE%AE%E7%9A%84%E7%9C%81%E7%95%A5/"/>
      <url>/blog/2021/05/25/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86/%E5%85%B3%E4%BA%8E-URL-%E4%B8%AD%E5%8D%8F%E8%AE%AE%E7%9A%84%E7%9C%81%E7%95%A5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>å‰å¤©çœ‹äº† Google HTML&#x2F;CSS ä»£ç é£æ ¼æŒ‡å—ï¼Œé‡Œé¢æœ‰å¾ˆå¤šå€¼å¾—å€Ÿé‰´çš„åœ°æ–¹ï¼Œä¹Ÿå­¦åˆ°äº†ä¸€äº›æ–°ä¸œè¥¿ï¼Œå…¶ä¸­ç¬¬ä¸€æ¡è¯´é“ï¼ŒHTML å’Œ CSS ä»£ç ä¸­å¼•ç”¨çš„å›¾ç‰‡ã€åª’ä½“ã€CSS å’Œ JS æ–‡ä»¶ä¸­çš„ URL éƒ½å¯ä»¥å»æ‰åè®®éƒ¨åˆ†ï¼ˆhttp: å’Œ https:ï¼‰ï¼Œæ¯”å¦‚</p><script src="http://www.google-analytics.com/ga.js" type="text/javascript"></script><script src="https://www.google-analytics.com/ga.js" type="text/javascript"></script><p>éƒ½å¯ä»¥æ¢æˆï¼š</p><script src="//www.google-analytics.com/ga.js" type="text/javascript"></script><p>åªè¦æ˜¯ä½¿ç”¨ httpã€https è¿™ä¸¤ç§åè®®éƒ½å¯ä»¥çœç•¥ã€‚åŸå› æ˜¯å¯ä»¥èŠ‚çœä¸€ç‚¹æ–‡ä»¶ä½“ç§¯ï¼ˆå½“ç„¶åªæ˜¯é‚£ä¹ˆä¸€ç‚¹ç‚¹ï¼‰ï¼Œå¦å¤–ä¸€ä¸ªåŸå›  Google è¯´æ˜¯å¯ä»¥è§£å†³æ··åˆå†…å®¹çš„é—®é¢˜ã€‚èµ·åˆæˆ‘å¯¹è¿™ä¸ªç¬¬äºŒç‚¹ä¸æ˜¯å¾ˆäº†è§£ï¼Œæ‰€ä»¥ç‰¹æ„æœç´¢äº†ä¸‹ã€‚æœ€åä» Paul Irish çš„ä¸€ç¯‡æ–‡ç« æ‰¾åˆ°ç­”æ¡ˆï¼Œé“¾æ¥åœ¨æ–‡åã€‚æ–‡ç« æ˜¯ä¸¤ä¸‰å¹´å‰å†™çš„ï¼Œè€å¤–ç ”ç©¶é—®é¢˜æ€»æ˜¯æ¯”æˆ‘ä»¬è¦æ—©å•Šã€‚</p><p>ä»¥ &#x2F;&#x2F; å¼€å¤´çš„å«åšç›¸å¯¹URLï¼ˆprotocol-relative URLï¼‰ï¼Œç›¸å…³çš„æ ‡å‡†å¯ä»¥çœ‹ RFC 3986 Section 4.2ï¼Œå†…å®¹ä¸æ˜¯ä¸€èˆ¬çš„é•¿ä¼°è®¡å¤§å®¶ä¹Ÿæ²¡è€å¿ƒå»çœ‹å§ã€‚æ€»ä¹‹æµè§ˆå™¨é‡åˆ°ç›¸å¯¹ URLï¼Œåˆ™ä¼šæ ¹æ®å½“å‰çš„ç½‘é¡µåè®®ï¼Œè‡ªåŠ¨åœ¨ &#x2F;&#x2F; å‰é¢åŠ ä¸Šç›¸åŒçš„åè®®ã€‚å¦‚å½“å‰ç½‘é¡µæ˜¯ http è®¿é—®ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„ç›¸å¯¹å¼•ç”¨ &#x2F;&#x2F; éƒ½ä¼šå˜æˆhttp:&#x2F;&#x2F;ã€‚https åŒç†ã€‚å¦‚æœä½ åœ¨æœ¬åœ°æŸ¥çœ‹ï¼Œåè®®å°±ä¼šå˜æˆ file:&#x2F;&#x2F;ã€‚</p><p>æ‰€ä»¥ï¼Œå¦‚æœçœç•¥åè®®ï¼Œå°±éœ€è¦ä¿è¯å¼•ç”¨çš„å¤–éƒ¨èµ„æºä¹Ÿé‡‡ç”¨å’Œç½‘é¡µç›¸åŒçš„åè®®ï¼Œæˆ–è€…ä¿è¯èµ„æºå¯ä»¥åŒæ—¶é€šè¿‡ http å’Œ https è®¿é—®ã€‚ç»è¿‡ StackOverflow ç½‘å‹æµ‹è¯•ï¼Œè¿™ç§ç”¨æ³•å‡ ä¹æ‰€æœ‰çš„æµè§ˆå™¨éƒ½èƒ½æ”¯æŒï¼Œåªæœ‰åœ¨ IE7&#x2F;8 ä¸‹ä¼šæœ‰ä¸€ç‚¹å°é—®é¢˜ï¼Œå°±æ˜¯é€šè¿‡ç›¸å¯¹ URL å¼•ç”¨çš„ CSS æ–‡ä»¶ï¼ˆæ— è®º <link> æˆ– @importï¼‰ä¼šè¢«ä¸‹è½½ä¸¤éã€‚æ‰€ä»¥å¯¹æ€§èƒ½æœ‰ä¸€ç‚¹å½±å“ã€‚</p><p>è‡³äº Google æåˆ°çš„æ··åˆå†…å®¹é—®é¢˜ï¼Œå…¶å®æ˜¯æŒ‡IEæœ‰æ—¶ä¼šå¼¹å‡ºçš„ä¸€ä¸ªè­¦å‘Šæ¡†ï¼š</p><p>è¿™ä¸ªæ¡†æƒ³å¿…å¤§å®¶ä¹Ÿéƒ½è§è¿‡ã€‚é€šå¸¸æ˜¯åœ¨æµè§ˆ https ç½‘é¡µçš„æ—¶å€™å‡ºç°ï¼ŒåŸå› æ˜¯ç½‘é¡µé‡Œå¼•ç”¨äº† http åè®®çš„å¤–éƒ¨èµ„æºï¼Œç”±äº http è¢«è®¤ä¸ºæ˜¯ä¸å®‰å…¨çš„ï¼ŒIE æ‰ä¼šç»™å‡ºæç¤ºã€‚å¦‚æœå¼•ç”¨çš„æ—¶å€™å†™æˆç›¸å¯¹ URLï¼Œæµè§ˆå™¨å°±ä¼šè‡ªåŠ¨é‡‡ç”¨ https åè®®ä¸‹è½½ï¼Œè¿™æ ·å°±è§£å†³äº†é—®é¢˜ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¹³æ—¶å†™ä»£ç è¿˜æ˜¯å¯ä»¥æ”¾å¿ƒä½¿ç”¨ç›¸å¯¹ URL çš„ï¼Œå†™åšå®¢çš„å¤§æ¦‚å¾ˆå°‘å¼€ httpsï¼Œå½“ç„¶åšé¡¹ç›®çš„å°±ä¾‹å¤–äº†ã€‚å¦‚æœä½ å¼•ç”¨çš„èµ„æºé‡Œæœ‰ https åè®®çš„å°±ç‰¹åˆ«å¤„ç†ä¸€ä¸‹ï¼Œæˆ–è€…åªè¦ http ä¹Ÿèƒ½è®¿é—®åˆ°èµ„æºå°±å¯ä»¥ã€‚æˆ‘çœ‹äº†ä¸‹å›½å†…çš„ç«™ç‚¹è¿™ä¹ˆç”¨çš„è¿˜ä¸å¤šï¼Œæœ‰ä¸€æ¬¡çœ‹åˆ°ç™¾åº¦éŸ³ä¹è¿™ä¹ˆç”¨è¿‡ã€‚ä¸è¿‡ Google å¾ˆå¤šç«™ç‚¹éƒ½å·²ç»æ˜¯è¿™æ ·çš„å†™æ³•äº†ã€‚</p><hr>> å‚è€ƒèµ„æ–™ï¼š<p><a href="http://paulirish.com/2010/the-protocol-relative-url/">http://paulirish.com/2010/the-protocol-relative-url/</a><br><a href="http://stackoverflow.com/questions/4831741/can-i-change-all-my-http-links-to-just">http://stackoverflow.com/questions/4831741/can-i-change-all-my-http-links-to-just</a><br><a href="https://developer.mozilla.org/zh-CN/">https://developer.mozilla.org/zh-CN/</a></p><blockquote><p>è½¬è½½ è‡ªï¼š<a href="http://pandacafe.net/post/231?huvqlc=r5eup1">http://pandacafe.net/post/231?huvqlc=r5eup1</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯çŸ¥è¯† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> http:// </tag>
            
            <tag> https:// </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤©æ°”æ™´-2021-5-20</title>
      <link href="/blog/2021/05/20/%E6%88%91%E7%9A%84%E6%97%A5%E8%AE%B0/%E5%A4%A9%E6%B0%94%E6%99%B4-2021-5-20/"/>
      <url>/blog/2021/05/20/%E6%88%91%E7%9A%84%E6%97%A5%E8%AE%B0/%E5%A4%A9%E6%B0%94%E6%99%B4-2021-5-20/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h3><span id="ä»Šå¤©æ˜¯2021å¹´5æœˆ20æ—¥æ˜¯ä¸ªå¥½æ—¥å­">ä»Šå¤©æ˜¯2021å¹´5æœˆ20æ—¥ï¼Œæ˜¯ä¸ªå¥½æ—¥å­</span></h3><p> æ—©ä¸Šæ‰“å¼€ç”µè„‘ æ’‡äº†ä¸‹å³ä¸‹è§’çš„ç”µè„‘ï¼Œæ˜¯2021&#x2F;5&#x2F;20 å—¯æ˜¯ä¸ªå‰åˆ©çš„æ•°å­—</p>]]></content>
      
      
      <categories>
          
          <category> diary </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç™¾å¹´å­¤ç‹¬</title>
      <link href="/blog/2021/05/18/%E7%BB%8F%E5%85%B8%E8%AF%BB%E7%89%A9/%E7%BB%8F%E5%85%B8%E8%AF%BB%E7%89%A9/"/>
      <url>/blog/2021/05/18/%E7%BB%8F%E5%85%B8%E8%AF%BB%E7%89%A9/%E7%BB%8F%E5%85%B8%E8%AF%BB%E7%89%A9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><blockquote><h3><span id="å®¶æ—çš„ç¬¬ä¸€ä¸ªäººè¢«æ†åœ¨æ ‘ä¸Šæœ€åä¸€ä¸ªäººæ­£è¢«èš‚èšåƒæ‰">å®¶æ—çš„ç¬¬ä¸€ä¸ªäººè¢«æ†åœ¨æ ‘ä¸Šï¼Œæœ€åä¸€ä¸ªäººæ­£è¢«èš‚èšåƒæ‰</span></h3></blockquote><ul><li>è¿™æœ¬ä¹¦åˆ°åº•è®²äº†ä»€ä¹ˆï¼Ÿä½œè€…æƒ³è¡¨è¾¾ä»€ä¹ˆï¼Ÿè‡ªå·±æœ‰äº†ä»€ä¹ˆæ ·çš„æ„Ÿè§¦<hr></li></ul><h3><span id="ç»å…¸è¯­å¥">ç»å…¸è¯­å¥</span></h3><p>1ã€å¤šå¹´ä»¥åï¼Œå¥¥é›·è¿è¯ºä¸Šæ ¡ç«™åœ¨è¡Œåˆ‘é˜Ÿé¢å‰ï¼Œå‡†ä¼šæƒ³èµ·çˆ¶äº²å¸¦ä»–å»å‚è§‚å†°å—çš„é‚£ä¸ªé¥è¿œçš„ä¸‹åˆã€‚</p><p>2ã€ è¿‡å»éƒ½æ˜¯å‡çš„ï¼Œå›å¿†æ˜¯ä¸€æ¡æ²¡æœ‰å½’é€”çš„è·¯ï¼Œä»¥å¾€çš„ä¸€åˆ‡æ˜¥å¤©éƒ½æ— æ³•å¤åŸï¼Œå³ä½¿æœ€ç‹‚çƒ­æœ€åšè´çš„çˆ±æƒ…ï¼Œå½’æ ¹ç»“åº•ä¹Ÿä¸è¿‡æ˜¯ä¸€ç§ç¬æ¯å³é€çš„ç°å®ï¼Œå”¯æœ‰å­¤ç‹¬æ°¸æ’ã€‚</p><p>3ã€ä¹°ä¸‹ä¸€å¼ æ°¸ä¹…è½¦ç¥¨ï¼Œç™»ä¸Šä¸€åˆ—æ°¸æ— ç»ˆç‚¹çš„ç«è½¦ã€‚</p><p>4ã€æˆ‘ä»¬è¶‹è¡Œåœ¨äººç”Ÿè¿™ä¸ªäº˜å¤çš„æ—…é€”ï¼Œåœ¨åå·ä¸­å¥”è·‘ï¼Œåœ¨æŒ«æŠ˜é‡Œæ¶…æ§ƒï¼Œå¿§æ„ç¼ æ»¡å…¨èº«ï¼Œç—›è‹¦é£˜æ´’ä¸€åœ°ã€‚æˆ‘ä»¬ç´¯ï¼Œå´æ— ä»æ­¢æ­‡ï¼›æˆ‘ä»¬è‹¦ï¼Œå´æ— æ³•å›é¿ã€‚</p><p>5ã€ç”Ÿå‘½ä¸­çœŸæ­£é‡è¦çš„ä¸æ˜¯ä½ é­é‡äº†ä»€ä¹ˆï¼Œè€Œæ˜¯ä½ è®°ä½äº†å“ªäº›äº‹ï¼Œåˆæ˜¯å¦‚ä½•é“­è®°çš„ã€‚</p><p>6ã€æˆ‘ç¡®å®ä¸€åº¦æ­»å»ï¼Œä½†éš¾ä»¥å¿å—å­¤ç‹¬åˆé‡è¿”äººä¸–ã€‚</p><p>7ã€ä»–æ¸´æœ›å­¤ç‹¬ï¼Œå¯¹æ•´ä¸ªä¸–ç•Œçš„æ€¨æ¨å’¬å™¬ç€ä»–çš„å†…å¿ƒã€‚</p><p>8ã€æˆ‘ä»¬è¶‹è¡Œåœ¨äººç”Ÿè¿™ä¸ªäº˜å¤çš„æ—…é€”ï¼Œåœ¨åå·ä¸­å¥”è·‘ï¼Œåœ¨æŒ«æŠ˜é‡Œæ¶…æ§ƒï¼Œå¿§æ„ç¼ æ»¡å…¨èº«ï¼Œç—›è‹¦é£˜æ´’ä¸€åœ°ã€‚æˆ‘ä»¬ç´¯ï¼Œå´æ— ä»æ­¢æ­‡ï¼›æˆ‘ä»¬è‹¦ï¼Œå´æ— æ³•å›é¿ã€‚</p><p>9ã€æ‰€æœ‰äººéƒ½æ˜¾å¾—å¾ˆå¯‚å¯ï¼Œç”¨è‡ªå·±çš„æ–¹å¼æƒ³å°½åŠæ³•æ’é£å¯‚å¯ï¼Œäº‹å®ä¸Šä»æ˜¯å»¶ç»­è‡ªå·±çš„å¯‚å¯ã€‚å¯‚å¯æ˜¯é€ åŒ–å¯¹ç¾¤å±…è€…çš„è¯…å’’ï¼Œå­¤ç‹¬æ‰æ˜¯å¯‚å¯çš„å”¯ä¸€å‡ºå£ã€‚</p><p>10ã€è¿™æ‰‹ç¨¿ä¸Šæ‰€å†™çš„äº‹æƒ…è¿‡å»ä¸æ›¾ï¼Œå°†æ¥ä¹Ÿæ°¸è¿œä¸ä¼šé‡å¤ï¼Œå› ä¸ºå‘½ä¸­æ³¨å®šè¦ä¸€ç™¾å¹´å¤„äºå­¤ç‹¬çš„ä¸–å®¶å†³ä¸ä¼šæœ‰å‡ºç°åœ¨ä¸–ä¸Šçš„ç¬¬äºŒæ¬¡æœºä¼šã€‚</p><h3><span id="ç™¾å¹´å­¤ç‹¬è®²è¿°äº†ä»€ä¹ˆ">ç™¾å¹´å­¤ç‹¬è®²è¿°äº†ä»€ä¹ˆ</span></h3><p>ã€Šç™¾å¹´å­¤ç‹¬ã€‹è®²çš„æ˜¯ä¸€ä¸ªå«å¸ƒæ©è¿ªäºšå®¶æ—ç™¾å¹´çš„å…´è¡°ä»¥åŠå°é•‡é©¬å­”å¤šçš„å‘å±•å˜è¿å²ã€‚</p><p>å¸ƒæ©è¿ªäºšå®¶æ—çš„æ¯ä¸€ä»£äººéƒ½åœ¨åŠªåŠ›åœ°æ‘†è„±å­¤ç‹¬è½åçš„ç”Ÿæ´»çŠ¶æ€ï¼Œä½†æ˜¯å´ä¸€æ¬¡åˆä¸€æ¬¡çš„å¤±è´¥ï¼Œæœ€ç»ˆï¼Œå®¶æ—çš„æœ€åä¸€ä¸ªäººè¢«èš‚èšåƒæ‰ï¼Œæ•´ä¸ªå±‹å­ä¹Ÿè¢«é£å·èµ°ï¼Œä»æ­¤æ¶ˆå¤±åœ¨åœ°çƒä¸Šï¼Œå†æœªå‡ºç°ã€‚</p><p>å­¤ç‹¬ä¼šè®©äººä¸§å¤±å¯¹ç”Ÿæ´»çš„å¸Œæœ›ã€‚æ²¡æœ‰äººå–œæ¬¢å­¤ç‹¬ï¼Œå¸ƒæ©è¿ªäºšå®¶æ—çš„äººä»˜å‡ºäº†ä¸€è¾ˆåˆä¸€è¾ˆçš„åŠªåŠ›ï¼Œå´ä¾ç„¶æ˜¯ä¸€åœºç©ºï¼Œä¹¦ä¹Ÿè¡¨ç°äº†äººç±»çš„æŠ—äº‰ï¼Œå¯¹å‘½è¿çš„æ— å¯å¥ˆä½•ä»¥åŠå¤©æ€§çš„é¡½å›ºã€‚</p><h3><span id="ç™¾å¹´å­¤ç‹¬åæ€">ç™¾å¹´å­¤ç‹¬åæ€</span></h3><p>ã€Šç™¾å¹´å­¤ç‹¬ã€‹æ˜¯å“¥ä¼¦æ¯”äºšä½œå®¶åŠ è¥¿äºšÂ·é©¬å°”å…‹æ–¯çš„ä¸€éƒ¨é•¿ç¯‡å°è¯´</p><p>ç™¾å¹´å­¤ç‹¬æ¯”è¾ƒé€‚åˆ25å²ä»¥ä¸Šï¼Œç»å†è¿‡ç¤¾ä¼šçš„äººçœ‹ã€‚è¿™æ ·æ‰èƒ½è¯»å‡ºéŸµå‘³çš„ã€‚</p><p>è¯´åˆ°åº•ã€Šç™¾å¹´å­¤ç‹¬ã€‹å¥½åœ¨å®ƒçš„æ–°é¢–ï¼Œä¸ä»…è®©äººä»¬çœ‹åˆ°ä¸€ä¸ªä¸ä¸€æ ·çš„æ•…äº‹ï¼Œä¹Ÿè®©äººçœ‹åˆ°äº†å°è¯´ä¸ä¸€æ ·çš„è¡¨ç°æ‰‹ï¼Œè€Œä¸”è¿™ç§ä¸ä¸€æ ·çš„è¡¨ç°æ‰‹æ³•ï¼Œè¢«å›½å†…è®¸å¤šçš„ä½œå®¶æ‰€å€Ÿé‰´å¼•ç”¨ã€‚è¿™ä¹Ÿå°±æ˜¯ã€Šç™¾å¹´å­¤ç‹¬ã€‹çš„å¥½å¤„ã€‚</p><p>å¯ä»¥ä¸å®¢æ°”åœ°è¯´ï¼Œã€Šç™¾å¹´å­¤ç‹¬ã€‹å½±å“äº†ä¸­å›½å½“ä»£æ–‡å­¦çš„èµ°å‘ï¼Œå›½å†…è®¸å¤šçš„ä½œå®¶ï¼Œæ­£æ˜¯ç”±äºçœ‹äº†è¿™æœ¬å°è¯´ä¹‹åï¼Œæ‰å¼€å§‹å†™å‡ºäº†è‡ªå·±æœ€ä¸ºé‡è¦çš„ä½œå“ï¼Œä¾‹å¦‚è«è¨€ã€é™ˆå¿ å®ã€ä½™åã€é˜è¿ç§‘ç­‰ç­‰ï¼Œè¿™äº›å›½å†…ä¸€çº¿ä½œå®¶ï¼Œé‚£éƒ½æ˜¯å—åˆ°äº†ã€Šç™¾å¹´å­¤ç‹¬ã€‹çš„å½±å“ï¼Œä»–ä»¬çš„ä½œå“é‡Œï¼Œéƒ½æœ‰ç€ã€Šç™¾å¹´å­¤ç‹¬ã€‹çš„å½±å­ã€‚ä¹Ÿæ­£æ˜¯è¿™ä¸€ä»½å½±å“ï¼Œä½¿å¾—å®ƒåœ¨å›½äººå¿ƒç›®ä¸­ï¼Œæœ‰ç€å´‡é«˜çš„åœ°ä½ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>git ä½¿ç”¨ connot stat</title>
      <link href="/blog/2021/05/17/GIT/cannot%20stat/"/>
      <url>/blog/2021/05/17/GIT/cannot%20stat/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>1.è®°ä¸€æ¬¡ä½¿ç”¨bug<br><img src="http://s2-cdn.oneitfarm.com/c71c1444ef7b472fbad9c71ba803fa95.png"><br>git error: cannot stat<br>åŸå› æ˜¯å› ä¸ºï¼Œåœ¨æŸä¸ªç¼–è¾‘å™¨æ‰“å¼€äº†masteråˆ†æ”¯çš„ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶ååˆ‡æ¢åˆ°featåˆ†æ”¯ï¼Œæ–‡ä»¶å¹¶ä¸æ¶ˆå¤±ï¼Œæ‹‰å–æ—¶å€™å‡ºç°é—®é¢˜ï¼Œ</p><p>è§£å†³åŠæ³•ï¼šå…³æ‰ç¼–è¾‘å™¨</p>]]></content>
      
      
      <categories>
          
          <category> git </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>GOLANG-æ”¹å–„golang50ä¸ªæœ‰æ•ˆå®è·µ</title>
      <link href="/blog/2021/05/14/GOLANG/GOLANG-%E7%AC%94%E8%AE%B010-%E6%94%B9%E5%96%84golang50%E4%B8%AA%E6%9C%89%E6%95%88%E5%AE%9E%E8%B7%B5/"/>
      <url>/blog/2021/05/14/GOLANG/GOLANG-%E7%AC%94%E8%AE%B010-%E6%94%B9%E5%96%84golang50%E4%B8%AA%E6%9C%89%E6%95%88%E5%AE%9E%E8%B7%B5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><blockquote><p>é—²é€›å¥½ä¹…goè®ºå›ï¼Œæ‰¾åˆ°ä¸€æœ¬é€‚åˆçœ‹çš„æ•™ç¨‹ï¼ŒèŠ±äº†ç‚¹æ—¶é—´å°†è¿™ä¸ªæ–‡ç« æ¬è¿è¿‡æ¥ï¼Œè‡ªå·±æ…¢æ…¢ç ”è¯»</p></blockquote><h4><span id="1-è¯­è¨€çš„å‰ç”Ÿä»Šä¸–">1 </span></h4><h4><span id="2-è¯­è¨€çš„è®¾è®¡å“²å­¦ä¹‹ä¸€ç®€å•">2 </span></h4><h4><span id="3-è¯­è¨€çš„è®¾è®¡å“²å­¦ä¹‹äºŒç»„åˆ">3  </span></h4><h4><span id="4-goè¯­è¨€çš„è®¾è®¡å“²å­¦ä¹‹ä¸‰å¹¶å‘">4  </span></h4><h4><span id="5-go-è¯­è¨€çš„è®¾è®¡å“²å­¦ä¹‹å››é¢å‘å·¥ç¨‹">5  </span></h4><h4><span id="6-å‚è€ƒ-go-é¡¹ç›®å¸ƒå±€è®¾è®¡ä½ çš„é¡¹ç›®ç»“æ„">6  </span></h4><h4><span id="7-gofmtgoä»£ç é£æ ¼çš„å”¯ä¸€æ ‡å‡†">7  </span></h4><h4><span id="8-go-æ ‡è¯†ç¬¦çš„å‘½åæƒ¯ä¾‹">8  </span></h4><h4><span id="9-å˜é‡å£°æ˜å½¢å¼å°½é‡ä¿æŒä¸€è‡´">9  </span></h4><h4><span id="10-æ— ç±»å‹å¸¸é‡è®©ä»£ç æ›´ç®€åŒ–">10  </span></h4><h4><span id="11-goæšä¸¾å¸¸é‡çš„æƒ¯ç”¨å®ç°æ–¹æ³•">11  </span></h4><h4><span id="12-å®šä¹‰é›¶å€¼å¯ç”¨çš„ç±»å‹">12  </span></h4><h4><span id="13-ç”¨å¤åˆå­—é¢å€¼ä½œåˆå€¼æ„é€ å™¨">13  </span></h4><h4><span id="14-æ·±å…¥ç†è§£å’Œé«˜æ•ˆè¿ç”¨åˆ‡ç‰‡slice">14  </span></h4><h4><span id="15-æ³¨æ„go-å­—ç¬¦ä¸²æ˜¯åŸç”Ÿç±»å‹">15  </span></h4><h4><span id="16-ç†è§£åŒ…å¯¼å…¥è·¯å¾„çš„å«ä¹‰">16  </span></h4><h4><span id="17-init-å‡½æ•°çš„å¦™ç”¨">17  </span></h4><h4><span id="18-go-å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘">18  </span></h4><h4><span id="19-defer-è®©ä½ çš„ä»£ç æ›´æ¸…">19  </span></h4><h4><span id="20-æ–¹æ³•çš„æœ¬è´¨">20  </span></h4><h4><span id="21-æ–¹æ³•é›†åˆå†³å®šæ¥å£å®ç°">21  </span></h4><h4><span id="22-å˜é•¿å‚æ•°å‡½æ•°çš„å¦™ç”¨">22  </span></h4><hr>è½¬è½½è‡ªæ…•è¯¾èµ„æºï¼Œä»…ä¾›å­¦ä¹ ä½¿ç”¨ï¼Œå¦‚æœ‰ä¾µæƒè”ç³»è‡ªè¡Œåˆ é™¤]]></content>
      
      
      <categories>
          
          <category> GOLANG </category>
          
      </categories>
      
      
        <tags>
            
            <tag> golang </tag>
            
            <tag> ä¹¦ç± </tag>
            
            <tag> æ¨è </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…¶ä»–-è½¯ä»¶è¡Œä¸šé«˜é¢‘å•è¯</title>
      <link href="/blog/2021/05/14/Wiki/%E5%85%B6%E4%BB%96-%E8%BD%AF%E4%BB%B6%E8%A1%8C%E4%B8%9A%E9%AB%98%E9%A2%91%E5%8D%95%E8%AF%8D/"/>
      <url>/blog/2021/05/14/Wiki/%E5%85%B6%E4%BB%96-%E8%BD%AF%E4%BB%B6%E8%A1%8C%E4%B8%9A%E9%AB%98%E9%A2%91%E5%8D%95%E8%AF%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h3><span id="1golangé«˜é¢‘è‹±è¯­">1.golangé«˜é¢‘è‹±è¯­</span></h3><p><strong>å¹¶å‘</strong>ï¼š(Concurrency) [kÉ™nËˆkÊŒrÉ™nsÉª] </p><p><strong>å¹¶è¡Œ</strong>ï¼š(Parallelism) [ËˆpÃ¦rÉ™lelÉªzÉ™m]  </p><p><strong>æ‘©å°”å®šå¾‹</strong>ï¼š(Mooreâ€™s Law):é›†æˆç”µè·¯ä¸Šå¯ä»¥å®¹çº³çš„æ™¶ä½“ç®¡æ•°ç›®åœ¨å¤§çº¦æ¯ç»è¿‡18ä¸ªæœˆä¾¿ä¼šå¢åŠ ä¸€å€ã€‚æ¢è¨€ä¹‹ï¼Œå¤„ç†å™¨çš„æ€§èƒ½æ¯éš”ä¸¤å¹´ç¿»ä¸€å€</p><p><strong>cupä¸»é¢‘</strong>ï¼šï¼ˆCPU Clock Speedï¼‰:ä¸»é¢‘å³CPUçš„æ—¶é’Ÿé¢‘ç‡ï¼Œè®¡ç®—æœºçš„æ“ä½œåœ¨æ—¶é’Ÿä¿¡å·çš„æ§åˆ¶ä¸‹åˆ†æ­¥æ‰§è¡Œï¼Œæ¯ä¸ªæ—¶é’Ÿä¿¡å·å‘¨æœŸå®Œæˆä¸€æ­¥æ“ä½œï¼Œæ—¶é’Ÿé¢‘ç‡çš„é«˜ä½åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šåæ˜ äº†CPUé€Ÿåº¦çš„å¿«æ…¢</p><p><strong>æ—¶é’Ÿé¢‘ç‡</strong>ï¼š(clock rate):æ˜¯æŒ‡åŒæ­¥ç”µè·¯ä¸­æ—¶é’Ÿçš„åŸºç¡€é¢‘ç‡ï¼Œå®ƒä»¥â€œè‹¥å¹²æ¬¡å‘¨æœŸæ¯ç§’â€æ¥åº¦é‡ï¼Œé‡åº¦å•ä½é‡‡ç”¨SIå•ä½èµ«å…¹ï¼ˆHzï¼‰ã€‚å®ƒæ˜¯è¯„å®šCPUæ€§èƒ½çš„é‡è¦æŒ‡æ ‡ã€‚ä¸€èˆ¬æ¥è¯´ä¸»é¢‘æ•°å­—å€¼è¶Šå¤§è¶Šå¥½ã€‚å¤–é¢‘ï¼Œæ˜¯CPUå¤–éƒ¨çš„å·¥ä½œé¢‘ç‡ï¼Œæ˜¯ç”±ä¸»æ¿æä¾›çš„åŸºå‡†æ—¶é’Ÿé¢‘ç‡ã€‚FSBé¢‘ç‡ï¼Œæ˜¯è¿æ¥CPUå’Œä¸»æ¿èŠ¯ç‰‡ç»„ä¸­çš„åŒ—æ¡¥èŠ¯ç‰‡çš„å‰ç«¯æ€»çº¿ï¼ˆFront Side Busï¼‰ä¸Šçš„æ•°æ®ä¼ è¾“é¢‘ç‡ã€‚CPUçš„ä¸»é¢‘å’Œå¤–é¢‘é—´å­˜åœ¨è¿™æ ·çš„å…³ç³»ï¼šä¸»é¢‘&#x3D;å¤–é¢‘Ã—å€é¢‘ã€‚</p><p><strong>pthread</strong>ï¼š (çº¿ç¨‹)<br><strong>kernel</strong> ï¼šï¼ˆæ ¸å¿ƒï¼‰</p><p>å¥½çš„å‘½åå°±åƒä¸€ä¸ªå¥½ç¬‘è¯ã€‚å¦‚æœä½ å¿…é¡»è§£é‡Šå®ƒï¼Œé‚£å°±ä¸å¥½ç¬‘äº†</p><p><strong>åœ¨ Go è¯­è¨€ä¸­ interface åå­—ä»ç„¶ä»¥å•ä¸ªè¯ä¸ºä¼˜å…ˆã€‚å¯¹äºæ‹¥æœ‰å”¯ä¸€æ–¹æ³• (method) æˆ–é€šè¿‡å¤šä¸ªæ‹¥æœ‰å”¯ä¸€æ–¹æ³•çš„æ¥å£ç»„åˆè€Œæˆçš„æ¥å£ï¼ŒGo è¯­è¨€çš„æƒ¯ä¾‹æ˜¯ä¸€èˆ¬ç”¨ â€œæ–¹æ³•å + erâ€ çš„æ–¹å¼ä¸º interface å‘½å</strong><br><strong>coined</strong>ï¼šåˆ›é€ <br><strong>Syntax</strong>: è¯­æ³•<br><strong>Semantics</strong>: è¯­æ„</p><p>Go è®¾è®¡è€…è®¤ä¸ºéšå¼è½¬æ¢å¸¦æ¥çš„ä¾¿åˆ©æ€§ä¸è¶³ä»¥æŠµæ¶ˆå…¶å¸¦æ¥çš„è¯¸å¤šé—®é¢˜ 1ï¼Œå› æ­¤è¦è§£å†³ä¸Šé¢çš„ç¼–è¯‘é”™è¯¯ï¼Œæˆ‘ä»¬å¿…é¡»è¿›è¡Œæ˜¾å¼åœ°è½¬å‹ï¼š</p>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-æ¦‚è¿°ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨è®¾è®¡æ¨¡å¼</title>
      <link href="/blog/2021/05/13/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E6%A6%82%E8%BF%B0%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
      <url>/blog/2021/05/13/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E6%A6%82%E8%BF%B0%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h3><span id="è®¾è®¡æ¨¡å¼design-pattern">è®¾è®¡æ¨¡å¼ï¼ˆDesign patternï¼‰</span></h3><blockquote><p>GOF(gong of for)å¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶å…ƒç´ </p></blockquote><ul><li>å¯¹æ¥å£ç¼–ç¨‹è€Œä¸æ˜¯å¯¹å®ç°ç¼–ç¨‹</li><li>ä¼˜å…ˆä½¿ç”¨å¯¹è±¡ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿</li></ul><h3><span id="è®¾è®¡æ¨¡å¼çš„ç±»å‹23ç§">è®¾è®¡æ¨¡å¼çš„ç±»å‹ï¼ˆ23ç§ï¼‰</span></h3><p>åŸºæœ¬å¯ä»¥åˆ†ä¸ºå››å¤§ç±»ï¼š</p><ul><li>åˆ›å»ºå‹æ¨¡å¼ï¼ˆCreational Patternsï¼‰<br>æä¾›ä¸€ç§åœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™éšè—é€»è¾‘æ–¹æ³•çš„å½¢å¼ï¼Œè€Œä¸æ˜¯ç›´æ¥newä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä½¿å¾—ç¨‹åºåœ¨åˆ¤æ–­é’ˆå¯¹æŸä¸ªç‰¹å®šçš„å®ä¾‹éœ€è¦åˆ›å»ºå“ªäº›å¯¹è±¡çš„æ—¶å€™æ›´åŠ çµæ´»ã€‚</li><li>ç»“æ„å‹æ¨¡å¼ (Structural Patterns)<br>å…³æ³¨ç±»å’Œå¯¹è±¡ç»„åˆï¼Œé›†æˆçš„æ¦‚å¿µç”¨æ¥ç»„åˆæ¥å£å’Œå®šä¹‰ç»„åˆå¯¹è±¡ è·å–æ–°çš„åŠŸèƒ½æ–¹å¼</li><li>è¡Œä¸ºå‹æ¨¡å¼ (Behavioral Patterns)<br>å…³æ³¨å¯¹è±¡ä¹‹é—´çš„é€šä¿¡</li><li>j2EEæ¨¡å¼<br>è¿™äº›æ¨¡å¼ä¸»è¦ç”±java ä¸­çš„è®¾è®¡æ¨¡å¼æä¾›ï¼ˆSun Java Centerï¼‰</li></ul><table><thead><tr><th align="left"></th><th>æ¨¡å¼æè¿°</th><th align="center">åŒ…æ‹¬</th></tr></thead><tbody><tr><td align="left">1</td><td>åˆ›å»ºå‹æ¨¡å¼</td><td align="center">å·¥å‚æ¨¡å¼ï¼ˆFactory Patternï¼‰ æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factory Patternï¼‰ å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰ å»ºé€ è€…æ¨¡å¼ï¼ˆBuilder Patternï¼‰ åŸå‹æ¨¡å¼ï¼ˆPrototype Patternï¼‰</td></tr><tr><td align="left">2</td><td>ç»“æ„å‹æ¨¡å¼</td><td align="center">é€‚é…å™¨æ¨¡å¼ï¼ˆAdapter Patternï¼‰ æ¡¥æ¥æ¨¡å¼ï¼ˆBridge Patternï¼‰ è¿‡æ»¤å™¨æ¨¡å¼ï¼ˆFilterã€Criteria Patternï¼‰ ç»„åˆæ¨¡å¼ï¼ˆComposite Patternï¼‰ è£…é¥°å™¨æ¨¡å¼ï¼ˆDecorator Patternï¼‰ å¤–è§‚æ¨¡å¼ï¼ˆFacade Patternï¼‰ äº«å…ƒæ¨¡å¼ï¼ˆFlyweight Patternï¼‰ ä»£ç†æ¨¡å¼ï¼ˆProxy Patternï¼‰</td></tr><tr><td align="left">3</td><td>è¡Œä¸ºå‹æ¨¡å¼</td><td align="center">è´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰ å‘½ä»¤æ¨¡å¼ï¼ˆCommand Patternï¼‰ è§£é‡Šå™¨æ¨¡å¼ï¼ˆInterpreter Patternï¼‰ è¿­ä»£å™¨æ¨¡å¼ï¼ˆIterator Patternï¼‰ ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediator Patternï¼‰ å¤‡å¿˜å½•æ¨¡å¼ï¼ˆMemento Patternï¼‰ è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserver Patternï¼‰ çŠ¶æ€æ¨¡å¼ï¼ˆState Patternï¼‰ ç©ºå¯¹è±¡æ¨¡å¼ï¼ˆNull Object Patternï¼‰ ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰ æ¨¡æ¿æ¨¡å¼ï¼ˆTemplate Patternï¼‰ è®¿é—®è€…æ¨¡å¼ï¼ˆVisitor Patternï¼‰</td></tr><tr><td align="left">4</td><td>J2eeå‹æ¨¡å¼</td><td align="center">MVC æ¨¡å¼ï¼ˆMVC Patternï¼‰ ä¸šåŠ¡ä»£è¡¨æ¨¡å¼ï¼ˆBusiness Delegate Patternï¼‰ ç»„åˆå®ä½“æ¨¡å¼ï¼ˆComposite Entity Patternï¼‰ æ•°æ®è®¿é—®å¯¹è±¡æ¨¡å¼ï¼ˆData Access Object Patternï¼‰ å‰ç«¯æ§åˆ¶å™¨æ¨¡å¼ï¼ˆFront Controller Patternï¼‰ æ‹¦æˆªè¿‡æ»¤å™¨æ¨¡å¼ï¼ˆIntercepting Filter Patternï¼‰ æœåŠ¡å®šä½å™¨æ¨¡å¼ï¼ˆService Locator Patternï¼‰ ä¼ è¾“å¯¹è±¡æ¨¡å¼ï¼ˆTransfer Object Patternï¼‰</td></tr></tbody></table><h3><span id="è®¾è®¡æ¨¡å¼-ä¹‹é—´å…³ç³»">è®¾è®¡æ¨¡å¼ ä¹‹é—´å…³ç³»</span></h3><p><img src="https://www.runoob.com/wp-content/uploads/2014/08/the-relationship-between-design-patterns.jpg"></p><h3><span id="è®¾è®¡æ¨¡å¼çš„å…­å¤§åŸåˆ™">è®¾è®¡æ¨¡å¼çš„å…­å¤§åŸåˆ™</span></h3><ol><li><p>å¼€é—­åŸåˆ™ï¼ˆOpen Close Principleï¼‰:<br> <strong>å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­</strong> ï¼Œåœ¨ç¨‹åºéœ€è¦è¿›è¡Œæ‰©å±•çš„æ—¶å€™ï¼Œä¸èƒ½å»ä¿®æ”¹åŸä»£ç ï¼Œå®ç°ä¸€ä¸ªçƒ­æ‹”æ’çš„æ•ˆæœã€‚ä¸ºäº†çš„æ˜¯ä½¿ç¨‹åºçš„æ‰©å±•æ€§æ›´å¥½ï¼Œæ˜“äºç»´æŠ¤å’Œå‡çº§ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ¥å£å’ŒæŠ½è±¡ç±»æ¥å®ç°</p></li><li><p>é‡Œæ°ä»£æ¢åŸåˆ™ï¼ˆLiskow Substitution Pricipleï¼‰</p><p> ä»»ä½•åŸºç±»å‡ºç°çš„åœ°æ–¹ï¼Œå­ç±»ä¸€å®šå¯ä»¥å‡ºç°ã€‚LSPæ˜¯ç»§æ‰¿å¤ç”¨çš„åŸºçŸ³ï¼Œåªæœ‰å½“æ´¾ç”Ÿç±»å¯ä»¥æ›¿æ¢æ‰åŸºç±»ï¼Œä¸”è½¯ä»¶å•ä½ä¸å—å½±å“çš„æ—¶å€™ï¼ŒåŸºç±»æ‰èƒ½çœŸæ­£çš„è¢«é™„ä¸­ï¼Œè€Œæ´¾ç”Ÿç±»å¯ä»¥åœ¨åŸºç±»ä¸­å¢åŠ æ–°çš„è¡Œä¸ºï¼ŒLSPæ˜¯å¯¹å¼€é—­åŸåˆ™çš„è¡¥å……ã€‚å¼€é—­åŸåˆ™å…³é”®æ­¥éª¤å°±æ˜¯æŠ½è±¡åŒ–ï¼ŒåŸºç±»ä¸å­ç±»çš„ç»§æ‰¿å…³ç³»å°±æ˜¯æŠ½è±¡åŒ–çš„å…·ä½“å®ç°ï¼Œå³ï¼šå¯¹å®ç°æŠ½è±¡åŒ–å…·ä½“æ­¥éª¤çš„è§„èŒƒ</p></li><li><p>ä¾èµ–å€’è½¬åŸåˆ™ï¼ˆDependence Inversion Pricipleï¼‰</p><p> é’ˆå¯¹æ¥å£å˜æˆï¼Œä¾èµ–äºæŠ½è±¡è€Œä¸ä¾èµ–äºå…·ä½“</p></li><li><p>æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregation Pricipleï¼‰</p><p> å¤šå®ç”¨éš”ç¦»çš„æ¥å£ï¼Œæ¯”ä½¿ç”¨å•ä¸ªæ¥å£æ›´å¥½ã€‚é™ä½ç±»ä¹‹é—´çš„è€¦åˆåº¦ã€‚</p></li><li><p>è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆDemeter Pricipleï¼‰</p><p> æœ€å°‘çŸ¥é“çš„åŸåˆ™ï¼šä¸€ä¸ªå®ä½“åº”å½“å°½é‡å°‘è·Ÿå…¶ä»–å®ä½“ä¹‹é—´å‘ç”Ÿç›¸äº’çš„ä½œç”¨ï¼Œæ˜¯å¾—ç³»ç»Ÿæ¨¡å—ç›¸å¯¹</p></li><li><p>åˆæˆå¤ç”¨åŸåˆ™ï¼ˆcomposite Reuse Pricipleï¼‰</p><p> å°½é‡ä½¿ç”¨åˆæˆ&#x2F;èšåˆæ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç»§æ‰¿</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP-Phpfpmè¿›ç¨‹ç®¡ç†çš„ä¸‰ç§æ¨¡å¼</title>
      <link href="/blog/2021/05/10/PHP/PHP-Phpfpm%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86%E7%9A%84%E4%B8%89%E7%A7%8D%E6%A8%A1%E5%BC%8F/"/>
      <url>/blog/2021/05/10/PHP/PHP-Phpfpm%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86%E7%9A%84%E4%B8%89%E7%A7%8D%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PHP-Phpfmp-å¦‚ä½•åˆ†é…ä»»åŠ¡åˆ°å­è¿›ç¨‹çš„</title>
      <link href="/blog/2021/05/10/PHP/PHP-Phpfmp-%E5%A6%82%E4%BD%95%E5%88%86%E9%85%8D%E4%BB%BB%E5%8A%A1%E5%88%B0%E5%AD%90%E8%BF%9B%E7%A8%8B%E7%9A%84/"/>
      <url>/blog/2021/05/10/PHP/PHP-Phpfmp-%E5%A6%82%E4%BD%95%E5%88%86%E9%85%8D%E4%BB%BB%E5%8A%A1%E5%88%B0%E5%AD%90%E8%BF%9B%E7%A8%8B%E7%9A%84/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p><a href="https://blog.csdn.net/liuqun0319/article/details/92573976?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-2.vipsorttest&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-2.vipsorttest">https://blog.csdn.net/liuqun0319/article/details/92573976?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-2.vipsorttest&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-2.vipsorttest</a></p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>GOLANG-ç¬”è®°5-ginå¼€å‘è§„èŒƒ</title>
      <link href="/blog/2021/04/29/GOLANG/GOLANG-%E7%AC%94%E8%AE%B05-gin%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/"/>
      <url>/blog/2021/04/29/GOLANG/GOLANG-%E7%AC%94%E8%AE%B05-gin%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h2><span id="goè¯­è¨€webæ¡†æ¶åŸºçº¿ç‰ˆæœ¬">Goè¯­è¨€Webæ¡†æ¶åŸºçº¿ç‰ˆæœ¬</span></h2><h3><span id="ä¸€æ¡†æ¶ç®€ä»‹">ä¸€.æ¡†æ¶ç®€ä»‹</span></h3><p>æ­¤webæ¡†æ¶å·²ginä¸ºæ ¸å¿ƒï¼ŒåŒ…å«äº†mysqã€redisã€rabbitmqã€logã€esç­‰åŸºç¡€ç»„ä»¶ã€‚<br>æ­¤æ¡†æ¶å†…dockerfileå’Œmakefileå·²é€‚é…ä¸­å°çš„æ‰“é•œåƒæµç¨‹ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦å¯¹è¿™ä¸¤ä¸ªæ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ controller //æ§åˆ¶å™¨</span><br><span class="line">â”‚Â Â  â””â”€â”€ v1</span><br><span class="line">â”œâ”€â”€ dao //daoå±‚</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ mysql</span><br><span class="line">â”‚Â Â  â””â”€â”€ redis</span><br><span class="line">â”œâ”€â”€ db //mysqlæ–‡ä»¶åˆå§‹åŒ–</span><br><span class="line">â”œâ”€â”€ docs //swagger æ¥å£æ–‡æ¡£</span><br><span class="line">â”œâ”€â”€ middleware //ä¸­é—´ä»¶</span><br><span class="line">â”œâ”€â”€ model //modelå±‚</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ mapi</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ mdb</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ mmysql</span><br><span class="line">â”‚Â Â  â””â”€â”€ mparam</span><br><span class="line">â”œâ”€â”€ pconst //å¸¸é‡å®šä¹‰</span><br><span class="line">â”œâ”€â”€ route //è·¯ç”±å±‚</span><br><span class="line">â”‚Â Â  â””â”€â”€ v1</span><br><span class="line">â”œâ”€â”€ script //è„šæœ¬å±‚</span><br><span class="line">â”‚Â Â  â””â”€â”€ logic</span><br><span class="line">â”œâ”€â”€ server //æœåŠ¡å¯åŠ¨</span><br><span class="line">â”œâ”€â”€ service //ä¸šåŠ¡å±‚</span><br><span class="line">â”œâ”€â”€ tgo //åŸºç¡€ç»„ä»¶</span><br><span class="line">â””â”€â”€ util //å·¥å…·åŒ…</span><br><span class="line">    â”œâ”€â”€ curl</span><br><span class="line">    â””â”€â”€ ip</span><br></pre></td></tr></table></figure><h3><span id="äºŒæ¡†æ¶åˆ†å±‚">äºŒ.æ¡†æ¶åˆ†å±‚</span></h3><h4><span id="21è·¯ç”±å±‚">2.1.è·¯ç”±å±‚</span></h4><p>æ¡†æ¶é‡‡ç”¨å¼ºè·¯ç”±æ¨¡å¼ï¼Œæ”¯æŒè·¯ç”±ç¾¤ç»„ã€ä¸­é—´ä»¶æ¨¡å¼ï¼Œè‡ªå¸¦è·¨åŸŸç»„ä»¶å¹¶é»˜è®¤å¼€å¯ï¼Œè·¯ç”±æ–‡ä»¶å­˜æ”¾åœ¨ route ç›®å½•ä¸‹</p><h4><span id="22æ§åˆ¶å™¨å±‚">2.2.æ§åˆ¶å™¨å±‚</span></h4><p>æ§åˆ¶å™¨å­˜æ”¾åœ¨controllerç›®å½•ä¸‹ï¼Œå¹¶åŒºåˆ†ç‰ˆæœ¬ï¼Œæ­¤å±‚ä»…é’ˆå¯¹å‚æ•°è¿›è¡Œè¿‡æ»¤å¤„ç†ï¼Œä¸å¤„ç†ç›¸å…³ä¸šåŠ¡ã€‚å·²é›†æˆswaggerè‡ªåŠ¨ç”Ÿæˆæ¥å£æ–‡æ¡£</p><h4><span id="23ä¸šåŠ¡å±‚">2.3.ä¸šåŠ¡å±‚</span></h4><p>ä¸šåŠ¡å±‚å­˜æ”¾åœ¨serviceç›®å½•ä¸‹ï¼Œç”¨æ¥å¤„ç†ä¸šåŠ¡ç›¸å…³çš„é€»è¾‘</p><h4><span id="24æ•°æ®å¤„ç†å±‚">2.4.æ•°æ®å¤„ç†å±‚</span></h4><p>ä¸šåŠ¡å±‚å­˜æ”¾åœ¨daoç›®å½•ä¸‹ï¼Œå¹¶æ ¹æ®ä¸‹æ¸¸ä¸åŒæœåŠ¡æ”¾å…¥ä¸åŒç›®å½•ä¸‹ï¼Œæ­¤å±‚ä»…å¤„ç†æ•°æ®ï¼Œä¸å¤„ç†ä¸šåŠ¡ç›¸å…³é€»è¾‘</p><h4><span id="25å¯¹è±¡å±‚">2.5.å¯¹è±¡å±‚</span></h4><p>å¯¹è±¡å±‚å­˜æ”¾åœ¨modeç›®å½•ä¸‹ï¼Œå¹¶æ ¹æ®å¯¹è±¡çš„ä¸åŒç±»å‹å­˜æ”¾ä¸‹çº§ä¸åŒç›®å½•</p><h4><span id="26ä¸­é—´ä»¶å±‚">2.6.ä¸­é—´ä»¶å±‚</span></h4><p>ä¸­é—´ä»¶å±‚å­˜æ”¾åœ¨middlewareç›®å½•ä¸‹ï¼Œç”¨ä»¥å¯¹åŒä¸€åˆ†ç»„æˆ–å…·æœ‰ç›¸åŒç‰¹å¾çš„è·¯ç”±è¿›è¡Œå…¨å±€ä¸šåŠ¡å¤„ç†</p><h4><span id="27è„šæœ¬å±‚">2.7.è„šæœ¬å±‚</span></h4><p>è„šæœ¬å±‚å­˜æ”¾åœ¨scriptç›®å½•ä¸‹ï¼Œç”¨ä»¥å¤„ç†éhttpç±»å‹çš„ä¸šåŠ¡ç±»å‹</p><h4><span id="28å¸¸é‡å±‚">2.8.å¸¸é‡å±‚</span></h4><p>å¸¸é‡å®šä¹‰å­˜æ”¾åœ¨pconstç›®å½•ä¸‹</p><h3><span id="ä¸‰æ•´ä½“æµç¨‹">ä¸‰.æ•´ä½“æµç¨‹</span></h3><p>æ¡†æ¶æ•´ä½“è¯·æ±‚è¯·æ±‚æµç¨‹ä¸ºroute - middleware - controller - service - daoï¼Œæ§åˆ¶å™¨ã€ä¸šåŠ¡ã€æ•°æ®å¤„ç†ç¦æ­¢é€†å‘è°ƒç”¨</p><h3><span id="å››è¯·æ±‚ç¤ºä¾‹">å››.è¯·æ±‚ç¤ºä¾‹</span></h3><p>å‚è€ƒæ§åˆ¶å™¨ä¸‹ log_platform.go æ–‡ä»¶</p><h3><span id="äº”ä¸­å°æœåŠ¡é—´è°ƒç”¨">äº”.ä¸­å°æœåŠ¡é—´è°ƒç”¨</span></h3><blockquote><p>gosdkä½¿ç”¨å’ŒæœåŠ¡é—´è°ƒç”¨æœ‰é—®é¢˜å’Œå»ºè®®å¯ä»¥è”ç³»è”ç³»åŸºç¡€æ¶æ„éƒ¨ï¼šå¼ è¶…</p></blockquote><p>ä¸­å°æœåŠ¡é—´è°ƒç”¨é€šè¿‡<a href="https://gitlab.oneitfarm.com/bifrost/gosdk">gosdk</a>è¿›è¡Œè°ƒç”¨ï¼Œgosdkå¦‚ä½•ä½¿ç”¨å¯ä»¥å‚è€ƒæœåŠ¡å†…çš„readmeæ–‡æ¡£ã€‚ </p><p>ä¸ºäº†é™ä½ä½¿ç”¨æˆæœ¬ï¼Œæˆ‘ä»¬å¯¹gosdkè¿›è¡Œäº†ä¸€æ¬¡å°è£…<a href="https://gitlab.oneitfarm.com/ci123sdk/requester">requester</a>åŒ…ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªæ¡ˆä¾‹<a href="https://gitlab.oneitfarm.com/ci123sdk/account">account</a>æœåŠ¡çš„æ¥å£å°è£…ã€‚</p><p>ã€å¼ºçƒˆå»ºè®®ã€‘ï¼šå¯¹å­æœåŠ¡ï¼ˆæ¯”å¦‚Aï¼‰çš„è°ƒç”¨å°è£…æˆå•ç‹¬çš„åŒ…ï¼Œå¹¶åœ¨gitlab.oneitfarm.com&#x2F;ci123sdk groupä¸‹åˆ›å»ºé¡¹ç›®Aï¼Œå°†æœåŠ¡Açš„æ¥å£è°ƒç”¨å°è£…ã€‚è¿™æ ·å…¶ä»–é¡¹ç›®ï¼ˆäººï¼‰åœ¨æ¥å…¥Aé¡¹ç›®æ—¶ï¼Œä¸éœ€è¦å†é‡å¤å°è£…æ­¤éƒ¨åˆ†å†…å®¹ã€‚<br>ç®€å•æ¥è¯´å°±æ˜¯æ¯ä¸ªæœåŠ¡åœ¨ci123sdkçš„groupä¸‹åˆ›å»ºé¡¹ç›®ï¼Œåç»­æ‰€æœ‰å¯¹æ­¤æœåŠ¡è°ƒç”¨çš„å°è£…éƒ½åœ¨æ­¤é¡¹ç›®ä¸­ï¼Œæ‰€æœ‰å¼•ç”¨æ­¤æœåŠ¡çš„æœåŠ¡æˆ–åº”ç”¨ï¼Œåªéœ€è¦å¼•ç”¨æ­¤åŒ…è¿›è¡Œå¼€å‘ï¼Œå¦‚æœæ”¯æŒæ¥å£ä¸å…¨å°±åœ¨æ­¤é¡¹ç›®ä¸­å®Œå–„å¹¶æ‰“æ–°çš„tagå¢åŠ ç‰ˆæœ¬ã€‚</p><h3><span id="å…­å…³äºpr">å…­.å…³äºPR</span></h3><p>æœ‰ä»»ä½•ç–‘é—®æˆ–è€…å»ºè®®ï¼Œæ¬¢è¿éšæ—¶è”ç³»åŸºç¡€æ¶æ„éƒ¨ï¼šé™¶åœ£ï¼Œä¹Ÿæ¬¢è¿å„ä½æäº¤æœ‰ä»·å€¼çš„PRï¼Œä¹Ÿå°†çº³å…¥å¹´ç»ˆç»©æ•ˆè€ƒæ ¸ä¸€éƒ¨åˆ†</p>]]></content>
      
      
      <categories>
          
          <category> GOLANG </category>
          
      </categories>
      
      
        <tags>
            
            <tag> golang </tag>
            
            <tag> farmworker </tag>
            
            <tag> gin </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é«˜æ€§èƒ½åº“zap gox</title>
      <link href="/blog/2021/04/29/GOLANG/GOLANG-%E7%AC%94%E8%AE%B04-%E9%AB%98%E6%80%A7%E8%83%BD%E5%BA%93zap/"/>
      <url>/blog/2021/04/29/GOLANG/GOLANG-%E7%AC%94%E8%AE%B04-%E9%AB%98%E6%80%A7%E8%83%BD%E5%BA%93zap/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h2><span id="zap">zap</span></h2><p>é«˜æ€§èƒ½æ—¥å¿—åº“åˆ†æ</p><h4><span id="å‚æ•°é…ç½®">å‚æ•°é…ç½®</span></h4><p>##GOX<br>äº¤å‰ç¼–è¯‘å·¥å…·å¯ä»¥ç¼–è¯‘å„ç§çš„ç¯å¢ƒ<br>go get github.com&#x2F;mitchellh&#x2F;gox<br>gox -build-toolchain</p><p>ç›´æ¥è¿è¡Œgoxã€‚ç¨‹åºä¼šä¸€å£æ°”ç”Ÿæˆ17ä¸ªæ–‡ä»¶<br>æ¨ªè·¨windows,linux,mac,freebsd,netbsdäº”å¤§æ“ä½œç³»ç»Ÿ<br>#####å›ºå®šå¹³å°<br>gox -osarch â€œwindows&#x2F;amd64 linux&#x2F;amd64â€ æˆ–<br>        gox -os â€œwindows linuxâ€ -arch amd64</p><h4><span id="go-mod-init-å‘½ä»¤">go mod init å‘½ä»¤</span></h4><p>go.sumæ˜¯ä¸€ä¸ªæ¨¡å—ç‰ˆæœ¬å†…å®¹çš„æ ¡éªŒå€¼ï¼Œç”¨æ¥éªŒè¯å½“å‰ç¼“å­˜çš„æ¨¡å—ã€‚go.sumåŒ…å«äº†ç›´æ¥ä¾èµ–å’Œé—´æ¥ä¾èµ–çš„åŒ…çš„ä¿¡æ¯ï¼Œæ¯”go.modè¦å¤šä¸€äº›ã€‚</p><h4><span id="æŸ¥çœ‹ä¾èµ–åŒ…">æŸ¥çœ‹ä¾èµ–åŒ…</span></h4><p>go list -m all</p><h4><span id="æ¨¡å—é…ç½®æ–‡æœ¬æ ¼å¼åŒ–">æ¨¡å—é…ç½®æ–‡æœ¬æ ¼å¼åŒ–</span></h4><p>go mod edit -fmt</p><h4><span id="windows-ä¸‹å¼€å¯-go111module-çš„å‘½ä»¤ä¸º">Windows ä¸‹å¼€å¯ GO111MODULE çš„å‘½ä»¤ä¸ºï¼š</span></h4><p>set GO111MODULE&#x3D;on æˆ–è€… set GO111MODULE&#x3D;auto</p><h4><span id="ä»£ç†">ä»£ç†</span></h4><p>GOPROXY&#x3D;<a href="https://goproxy.cn,direct/">https://goproxy.cn,direct</a></p><h4><span id="ä»¥ç´¢å¼•æ•´ä¸ª-gopath">ä»¥ç´¢å¼•æ•´ä¸ª GOPATH</span></h4><p>.Preferences -&gt; Go -&gt; GOPATHï¼Œå‹¾é€‰ä¸Š Index entire GOPATH</p><hr><h4><span id="åŸºç¡€å‘½ä»¤å…³äºmoduleçš„">åŸºç¡€å‘½ä»¤å…³äºmoduleçš„</span></h4><p>go mod download<br>go mod download -json å‚æ•°ä¼šä»¥JSONçš„æ ¼å¼æ‰“å°ä¸‹è½½çš„æ¨¡å—å¯¹è±¡<br><br>go mod tidy<br>go mod tidy -v  å¯ä»¥å°†æ‰§è¡Œçš„ä¿¡æ¯<br>å¯ä»¥ä½¿ç”¨go mod tidyå‘½ä»¤æ¥æ¸…é™¤å®ƒ<br><br>go mod vendor<br>go mod vendor -vä¼šå°†æ·»åŠ åˆ°vendorä¸­çš„æ¨¡å—æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºã€‚<br>go mod graph<br><br>æ‰“å°æ¨¡å—ä¾èµ–å›¾</p>]]></content>
      
      
      <categories>
          
          <category> GOLANG </category>
          
      </categories>
      
      
        <tags>
            
            <tag> golang </tag>
            
            <tag> zap </tag>
            
            <tag> gox </tag>
            
            <tag> module </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ€è¿‘å¤ªæ‡’äº†</title>
      <link href="/blog/2021/04/29/%E6%88%91%E7%9A%84%E6%97%A5%E8%AE%B0/%E6%9C%80%E8%BF%91%E5%A4%AA%E6%87%92%E4%BA%86/"/>
      <url>/blog/2021/04/29/%E6%88%91%E7%9A%84%E6%97%A5%E8%AE%B0/%E6%9C%80%E8%BF%91%E5%A4%AA%E6%87%92%E4%BA%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>è‡ªå®šä¹‰æ”¯æŒmarkdownåªä¼šè®©æˆ‘çš„VsCodeè¶Šæ¥è¶Šå¡</p><h1><span id></span></h1><p>æŠ€æœ¯æ€§ä¸å¼ºä½†æ˜¯æ‰“å­—è¿˜æ…¢æ— è¯­äº†ï¼Œè¿™ä¸ªæ‰“å­—çš„ä¸œè¥¿</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(a)</span><br></pre></td></tr></table></figure> <hr><p><br>å¼ºè¡Œæ¢è¡Œ</p>]]></content>
      
      
      <categories>
          
          <category> diary </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>golangè°ƒåº¦-channel</title>
      <link href="/blog/2021/01/10/GOLANG/GOLANG-%E7%AC%94%E8%AE%B011-Channel/"/>
      <url>/blog/2021/01/10/GOLANG/GOLANG-%E7%AC%94%E8%AE%B011-Channel/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p><strong>Channel</strong></p><h3><span id="è®¾è®¡åŸç†">è®¾è®¡åŸç†</span></h3><p>ä¸è¦é€šè¿‡æ­å–œå†…å­˜çš„æ–¹å¼è¿›è¡Œé€šä¿¡ï¼ŒäºŒåé€šè¿‡é€šä¿¡çš„æ–¹å¼å…±äº«å†…å­˜ã€‚</p><p>å¾ˆå¤šä¸»æµç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå¤šä¸ªçº¿ç¨‹ä¼ é€’æ•°æ®æ–¹å¼ä¸€èˆ¬æƒ…å†µéƒ½æ˜¯å…±äº«å†…å­˜ï¼Œä¸ºäº†è§£å†³çº¿ç¨‹ç«äº‰ï¼Œéœ€è¦é™åˆ¶åŒä¸€æ—¶é—´è¯»å†™è¿™äº›å˜é‡çš„çº¿ç¨‹æ•°é‡</p><p>è™½ç„¶å¯ä»¥é€šè¿‡å…±äº«å†…å­˜åŠ äº’æ–¥é”è¿›è¡Œé€šä¿¡ï¼Œä½†æ˜¯goæä¾›äº†ä¸€ç§ä¸åŒå¹¶å‘çš„æ¨¡å‹ï¼Œå³é¡ºåºé€šè®¯è¿›ç¨‹ï¼Œ</p><p>Gorouting å’Œchannelåˆ†åˆ«å¯¹åº”cspä¸­å®ä½“å’Œä¼ é€’ä¿¡æ¯åª’ä»‹ã€‚</p><p><strong>gorutineé€šè¿‡channelä¼ é€’æ•°æ®</strong></p><p>ä¸¤ä¸ªç‹¬ç«‹çš„goroutine ï¼Œä¸€ä¸ªä¼šå‘channelä¸­å‘é€æ•°æ®ï¼Œå¦ä¸€ä¸ªä¼šä»channelä¸­è¯»å–æ•°æ®ï¼Œä¸¤ä¸ªèƒ½ç‹¬ç«‹çš„è¿è¡Œï¼Œå¹¶ä¸å­˜åœ¨ç›´æ¥å…³è”ï¼Œä½†æ˜¯é€šè¿‡channelå®Œæˆé€šè®¯</p><p><strong>å…ˆå…¥å…ˆå‡ºåŸåˆ™</strong>ï¼ˆFIFOï¼‰</p><ul><li>å…ˆä»channelè¯»å–æ•°æ®çš„goroutineä¼šå…ˆæ¥å—åˆ°æ•°æ®</li><li>å…ˆå‘channelå‘é€æ•°æ®çš„goroutineä¼šå¾—åˆ°å…ˆå‘é€çš„æƒåŠ›</li></ul><p>è¿™ç§ FIFO çš„è®¾è®¡æ˜¯ç›¸å¯¹å¥½ç†è§£çš„ï¼Œä½†æ˜¯ç¨æ—©çš„ Go è¯­è¨€å®ç°å´æ²¡æœ‰ä¸¥æ ¼éµå¾ªè¿™ä¸€è¯­ä¹‰ï¼Œæˆ‘ä»¬èƒ½åœ¨ <a href="https://github.com/golang/go/issues/11506">runtime: make sure blocked channels run operations in FIFO order</a> ä¸­æ‰¾åˆ°å…³äºå¸¦ç¼“å†²åŒºçš„ Channel åœ¨æ‰§è¡Œæ”¶å‘æ“ä½œæ—¶æ²¡æœ‰éµå¾ªå…ˆè¿›å…ˆå‡ºçš„è®¨è®º<a href="https://draveness.me/golang/docs/part3-runtime/ch06-concurrency/golang-channel/#fn:2">2</a>ã€‚</p><ul><li>å‘é€æ–¹ä¼šå‘ç¼“å†²åŒºå†™å…¥æ•°æ®ï¼Œç„¶åå”¤é†’æ¥æ”¶æ–¹ï¼Œå¤šä¸ªæ¥å—æ–¹ä¼šå…ˆå°è¯•ä»ç¼“å†²åŒºè¯»å–æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰è¯»å–åˆ°ä¼šé‡æ–°é™·å…¥ä¼‘çœ ã€‚</li><li>æ¥æ”¶æ–¹ä¼šä»ç¼“å†²åŒºå»è¯»æ•°æ®ï¼Œç„¶åå”¤é†’æ¥æ”¶æ–¹ï¼Œå‘é€æ–¹ä¼šå°è¯•åƒç¼“å†²å»å†™å…¥æ•°æ®ï¼Œå¦‚æœç¼“å†²åŒºå·²æ»¡ä¼šé‡æ–°é™·å…¥ä¼‘çœ </li></ul><p>è¿™ç§åŸºäºé‡è¯•çš„æœºåˆ¶ä¼šå¯¼è‡´channelçš„å¤„ç†éµå¾ªå…ˆè¿›å…ˆå‡ºçš„åŸåˆ™ã€‚</p><p><strong>æ— é”ç®¡é“</strong></p><p><strong>æ•°æ®ç»“æ„</strong></p><p>Goåœ¨channelä¸­è¿è¡Œä½¿ç”¨runtime.hchan ,æ–°å»ºchnanelç»“æ„</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> hchan <span class="keyword">struct</span> &#123;</span><br><span class="line">qcount   <span class="type">uint</span></span><br><span class="line">dataqsiz <span class="type">uint</span></span><br><span class="line">buf      unsafe.Pointer</span><br><span class="line">elemsize <span class="type">uint16</span></span><br><span class="line">closed   <span class="type">uint32</span></span><br><span class="line">elemtype *_type</span><br><span class="line">sendx    <span class="type">uint</span></span><br><span class="line">recvx    <span class="type">uint</span></span><br><span class="line">recvq    waitq</span><br><span class="line">sendq    waitq</span><br><span class="line"></span><br><span class="line">lock mutex</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºæ–°çš„channelï¼Œå¦‚ä¸Šç»“æ„æ„é€ åœ°åŸå¾ªç¯é˜Ÿåˆ—ï¼šäº”ä¸ªå­—æ®µ</p><ul><li>qcount channelä¸­å…ƒç´ ä¸ªæ•°</li><li>dataqsiz channelå¾ªç¯é•¿åº¦</li><li>buf channelç¼“å†²æŒ‡é’ˆ</li><li>sendx channelå‘é€æ“ä½œå¤„ç†åˆ°çš„ä½ç½®</li><li>recvx channel æ¥å—çš„æ“ä½œä½ç½®</li></ul><p>é™¤æ­¤ä¹‹å¤–ï¼Œelemsize elemtype æ ‡è¯†channelæ”¶å‘çš„å…ƒç´ ç±»å‹å’Œå¤§å°</p><p>sendqå’Œrecvqå­˜å‚¨å½“å‰channelç”±äºç¼“å†²åŒºå…ƒç´ ä¸è¶³è€Œé˜»å¡çš„goroutine åˆ—è¡¨ï¼Œè¿™äº›ç­‰å¾…é˜Ÿåˆ—å¯ä»¥ç”¨åŒå‘åˆ—è¡¨runtime.waitqæ ‡è¯†ï¼Œé“¾è¡¨ä¸­æ‰€æœ‰å…ƒç´ éƒ½æ˜¯runtime.sudog</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> waitq <span class="keyword">struct</span> &#123;</span><br><span class="line">first *sudog</span><br><span class="line">last  *sudog</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://draveness.me/golang/tree/runtime.sudog"><code>runtime.sudog</code></a> è¡¨ç¤ºä¸€ä¸ªåœ¨ç­‰å¾…åˆ—è¡¨ä¸­çš„ Goroutineï¼Œè¯¥ç»“æ„ä¸­å­˜å‚¨äº†ä¸¤ä¸ªåˆ†åˆ«æŒ‡å‘å‰å <a href="https://draveness.me/golang/tree/runtime.sudog"><code>runtime.sudog</code></a> çš„æŒ‡é’ˆä»¥æ„æˆé“¾è¡¨ã€‚</p><p><strong>åˆ›å»ºç®¡é“</strong></p><p>goä¸­æ‰€æœ‰channelèŠ‚ç‚¹åˆ›å»ºéƒ½ä¼šä½¿ç”¨makeå…³é”®å­—ï¼Œç¼–è¯‘å™¨ä¼šå°†make(chan int,10)è¡¨è¾¾å¼è½¬æ¢æˆOMAKEç±»å‹çš„èŠ‚ç‚¹ï¼Œå¹¶åœ¨ç±»å‹æ£€æŸ¥é˜¶æ®µï¼Œå°†OMAKElç±»å‹èŠ‚ç‚¹è½¬ä¸ºOMAKECHANç±»å‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">func typecheck1(n *Node, top int) (res *Node) &#123;</span><br><span class="line">switch n.Op &#123;</span><br><span class="line">case OMAKE:</span><br><span class="line">...</span><br><span class="line">switch t.Etype &#123;</span><br><span class="line">case TCHAN:</span><br><span class="line">l = nil</span><br><span class="line">if i &lt; len(args) &#123; // å¸¦ç¼“å†²åŒºçš„å¼‚æ­¥ Channel</span><br><span class="line">...</span><br><span class="line">n.Left = l</span><br><span class="line">&#125; else &#123; // ä¸å¸¦ç¼“å†²åŒºçš„åŒæ­¥ Channel</span><br><span class="line">n.Left = nodintconst(0)</span><br><span class="line">&#125;</span><br><span class="line">n.Op = OMAKECHAN</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸€é˜¶æ®µä¼šå¯¹ä¼ å…¥ <code>make</code> å…³é”®å­—çš„ç¼“å†²åŒºå¤§å°è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœæˆ‘ä»¬ä¸å‘ <code>make</code> ä¼ é€’è¡¨ç¤ºç¼“å†²åŒºå¤§å°çš„å‚æ•°ï¼Œé‚£ä¹ˆå°±ä¼šè®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼ 0ï¼Œä¹Ÿå°±æ˜¯å½“å‰çš„ Channel ä¸å­˜åœ¨ç¼“å†²åŒºã€‚</p><ul><li>å¦‚æœå½“å‰ Channel ä¸­ä¸å­˜åœ¨ç¼“å†²åŒºï¼Œé‚£ä¹ˆå°±åªä¼šä¸º <a href="https://draveness.me/golang/tree/runtime.hchan"><code>runtime.hchan</code></a> åˆ†é…ä¸€æ®µå†…å­˜ç©ºé—´ï¼›</li><li>å¦‚æœå½“å‰ Channel ä¸­å­˜å‚¨çš„ç±»å‹ä¸æ˜¯æŒ‡é’ˆç±»å‹ï¼Œä¼šä¸ºå½“å‰çš„ Channel å’Œåº•å±‚çš„æ•°ç»„åˆ†é…ä¸€å—è¿ç»­çš„å†…å­˜ç©ºé—´ï¼›</li><li>åœ¨é»˜è®¤æƒ…å†µä¸‹ä¼šå•ç‹¬ä¸º <a href="https://draveness.me/golang/tree/runtime.hchan"><code>runtime.hchan</code></a> å’Œç¼“å†²åŒºåˆ†é…å†…å­˜ï¼›</li></ul><p>åœ¨å‡½æ•°çš„æœ€åä¼šç»Ÿä¸€æ›´æ–° <a href="https://draveness.me/golang/tree/runtime.hchan"><code>runtime.hchan</code></a> çš„ <code>elemsize</code>ã€<code>elemtype</code> å’Œ <code>dataqsiz</code> å‡ ä¸ªå­—æ®µã€‚</p><p><strong>å‘é€æ•°æ®</strong></p><p>å½“æˆ‘ä»¬æƒ³è¦å‘Channelå‘é€æ•°æ®æ—¶å€™ï¼Œå°±éœ€è¦ä½¿ç”¨ch&lt;-iè¯­å¥ï¼Œç¼–è¯‘å™¨å°†ä¼šå°†å®ƒè§£æå†²OSENDèŠ‚ç‚¹ï¼Œå¹¶åœ¨xxx ,è½¬æ¢runtime.channelsend1</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">walkexpr</span><span class="params">(n *Node, init *Nodes)</span></span> *Node &#123;</span><br><span class="line"><span class="keyword">switch</span> n.Op &#123;</span><br><span class="line"><span class="keyword">case</span> OSEND:</span><br><span class="line">n1 := n.Right</span><br><span class="line">n1 = assignconv(n1, n.Left.Type.Elem(), <span class="string">&quot;chan send&quot;</span>)</span><br><span class="line">n1 = walkexpr(n1, init)</span><br><span class="line">n1 = nod(OADDR, n1, <span class="literal">nil</span>)</span><br><span class="line">n = mkcall1(chanfn(<span class="string">&quot;chansend1&quot;</span>, <span class="number">2</span>, n.Left.Type), <span class="literal">nil</span>, init, n.Left, n1)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://draveness.me/golang/tree/runtime.chansend1"><code>runtime.chansend1</code></a> åªæ˜¯è°ƒç”¨äº† <a href="https://draveness.me/golang/tree/runtime.chansend"><code>runtime.chansend</code></a> å¹¶ä¼ å…¥ Channel å’Œéœ€è¦å‘é€çš„æ•°æ®ã€‚<a href="https://draveness.me/golang/tree/runtime.chansend"><code>runtime.chansend</code></a> æ˜¯å‘ Channel ä¸­å‘é€æ•°æ®æ—¶ä¸€å®šä¼šè°ƒç”¨çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°åŒ…å«äº†å‘é€æ•°æ®çš„å…¨éƒ¨é€»è¾‘ï¼Œå¦‚æœæˆ‘ä»¬åœ¨è°ƒç”¨æ—¶å°† <code>block</code> å‚æ•°è®¾ç½®æˆ <code>true</code>ï¼Œé‚£ä¹ˆè¡¨ç¤ºå½“å‰å‘é€æ“ä½œæ˜¯é˜»å¡çš„ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">chansend</span><span class="params">(c *hchan, ep unsafe.Pointer, block <span class="type">bool</span>, callerpc <span class="type">uintptr</span>)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">lock(&amp;c.lock)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> c.closed != <span class="number">0</span> &#123;</span><br><span class="line">unlock(&amp;c.lock)</span><br><span class="line"><span class="built_in">panic</span>(plainError(<span class="string">&quot;send on closed channel&quot;</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å‘é€æ•°æ®çš„é€»è¾‘æ‰§è¡Œä¹‹å‰ä¼šå…ˆä¸ºå½“å‰ Channel åŠ é”ï¼Œé˜²æ­¢å¤šä¸ªçº¿ç¨‹å¹¶å‘ä¿®æ”¹æ•°æ®ã€‚å¦‚æœ Channel å·²ç»å…³é—­ï¼Œé‚£ä¹ˆå‘è¯¥ Channel å‘é€æ•°æ®æ—¶ä¼šæŠ¥ â€œsend on closed channelâ€ é”™è¯¯å¹¶ä¸­æ­¢ç¨‹åºã€‚</p><p>å› ä¸º <a href="https://draveness.me/golang/tree/runtime.chansend"><code>runtime.chansend</code></a> å‡½æ•°çš„å®ç°æ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå°†è¯¥å‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹åˆ†æˆä»¥ä¸‹çš„ä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>å½“å­˜åœ¨ç­‰å¾…çš„æ¥æ”¶è€…æ—¶ï¼Œé€šè¿‡ <a href="https://draveness.me/golang/tree/runtime.send"><code>runtime.send</code></a> ç›´æ¥å°†æ•°æ®å‘é€ç»™é˜»å¡çš„æ¥æ”¶è€…ï¼›</li><li>å½“ç¼“å†²åŒºå­˜åœ¨ç©ºä½™ç©ºé—´æ—¶ï¼Œå°†å‘é€çš„æ•°æ®å†™å…¥ Channel çš„ç¼“å†²åŒºï¼›</li><li>å½“ä¸å­˜åœ¨ç¼“å†²åŒºæˆ–è€…ç¼“å†²åŒºå·²æ»¡æ—¶ï¼Œç­‰å¾…å…¶ä»– Goroutine ä» Channel æ¥æ”¶æ•°æ®ï¼›</li></ul><p>å°ç»“ï¼š</p><h3><span id="å°ç»“">å°ç»“ </span></h3><p>æˆ‘ä»¬åœ¨è¿™é‡Œå¯ä»¥ç®€å•æ¢³ç†å’Œæ€»ç»“ä¸€ä¸‹ä½¿ç”¨ <code>ch &lt;- i</code> è¡¨è¾¾å¼å‘ Channel å‘é€æ•°æ®æ—¶é‡åˆ°çš„å‡ ç§æƒ…å†µï¼š</p><ol><li>å¦‚æœå½“å‰ Channel çš„ <code>recvq</code> ä¸Šå­˜åœ¨å·²ç»è¢«é˜»å¡çš„ Goroutineï¼Œé‚£ä¹ˆä¼šç›´æ¥å°†æ•°æ®å‘é€ç»™å½“å‰ Goroutine å¹¶å°†å…¶è®¾ç½®æˆä¸‹ä¸€ä¸ªè¿è¡Œçš„ Goroutineï¼›</li><li>å¦‚æœ Channel å­˜åœ¨ç¼“å†²åŒºå¹¶ä¸”å…¶ä¸­è¿˜æœ‰ç©ºé—²çš„å®¹é‡ï¼Œæˆ‘ä»¬ä¼šç›´æ¥å°†æ•°æ®å­˜å‚¨åˆ°ç¼“å†²åŒº <code>sendx</code> æ‰€åœ¨çš„ä½ç½®ä¸Šï¼›</li><li>å¦‚æœä¸æ»¡è¶³ä¸Šé¢çš„ä¸¤ç§æƒ…å†µï¼Œä¼šåˆ›å»ºä¸€ä¸ª <a href="https://draveness.me/golang/tree/runtime.sudog"><code>runtime.sudog</code></a> ç»“æ„å¹¶å°†å…¶åŠ å…¥ Channel çš„ <code>sendq</code> é˜Ÿåˆ—ä¸­ï¼Œå½“å‰ Goroutine ä¹Ÿä¼šé™·å…¥é˜»å¡ç­‰å¾…å…¶ä»–çš„åç¨‹ä» Channel æ¥æ”¶æ•°æ®ï¼›</li></ol><p>å‘é€æ•°æ®çš„è¿‡ç¨‹ä¸­åŒ…å«å‡ ä¸ªä¼šè§¦å‘ Goroutine è°ƒåº¦çš„æ—¶æœºï¼š</p><ol><li>å‘é€æ•°æ®æ—¶å‘ç° Channel ä¸Šå­˜åœ¨ç­‰å¾…æ¥æ”¶æ•°æ®çš„ Goroutineï¼Œç«‹åˆ»è®¾ç½®å¤„ç†å™¨çš„ <code>runnext</code> å±æ€§ï¼Œä½†æ˜¯å¹¶ä¸ä¼šç«‹åˆ»è§¦å‘è°ƒåº¦ï¼›</li><li>å‘é€æ•°æ®æ—¶å¹¶æ²¡æœ‰æ‰¾åˆ°æ¥æ”¶æ–¹å¹¶ä¸”ç¼“å†²åŒºå·²ç»æ»¡äº†ï¼Œè¿™æ—¶ä¼šå°†è‡ªå·±åŠ å…¥ Channel çš„ <code>sendq</code> é˜Ÿåˆ—å¹¶è°ƒç”¨ <a href="https://draveness.me/golang/tree/runtime.goparkunlock"><code>runtime.goparkunlock</code></a> è§¦å‘ Goroutine çš„è°ƒåº¦è®©å‡ºå¤„ç†å™¨çš„ä½¿ç”¨æƒï¼›</li></ol>]]></content>
      
      
      <categories>
          
          <category> GOLANG </category>
          
      </categories>
      
      
        <tags>
            
            <tag> golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»¥åŠå¦‚ä½•ä½¿ç”¨rpc</title>
      <link href="/blog/2020/09/19/HTTP/GRPC-go-php/"/>
      <url>/blog/2020/09/19/HTTP/GRPC-go-php/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p><a href="http://doc.oschina.net/grpc?t=57966">http://doc.oschina.net/grpc?t=57966</a></p><p>gRPC åŸºäº HTTP&#x2F;2 æ ‡å‡†è®¾è®¡ï¼Œå¸¦æ¥è¯¸å¦‚åŒå‘æµã€æµæ§ã€å¤´éƒ¨å‹ç¼©ã€å• TCP è¿æ¥ä¸Šçš„å¤šå¤ç”¨è¯·æ±‚ç­‰ç‰¹ã€‚è¿™äº›ç‰¹æ€§ä½¿å¾—å…¶åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šè¡¨ç°æ›´å¥½ï¼Œæ›´çœç”µå’ŒèŠ‚çœç©ºé—´å ç”¨ã€‚<br>gRPC ä¹Ÿæ˜¯åŸºäºä»¥ä¸‹ç†å¿µï¼šå®šä¹‰ä¸€ä¸ªæœåŠ¡ï¼ŒæŒ‡å®šå…¶èƒ½å¤Ÿè¢«è¿œç¨‹è°ƒç”¨çš„æ–¹æ³•ï¼ˆåŒ…å«å‚æ•°å’Œè¿”å›ç±»å‹ï¼‰ã€‚åœ¨æœåŠ¡ç«¯å®ç°è¿™ä¸ªæ¥å£ï¼Œå¹¶è¿è¡Œä¸€ä¸ª gRPC æœåŠ¡å™¨æ¥å¤„ç†å®¢æˆ·ç«¯è°ƒç”¨ã€‚åœ¨å®¢æˆ·ç«¯æ‹¥æœ‰ä¸€ä¸ªå­˜æ ¹èƒ½å¤ŸåƒæœåŠ¡ç«¯ä¸€æ ·çš„æ–¹æ³•ã€‚</p><p>æ­£å¦‚å…¶ä»– RPC ç³»ç»Ÿï¼ŒgRPC åŸºäºå¦‚ä¸‹æ€æƒ³ï¼šå®šä¹‰ä¸€ä¸ªæœåŠ¡ï¼Œ æŒ‡å®šå…¶å¯ä»¥è¢«è¿œç¨‹è°ƒç”¨çš„æ–¹æ³•åŠå…¶å‚æ•°å’Œè¿”å›ç±»å‹ã€‚gRPC é»˜è®¤ä½¿ç”¨ protocol buffers ä½œä¸ºæ¥å£å®šä¹‰è¯­è¨€ï¼Œæ¥æè¿°æœåŠ¡æ¥å£å’Œæœ‰æ•ˆè½½è·æ¶ˆæ¯ç»“æ„ã€‚å¦‚æœæœ‰éœ€è¦çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–æ›¿ä»£æ–¹æ¡ˆã€‚</p><p>ä½¿ç”¨ protocol buffers</p>]]></content>
      
      
      <categories>
          
          <category> HTTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rpc() </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP-è§£å†³å¾ªç¯å†…å­˜å ç”¨æº¢å‡º-ç¼“å†²æŸ¥è¯¢</title>
      <link href="/blog/2020/09/02/PHP/PHP-%E8%A7%A3%E5%86%B3%E5%BE%AA%E7%8E%AF%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8%E6%BA%A2%E5%87%BA-%E7%BC%93%E5%86%B2%E6%9F%A5%E8%AF%A2/"/>
      <url>/blog/2020/09/02/PHP/PHP-%E8%A7%A3%E5%86%B3%E5%BE%AA%E7%8E%AF%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8%E6%BA%A2%E5%87%BA-%E7%BC%93%E5%86%B2%E6%9F%A5%E8%AF%A2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PHP-æ·±æ‹·è´æµ…æ‹·è´-_clone</title>
      <link href="/blog/2020/09/02/PHP/PHP-%E6%B7%B1%E6%8B%B7%E8%B4%9D%E6%B5%85%E6%8B%B7%E8%B4%9D/"/>
      <url>/blog/2020/09/02/PHP/PHP-%E6%B7%B1%E6%8B%B7%E8%B4%9D%E6%B5%85%E6%8B%B7%E8%B4%9D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><ul><li><p>æ·±æ‹·è´&#x2F;&#x2F;å˜é‡å¤åˆ¶äº†ä¸€ä»½ä¼ é€’ç»™å¦ä¸€ä¸ªå˜é‡å°±æ˜¯æ·±æ‹·è´,ä¸€ä¸ªå€¼æ”¹å˜äº†,å¦ä¸€ä¸ªå€¼ä¸ä¼šå˜ï¼ˆç›´æ¥å¤åˆ¶ï¼‰</p></li><li><p>æµ…æ‹·è´&#x2F;&#x2F;å˜é‡ä¹‹é—´çš„å€¼æ˜¯åœ°å€*|&amp;ä¼ é€’,è¿™å°±æ˜¯æµ…æ‹·è´.å€¼å¦‚æœæ”¹å˜äº†ä¸¤ä¸ªå˜é‡çš„å€¼éƒ½ä¼šæ”¹å˜ ï¼ˆå¼•ç”¨å¤åˆ¶ï¼Œå¯å˜ï¼‰</p></li></ul><blockquote><p>å…³é”®æ¬¡ _clone</p></blockquote><ul><li>å¯¹è±¡èµ‹å€¼ï¼šæµ…æ‹·è´</li><li>æ™®é€šç±»å‹çš„å˜é‡æ˜¯æ·±æ‹·è´</li></ul><h4><span id="phpé»˜è®¤æµ…æ‹·è´å³æ™®é€šèµ‹å€¼">phpé»˜è®¤æµ…æ‹·è´å³æ™®é€šèµ‹å€¼</span></h4><blockquote><p>ä¾‹1ï¼š</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class Persion</span><br><span class="line">&#123;</span><br><span class="line">public $age = 0;</span><br><span class="line">public $name = &#x27;xiapeifus&#x27;;</span><br><span class="line">public $obj = null;</span><br><span class="line">&#125;</span><br><span class="line">$persion = new Persion();</span><br><span class="line">$xiaoming = clone $persion; //ä½¿ç”¨cloneå…³é”®å­—å¤åˆ¶ä¸€ä»½$açš„å€¼,è¿›è¡Œæ·±æ‹·è´.æ‹·è´ä¹‹åä¸ä¼šæ”¹å˜$aä¹‹å‰çš„å€¼</span><br><span class="line">$xiaoming-&gt;age = 1;</span><br><span class="line">var_dump($persion-&gt;age);// 0</span><br><span class="line">var_dump($xiaoming-&gt;age);// 1</span><br></pre></td></tr></table></figure><blockquote><p>&#x2F;&#x2F;ä¾‹2ï¼šå¢åŠ __cloneå¯¹è±¡çš„èµ‹å€¼</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">class doclone&#123;</span><br><span class="line">    private $id,$name,$address;</span><br><span class="line">    public function __construct($id=0,$name=&#x27;&#x27;,$address=&#x27;&#x27;)&#123;</span><br><span class="line">        $this-&gt;name=$name;</span><br><span class="line">        $this-&gt;id=$id;</span><br><span class="line">        $this-&gt;address=$address;</span><br><span class="line">    &#125;</span><br><span class="line">    public function get_id()&#123;</span><br><span class="line">        return $this-&gt;id;</span><br><span class="line">    &#125;</span><br><span class="line">    public function get_name()&#123;</span><br><span class="line">        return $this-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">    public function get_address()&#123;</span><br><span class="line">        return $this-&gt;address;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __clone()&#123;</span><br><span class="line">        $this-&gt;id=$this-&gt;id+1;</span><br><span class="line">        $this-&gt;name=&#x27;wqw&#x27;;</span><br><span class="line">        $this-&gt;address=&#x27;USA&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$A = new doclone(1,&#x27;xiapeifu&#x27;,&#x27;UK&#x27;);</span><br><span class="line">echo &#x27;å…‹éš†ä¹‹å‰çš„å¯¹è±¡:&#x27;;</span><br><span class="line">echo &#x27;id=&#x27;.$A-&gt;get_id();</span><br><span class="line">echo &#x27;name=&#x27;.$A-&gt;get_name();</span><br><span class="line">echo &#x27;address=&#x27;.$A-&gt;get_address();</span><br><span class="line">echo &quot;\n&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$B = clone $A;</span><br><span class="line">echo &#x27;å…‹éš†è¿‡åçš„å¯¹è±¡ï¼š&#x27;;</span><br><span class="line">echo &#x27;id=&#x27;.$A-&gt;get_id();</span><br><span class="line">echo &#x27;name=&#x27;.$A-&gt;get_name();</span><br><span class="line">echo &#x27;address=&#x27;.$A-&gt;get_address();</span><br><span class="line">echo &quot;\n&quot;;</span><br><span class="line"></span><br><span class="line">echo &#x27;å…‹éš†è¿‡åçš„å¯¹è±¡å±æ€§:&#x27;;</span><br><span class="line">echo &#x27;id=&#x27;.$B-&gt;get_id();</span><br><span class="line">echo &#x27;name=&#x27;.$B-&gt;get_name();</span><br><span class="line">echo &#x27;address=&#x27;.$B-&gt;get_address();</span><br><span class="line">//ç»“æœ</span><br><span class="line">//å…‹éš†ä¹‹å‰çš„å¯¹è±¡:id=1name=xiapeifuaddress=UK</span><br><span class="line">//å…‹éš†è¿‡åçš„å¯¹è±¡ï¼šid=1name=xiapeifuaddress=UK</span><br><span class="line">//å…‹éš†è¿‡åçš„å¯¹è±¡å±æ€§:id=2name=wqwaddress=USA</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>æ€è€ƒï¼šcolne å…³é”®è¯ å½“å¯¹è±¡æ²¡__colne æ–¹æ³•æ—¶å€™ç±»ä¼¼äºnew ä¸€ä¸ªå¯¹è±¡å‡ºæ¥æ²¡åŒºåˆ«<br>        å½“å¯¹è±¡æœ‰__cloneæ—¶å€™ä¼šåœ¨cloneé‡Œé¢çš„é‡æ–°èµ‹å€¼æ–°çš„å±æ€§ï¼Œç±»ä¼¼äºé‡æ–°new ä¸€ä¸ªå¯¹è±¡ ï¼Œåªä¸è¿‡æŠŠé‡æ–°newçš„å¯¹è±¡è¿›è¡Œä¸€äº›é»˜è®¤æ“ä½œï¼Œå…¶å®é‡æ–°newä¸€ä¸ªå¯¹è±¡é‡æ–°èµ‹å€¼ä¹Ÿä¸€æ ·ï¼Œcloneå¯èƒ½å°±æ˜¯å•çº¯ç‚«æŠ€å§</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Git-ä»£ç æäº¤è§„èŒƒ</title>
      <link href="/blog/2020/09/02/GIT/Git-%E4%BB%A3%E7%A0%81%E6%8F%90%E4%BA%A4%E8%A7%84%E8%8C%83/"/>
      <url>/blog/2020/09/02/GIT/Git-%E4%BB%A3%E7%A0%81%E6%8F%90%E4%BA%A4%E8%A7%84%E8%8C%83/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>Git commit message æ˜¯Gitæäº¤çš„å¿…è¦ä¿¡æ¯ï¼Œmessageçš„ä¿¡æ¯å®Œæ•´åº¦ä¹Ÿåæ˜ äº†å·¥ç¨‹å¸ˆå¯¹äºä»£ç æäº¤çš„é‡è§†ç¨‹åº¦ï¼Œä¸æ¸…æ™°çš„git messageä¿¡æ¯ç”šè‡³ä¼šè®©å·¥ç¨‹å¸ˆå®Œå…¨å›å¿†ä¸èµ·è‡ªå·±å½“åˆåšäº†ä»€ä¹ˆè°ƒæ•´ï¼Œå¯¼è‡´åç»­ä»£ç ç»´æŠ¤æˆæœ¬ç‰¹åˆ«å¤§ã€‚å› æ­¤ä¸ºäº†æé«˜çº¿ä¸Šä»£ç åº“çš„ç®¡ç†ç¨‹åº¦ï¼Œç‰¹æ­¤åˆ¶å®šGIT commit messageè§„èŒƒã€‚</p><p>ä¸€ã€commit messageæ ¼å¼<br>1ã€Type(å¿…é¡»)<br>ç”¨äºè¯´æ˜ git commit çš„ç±»åˆ«ï¼Œåªå…è®¸ä½¿ç”¨ä¸‹é¢çš„æ ‡è¯†ã€‚<br>featï¼šæ–°åŠŸèƒ½ï¼ˆfeatureï¼‰ã€‚<br>fix&#x2F;toï¼šä¿®å¤bugï¼Œå¯ä»¥æ˜¯QAå‘ç°çš„BUGï¼Œä¹Ÿå¯ä»¥æ˜¯ç ”å‘è‡ªå·±å‘ç°çš„BUGã€‚<br>fixï¼šäº§â½£diffå¹¶è‡ªåŠ¨ä¿®å¤æ­¤é—®é¢˜ã€‚é€‚åˆäºä¸€æ¬¡æäº¤ç›´æ¥ä¿®å¤é—®é¢˜<br>toï¼šåªäº§â½£diffä¸è‡ªåŠ¨ä¿®å¤æ­¤é—®é¢˜ã€‚é€‚åˆäºå¤šæ¬¡æäº¤ã€‚æœ€ç»ˆä¿®å¤é—®é¢˜æäº¤æ—¶ä½¿ç”¨fix<br>docsï¼šæ–‡æ¡£ï¼ˆdocumentationï¼‰ã€‚<br>styleï¼šæ ¼å¼ï¼ˆä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨ï¼‰ã€‚<br>refactorï¼šé‡æ„ï¼ˆå³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹bugçš„ä»£ç å˜åŠ¨ï¼‰ã€‚<br>perfï¼šä¼˜åŒ–ç›¸å…³ï¼Œæ¯”å¦‚æå‡æ€§èƒ½ã€ä½“éªŒã€‚<br>testï¼šå¢åŠ æµ‹è¯•ã€‚<br>choreï¼šæ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨ã€‚<br>revertï¼šå›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ã€‚<br>mergeï¼šä»£ç åˆå¹¶ã€‚<br>syncï¼šåŒæ­¥ä¸»çº¿æˆ–åˆ†â½€çš„Bug</p><p>2ã€scope(å¯é€‰)<br>scopeç”¨äºè¯´æ˜ commit å½±å“çš„èŒƒå›´ï¼Œæ¯”å¦‚æ•°æ®å±‚ã€æ§åˆ¶å±‚ã€è§†å›¾å±‚ç­‰ç­‰ï¼Œè§†é¡¹ç›®ä¸åŒè€Œä¸åŒã€‚<br>ä¾‹å¦‚åœ¨Angularï¼Œå¯ä»¥æ˜¯locationï¼Œbrowserï¼Œcompileï¼Œcompileï¼ŒrootScopeï¼Œ ngHrefï¼ŒngClickï¼ŒngViewç­‰ã€‚<br>å¦‚æœä½ çš„ä¿®æ”¹å½±å“äº†ä¸æ­¢ä¸€ä¸ªscopeï¼Œä½ å¯ä»¥ä½¿ç”¨*ä»£æ›¿ã€‚</p><p>3ã€subject(å¿…é¡»)<br>subjectæ˜¯commitç›®çš„çš„ç®€çŸ­æè¿°ï¼Œä¸è¶…è¿‡50ä¸ªå­—ç¬¦ã€‚<br>1.å»ºè®®ä½¿ç”¨ä¸­æ–‡ã€‚<br>2.ç»“å°¾ä¸åŠ å¥å·æˆ–å…¶ä»–æ ‡ç‚¹ç¬¦å·ã€‚<br>æ ¹æ®ä»¥ä¸Šè§„èŒƒ git commit message å°†æ˜¯å¦‚ä¸‹çš„æ ¼å¼ï¼š<br>fix(DAO): ç”¨æˆ·æŸ¥è¯¢ç¼ºå°‘usernameå±æ€§<br>feat(Controller): ç”¨æˆ·æŸ¥è¯¢æ¥å£å¼€å‘</p><p>äºŒã€è§„èŒƒçš„å¥½å¤„<br>æˆ‘ä»¬è¿™æ ·è§„èŒƒgit commitåˆ°åº•æœ‰å“ªäº›å¥½å¤„å‘¢ï¼Ÿ<br>1.ä¾¿äºç¨‹åºå‘˜å¯¹æäº¤å†å²è¿›è¡Œè¿½æº¯ï¼Œäº†è§£å‘â½£äº†ä»€ä¹ˆæƒ…å†µã€‚<br>2.ä¸€æ—¦çº¦æŸäº†commit messageï¼Œæ„å‘³ç€æˆ‘ä»¬å°†æ…é‡çš„è¿›è¡Œæ¯ä¸€æ¬¡æäº¤ï¼Œä¸èƒ½å†ä¸€è‚¡è„‘çš„æŠŠå„ç§å„æ ·çš„æ”¹åŠ¨éƒ½æ”¾åœ¨ä¸€ä¸ªgit commité‡Œé¢ï¼Œè¿™æ ·ä¸€æ¥æ•´ä¸ªä»£ç æ”¹åŠ¨çš„å†å²ä¹Ÿå°†æ›´åŠ æ¸…æ™°ã€‚<br>3.æ ¼å¼åŒ–çš„commit messageæ‰å¯ä»¥ç”¨äºè‡ªåŠ¨åŒ–è¾“å‡ºChange logã€‚</p><p>ä¸‰ã€æ ‡å‡†æ‰§è¡Œç›‘ç®¡<br>ä¸ºäº†æ›´å¥½çš„æ‰§è¡Œæ ‡å‡†ï¼Œå…¬å¸é’ˆå¯¹gitæäº¤ä¼šè¿›è¡Œç›¸å…³ç›‘ç®¡åŠŸèƒ½çš„ç ”å‘ï¼Œå½“å·¥ç¨‹å¸ˆæäº†ä¸åˆè§„çš„commitï¼Œä¼šæ”¶åˆ°ç›¸å…³çš„é‚®ä»¶è­¦å‘Šã€‚</p>]]></content>
      
      
      <categories>
          
          <category> git </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯-npmç§æœ‰æºåŠ è½½å¹³å°</title>
      <link href="/blog/2020/09/01/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86/%E5%89%8D%E7%AB%AF-npm%E7%A7%81%E6%9C%89%E6%BA%90%E5%8A%A0%E8%BD%BD%E5%B9%B3%E5%8F%B0/"/>
      <url>/blog/2020/09/01/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86/%E5%89%8D%E7%AB%AF-npm%E7%A7%81%E6%9C%89%E6%BA%90%E5%8A%A0%E8%BD%BD%E5%B9%B3%E5%8F%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h3><span id="è°ƒç ”å¹³å°sinopiaverdaccio">è°ƒç ”å¹³å°ï¼šsinopiaï¼ŒVerdaccio</span></h3><h4><span id="verdaccio">Verdaccio</span></h4><h5><span id="å®˜æ–¹æ–‡æ¡£">å®˜æ–¹æ–‡æ¡£</span></h5><p><a href="https://verdaccio.org/docs/en/configuration">https://verdaccio.org/docs/en/configuration</a></p><p>æ­å»ºï¼š</p><h5><span id="è®¤è¯æ–¹å¼">è®¤è¯æ–¹å¼</span></h5><p>èº«ä»½éªŒè¯ä¸æ‚¨æ­£åœ¨ä½¿ç”¨çš„auth <a href="https://verdaccio.org/docs/en/plugins">æ’ä»¶ç›¸å…³</a>ã€‚è½¯ä»¶åŒ…é™åˆ¶ä¹Ÿç”±<a href="https://verdaccio.org/docs/en/packages">Package Access</a>å¤„ç†ã€‚</p><p>å®¢æˆ·ç«¯ï¼šåŸºäºnpmå®¢æˆ·ç«¯ç™»å½•åä¼šç”Ÿæˆä¸€ä¸ªé…ç½®ä»¤ç‰Œï¼Œåœ¨.npmrcä¸­</p><p><a href="https://docs.npmjs.com/files/npmrc">https://docs.npmjs.com/files/npmrc</a></p><p>ä¸”å…è®¸åŒ¿åå‘å¸ƒåŒ…</p><p>åŒ…å‘å¸ƒçš„æ—¶å€™å…è®¸é˜»æ­¢è®¿é—®å’Œä¸‹è½½</p><p>æœåŠ¡ç«¯å…³äºç»„çš„éªŒè¯:</p><p>â€‹    access: $all-&gt;<br>â€‹    publish: $all<br>â€‹    proxy: npmjs</p><p><img src="//s2-cdn.oneitfarm.com/186bdf368bd54a57b12eb71ba2e10636.png" alt="image-20200901175328057"></p><p> ä¸åŒçš„åŒ…è¯»å–æƒé™é™åˆ¶ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">packages</span>:</span><br><span class="line">  <span class="string">&#x27;jquery&#x27;</span>:</span><br><span class="line">    <span class="attr">access</span>: $all</span><br><span class="line">    <span class="attr">publish</span>: $all</span><br><span class="line">  <span class="string">&#x27;my-company-*&#x27;</span>:</span><br><span class="line">    <span class="attr">access</span>: $all</span><br><span class="line">    <span class="attr">publish</span>: $authenticated</span><br><span class="line">  <span class="string">&#x27;@my-local-scope/*&#x27;</span>:</span><br><span class="line">    <span class="attr">access</span>: $all</span><br><span class="line">    <span class="attr">publish</span>: $authenticated</span><br><span class="line">  <span class="string">&#x27;**&#x27;</span>:</span><br><span class="line">    <span class="attr">access</span>: $all</span><br><span class="line">    <span class="attr">publish</span>: $authenticated</span><br><span class="line">    <span class="attr">proxy</span>: npmjs</span><br></pre></td></tr></table></figure><p>ç»„ å®šä¹‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x27;company-*&#x27;:</span><br><span class="line">  access: admin internal</span><br><span class="line">  publish: admin</span><br><span class="line">  proxy: server1</span><br><span class="line">&#x27;supersecret-*&#x27;:</span><br><span class="line">  access: secret super-secret-area ultra-secret-area</span><br><span class="line">  publish: secret ultra-secret-area</span><br><span class="line">  proxy: server1</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯çŸ¥è¯† </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å…¶ä»–-CRLFã€CRã€LFè¯¦è§£</title>
      <link href="/blog/2020/09/01/Wiki/%E5%85%B6%E4%BB%96-CRLF%E3%80%81CR%E3%80%81LF%E8%AF%A6%E8%A7%A3/"/>
      <url>/blog/2020/09/01/Wiki/%E5%85%B6%E4%BB%96-CRLF%E3%80%81CR%E3%80%81LF%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>å¾ˆé•¿ä¸€æ®µæ—¶é—´é‡Œï¼Œå¯¹äºCRLFã€CRã€LFçš„ç†è§£ä»…é™äºä¸åŒæ“ä½œç³»ç»Ÿä¸‹å¯¹æ¢è¡Œç¬¦çš„å®šä¹‰ã€‚æ‰€è°“çŸ¥å…¶ç„¶éœ€çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œä»å­¦ä¹ ä¸­æ‰¾åˆ°ä¹è¶£ï¼Œå¯¹çŸ¥è¯†çš„è®°å¿†æ‰ä¼šæ›´åŠ æ·±åˆ»ã€‚</p><p>åè¯è§£é‡Š<br>CRï¼šCarriage Returnï¼Œå¯¹åº”ASCIIä¸­è½¬ä¹‰å­—ç¬¦\rï¼Œè¡¨ç¤ºå›è½¦<br>LFï¼šLinefeedï¼Œå¯¹åº”ASCIIä¸­è½¬ä¹‰å­—ç¬¦\nï¼Œè¡¨ç¤ºæ¢è¡Œ<br>CRLFï¼šCarriage Return &amp; Linefeedï¼Œ\r\nï¼Œè¡¨ç¤ºå›è½¦å¹¶æ¢è¡Œ<br>ä¼—æ‰€å‘¨çŸ¥ï¼ŒWindowsæ“ä½œç³»ç»Ÿé‡‡ç”¨ä¸¤ä¸ªå­—ç¬¦æ¥è¿›è¡Œæ¢è¡Œï¼Œå³CRLFï¼›Unix&#x2F;Linux&#x2F;Mac OS Xæ“ä½œç³»ç»Ÿé‡‡ç”¨å•ä¸ªå­—ç¬¦LFæ¥è¿›è¡Œæ¢è¡Œï¼›å¦å¤–ï¼ŒMacIntoshæ“ä½œç³»ç»Ÿï¼ˆå³æ—©æœŸçš„Macæ“ä½œç³»ç»Ÿï¼‰é‡‡ç”¨å•ä¸ªå­—ç¬¦CRæ¥è¿›è¡Œæ¢è¡Œã€‚</p><p>é‡å²<br>è€å¼æœºæ¢°æ‰“å­—æœºï¼ˆæ¥æºï¼šè§†è§‰ä¸­å›½ï¼‰<br>æ®é‡å²è®°è½½ï¼Œåœ¨å¾ˆä¹…ä»¥å‰çš„æœºæ¢°æ‰“å­—æœºæ—¶ä»£ï¼ŒCRå’ŒLFåˆ†åˆ«å…·æœ‰ä¸åŒçš„ä½œç”¨ï¼šLFä¼šå°†æ‰“å°çº¸å¼ ä¸Šç§»ä¸€è¡Œä½ç½®ï¼Œä½†æ˜¯ä¿æŒå½“å‰æ‰“å­—çš„æ°´å¹³ä½ç½®ä¸å˜ï¼›CRåˆ™ä¼šå°†â€œCarriageâ€ï¼ˆæ‰“å­—æœºä¸Šçš„æ»šåŠ¨æ‰˜æ¶ï¼‰æ»šå›åˆ°æ‰“å°çº¸å¼ çš„æœ€å·¦ä¾§ï¼Œä½†æ˜¯ä¿æŒå½“å‰æ‰“å­—çš„å‚ç›´ä½ç½®ä¸å˜ï¼Œå³è¿˜æ˜¯åœ¨åŒä¸€è¡Œã€‚</p><p>å½“CRå’ŒLFç»„åˆä½¿ç”¨æ—¶ï¼Œåˆ™ä¼šå°†æ‰“å°çº¸å¼ ä¸Šç§»ä¸€è¡Œï¼Œä¸”ä¸‹ä¸€ä¸ªæ‰“å­—ä½ç½®å°†å›åˆ°è¯¥è¡Œçš„æœ€å·¦ä¾§ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä»Šå¤©æ‰€ç†è§£çš„æ¢è¡Œæ“ä½œã€‚</p><p>éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæœºæ¢°æ‰“å­—æœºæ¸æ¸åœ°é€€å‡ºäº†å†å²èˆå°ï¼Œå½“åˆçš„çº¸å¼ å˜æˆäº†ä»Šå¤©çš„æ˜¾ç¤ºå™¨ï¼Œæ‰“å­—æœºçš„æŒ‰é”®ä¹Ÿæ¼”å˜ä¸ºäº†å¦‚ä»Šçš„é”®ç›˜ã€‚åœ¨æ“ä½œç³»ç»Ÿå‡ºç°çš„å¹´ä»£ï¼Œå—é™äºå†…å­˜å’Œè½¯ç›˜ç©ºé—´çš„ä¸è¶³ï¼Œä¸€äº›æ“ä½œç³»ç»Ÿçš„è®¾è®¡è€…å†³å®šé‡‡ç”¨å•ä¸ªå­—ç¬¦æ¥è¡¨ç¤ºæ¢è¡Œç¬¦ï¼Œå¦‚Unixçš„LFã€MacIntoshçš„CRã€‚ä»–ä»¬çš„æ„å›¾éƒ½æ˜¯ä¸ºäº†è¿›è¡Œæ¢è¡Œæ“ä½œï¼Œåªæ˜¯å½“åˆå¹¶æ²¡æœ‰ä¸€ä¸ªå›½é™…æ ‡å‡†ï¼ˆæˆ–è€…å…¶ä»–åŸå› ï¼Œé¬¼çŸ¥é“ï¼‰ï¼Œæ‰€ä»¥æ‰æœ‰è¿™æ ·å­—ç¬¦ä¸Šçš„ä¸åŒã€‚</p><p>ç»“è®º<br>è®¸å¤šç°ä»£çš„æ–‡æœ¬ç¼–è¾‘å™¨å’Œå‘½ä»¤è¡Œå·¥å…·éƒ½æä¾›äº†å¯é€‰æ‹©çš„æ¢è¡Œç¬¦é…ç½®ï¼Œæ–¹ä¾¿ç”¨æˆ·æŒ‰ç…§è‡ªå·±çš„æ„æ„¿æ¥æ”¹å˜æ¢è¡Œç¬¦çš„è¡¨ç°å½¢å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦çŸ¥é“CRLFã€CRã€LFçš„ä½œç”¨å³å¯ã€‚</p><p>å‚è€ƒæ–‡çŒ®<br><a href="http://en.wikipedia.org/wiki/Newline">http://en.wikipedia.org/wiki/Newline</a><br><a href="https://en.wikipedia.org/wiki/Control_character">https://en.wikipedia.org/wiki/Control_character</a><br><a href="https://stackoverflow.com/questions/1552749/difference-between-cr-lf-lf-and-cr-line-break-types">https://stackoverflow.com/questions/1552749/difference-between-cr-lf-lf-and-cr-line-break-types</a></p><p>ä½œè€…ï¼šJSoon<br>é“¾æ¥ï¼š<a href="https://www.jianshu.com/p/b03ad01acd69">https://www.jianshu.com/p/b03ad01acd69</a><br>æ¥æºï¼šç®€ä¹¦<br>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºblogæ›´æ–°å‘¨æœŸ</title>
      <link href="/blog/2020/08/31/%E6%88%91%E7%9A%84%E6%97%A5%E8%AE%B0/%E5%85%B3%E4%BA%8Eblog%E6%9B%B4%E6%96%B0%E5%91%A8%E6%9C%9F/"/>
      <url>/blog/2020/08/31/%E6%88%91%E7%9A%84%E6%97%A5%E8%AE%B0/%E5%85%B3%E4%BA%8Eblog%E6%9B%B4%E6%96%B0%E5%91%A8%E6%9C%9F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>æ¯å‘¨ ä¸‰ç¯‡åŸºç¡€çŸ¥è¯†æ–‡æ¡£ç¼–å†™</p><p>æ¯ä¸¤å‘¨ä¸€æ¬¡æ€»ç»“å·¥ä½œæƒ…å†µ</p><p>æ¯æœˆä¸€æ¬¡çš„è½¯ä»¶ä½¿ç”¨æ•™ç¨‹è®°å½•</p>]]></content>
      
      
      <categories>
          
          <category> diary </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PHP-è¾…åŠ©å‡½æ•°</title>
      <link href="/blog/2020/08/28/PHP/PHP-%E8%BE%85%E5%8A%A9%E5%87%BD%E6%95%B0/"/>
      <url>/blog/2020/08/28/PHP/PHP-%E8%BE%85%E5%8A%A9%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>PHP-åŒ¿åç±»åŒ¿åå‡½æ•°ï¼ˆé—­åŒ…ï¼‰</title>
      <link href="/blog/2020/08/28/PHP/PHP-%E5%8C%BF%E5%90%8D%E7%B1%BB%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0%EF%BC%88%E9%97%AD%E5%8C%85%EF%BC%89/"/>
      <url>/blog/2020/08/28/PHP/PHP-%E5%8C%BF%E5%90%8D%E7%B1%BB%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0%EF%BC%88%E9%97%AD%E5%8C%85%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h4><span id="1å†™ä¸€ä¸ªåŒ¿åå‡½æ•°">1.å†™ä¸€ä¸ªåŒ¿åå‡½æ•°</span></h4><blockquote><p>ç±»ä¸­ çš„å†™æ³•</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¬¬ä¸€ç§å†™æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">qq</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$result</span> = <span class="title function_ invoke__">array_reduce</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>], function (<span class="variable">$result</span>, <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">array_merge</span>(<span class="variable">$result</span>, <span class="title function_ invoke__">array_values</span>(<span class="variable">$value</span>));</span><br><span class="line">        &#125;, <span class="keyword">array</span>());</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//ç¬¬äºŒç§å†™æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">qq2</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">//å°†åŒ¿åå‡½æ•°äº¤ä¸ªä¸€ä¸ªå˜é‡</span></span><br><span class="line">        <span class="variable">$a</span> = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$result</span>, <span class="variable">$value</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">array_merge</span>(<span class="variable">$result</span>, <span class="title function_ invoke__">array_values</span>(<span class="variable">$value</span>));</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="variable">$result</span> = <span class="title function_ invoke__">array_reduce</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>], <span class="variable">$a</span>, <span class="keyword">array</span>());</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4><span id="2ç†è§£ä¸€ä¸ªé—­åŒ…åŒ¿åå‡½æ•°">2.ç†è§£ä¸€ä¸ªé—­åŒ…ï¼ˆåŒ¿åå‡½æ•°ï¼‰</span></h4><p>ç›®å‰phpç”¨åˆ°é—­åŒ…çš„æ•°ç»„å‡½æ•°åŒ…æ‹¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">array_map â€” ä¸ºæ•°ç»„çš„æ¯ä¸ªå…ƒç´ åº”ç”¨å›è°ƒå‡½æ•°</span><br><span class="line">array_walk â€” ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ åšå›è°ƒå¤„ç†</span><br><span class="line">array_reduce â€” ç”¨å›è°ƒå‡½æ•°è¿­ä»£åœ°å°†æ•°ç»„ç®€åŒ–ä¸ºå•ä¸€çš„å€¼</span><br><span class="line">array_filter â€” ç”¨å›è°ƒå‡½æ•°è¿‡æ»¤æ•°ç»„ä¸­çš„å•å…ƒ</span><br><span class="line">è¯¥å‡½æ•°æŠŠè¾“å…¥æ•°ç»„ä¸­çš„æ¯ä¸ªé”®å€¼ä¼ ç»™å›è°ƒå‡½æ•°ã€‚å¦‚æœå›è°ƒå‡½æ•°è¿”å› trueï¼Œåˆ™æŠŠè¾“å…¥æ•°ç»„ä¸­çš„å½“å‰é”®å€¼è¿”å›ç»“æœæ•°ç»„ä¸­ã€‚æ•°ç»„é”®åä¿æŒä¸å˜ã€‚</span><br><span class="line">array_intersect_uassoc â€” å¸¦ç´¢å¼•æ£€æŸ¥è®¡ç®—æ•°ç»„çš„äº¤é›†ï¼Œç”¨å›è°ƒå‡½æ•°æ¯”è¾ƒç´¢å¼•</span><br><span class="line">array_intersect_ukey â€” ç”¨å›è°ƒå‡½æ•°æ¯”è¾ƒé”®åæ¥è®¡ç®—æ•°ç»„çš„äº¤é›†</span><br><span class="line">array_reduce â€” ç”¨å›è°ƒå‡½æ•°è¿­ä»£åœ°å°†æ•°ç»„ç®€åŒ–ä¸ºå•ä¸€çš„å€¼</span><br><span class="line">æ‹¼æ¥æˆç±»ä¼¼ (1,2,3,4,5) </span><br><span class="line"></span><br><span class="line">array_walk_recursive â€” å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªæˆå‘˜é€’å½’åœ°åº”ç”¨ç”¨æˆ·å‡½æ•°</span><br><span class="line">----ç­‰ç­‰</span><br><span class="line">å¸¸ç”¨çš„å°±æ˜¯: array_map array_walk</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4><span id="3ä¸´æ—¶æ€»ç»“">3.ä¸´æ—¶æ€»ç»“</span></h4><p><strong>å¼‚åŒç‚¹</strong><br>â€ƒarray_filter() é‡ç‚¹åœ¨äºè¿‡æ»¤ï¼ˆè€Œä¸æ˜¯æ–°å¢ï¼‰æŸä¸ªå…ƒç´ ï¼Œå½“ä½ å¤„ç†åˆ°ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œè¿”å›è¿‡æ»¤åçš„æ•°ç»„<br>â€ƒarray_map() é‡ç‚¹åœ¨äºéå†ä¸€ä¸ªæ•°ç»„æˆ–å¤šä¸ªæ•°ç»„çš„å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„<br>â€ƒarray_walk() é‡ç‚¹åœ¨äºéå†æ•°ç»„è¿›è¡ŒæŸç§æ“ä½œ</p><p>â€ƒarray_filter() å’Œ array_walk()å¯¹ä¸€ä¸ªæ•°ç»„è¿›è¡Œæ“ä½œï¼Œæ•°ç»„å‚æ•°åœ¨å‰ï¼Œå‡½æ•°å‚æ•°åœ¨å<br>â€ƒarray_map() å¯ä»¥å¤„ç†å¤šä¸ªæ•°ç»„ï¼Œå› æ­¤å‡½æ•°å‚æ•°åœ¨å‰ï¼Œæ•°ç»„å‚æ•°åœ¨åï¼Œå¯ä»¥æ ¹æ®å®é™…æƒ…å†µæ”¾å…¥å¤šä¸ªæ•°ç»„å‚æ•°</p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Closure </tag>
            
            <tag> åŒ¿åå‡½æ•° </tag>
            
            <tag> åŒ¿åç±» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP-è¿è¡Œæ¨¡å¼cli fastcgi</title>
      <link href="/blog/2020/08/28/PHP/PHP-%E8%BF%90%E8%A1%8C%E6%A8%A1%E5%BC%8F/"/>
      <url>/blog/2020/08/28/PHP/PHP-%E8%BF%90%E8%A1%8C%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p><strong>1.cgiå…¨ç§°â€œé€šç”¨ç½‘å…³æ¥å£â€(Common Gateway Interface)ï¼Œ å®ƒå¯ä»¥è®©ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œä»æµè§ˆå™¨å‘WebæœåŠ¡å™¨ä¸Šçš„ç¨‹åºè¯·æ±‚æ•°æ®ï¼Œæ˜¯å®¢æˆ·ç«¯å’Œç¨‹åºä¹‹é—´ä¼ è¾“æ•°æ®çš„ä¸€ç§æ ‡å‡†ï¼Œå¦å¤–CGIç‹¬ç«‹äºä»»ä½•è¯­è¨€ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ä»»ä½•ä¸€ç§è¯­è¨€ç¼–å†™ï¼Œåªè¦è¿™ç§è¯­è¨€å…·æœ‰æ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œç¯å¢ƒå˜é‡ã€‚å¦‚php,perl,tclç­‰ã€‚CGIé’ˆå¯¹æ¯ä¸ªç”¨æˆ·è¯·æ±‚éƒ½è¦å¼€å•ç‹¬çš„å­è¿›ç¨‹å»ç»´æŠ¤ï¼Œæ‰§è¡Œç»“æŸå¤„ç†æ‰è¿™ä¸ªè¿›ç¨‹ã€‚å…¸å‹çš„fork-and-executeæ–¹å¼</strong></p><p>ã€€ã€€<strong>2.fastcgiï¼Œæ ¹æ®1ä¸­cgiçš„ç‰¹æ€§ï¼Œå¯ä»¥çŸ¥é“æ¶ˆè€—å¾ˆå¤§ï¼Œå¦‚æœå¾ˆå¤šç”¨æˆ·è¯·æ±‚ï¼Œåˆ™ä¼šç”³è¯·å¾ˆå¤šä¸ªå­è¿›ç¨‹ã€‚ã€‚è¿™æ—¶å€™å‡ºç°äº†FastCGIã€‚FastCGI åƒæ˜¯ä¸€ä¸ªå¸¸é©» (long-live) å‹çš„ CGIï¼Œå®ƒå¯ä»¥ä¸€ç›´æ‰§è¡Œç€ï¼Œåªè¦æ¿€æ´»åï¼Œä¸ä¼šæ¯æ¬¡éƒ½è¦èŠ±è´¹æ—¶é—´å» fork ä¸€æ¬¡ (è¿™æ˜¯ CGI æœ€ä¸ºäººè¯Ÿç—…çš„ fork-and-execute æ¨¡å¼)ã€‚è¿™ä¸ªæ˜¯å½“ä¸‹ç”¨çš„æœ€å¤šçš„äº†ã€‚ã€‚linux+nginx+php+mysql</strong></p><p>ã€€FastCGIçš„å·¥ä½œåŸç†æ˜¯ï¼š</p><p><em>(1)ã€Web Serverå¯åŠ¨æ—¶è½½å…¥FastCGIè¿›ç¨‹ç®¡ç†å™¨ã€PHPçš„FastCGIè¿›ç¨‹ç®¡ç†å™¨æ˜¯PHP-FPM(php-FastCGI Process Manager)ã€‘ï¼ˆnginx);</em><br><em>(2)ã€FastCGIè¿›ç¨‹ç®¡ç†å™¨è‡ªèº«åˆå§‹åŒ–ï¼Œå¯åŠ¨å¤šä¸ªCGIè§£é‡Šå™¨è¿›ç¨‹ (åœ¨ä»»åŠ¡ç®¡ç†å™¨ä¸­å¯è§å¤šä¸ªphp-cgi.exe)å¹¶ç­‰å¾…æ¥è‡ªWebServerçš„è¿æ¥ã€‚</em><br><em>(3)ã€å½“å®¢æˆ·ç«¯è¯·æ±‚åˆ°è¾¾Web Serveræ—¶ï¼ŒFastCGIè¿›ç¨‹ç®¡ç†å™¨é€‰æ‹©å¹¶è¿æ¥åˆ°ä¸€ä¸ªCGIè§£é‡Šå™¨ã€‚Web serverå°†CGIç¯å¢ƒå˜é‡å’Œæ ‡å‡†è¾“å…¥å‘é€åˆ°FastCGIå­è¿›ç¨‹php-cgiã€‚</em><br><em>(4)ã€FastCGIå­è¿›ç¨‹å®Œæˆå¤„ç†åå°†æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯ä¿¡æ¯ä»åŒä¸€è¿æ¥è¿”å›Web Serverã€‚å½“FastCGIå­è¿›ç¨‹å…³é—­è¿æ¥æ—¶ï¼Œè¯·æ±‚ä¾¿å‘Šå¤„ç†å®Œæˆã€‚FastCGIå­è¿›ç¨‹æ¥ç€ç­‰å¾…å¹¶å¤„ç†æ¥è‡ªFastCGIè¿›ç¨‹ç®¡ç†å™¨ï¼ˆè¿è¡Œåœ¨ WebServerä¸­ï¼‰çš„ä¸‹ä¸€ä¸ªè¿æ¥ã€‚åœ¨æ­£å¸¸çš„CGIæ¨¡å¼ä¸­ï¼Œphp-cgiæˆ– .exeåœ¨æ­¤ä¾¿é€€å‡ºäº†ã€‚</em><br><em>åœ¨CGIæ¨¡å¼ä¸­ï¼Œä½ å¯ä»¥æƒ³è±¡ CGIé€šå¸¸æœ‰å¤šæ…¢ã€‚æ¯ä¸€ä¸ªWebè¯·æ±‚PHPéƒ½å¿…é¡»é‡æ–°è§£æphp.iniã€é‡æ–°è½½å…¥å…¨éƒ¨dllæ‰©å±•å¹¶é‡åˆå§‹åŒ–å…¨éƒ¨æ•°æ®ç»“æ„ã€‚ä½¿ç”¨FastCGIï¼Œæ‰€æœ‰è¿™äº›éƒ½åªåœ¨è¿›ç¨‹å¯åŠ¨æ—¶å‘ç”Ÿä¸€æ¬¡ã€‚ä¸€ä¸ªé¢å¤–çš„å¥½å¤„æ˜¯ï¼ŒæŒç»­æ•°æ®åº“è¿æ¥(Persistent database connection)å¯ä»¥å·¥ä½œã€‚</em><br>ã€€ã€€<em>3.moduleå½¢å¼ä¸€èˆ¬ç”¨äºapacheï¼Œæ¨¡å—æ¨¡å¼æ˜¯ä»¥mod_php5æ¨¡å—çš„å½¢å¼é›†æˆï¼Œæ­¤æ—¶mod_php5æ¨¡å—çš„ä½œç”¨æ˜¯æ¥æ”¶Apacheä¼ é€’è¿‡æ¥çš„PHPæ–‡ä»¶è¯·æ±‚ï¼Œå¹¶å¤„ç†è¿™äº›è¯·æ±‚ï¼Œç„¶åå°†å¤„ç†åçš„ç»“æœè¿”å›ç»™Apacheã€‚</em><br>ã€€ã€€<em>4.cliæ¨¡å¼ã€‚å‘½ä»¤è¡Œæ‰§è¡Œphpï¼Œä¸€èˆ¬ä¸ç”¨ã€‚æˆ‘ä»¬åœ¨linuxä¸‹ç»å¸¸ä½¿ç”¨ â€œphp -mâ€æŸ¥æ‰¾PHPå®‰è£…äº†é‚£äº›æ‰©å±•å°±æ˜¯PHPå‘½ä»¤è¡Œè¿è¡Œæ¨¡å¼ï¼›ä¹Ÿå¯ä»¥ç›´æ¥å‘½ä»¤è¡Œæ‰§è¡Œphp xxx.php</em></p><h4><span id="1phpä¸€å…±åˆ†ä¸ºäº”å¤§è¿è¡Œæ¨¡å¼åŒ…æ‹¬ducgi-fast-cgi-cli-isapi-apache-æ¨¡å—çš„-dllcgi">1.phpä¸€å…±åˆ†ä¸ºäº”å¤§è¿è¡Œæ¨¡å¼ï¼šåŒ…æ‹¬ducgi ã€fast-cgiã€cliã€isapiã€apache æ¨¡å—çš„ DLLCGI</span></h4><p>  å…³äºPHPç›®å‰æ¯”è¾ƒå¸¸è§çš„äº”å¤§è¿è¡Œæ¨¡å¼ï¼š</p><p>1ï¼‰CGIï¼ˆé€šç”¨ç½‘å…³æ¥å£&#x2F; Common Gateway Interfaceï¼‰<br>2ï¼‰FastCGIï¼ˆå¸¸é©»å‹CGI &#x2F; Long-Live CGIï¼‰<br>3ï¼‰CLIï¼ˆå‘½ä»¤è¡Œè¿è¡Œ &#x2F; Command Line Interfaceï¼‰<br>4ï¼‰LoadModuleï¼ˆApacheç‹¬æœ‰ï¼‰ï¼š<br>åœ¨Apacheé…ç½®æ–‡ä»¶httpd.confé‡Œï¼Œé€šå¸¸åŠ çš„LoadModule php7_module â€œD:&#x2F;â€¦&#x2F;php71&#x2F;php7apache2_4.dllâ€èµ·åˆ°çš„ä½œç”¨å°±æ˜¯è¿™ä¸ª<br>5ï¼‰ISAPIï¼ˆInternet Server Application Program Interfaceï¼‰<br>IISç‹¬æœ‰ï¼š<br>å¤‡æ³¨ï¼šåœ¨PHP5.3ä»¥åï¼ŒPHPä¸å†æœ‰ISAPIæ¨¡å¼ï¼Œå®‰è£…åä¹Ÿä¸å†æœ‰php5isapi.dllè¿™ä¸ªæ–‡ä»¶ã€‚è¦åœ¨IIS6ä¸Šä½¿ç”¨é«˜ç‰ˆæœ¬PHPï¼Œå¿…é¡»å®‰è£…FastCGI æ‰©å±•ï¼Œç„¶åä½¿IIS6æ”¯æŒFastCGIã€‚  </p><h3><span id="2-php-cli-ä¸php-fpmfastcgi-process-manager">2ã€php-cli ä¸php-fpmï¼ˆfastcgi process managerï¼‰</span></h3><p><img src="https://img-blog.csdnimg.cn/20190420173441325.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lpbnFpYW45OTk=,size_16,color_FFFFFF,t_70" alt="[**CGIã€FastCGIå’ŒPHP-FPMå…³ç³»å›¾è§£**](https://www.awaimai.com/371.html)"></p><p>cli æ¨¡å¼å°±æ˜¯å¸¸è§çš„å‘½ä»¤ä½¿ç”¨çš„phpå‘½ä»¤ï¼Œå…¶å®ä»–ä¹Ÿå¯ä»¥æä¾›httpè¯·æ±‚æœåŠ¡ï¼Œå†…ç½®äº†httpæœåŠ¡å™¨<br>fpm æ˜¯ä¸€ä¸ªå¤šè¿›ç¨‹æ¶æ„çš„FastCgi æœåŠ¡ï¼Œå†…ç½®PHPè§£é‡Šå™¨è¿›ç¨‹å¸¸é©»åå°ï¼Œè‡ªå¸¦è¿›ç¨‹ç®¡ç†æ”¯æŒè¿›ç¨‹æ± é…ç½®å’Œé…ç½®Nginxä½¿ç”¨</p><p>cli å’Œfpm æ˜¯ä¸¤ä¸ªè¿è¡Œæ–¹å¼</p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cgi </tag>
            
            <tag> fastcgi </tag>
            
            <tag> cli </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP-ç†è§£phpçš„Generator,yield,Iteratoræ¥å£</title>
      <link href="/blog/2020/08/28/PHP/PHP-%E7%90%86%E8%A7%A3php%E7%9A%84Generator,yield,Iterator%E6%8E%A5%E5%8F%A3/"/>
      <url>/blog/2020/08/28/PHP/PHP-%E7%90%86%E8%A7%A3php%E7%9A%84Generator,yield,Iterator%E6%8E%A5%E5%8F%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><blockquote><p>ç­‰å¾…æ›´æ–°<br>yield<br>è§£å†³è¯»å–å¤§æ–‡</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Generator </tag>
            
            <tag> yield </tag>
            
            <tag> Iterator - ç­‰å¾…æ›´æ–° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…¶ä»–-serveré…±æ‰“å¡ç½‘æ˜“äº‘</title>
      <link href="/blog/2020/08/26/Wiki/%E5%85%B6%E4%BB%96-Server%E9%85%B1%E6%89%93%E5%8D%A1%E7%BD%91%E6%98%93%E4%BA%91%20%E5%B0%8F%E6%8A%80%E5%B7%A7/"/>
      <url>/blog/2020/08/26/Wiki/%E5%85%B6%E4%BB%96-Server%E9%85%B1%E6%89%93%E5%8D%A1%E7%BD%91%E6%98%93%E4%BA%91%20%E5%B0%8F%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><blockquote><p>ç­‰å¾…æ›´æ–°</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç½‘æ˜“äº‘ serveré…± py äº‘å‡½æ•°  å¾…æ›´æ–° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker-info</title>
      <link href="/blog/2020/08/20/DOCKER/Docker-%E5%88%B6%E4%BD%9C-1/"/>
      <url>/blog/2020/08/20/DOCKER/Docker-%E5%88%B6%E4%BD%9C-1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h4><span id="æ³¨å†Œç™»å½•">æ³¨å†Œç™»å½•</span></h4><p><a href="https://hub.docker.com/">https://hub.docker.com/</a></p><h4><span id="dockerå¿«æ·é”®">Dockerå¿«æ·é”®</span></h4><blockquote><p>å¸¸ç”¨ï¼š start restart stop  images ps-a</p></blockquote><h5><span id="å¸¦æœ‰å‚æ•°çš„ä½¿ç”¨">å¸¦æœ‰å‚æ•°çš„ä½¿ç”¨</span></h5><p>docker ps -a ï¼šæŸ¥çœ‹æœ€è¿‘ä½¿ç”¨çš„å®¹å™¨id</p><p>docker rm å®¹å™¨id:åˆ é™¤æŸä¸ªå®¹å™¨</p><p>docker images</p><p>docker rmi é•œåƒid:åˆ é™¤æŸä¸ªé•œåƒ</p><p>docker run :</p><p>docker run -d -p 9200:9200 -p 5601:5601 nshou&#x2F;elasticsearch-kibana</p><blockquote><p>-d åå°è¿è¡Œï¼Œ-p å†…éƒ¨ç«¯å£&#x2F;å®¿ä¸»æœºç«¯å£ å®¹å™¨id</p></blockquote><p>docker exec -it &#x2F;bash :è¿›å…¥å®¹å™¨</p><p>docker login -u xx -p xxxï¼šç™»å½•</p><h4><span id="é…ç½®åŠ é€Ÿæº">é…ç½®åŠ é€Ÿæº</span></h4><p>1.é˜¿é‡Œäº‘ï¼šç™¾åº¦å¦‚ä½•é€šè¿‡é˜¿é‡Œäº‘åŠ é€Ÿdockeræ‹‰å–å’Œæ¨é€é€Ÿåº¦</p><p>2.DaoCloud ï¼šå¤§å…¬å¸ï¼Œå›½å†…çš„ã€‚ç½‘ç«™ï¼š<a href="https://www.daocloud.io/mirror">https://www.daocloud.io/mirror</a></p><blockquote><p>åŠ é€Ÿurl</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Linux:curl -sSL https://get.daocloud.io/daotools/set_mirror.sh | sh -s http://f1361db2.m.daocloud.io</span><br></pre></td></tr></table></figure><p>åŸç†ï¼šç¼–è¾‘   &#x2F;etc&#x2F;docker&#x2F;daemon.json  è¿™ä¸ªæ–‡ä»¶å¤¹</p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;registry-mirrors&quot;: [&quot;http://f1361db2.m.daocloud.io&quot;,&quot;https://vbw6t0eb.mirror.aliyuncs.com&quot;]&#125;</span><br></pre></td></tr></table></figure><h4><span id="æŸ¥çœ‹å½“å‰dockeré…ç½®æ–‡ä»¶">æŸ¥çœ‹å½“å‰dockeré…ç½®æ–‡ä»¶</span></h4><p>docker info :å¯ä»¥æŸ¥çœ‹æ˜¯å¦é…ç½®æˆåŠŸåŠ é€Ÿ ç‰ˆæœ¬ä¿¡æ¯ç­‰å„ç§ä¿¡æ¯</p><h4><span id="æ‰“åŒ…é•œåƒæºå’Œæ¨é€åˆ°dockerio">æ‰“åŒ…é•œåƒæºå’Œæ¨é€åˆ°docker.io</span></h4><p>1.docker pull xxxé•œåƒ:tag</p><p>2.docker images æŸ¥çœ‹é•œåƒ</p><p>3.docker run -d -p 8080:8081 xxxé•œåƒ:version</p><p>4.docker ps -a æŸ¥çœ‹æ˜¯ä¸æ˜¯å¯åŠ¨äº†ï¼Œç„¶åstop start restart æ‰¾æ‰¾æ„Ÿè§‰</p><p>5.docker exec -it é•œåƒid bash :è¿›å…¥é•œåƒè¿›è¡Œä¿®æ”¹ï¼šæ‹‰ä»£ç ï¼ŒæŸ¥bug ,å¢åŠ mysqlå®ä¾‹ç­‰</p><p>6.docker commit -m â€œphp71-daemon:xhprof-graphvizâ€ -a â€œsomeâ€ f69187b4375e â€œ18260356308&#x2F;php71-daemon:xhprofâ€</p><p>â€‹docker commit -m â€œæäº¤logâ€ -a â€œä½œè€…â€  å®¹å™¨id â€œdockerè´¦æˆ·å&#x2F;è‡ªå®šä¹‰é•œåƒåï¼štagâ€ å°±ä¼šåˆ¶ä½œæˆä¸€ä¸ªæ–°çš„imageäº†</p><p>7.æ‰§è¡Œdocker push xxxé•œåƒçš„idï¼š</p><blockquote><p>tips:</p><p>å‰ææ˜¯å¾—ç™»å½•ï¼Œè¿˜æœ‰  æ³¨æ„ä¸€ä¸ªé—®é¢˜,ç»™è‡ªå·±é•œåƒå‘½åçš„æ—¶å€™æ ¼å¼åº”è¯¥æ˜¯: dockeræ³¨å†Œç”¨æˆ·å&#x2F;é•œåƒå,æ¯”å¦‚æˆ‘çš„dockerç”¨æˆ·åä¸º test123,é‚£ä¹ˆæˆ‘çš„é•œåƒtagå°±ä¸º test123&#x2F;whalesay,ä¸ç„¶æ˜¯pushä¸ä¸Šå»çš„</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> DOCKER </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docekr images </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP-xhprof-æ€§èƒ½ä¼˜åŒ–</title>
      <link href="/blog/2020/08/20/PHP/PHP-xhprof-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
      <url>/blog/2020/08/20/PHP/PHP-xhprof-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h3><span id="ç®€ä»‹">ç®€ä»‹</span></h3><hr><h3><span id="å®‰è£…">å®‰è£…</span></h3><hr><h3><span id="åµŒå…¥ä»£ç ">åµŒå…¥ä»£ç </span></h3><hr><h3><span id="æŸ¥çœ‹åˆ†ææŠ¥å‘Š">æŸ¥çœ‹åˆ†ææŠ¥å‘Š</span></h3><hr><h3><span id="æ€»ç»“">æ€»ç»“</span></h3><hr><h3><span id="åè¯è§£é‡Š">åè¯è§£é‡Š</span></h3><p>Function Nameï¼šæ–¹æ³•åç§°ã€‚</p><p>Callsï¼šæ–¹æ³•è¢«è°ƒç”¨çš„æ¬¡æ•°ã€‚</p><p>Calls%ï¼šæ–¹æ³•è°ƒç”¨æ¬¡æ•°åœ¨åŒçº§æ–¹æ³•æ€»æ•°è°ƒç”¨æ¬¡æ•°ä¸­æ‰€å çš„ç™¾åˆ†æ¯”ã€‚</p><p>Incl.Wall Time(microsec)ï¼šæ–¹æ³•æ‰§è¡ŒèŠ±è´¹çš„æ—¶é—´ï¼ŒåŒ…æ‹¬å­æ–¹æ³•çš„æ‰§è¡Œæ—¶é—´ã€‚ï¼ˆå•ä½ï¼šå¾®ç§’ï¼‰</p><p>IWall%ï¼šæ–¹æ³•æ‰§è¡ŒèŠ±è´¹çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚</p><p>Excl. Wall Time(microsec)ï¼šæ–¹æ³•æœ¬èº«æ‰§è¡ŒèŠ±è´¹çš„æ—¶é—´ï¼Œä¸åŒ…æ‹¬å­æ–¹æ³•çš„æ‰§è¡Œæ—¶é—´ã€‚ï¼ˆå•ä½ï¼šå¾®ç§’ï¼‰</p><p>EWall%ï¼šæ–¹æ³•æœ¬èº«æ‰§è¡ŒèŠ±è´¹çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚</p><p>Incl. CPU(microsecs)ï¼šæ–¹æ³•æ‰§è¡ŒèŠ±è´¹çš„CPUæ—¶é—´ï¼ŒåŒ…æ‹¬å­æ–¹æ³•çš„æ‰§è¡Œæ—¶é—´ã€‚ï¼ˆå•ä½ï¼šå¾®ç§’ï¼‰</p><p>ICpu%ï¼šæ–¹æ³•æ‰§è¡ŒèŠ±è´¹çš„CPUæ—¶é—´ç™¾åˆ†æ¯”ã€‚</p><p>Excl. CPU(microsec)ï¼šæ–¹æ³•æœ¬èº«æ‰§è¡ŒèŠ±è´¹çš„CPUæ—¶é—´ï¼Œä¸åŒ…æ‹¬å­æ–¹æ³•çš„æ‰§è¡Œæ—¶é—´ã€‚ï¼ˆå•ä½ï¼šå¾®ç§’ï¼‰</p><p>ECPU%ï¼šæ–¹æ³•æœ¬èº«æ‰§è¡ŒèŠ±è´¹çš„CPUæ—¶é—´ç™¾åˆ†æ¯”ã€‚</p><p>Incl.MemUse(bytes)ï¼šæ–¹æ³•æ‰§è¡Œå ç”¨çš„å†…å­˜ï¼ŒåŒ…æ‹¬å­æ–¹æ³•æ‰§è¡Œå ç”¨çš„å†…å­˜ã€‚ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰</p><p>IMemUse%ï¼šæ–¹æ³•æ‰§è¡Œå ç”¨çš„å†…å­˜ç™¾åˆ†æ¯”ã€‚</p><p>Excl.MemUse(bytes)ï¼šæ–¹æ³•æœ¬èº«æ‰§è¡Œå ç”¨çš„å†…å­˜ï¼Œä¸åŒ…æ‹¬å­æ–¹æ³•æ‰§è¡Œå ç”¨çš„å†…å­˜ã€‚ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰</p><p>EMemUse%ï¼šæ–¹æ³•æœ¬èº«æ‰§è¡Œå ç”¨çš„å†…å­˜ç™¾åˆ†æ¯”ã€‚</p><p>Incl.PeakMemUse(bytes)ï¼šIncl.MemUseå³°å€¼ã€‚ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰</p><p>IPeakMemUse%ï¼šIncl.MemUseå³°å€¼ç™¾åˆ†æ¯”ã€‚</p><p>Excl.PeakMemUse(bytes)ï¼šExcl.MemUseå³°å€¼ã€‚å•ä½ï¼šï¼ˆå­—èŠ‚ï¼‰</p><p>EPeakMemUse%ï¼šExcl.MemUseå³°å€¼ç™¾åˆ†æ¯”ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xhprof docker push </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GOLANG-ç¬”è®°-ArrayMapSlice</title>
      <link href="/blog/2020/06/29/GOLANG/GOLANG-%E7%AC%94%E8%AE%B02-ArrayMapSlice/"/>
      <url>/blog/2020/06/29/GOLANG/GOLANG-%E7%AC%94%E8%AE%B02-ArrayMapSlice/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h4><span id="1golang-æ•°æ®ç±»å‹">1.golang æ•°æ®ç±»å‹</span></h4><p>1ã€åŸºæœ¬æ•°æ®ç±»å‹ï¼šæ•´å½¢ã€æµ®ç‚¹ã€å¸ƒå°”ã€å­—ç¬¦ä¸²ã€å­—ç¬¦<br>2ã€å¤åˆæ•°æ®ç±»å‹ï¼šå‡½æ•°ä¸æŒ‡é’ˆã€æ•°ç»„ã€åˆ‡ç‰‡ã€mapã€listã€ç»“æ„ä½“ã€é€šé“</p><h4><span id="11-å‡½æ•°ä¸æŒ‡é’ˆ">1.1 å‡½æ•°ä¸æŒ‡é’ˆ</span></h4><p>å‡½æ•°ï¼šfuncï¼ˆï¼‰<br>æŒ‡é’ˆï¼š* ä»£è¡¨æŒ‡é’ˆ &amp; å»åœ°å€ç¬¦ ï¼ˆå¼•ç”¨ä¼ å€¼ï¼‰</p><p>*å¯ä»¥è¡¨ç¤ºä¸€ä¸ªå˜é‡æ˜¯æŒ‡é’ˆç±»å‹ , ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸€ä¸ªæŒ‡é’ˆå˜é‡æ‰€æŒ‡å‘çš„å­˜å‚¨å•å…ƒ , ä¹Ÿå°±æ˜¯è¿™ä¸ªåœ°å€æ‰€å­˜å‚¨çš„å€¼ .<br>æ‰“å° *ç±»å‹æ•°æ®è·å–çš„ä¸€å †2è¿›åˆ¶æ•°æ®</p><p>&amp;å¯¹å˜é‡å–åœ°å€ å³å–å¾—æŸä¸ªå˜é‡çš„åœ°å€ , å¦‚ ; &amp;a</p><h4><span id="12æ•°ç»„">1.2æ•°ç»„</span></h4><p>Array(æ•°ç»„)<br>æ•°ç»„æ˜¯å¾ˆæœ‰ä»·å€¼çš„æ•°æ®ç»“æ„ï¼Œå› ä¸ºå®ƒçš„å†…å­˜åˆ†é…æ˜¯è¿ç»­çš„ï¼Œå†…å­˜è¿ç»­æ„å‘³ç€å¯æ˜¯è®©å®ƒåœ¨ CPU ç¼“å­˜ä¸­å¾…æ›´ä¹…ï¼Œæ‰€ä»¥è¿­ä»£æ•°ç»„å’Œç§»åŠ¨å…ƒç´ éƒ½ä¼šéå¸¸è¿…é€Ÿã€‚</p><ul><li>æ•°ç»„æ‰€æœ‰ çš„key éƒ½æ˜¯int é»˜è®¤ä»0 å¼€å§‹ï¼Œstringç±»å‹çš„æ˜¯mapå’Œlistå…¶ä»–ï¼Œä¸å»ºè®®ä½¿ç”¨æ•°ç»„ï¼Œä¸€èˆ¬ç›´æ¥ä¸Šåˆ‡ç‰‡</li><li>var å˜é‡å [æ•°ç»„é•¿åº¦]æ•°æ®ç±»å‹<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">var a [4]int</span><br><span class="line">println(a)</span><br><span class="line">d := [3]int&#123;1, 2, 4&#125;</span><br><span class="line">println(d)</span><br><span class="line">f := [...]int&#123;1, 2, 4, 5, 6&#125; //... çœç•¥æ•°ç»„é•¿åº¦ è‡ªåŠ¨è®¡ç®—</span><br><span class="line">println(f)</span><br><span class="line"></span><br><span class="line">a2 := [...]int&#123;1, 2, 4: 5, 6&#125;</span><br><span class="line">println(a2)</span><br><span class="line">for key, val := range a2 &#123;</span><br><span class="line">println(key,val)</span><br><span class="line">&#125;</span><br><span class="line"> // äºŒç»´æ•°ç»„èµ‹å€¼ </span><br><span class="line">var arrayarr = [3][4]int&#123;&#123;1, 2, 3, 4&#125;, &#123;5, 6, 7, 8&#125;, &#123;9, 10, 11, 12&#125;&#125;</span><br><span class="line">dd := [...][...]string&#123;</span><br><span class="line">&#123;&quot;3&quot;, &quot;4&quot;&#125;,</span><br><span class="line">&#123;&quot;c&quot;, &quot;2&quot;&#125;,</span><br><span class="line">&#125;</span><br><span class="line">println(dd)</span><br><span class="line">println(arrayarr)</span><br><span class="line">  </span><br></pre></td></tr></table></figure></li><li>è¡¥å……ä¸€ä¸ªå¾ˆæ¶å¿ƒçš„ä»£ç <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//è¡¥å……ä¸€ç§ç¡®å®šä¸‹æ ‡çš„æ•°ç»„å£°æ˜åŠå®šä¹‰æ–¹å¼ï¼š</span><br><span class="line">func testArray04()&#123;</span><br><span class="line">//a1æ•°ç»„ä¸‹æ ‡0çš„æ²¡æœ‰å®šä¹‰ï¼Œé»˜è®¤ä¸º0ï¼Œä¸‹æ ‡1çš„æ˜¯2ï¼Œä¸‹æ ‡2çš„æ˜¯3ï¼Œ</span><br><span class="line">a1 := [...]int&#123;2:3,1:2&#125; //è¿™è¾¹çš„2 æ˜¯key æ‰“å°æŒ‰ç…§keyæ¥æ‰“å°</span><br><span class="line">fmt.Println(a1)      //[0 2 3]</span><br><span class="line"> </span><br><span class="line">//a2æ•°ç»„ä¸‹æ ‡4å®šä¹‰ä¸º5ï¼Œä¹‹å‰ä¸‹æ ‡2å’Œ3æœªå®šä¹‰ï¼Œé»˜è®¤ä¸º0</span><br><span class="line">a2 := [...]int&#123;1,2,4:5,6&#125;</span><br><span class="line">fmt.Println(a2)      //[1 2 0 0 5 6]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4><span id="13-mapé›†åˆ">1.3 Map(é›†åˆ)</span></h4><p>Map æ˜¯ä¸€ç§æ— åºçš„é”®å€¼å¯¹çš„é›†åˆã€‚Map æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯é€šè¿‡ key æ¥å¿«é€Ÿæ£€ç´¢æ•°æ®ï¼Œkey ç±»ä¼¼äºç´¢å¼•ï¼ŒæŒ‡å‘æ•°æ®çš„å€¼ã€‚<br>Map æ˜¯ä¸€ç§é›†åˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åƒè¿­ä»£æ•°ç»„å’Œåˆ‡ç‰‡é‚£æ ·è¿­ä»£å®ƒã€‚ä¸è¿‡ï¼ŒMap æ˜¯æ— åºçš„ï¼Œæˆ‘ä»¬æ— æ³•å†³å®šå®ƒçš„è¿”å›é¡ºåºï¼Œè¿™æ˜¯å› ä¸º Map æ˜¯ä½¿ç”¨ hash è¡¨æ¥å®ç°çš„ã€‚</p><p>å£°æ˜ï¼š m :&#x3D; make(map[string]string)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ff := map[string]string&#123;</span><br><span class="line">&quot;a&quot;: &quot;c&quot;,</span><br><span class="line">&#125;</span><br><span class="line"> var keys []string</span><br><span class="line">  for k := range m &#123;</span><br><span class="line">    keys = append(keys, k) //append  ç›´æ¥åœ¨åˆ‡ç‰‡çº§åˆ«è¿›è¡Œæè¿°</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">for s, s2 := range ff &#123;</span><br><span class="line">println(s,s2)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ff := map[string]string&#123;</span><br><span class="line">&quot;a&quot;: &quot;c&quot;,</span><br><span class="line">&#125;</span><br><span class="line">fff:=make(map[string]int) //ç›´æ¥å£°æ˜ä¸åŠ å‚æ•°</span><br><span class="line">ff[&quot;cc&quot;]=&quot;cccc&quot;;//èµ‹å€¼</span><br><span class="line">delete(ff,&quot;cc&quot;)</span><br></pre></td></tr></table></figure><h4><span id="14åˆ‡ç‰‡">1.4åˆ‡ç‰‡</span></h4><h4><span id="15-ç»“æ„ä½“">1.5 ç»“æ„ä½“</span></h4><p>å®šä¹‰åˆ‡ç‰‡:<br>ä½ å¯ä»¥å£°æ˜ä¸€ä¸ªæœªæŒ‡å®šå¤§å°çš„æ•°ç»„æ¥å®šä¹‰åˆ‡ç‰‡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var identifier []type//æœªå®šä¹‰å¤§å°çš„æ•°ç»„å³åˆ‡ç‰‡</span><br></pre></td></tr></table></figure><p>æˆ–ä½¿ç”¨ make() å‡½æ•°æ¥åˆ›å»ºåˆ‡ç‰‡:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slice1 := make([]type, len)  //make([]T, length, capacity)</span><br></pre></td></tr></table></figure><p>append  å’Œcopy æµ…æ‹·è´</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var numbers []int</span><br><span class="line">numbers = append(numbers, 0)//appendè¿½åŠ </span><br><span class="line">  /* åŒæ—¶æ·»åŠ å¤šä¸ªå…ƒç´  */</span><br><span class="line">numbers = append(numbers, 2,3,4)</span><br><span class="line"> /* æ‹·è´ numbers çš„å†…å®¹åˆ° numbers1 */</span><br><span class="line">copy(numbers1,numbers)</span><br></pre></td></tr></table></figure><h4><span id="16-listé“¾è¡¨">1.6 Listï¼ˆé“¾è¡¨ï¼‰</span></h4><p>éå†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// å£°æ˜é“¾è¡¨</span><br><span class="line">l := list.New()</span><br><span class="line"></span><br><span class="line">// æ•°æ®æ·»åŠ åˆ°å°¾éƒ¨</span><br><span class="line">l.PushBack(4)</span><br><span class="line">l.PushBack(5)</span><br><span class="line">l.PushBack(6)</span><br><span class="line"></span><br><span class="line">// éå†</span><br><span class="line">for e := l.Front(); e != nil; e = e.Next() &#123;</span><br><span class="line">     fmt.Printf(&quot;%v\n&quot;, e.Value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> l := list.New()</span><br><span class="line"> l.PushBack(4)</span><br><span class="line"> six := l.PushBack(6)</span><br><span class="line"> l.Remove(six) // åˆ é™¤6è¿™ä¸ªèŠ‚ç‚¹</span><br></pre></td></tr></table></figure><h4><span id="16-é€šé“">1.6 é€šé“</span></h4><p> å…¶ä»–æ–‡ç« ä¼šæœ‰è¯¦ç»†è®²è¿°</p><h4><span id="2æ€»ç»“">2æ€»ç»“</span></h4><p>æ•°ç»„æ˜¯ slice å’Œ map çš„åº•å±‚ç»“æ„ã€‚<br>slice æ˜¯ Go é‡Œé¢æƒ¯ç”¨çš„é›†åˆæ•°æ®çš„æ–¹æ³•ï¼Œmap åˆ™æ˜¯ç”¨æ¥å­˜å‚¨é”®å€¼å¯¹ã€‚<br>å†…å»ºå‡½æ•° make ç”¨æ¥åˆ›å»º slice å’Œ mapï¼Œå¹¶ä¸”ä¸ºå®ƒä»¬æŒ‡å®šé•¿åº¦å’Œå®¹é‡ç­‰ç­‰ã€‚slice å’Œ map å­—é¢å€¼ä¹Ÿå¯ä»¥åšåŒæ ·çš„äº‹ã€‚<br>slice æœ‰å®¹é‡çš„çº¦æŸï¼Œä¸è¿‡å¯ä»¥é€šè¿‡å†…å»ºå‡½æ•° append æ¥å¢åŠ å…ƒç´ ã€‚<br>map æ²¡æœ‰å®¹é‡ä¸€è¯´ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰ä»»ä½•å¢é•¿é™åˆ¶ã€‚<br>å†…å»ºå‡½æ•° len å¯ä»¥ç”¨æ¥è·å¾— slice å’Œ map çš„é•¿åº¦ã€‚<br>å†…å»ºå‡½æ•° cap åªèƒ½ä½œç”¨åœ¨ slice ä¸Šã€‚<br>å¯ä»¥é€šè¿‡ç»„åˆæ–¹å¼æ¥åˆ›å»ºå¤šç»´æ•°ç»„å’Œ sliceã€‚map çš„å€¼å¯ä»¥æ˜¯ slice æˆ–è€…å¦ä¸€ä¸ª mapã€‚slice ä¸èƒ½ä½œä¸º map çš„é”®ã€‚<br>åœ¨å‡½æ•°ä¹‹é—´ä¼ é€’ slice å’Œ map æ˜¯ç›¸å½“å»‰ä»·çš„ï¼Œå› ä¸ºä»–ä»¬ä¸ä¼šä¼ é€’åº•å±‚æ•°ç»„çš„æ‹·è´ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> GOLANG </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Slice </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP-SPL(æ•°æ®ç»“æ„)</title>
      <link href="/blog/2020/06/23/PHP/PHP-SPL(%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84)/"/>
      <url>/blog/2020/06/23/PHP/PHP-SPL(%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84)/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><blockquote><p>php SPLå››ç§å¸¸ç”¨çš„æ•°æ®ç»“æ„<br>1.æ ˆã€å…ˆè¿›åå‡ºã€‘</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;span style=&quot;font-size:18px;&quot;&gt;$stack = new SplStack();</span><br><span class="line">$stack-&gt;push(&#x27;data1&#x27;);</span><br><span class="line">$stack-&gt;push(&#x27;data2&#x27;);</span><br><span class="line">$stack-&gt;push(&#x27;data3&#x27;);</span><br><span class="line">echo $stack-&gt;pop();</span><br><span class="line"> </span><br><span class="line">//è¾“å‡ºç»“æœä¸º</span><br><span class="line">//data3&lt;/span&gt;&lt;span style=&quot;font-size:24px;font-weight: bold;&quot;&gt;</span><br><span class="line">&lt;/span&gt;</span><br></pre></td></tr></table></figure><p>2.é˜Ÿåˆ—ã€å…ˆè¿›å…ˆå‡º åè¿›åå‡ºã€‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;span style=&quot;font-size:18px;&quot;&gt;$queue = new SplQueue();</span><br><span class="line">$queue-&gt;enqueue(&quot;data1&quot;);</span><br><span class="line">$queue-&gt;enqueue(&quot;data2&quot;);</span><br><span class="line">$queue-&gt;enqueue(&quot;data3&quot;);</span><br><span class="line">echo $queue-&gt;dequeue();</span><br><span class="line">//è¾“å‡ºç»“æœä¸º</span><br><span class="line">//data1&lt;/span&gt;</span><br></pre></td></tr></table></figure><p>3.å †</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;span style=&quot;font-size:18px;&quot;&gt;$heap = new SplMinHeap();</span><br><span class="line">$heap-&gt;insert(&quot;data1&quot;);</span><br><span class="line">$heap-&gt;insert(&quot;data2&quot;);</span><br><span class="line">echo $heap-&gt;extract();</span><br><span class="line">//è¾“å‡ºç»“æœä¸º</span><br><span class="line">//data1&lt;/span&gt;</span><br></pre></td></tr></table></figure><p>4.å›ºå®šå°ºå¯¸æ•°ç»„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;span style=&quot;font-size:18px;&quot;&gt;$array = new SplFixedArray(5);</span><br><span class="line">$array[0]=1;</span><br><span class="line">$array[3]=3;</span><br><span class="line">$array[2]=2;</span><br><span class="line">var_dump($array);</span><br><span class="line">//è¾“å‡ºç»“æœä¸º</span><br><span class="line">// object(SplFixedArray)[1]</span><br><span class="line">// public 0 =&gt; int 1</span><br><span class="line">// public 1 =&gt; null</span><br><span class="line">// public 2 =&gt; int 2</span><br><span class="line">// public 3 =&gt; int 3</span><br></pre></td></tr></table></figure><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>æ¨èå­¦ä¹ ï¼š<a href="http://www.imooc.com/video/4849">http://www.imooc.com/video/4849</a><br>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/zhengwish/article/details/51742264">https://blog.csdn.net/zhengwish/article/details/51742264</a></p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP-use</title>
      <link href="/blog/2020/06/23/PHP/PHP-Use-%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF/"/>
      <url>/blog/2020/06/23/PHP/PHP-Use-%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>php useç”¨æ³•</p><h4><span id="1-user-namespace">1ã€user namespace</span></h4><h4><span id="2-use-ä¸€ä¸ªtrait">2ã€use ä¸€ä¸ªtrait</span></h4><p>é’ˆå¯¹äºtraitçš„å³å¤šç»§æ‰¿</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">A</span></span>&#123; <span class="title function_ invoke__">eat</span>()&#125; <span class="class"><span class="keyword">trait</span> <span class="title">B</span></span>&#123; <span class="title function_ invoke__">drink</span>()&#125;  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line"><span class="keyword">use</span> <span class="title">A</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">B</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Class D&#123;</span><br><span class="line">d=<span class="keyword">new</span> <span class="title class_">Class</span> <span class="title function_ invoke__">C</span>()</span><br><span class="line">d-&gt;<span class="title function_ invoke__">eat</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p> å½“ä¸åŒçš„traitä¸­ï¼Œå´æœ‰ç€åŒåçš„æ–¹æ³•æˆ–å±æ€§ï¼Œä¼šäº§ç”Ÿå†²çªï¼Œå¯ä»¥ä½¿ç”¨insteadofæˆ– asè¿›è¡Œè§£å†³ï¼Œinsteadof æ˜¯è¿›è¡Œæ›¿ä»£ï¼Œè€Œasæ˜¯ç»™å®ƒå–åˆ«å</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use trait1,trait2&#123;</span><br><span class="line">        trait1::eat insteadof trait2;</span><br><span class="line">        trait1::drive insteadof trait2;</span><br><span class="line">        trait2::eat as eaten;</span><br><span class="line">        trait2::drive as driven;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4><span id="3é—­åŒ…-gtåŒ¿åå‡½æ•°">3.é—­åŒ…-&gt;åŒ¿åå‡½æ•°</span></h4><p>å¥½å¤„ï¼šèŠ‚çœå†…å­˜  é€‚åˆåšå›è°ƒå‡½æ•°</p><p>åŒ¿åå‡½æ•°ï¼šå®šä¹‰æ—¶æœªå®šä¹‰å‡½æ•°çš„åç§°<br>é—­åŒ…ï¼š åˆ›å»ºæ—¶å°è£…å‘¨å›´çŠ¶æ€çš„å‡½æ•°ï¼ŒåŠæ—¶å‘¨å›´çš„ç¯å¢ƒä¸å­˜åœ¨äº†ï¼Œé—­åŒ…ä¸­çš„çŠ¶æ€è¿˜ä¼šå­˜åœ¨</p><p>ä½¿ç”¨æ³•åˆ™ï¼š</p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> USE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP-strlenä¸mb_strlen</title>
      <link href="/blog/2020/06/22/PHP/PHP-strlen%E4%B8%8Emb-strlen/"/>
      <url>/blog/2020/06/22/PHP/PHP-strlen%E4%B8%8Emb-strlen/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>åœ¨PHPä¸­ï¼Œstrlenä¸mb_strlenæ˜¯æ±‚å­—ç¬¦ä¸²é•¿åº¦çš„å‡½æ•°<br>PHPå†…ç½®çš„å­—ç¬¦ä¸²é•¿åº¦å‡½æ•°strlenæ— æ³•æ­£ç¡®å¤„ç†ä¸­æ–‡å­—ç¬¦ä¸²ï¼Œå®ƒå¾—åˆ°çš„åªæ˜¯å­—ç¬¦ä¸²æ‰€å çš„å­—èŠ‚æ•°ã€‚å¯¹äºGB2312çš„ä¸­æ–‡ç¼–ç ï¼Œstrlenå¾—åˆ°çš„å€¼æ˜¯æ±‰å­—ä¸ªæ•°çš„2å€ï¼Œè€Œå¯¹äºUTF-8ç¼–ç çš„ä¸­æ–‡ï¼Œå°±æ˜¯3å€ï¼ˆåœ¨ UTF-8ç¼–ç ä¸‹ï¼Œä¸€ä¸ªæ±‰å­—å 3ä¸ªå­—èŠ‚ï¼‰ã€‚</p><p>é‡‡ç”¨mb_strlenå‡½æ•°å¯ä»¥è¾ƒå¥½åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚mb_strlençš„ç”¨æ³•å’Œstrlenç±»ä¼¼ï¼Œåªä¸è¿‡å®ƒæœ‰ç¬¬äºŒä¸ªå¯é€‰å‚æ•°ç”¨äºæŒ‡å®šå­—ç¬¦ç¼–ç ã€‚ä¾‹å¦‚å¾—åˆ°UTF-8çš„å­—ç¬¦ä¸²stré•¿åº¦ï¼Œå¯ä»¥ç”¨mbstrlen(stré•¿åº¦ï¼Œå¯ä»¥ç”¨mbstrlen(str,â€˜UTF-8â€™)ã€‚å¦‚æœçœç•¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œåˆ™ä¼šä½¿ç”¨PHPçš„å†…éƒ¨ç¼–ç ã€‚å†…éƒ¨ç¼–ç å¯ä»¥é€šè¿‡ mb_internal_encoding()å‡½æ•°å¾—åˆ°ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œmb_strlenå¹¶ä¸æ˜¯PHPæ ¸å¿ƒå‡½æ•°ï¼Œä½¿ç”¨å‰éœ€è¦ç¡®ä¿åœ¨php.iniä¸­åŠ è½½äº†php_mbstring.dllï¼Œå³ç¡®ä¿â€œextension&#x3D;php_mbstring.dllâ€è¿™ä¸€è¡Œå­˜åœ¨å¹¶ä¸”æ²¡æœ‰è¢«æ³¨é‡Šæ‰ï¼Œå¦åˆ™ä¼šå‡ºç°æœªå®šä¹‰å‡½ æ•°çš„é—®é¢˜ã€‚</p><hr><p>åœ¨strlenè®¡ç®—ä¸­ï¼Œå¯¹å¾…ä¸€ä¸ªUTF8çš„ä¸­æ–‡å­—ç¬¦ï¼Œå¤„ç†ä¸º3ä¸ªå­—èŠ‚é•¿åº¦ï¼Œæ‰€ä»¥ä¸º3+1+2+1+9&#x3D;16ä¸ª</p><p>å½“mb_strlençš„å†…ç é€‰æ‹©ä¸ºUTF-8çš„æ—¶å€™ï¼Œåˆ™ä¼šå°†ä¸­æ–‡å­—ç¬¦å½“æˆä¸€ä¸ªå­—ç¬¦,æ‰€ä»¥ä¸º3+1+2+1+3&#x3D;10;</p><p>å½“mb_strlençš„å†…ç é€‰æ‹©ä¸ºgbkçš„æ—¶å€™ï¼Œä¸€ä¸ªä¸­æ–‡å­—ç¬¦å½“æˆ1.5ä¸ªå­—ç¬¦æ¥å¤„ç†æ¥å¤„ç†,æœ€åå°±æ˜¯:3+1+2+1+4.5&#x3D;11.5</p><p>å‡½æ•°ï¼šmb_internal_encoding()ä¼šå¾—åˆ°å½“å‰PHPä½¿ç”¨çš„å†…éƒ¨ç¼–ç </p><p>strlen,å¾—åˆ°çš„æ˜¯å­—ç¬¦ä¸²æ‰€å çš„å­—èŠ‚æ•°ï¼Œæ‰€ä»¥åœ¨æŸ¥çœ‹ä¸€ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦çš„æ—¶å€™ï¼Œstrlenå¹¶ä¸èƒ½å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„çœŸå®å€¼</p><p>mb_strlen å‡½æ•°å¯ä»¥å¾ˆå¥½çš„å¤„ç†è¿™ä¸€ç‚¹</p><p>æ³¨æ„ï¼šmb_strlenå‡½æ•°å¹¶ä¸æ˜¯phpçš„æ ¸å¿ƒå‡½æ•°ï¼Œåªæ˜¯PHPçš„ä¸€ä¸ªæ‰©å±•å‡½æ•°ï¼Œä½¿ç”¨ä¹‹å‰è¦åˆ¤æ–­æ˜¯å¦åŠ åœ¨çš„mbstringæ‰©å±•æ¨¡å—ï¼Œåœ¨Php.iniæ–‡ä»¶ä¸­å¯ä»¥æŸ¥çœ‹ç›¸å…³é…ç½®</p><blockquote><p>strlenç»“æœä¸ºä»€ä¹ˆæ˜¯4<br>strlenåœ¨é‡åˆ°ç¬¬ä¸€ä¸ª\0æ—¶ç»“æŸï¼Œåé¢çš„å­—ç¬¦æ— è§†ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> strlen </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…¶ä»–-ç§‘å­¦ä¸Šç½‘</title>
      <link href="/blog/2020/06/22/Wiki/%E5%85%B6%E4%BB%96-%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"/>
      <url>/blog/2020/06/22/Wiki/%E5%85%B6%E4%BB%96-%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h1><span id="è§£å†³systemreflectiontargetinvocationexception-è°ƒç”¨çš„ç›®æ ‡å‘ç”Ÿäº†å¼‚å¸¸">è§£å†³System.Reflection.TargetInvocationException: è°ƒç”¨çš„ç›®æ ‡å‘ç”Ÿäº†å¼‚å¸¸ã€‚</span></h1><blockquote><p>windows7ç³»ç»Ÿè¿è¡Œæ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æ”¾åˆ°Windows10 ä¸Šé¢å°±å‡ºç°è¿æ¥ä¸ä¸Šçš„é—®é¢˜ï¼Œè¯•äº†å¾ˆå¤šç§æ–¹æ³•è¿˜æ˜¯è¿™ç§è§£å†³äº†ã€‚</p></blockquote><p>é—®é¢˜ï¼š</p><p>System.Reflection.TargetInvocationException: è°ƒç”¨çš„ç›®æ ‡å‘ç”Ÿäº†å¼‚å¸¸ã€‚</p><p>â€”&gt; System.Reflection.TargetInvocationException: è°ƒç”¨çš„ç›®æ ‡å‘ç”Ÿäº†å¼‚å¸¸ã€‚</p><p>â€”&gt; System.InvalidOperationException: æ­¤å®ç°ä¸æ˜¯ Windows å¹³å° FIPS éªŒè¯çš„åŠ å¯†ç®—æ³•çš„ä¸€éƒ¨åˆ†</p><p>è§£å†³åŠæ³•ï¼šéœ€è¦ä¿®æ”¹æ³¨å†Œè¡¨,cmdå‘½ä»¤ï¼Œè¾“å…¥regeditæ‰“å¼€æ³¨å†Œè¡¨ç„¶åæ‰¾åˆ°ä»¥ä¸‹è·¯å¾„</p><p>KEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\FipsAlgorithmPolicy</p><p>ä¿®æ”¹æ­¤è·¯å¾„ä¸‹çš„Enableå€¼ä¸º1ï¼Œç„¶åé‡æ–°æ‰“å¼€shadowsocksï¼Œå¤§åŠŸå‘Šæˆï¼è®°å¾—é‡å¯ssr</p><p>ï¼ˆå¦‚æœ1ä¸è¡Œé‚£å°±åˆ‡æ¢æˆ0ï¼‰</p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/qq_27536941/article/details/103300646">https://blog.csdn.net/qq_27536941/article/details/103300646</a></p>]]></content>
      
      
      <categories>
          
          <category> å…¶ä»– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssr </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP-å¼‚å¸¸ç±»</title>
      <link href="/blog/2020/06/22/PHP/PHP-%E5%BC%82%E5%B8%B8%E7%B1%BB/"/>
      <url>/blog/2020/06/22/PHP/PHP-%E5%BC%82%E5%B8%B8%E7%B1%BB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>PHP å¼‚å¸¸ä¸é”™è¯¯ â€”â€” Throwable<br>Throwable</p><p>å®˜æ–¹æ–‡æ¡£åœ°å€ï¼š <a href="http://php.net/manual/en/class.throwable.php">http://php.net/manual/en/class.throwable.php</a></p><p>PHP æ”¯æŒç‰ˆæœ¬ï¼š 7</p><blockquote><p>PHP7 å¼‚å¸¸ä¸é”™è¯¯å¤„ç†æœºåˆ¶ Exception, Error, Throwable<br>Throwable æ˜¯ PHP 7 ä¸­å¯ä»¥ç”¨ä½œä»»ä½•å¯¹è±¡æŠ›å‡ºå£°æ˜çš„åŸºæœ¬æ¥å£ï¼ŒåŒ…æ‹¬ Expection ï¼ˆå¼‚å¸¸ï¼‰å’Œ Error ï¼ˆé”™è¯¯ï¼‰ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Throwable &#123;</span><br><span class="line">    </span><br><span class="line">  /* æŠ½è±¡æ–¹æ³• */</span><br><span class="line">  abstract public string getMessage ( void ) // è·å–æŠ›å‡ºçš„æ¶ˆæ¯å†…å®¹</span><br><span class="line"></span><br><span class="line">  abstract public int getCode ( void ) // è·å–æŠ›å‡ºçš„é”™è¯¯ä»£ç </span><br><span class="line"></span><br><span class="line">  abstract public string getFile ( void ) // è·å–äº§ç”Ÿå¼‚å¸¸çš„æ–‡ä»¶å</span><br><span class="line"></span><br><span class="line">  abstract public int getLine ( void ) // è·å–ç›¸å…³è¡Œå·</span><br><span class="line"></span><br><span class="line">  abstract public array getTrace ( void ) // è·å–è¿½è¸ªä¿¡æ¯ï¼Œè¿”å›æ•°ç»„å½¢å¼</span><br><span class="line"></span><br><span class="line">  abstract public string getTraceAsString ( void ) // è·å–è¿½è¸ªä¿¡æ¯ï¼Œè¿”å›å­—ç¬¦ä¸²å½¢å¼</span><br><span class="line"></span><br><span class="line">  abstract public Throwable getPrevious ( void ) // è¿”å›ä¸Šä¸€ä¸ª Throwable</span><br><span class="line"></span><br><span class="line">  abstract public string __toString ( void ) // æŠ›å‡ºçš„å¯¹è±¡ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›ï¼Œå¯ä»¥ç”¨ echo æ‰“å°ç›¸åº”ç»“æœ</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯·ä¸€å®šè¦æ³¨æ„ï¼Œæ²¡æœ‰ç‰¹æ®Šè¯´æ˜ï¼šæœ¬ä¾‹ PHP Version &lt; 7<br>ã€€ã€€è¯´èµ· PHP å¼‚å¸¸å¤„ç†ï¼Œå¤§å®¶é¦–å…ˆä¼šæƒ³åˆ° try-catchï¼Œé‚£å¥½ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€æ®µç¨‹åºå§ï¼šæœ‰ä¸€ä¸ª test.php æ–‡ä»¶ï¼Œæœ‰ä¸€æ®µç®€å•çš„ PHP ç¨‹åºï¼Œå†…å®¹å¦‚ä¸‹ï¼Œç„¶åå‘½ä»¤è¡Œæ‰§è¡Œï¼šphp test.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1 &lt;?php</span><br><span class="line">2 $num = 0;</span><br><span class="line">3     try &#123;</span><br><span class="line">4         echo 1/$num;</span><br><span class="line">5</span><br><span class="line">6 &#125; catch (Exception $e)&#123;</span><br><span class="line">7         echo $e-&gt;getMessage();</span><br><span class="line">8 &#125;</span><br><span class="line">9 ?&gt;</span><br></pre></td></tr></table></figure><p>ã€€ã€€æˆ‘çš„é—®é¢˜æ˜¯ï¼šè¿™æ®µç¨‹åºèƒ½æ­£ç¡®çš„æ•æ‰åˆ°é™¤ 0 çš„é”™è¯¯ä¿¡æ¯å—ï¼Ÿ<br>ã€€ã€€å¦‚æœä½ å›ç­”èƒ½ï¼Œé‚£ä½ å°±æŠŠè¿™ç¯‡æ–‡ç« çœ‹å®Œå§ï¼åº”è¯¥èƒ½å­¦ç‚¹ä¸œè¥¿ã€‚</p><p>æœ¬æ–‡ç« åˆ† 5 ä¸ªéƒ¨åˆ†ä»‹ç»æˆ‘çš„å¼‚å¸¸å¤„ç†çš„ç†è§£ï¼š</p><p>ä¸€ã€å¼‚å¸¸ä¸é”™è¯¯çš„æ¦‚è¿°</p><p>äºŒã€ERROR çš„çº§åˆ«</p><p>ä¸‰ã€PHP å¼‚å¸¸å¤„ç†ä¸­çš„é»‘ç§‘æŠ€</p><p>å››ã€å·§å¦™çš„æ•è·é”™è¯¯å’Œå¼‚å¸¸</p><p>äº”ã€è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†å’Œå¼‚å¸¸åµŒå¥—</p><p>å…­ã€PHP7 ä¸­çš„å¼‚å¸¸å¤„ç†</p><p>ä¸€ã€å¼‚å¸¸ä¸é”™è¯¯çš„æ¦‚è¿°<br>ã€€ã€€ PHP ä¸­ä»€ä¹ˆæ˜¯å¼‚å¸¸ï¼š<br>ã€€ã€€ç¨‹åºåœ¨è¿è¡Œä¸­å‡ºç°ä¸ç¬¦åˆé¢„æœŸçš„æƒ…å†µï¼Œå…è®¸å‘ç”Ÿï¼ˆä½ ä¹Ÿä¸æƒ³è®©ä»–å‡ºç°ä¸æ­£å¸¸çš„æƒ…å†µï¼‰ä½†ä»–æ˜¯ä¸€ç§ä¸æ­£å¸¸çš„æƒ…å†µï¼ŒæŒ‰ç…§æˆ‘ä»¬çš„æ­£å¸¸é€»è¾‘æœ¬ä¸è¯¥å‡ºçš„é”™è¯¯ï¼Œä½†ä»ç„¶ä¼šå‡ºç°çš„é”™è¯¯ï¼Œå±äºé€»è¾‘å’Œä¸šåŠ¡æµç¨‹çš„é”™è¯¯ï¼Œè€Œä¸æ˜¯ç¼–è¯‘æˆ–è€…è¯­æ³•ä¸Šçš„é”™è¯¯ã€‚</p><p>PHP ä¸­ä»€ä¹ˆæ˜¯é”™è¯¯ï¼š<br>ã€€ã€€å±äº php è„šæœ¬è‡ªèº«çš„é—®é¢˜ï¼Œå¤§éƒ¨åˆ†æƒ…å†µæ˜¯ç”±é”™è¯¯çš„è¯­æ³•ï¼ŒæœåŠ¡å™¨ç¯å¢ƒå¯¼è‡´ï¼Œä½¿å¾—ç¼–è¯‘å™¨æ— æ³•é€šè¿‡æ£€æŸ¥ï¼Œç”šè‡³æ— æ³•è¿è¡Œçš„æƒ…å†µã€‚warningã€notice éƒ½æ˜¯é”™è¯¯ï¼Œåªæ˜¯ä»–ä»¬çš„çº§åˆ«ä¸åŒè€Œå·²ï¼Œå¹¶ä¸”é”™è¯¯æ˜¯ä¸èƒ½è¢« try-catch æ•è·çš„ã€‚</p><p>ä¸Šé¢çš„è¯´æ³•æ˜¯æœ‰å‰ææ¡ä»¶çš„ï¼š<br>ã€€ã€€åœ¨ PHP ä¸­ï¼Œå› ä¸ºåœ¨å…¶ä»–è¯­è¨€ä¸­å°±ä¸èƒ½è¿™æ ·ä¸‹ç»“è®ºäº†ï¼Œä¹Ÿå°±æ˜¯è¯´å¼‚å¸¸å’Œé”™è¯¯çš„è¯´æ³•åœ¨ä¸åŒçš„è¯­è¨€æœ‰ä¸åŒçš„è¯´æ³•ã€‚åœ¨ PHP ä¸­ä»»ä½•è‡ªèº«çš„é”™è¯¯æˆ–è€…æ˜¯éæ­£å¸¸çš„ä»£ç éƒ½ä¼šå½“åšé”™è¯¯å¯¹å¾…ï¼Œå¹¶ä¸ä¼šä»¥å¼‚å¸¸çš„å½¢å¼æŠ›å‡ºï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›æƒ…å†µä¼šå½“åšå¼‚å¸¸å’Œé”™è¯¯åŒæ—¶æŠ›å‡º(æ®è¯´æ˜¯ï¼Œæˆ‘æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„ä¾‹å­)ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ æƒ³åœ¨æ•°æ®åº“è¿æ¥å¤±è´¥çš„æ—¶å€™è‡ªåŠ¨æ•è·å¼‚å¸¸æ˜¯è¡Œä¸é€šçš„ï¼Œå› ä¸ºè¿™å°±ä¸æ˜¯å¼‚å¸¸ï¼Œæ˜¯é”™è¯¯ã€‚ä½†æ˜¯åœ¨ java ä¸­å°±ä¸ä¸€æ ·äº†ï¼Œä»–ä¼šæŠŠå¾ˆå¤šå’Œé¢„æœŸä¸ä¸€è‡´çš„è¡Œä¸ºå½“åšå¼‚å¸¸æ¥è¿›è¡Œæ•è·ã€‚</p><p>PHP å¼‚å¸¸å¤„ç†å¾ˆé¸¡è‚‹ï¼Ÿ<br>ã€€ã€€åœ¨ä¸Šé¢çš„åˆ†æä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒPHP å¹¶ä¸èƒ½ä¸»åŠ¨çš„æŠ›å‡ºå¼‚å¸¸ï¼Œä½†æ˜¯ä½ å¯ä»¥æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸ï¼Œè¿™å°±å¾ˆæ— è¯­äº†ï¼Œå¦‚æœä½ çŸ¥é“å“ªé‡Œä¼šå‡ºé—®é¢˜ï¼Œä½ æ·»åŠ  if else è§£å†³ä¸å°±è¡Œäº†å—ï¼Œä¸ºå•¥è¿˜è¦æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸ï¼Œæ—¢ç„¶èƒ½æ‰‹åŠ¨æŠ›å‡ºå°±è¯æ˜è¿™ä¸ªä¸æ˜¯å¼‚å¸¸ï¼Œè€Œæ˜¯æ„æ–™ä¹‹ä¸­ã€‚ä»¥æˆ‘çš„ç†è§£ï¼Œè¿™å°±æ˜¯ PHP å¼‚å¸¸å¤„ç†é¸¡è‚‹çš„åœ°æ–¹ï¼ˆä¸ä¸€å®šå¯¹å•Šï¼‰ã€‚æ‰€ä»¥ PHP çš„å¼‚å¸¸æœºåˆ¶ä¸æ˜¯é‚£ä¹ˆçš„å®Œç¾ï¼Œä½†æ˜¯ä½¿ç”¨è¿‡æ¡†æ¶çš„åŒå­¦éƒ½çŸ¥é“æœ‰è¿™ä¸ªæƒ…å†µï¼šä½ åœ¨æ¡†æ¶ä¸­ç›´æ¥å†™å¼€å¤´é‚£æ®µ phpâ€œè‡ªåŠ¨â€æ•è·å¼‚å¸¸çš„ä»£ç æ˜¯å¯ä»¥çš„ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿçœ‹è¿‡æºç çš„åŒå­¦éƒ½çŸ¥é“æ¡†æ¶ä¸­éƒ½ä¼šæ¶‰åŠä¸‰ä¸ªå‡½æ•°ï¼šregister_shutdown_functionï¼Œset_error_handlerï¼Œset_exception_handler åé¢æˆ‘ä¼šé‡ç‚¹è®²è§£ç€ä¸‰ä¸ªé»‘ç§‘æŠ€ï¼Œé€šè¿‡è¿™å‡ ä¸ªå‡½æ•°æˆ‘ä»¬å¯ä»¥å®ç° PHP å‡è‡ªåŠ¨æ•è·å¼‚å¸¸å’Œé”™è¯¯ã€‚</p><p>äºŒã€ERROR çš„çº§åˆ«<br>ã€€ã€€åªæœ‰ç†Ÿæ‚‰é”™è¯¯çº§åˆ«æ‰èƒ½å¯¹é”™è¯¯æ•æ‰æœ‰æ›´å¥½çš„è®¤è¯†ã€‚ ERROR æœ‰ä¸åŒçš„é”™è¯¯çº§åˆ«ï¼Œæˆ‘ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« ä¸­æœ‰å†™åˆ°ï¼š<a href="http://www.cnblogs.com/zyf-zhaoyafei/p/3649434.html">http://www.cnblogs.com/zyf-zhaoyafei/p/3649434.html</a><br>ã€€ã€€ä¸‹é¢æˆ‘å†æ€»ç»“æ€§çš„ç»™å‡ºè¿™å‡ ç±»é”™è¯¯çº§åˆ«ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">1 Fatal Error:è‡´å‘½é”™è¯¯ï¼ˆè„šæœ¬ç»ˆæ­¢è¿è¡Œï¼‰</span><br><span class="line">2 E_ERROR // è‡´å‘½çš„è¿è¡Œé”™è¯¯ï¼Œé”™è¯¯æ— æ³•æ¢å¤ï¼Œæš‚åœæ‰§è¡Œè„šæœ¬</span><br><span class="line">3 E_CORE_ERROR // PHP å¯åŠ¨æ—¶åˆå§‹åŒ–è¿‡ç¨‹ä¸­çš„è‡´å‘½é”™è¯¯</span><br><span class="line">4 E_COMPILE_ERROR // ç¼–è¯‘æ—¶è‡´å‘½æ€§é”™ï¼Œå°±åƒç”± Zend è„šæœ¬å¼•æ“ç”Ÿæˆäº†ä¸€ä¸ª E_ERROR</span><br><span class="line">5 E_USER_ERROR // è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯ã€‚åƒç”¨ PHP å‡½æ•° trigger_errorï¼ˆé”™è¯¯ç±»å‹è®¾ç½®ä¸ºï¼šE_USER_ERRORï¼‰</span><br><span class="line">6</span><br><span class="line">7 Parse Errorï¼šç¼–è¯‘æ—¶è§£æé”™è¯¯ï¼Œè¯­æ³•é”™è¯¯ï¼ˆè„šæœ¬ç»ˆæ­¢è¿è¡Œï¼‰</span><br><span class="line">8 E_PARSE //ç¼–è¯‘æ—¶çš„è¯­æ³•è§£æé”™è¯¯</span><br><span class="line">9</span><br><span class="line">10 Warning Errorï¼šè­¦å‘Šé”™è¯¯ï¼ˆä»…ç»™å‡ºæç¤ºä¿¡æ¯ï¼Œè„šæœ¬ä¸ç»ˆæ­¢è¿è¡Œï¼‰</span><br><span class="line">11 E_WARNING // è¿è¡Œæ—¶è­¦å‘Š (éè‡´å‘½é”™è¯¯)ã€‚</span><br><span class="line">12 E_CORE_WARNING // PHP åˆå§‹åŒ–å¯åŠ¨è¿‡ç¨‹ä¸­å‘ç”Ÿçš„è­¦å‘Š (éè‡´å‘½é”™è¯¯) ã€‚</span><br><span class="line">13 E_COMPILE_WARNING // ç¼–è¯‘è­¦å‘Š</span><br><span class="line">14 E_USER_WARNING // ç”¨æˆ·äº§ç”Ÿçš„è­¦å‘Šä¿¡æ¯</span><br><span class="line">15</span><br><span class="line">16 Notice Errorï¼šé€šçŸ¥é”™è¯¯ï¼ˆä»…ç»™å‡ºé€šçŸ¥ä¿¡æ¯ï¼Œè„šæœ¬ä¸ç»ˆæ­¢è¿è¡Œï¼‰</span><br><span class="line">17 E_NOTICE // è¿è¡Œæ—¶é€šçŸ¥ã€‚è¡¨ç¤ºè„šæœ¬é‡åˆ°å¯èƒ½ä¼šè¡¨ç°ä¸ºé”™è¯¯çš„æƒ…å†µ.</span><br><span class="line">18 E_USER_NOTICE // ç”¨æˆ·äº§ç”Ÿçš„é€šçŸ¥ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><p>ã€€ã€€ç”±æ­¤å¯çŸ¥æœ‰ 5 ç±»æ˜¯äº§ç”Ÿ ERROR çº§åˆ«çš„é”™è¯¯ï¼Œè¿™ç§é”™è¯¯ç›´æ¥å¯¼è‡´ PHP ç¨‹åºé€€å‡ºã€‚<br>ã€€ã€€å¯ä»¥å®šä¹‰æˆï¼š</p><p>1 ERROR &#x3D; E_ERROR | E_CORE_ERROR | E_COMPILE_ERROR | E_USER_ERROR | E_PARSE<br>ä¸‰ã€PHP å¼‚å¸¸å¤„ç†ä¸­çš„é»‘ç§‘æŠ€<br>ã€€ã€€å‰é¢æåˆ°æ¡†æ¶ä¸­æ˜¯å¯ä»¥æ•è·æ‰€æœ‰çš„é”™è¯¯å’Œå¼‚å¸¸çš„ï¼Œä¹‹æ‰€ä»¥èƒ½å®ç°åº”è¯¥æ˜¯ä½¿ç”¨äº†é»‘ç§‘æŠ€ï¼Œå“ˆå“ˆï¼å…¶å®ä¹Ÿä¸æ˜¯ä»€ä¹ˆé»‘ç§‘æŠ€ï¼Œä¸»è¦æ˜¯ä¸‰ä¸ªé‡è¦çš„å‡½æ•°ï¼š</p><p>1ï¼šset_error_handler()<br>ã€€ã€€çœ‹åˆ°è¿™ä¸ªåå­—ä¼°è®¡å°±çŸ¥é“ä»€ä¹ˆæ„æ€äº†ï¼Œè¿™ä¸ªå‡½æ•°ç”¨äºæ•è·é”™è¯¯ï¼Œè®¾ç½®ä¸€ä¸ªç”¨æˆ·è‡ªå®šä¹‰çš„é”™è¯¯å¤„ç†å‡½æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1 &lt;?php</span><br><span class="line">2 set_error_handler(&#x27;zyferror&#x27;);</span><br><span class="line">3 function zyferror($type, $message, $file, $line)</span><br><span class="line">4 &#123;</span><br><span class="line">5 ã€€ã€€ var_dump(&#x27;&lt;b&gt;set_error_handler: &#x27; . $type . &#x27;:&#x27; . $message . &#x27; in &#x27; . $file . &#x27; on &#x27; . $line . &#x27; line .&lt;/b&gt;&lt;br /&gt;&#x27;);</span><br><span class="line">6 &#125;</span><br><span class="line">7 ?&gt;</span><br></pre></td></tr></table></figure><p>ã€€ã€€å½“ç¨‹åºå‡ºç°é”™è¯¯çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•ï¼Œä¸è¿‡éœ€è¦æ³¨æ„ä¸€ä¸‹ä¸¤ç‚¹ï¼šç¬¬ä¸€ï¼Œå¦‚æœå­˜åœ¨è¯¥æ–¹æ³•ï¼Œç›¸åº”çš„ error_reporting()å°±ä¸èƒ½åœ¨ä½¿ç”¨äº†ã€‚æ‰€æœ‰çš„é”™è¯¯éƒ½ä¼šäº¤ç»™è‡ªå®šä¹‰çš„å‡½æ•°å¤„ç†ã€‚ç¬¬äºŒï¼Œæ­¤æ–¹æ³•ä¸èƒ½å¤„ç†ä»¥ä¸‹çº§åˆ«çš„é”™è¯¯ï¼šE_ERRORã€ E_PARSEã€ E_CORE_ERRORã€ E_CORE_WARNINGã€ E_COMPILE_ERRORã€ E_COMPILE_WARNINGï¼Œset_error_handler() å‡½æ•°æ‰€åœ¨æ–‡ä»¶ä¸­äº§ç”Ÿçš„ E_STRICTï¼Œè¯¥å‡½æ•°åªèƒ½æ•è·ç³»ç»Ÿäº§ç”Ÿçš„ä¸€äº› Warningã€Notice çº§åˆ«çš„é”™è¯¯ã€‚<br>ã€€ã€€å¹¶ä¸”ä»–æœ‰å¤šç§è°ƒç”¨çš„æ–¹æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1 &lt;?php</span><br><span class="line">2 // ç›´æ¥ä¼ å‡½æ•°å NonClassFunction</span><br><span class="line">3 set_error_handler(&#x27;function_name&#x27;);</span><br><span class="line">4</span><br><span class="line">5 // ä¼  class_name &amp;&amp; function_name</span><br><span class="line">6 set_error_handler(array(&#x27;class_name&#x27;, &#x27;function_name&#x27;));</span><br><span class="line">7 ?&gt;</span><br></pre></td></tr></table></figure><p>ã€€ã€€ 2ï¼šregister_shutdown_function()<br>ã€€ã€€æ•è· PHP çš„é”™è¯¯ï¼šFatal Errorã€Parse Error ç­‰ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ PHP è„šæœ¬æ‰§è¡Œç»“æŸå‰æœ€åä¸€ä¸ªè°ƒç”¨çš„å‡½æ•°ï¼Œæ¯”å¦‚è„šæœ¬é”™è¯¯ã€die()ã€exitã€å¼‚å¸¸ã€æ­£å¸¸ç»“æŸéƒ½ä¼šè°ƒç”¨ï¼Œå¤šä¹ˆç‰›é€¼çš„ä¸€ä¸ªå‡½æ•°å•Šï¼é€šè¿‡è¿™ä¸ªå‡½æ•°å°±å¯ä»¥åœ¨è„šæœ¬ç»“æŸå‰åˆ¤æ–­è¿™æ¬¡æ‰§è¡Œæ˜¯å¦æœ‰é”™è¯¯äº§ç”Ÿï¼Œè¿™æ—¶å°±è¦å€ŸåŠ©äºä¸€ä¸ªå‡½æ•°ï¼šerror_get_last()ï¼›è¿™ä¸ªå‡½æ•°å¯ä»¥æ‹¿åˆ°æœ¬æ¬¡æ‰§è¡Œäº§ç”Ÿçš„æ‰€æœ‰é”™è¯¯ã€‚error_get_last();è¿”å›çš„ä¿¡æ¯ï¼š<br>ã€€ã€€[type] - é”™è¯¯ç±»å‹<br>ã€€ã€€[message] - é”™è¯¯æ¶ˆæ¯<br>ã€€ã€€[file] - å‘ç”Ÿé”™è¯¯æ‰€åœ¨çš„æ–‡ä»¶<br>ã€€ã€€[line] - å‘ç”Ÿé”™è¯¯æ‰€åœ¨çš„è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1 &lt;?php</span><br><span class="line">2 register_shutdown_function(&#x27;zyfshutdownfunc&#x27;);</span><br><span class="line">3 function zyfshutdownfunc()</span><br><span class="line">4 &#123;</span><br><span class="line">5 if ($error = error_get_last()) &#123;</span><br><span class="line">6             var_dump(&#x27;&lt;b&gt;register_shutdown_function: Type:&#x27; . $error[&#x27;type&#x27;] . &#x27; Msg: &#x27; . $error[&#x27;message&#x27;] . &#x27; in &#x27; . $error[&#x27;file&#x27;] . &#x27; on line &#x27; . \$error[&#x27;line&#x27;] . &#x27;&lt;/b&gt;&#x27;);</span><br><span class="line">7 &#125;</span><br><span class="line">8 &#125;</span><br><span class="line">9 ?&gt;</span><br></pre></td></tr></table></figure><p>ã€€ã€€é€šè¿‡è¿™ç§æ–¹æ³•å°±å¯ä»¥å·§å¦™çš„æ‰“å°å‡ºç¨‹åºç»“æŸå‰æ‰€æœ‰çš„é”™è¯¯ä¿¡æ¯ã€‚ä½†æ˜¯æˆ‘åœ¨æµ‹è¯•çš„æ—¶å€™æˆ‘å‘ç°å¹¶ä¸æ˜¯æ‰€æœ‰çš„é”™è¯¯ç»ˆæ­¢åéƒ½ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥çœ‹ä¸‹é¢çš„ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œå†…å®¹æ˜¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">1 &lt;?php</span><br><span class="line">2 register_shutdown_function(&#x27;zyfshutdownfunc&#x27;);</span><br><span class="line">3 function zyfshutdownfunc()</span><br><span class="line">4 &#123;</span><br><span class="line">5 if ($error = error_get_last()) &#123;</span><br><span class="line"> 6             var_dump(&#x27;&lt;b&gt;register_shutdown_function: Type:&#x27; . $error[&#x27;type&#x27;] . &#x27; Msg: &#x27; . $error[&#x27;message&#x27;] . &#x27; in &#x27; . $error[&#x27;file&#x27;] . &#x27; on line &#x27; . \$error[&#x27;line&#x27;] . &#x27;&lt;/b&gt;&#x27;);</span><br><span class="line">7 &#125;</span><br><span class="line">8 &#125;</span><br><span class="line">9 var_dump(23+-+); //æ­¤å¤„è¯­æ³•é”™è¯¯</span><br><span class="line">10 ?&gt;</span><br><span class="line"></span><br><span class="line">ã€€ã€€è‡ªå·±å¯ä»¥è¯•ä¸€ä¸‹ï¼Œä½ å¯ä»¥çœ‹åˆ°æ ¹æœ¬å°±ä¸ä¼šè§¦å‘ zyfshutdownfunc()å‡½æ•°ï¼Œå…¶å®è¿™æ˜¯ä¸€ä¸ªè¯­æ³•é”™è¯¯ï¼Œç›´æ¥æŠ¥äº†ä¸€ä¸ªï¼š</span><br><span class="line"></span><br><span class="line">1 &lt;?php</span><br><span class="line">2 Parse error: syntax error, unexpected &#x27;)&#x27; in /www/mytest/exception/try-catch.php on line 71</span><br><span class="line">3 ?&gt;</span><br><span class="line">ã€€ã€€ç”±æ­¤å¼•å‡ºä¸€ä¸ªå¥‡è‘©çš„é—®é¢˜ï¼šé—®ä»€ä¹ˆä¸èƒ½è§¦å‘ï¼Œä¸ºä»€ä¹ˆæ¡†æ¶ä¸­æ˜¯å¯ä»¥çš„ï¼Ÿå…¶å®åŸå› å¾ˆç®€å•ï¼Œåªåœ¨ parse-time å‡ºé”™æ—¶æ˜¯ä¸ä¼šè°ƒç”¨æœ¬å‡½æ•°çš„ã€‚åªæœ‰åœ¨ run-time å‡ºé”™çš„æ—¶å€™ï¼Œæ‰ä¼šè°ƒç”¨æœ¬å‡½æ•°ï¼Œæˆ‘çš„ç†è§£æ˜¯è¯­æ³•æ£€æŸ¥å™¨å‰æ²¡æœ‰æ‰§è¡Œ register_shutdown_function()å»æŠŠéœ€è¦æ³¨å†Œçš„å‡½æ•°æ”¾åˆ°è°ƒç”¨çš„å †æ ˆä¸­ï¼Œæ‰€ä»¥å°±æ ¹æœ¬ä¸ä¼šè¿è¡Œã€‚é‚£æ¡†æ¶ä¸­ä¸ºä»€ä¹ˆä»»ä½•é”™è¯¯éƒ½èƒ½è¿›å…¥åˆ° register_shutdown_function()ä¸­å‘¢ï¼Œå…¶å®åœ¨æ¡†æ¶ä¸­ä¸€èˆ¬ä¼šæœ‰ç»Ÿä¸€çš„å…¥å£ index.phpï¼Œç„¶åæ¯ä¸ªç±»åº“æ–‡ä»¶éƒ½ä¼šé€šè¿‡ include \*\* çš„æ–¹å¼åŠ è½½åˆ° index.php ä¸­ï¼Œç›¸å½“ä¸æ‰€æœ‰çš„ç¨‹åºéƒ½ä¼šåœ¨ index.php ä¸­èšé›†ï¼ŒåŒæ ·ï¼Œä½ å†™çš„å…·æœ‰è¯­æ³•é”™è¯¯çš„æ–‡ä»¶ä¹Ÿä¼šè¢«å¼•å…¥åˆ°å…¥å£æ–‡ä»¶ä¸­ï¼Œè¿™æ ·çš„è¯ï¼Œè°ƒç”¨æ¡†æ¶ï¼Œæ‰§è¡Œ index.phpï¼Œindex.php æœ¬èº«å¹¶æ²¡æœ‰è¯­æ³•é”™è¯¯ï¼Œä¹Ÿå°±ä¸ä¼šäº§ç”Ÿ parse-time é”™è¯¯ï¼Œè€Œæ˜¯ include æ–‡ä»¶å‡ºé”™äº†ï¼Œæ˜¯ run-time çš„æ—¶å€™å‡ºé”™äº†ï¼Œæ‰€ä»¥æ¡†æ¶æ‰§è¡Œå®Œä¹‹åå°±ä¼šè§¦å‘ register_shutdown_function();</span><br><span class="line">ã€€ã€€æ‰€ä»¥ç°åœ¨å¯æ˜¯è¯•ä¸€ä¸‹è¿™ä¸ªå†™æ³•ï¼Œè¿™æ ·å°±ä¼šè§¦å‘ zyfshutdownfunc()å›è°ƒäº†ï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>1 a.php æ–‡ä»¶<br>2 <?php3 ã€€ã€€// æ¨¡æ‹Ÿè¯­æ³•é”™è¯¯4 ã€€ã€€ var_dump(23+-+);5 ?><br>6<br>7 b.php æ–‡ä»¶<br>8 <?php9 register_shutdown_function('zyfshutdownfunc');10 function zyfshutdownfunc()11 {12 if ($error = error_get_last()) {13             var_dump('<b>register_shutdown_function: Type:' . $error['type'] . ' Msg: ' . $error['message'] . ' in ' . $error['file'] . ' on line ' . \$error['line'] . '');14 }15 }16 require 'a.php';17 ?></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ã€€ã€€ 3ï¼šset_exception_handler()</span><br><span class="line">ã€€ã€€è®¾ç½®é»˜è®¤çš„å¼‚å¸¸å¤„ç†ç¨‹åºï¼Œç”¨åœ¨æ²¡æœ‰ç”¨ try/catch å—æ¥æ•è·çš„å¼‚å¸¸ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ç®¡ä½ æŠ›å‡ºçš„å¼‚å¸¸æœ‰æ²¡æœ‰äººæ•è·ï¼Œå¦‚æœæ²¡æœ‰äººæ•è·å°±ä¼šè¿›å…¥åˆ°è¯¥æ–¹æ³•ä¸­ï¼Œå¹¶ä¸”åœ¨å›è°ƒå‡½æ•°è°ƒç”¨åå¼‚å¸¸ä¼šä¸­æ­¢ã€‚çœ‹ä¸€ä¸‹ç”¨æ³•ï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>1 <?php2 set_exception_handler('zyfexception');3 function zyfexception($exception)4     {5         var_dump("<b>set_exception_handler: Exception: " . $exception->getMessage() . '');6 }7 throw new Exception("zyf exception");8 ?></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å››ã€å·§å¦™çš„æ•è·é”™è¯¯å’Œå¼‚å¸¸</span><br><span class="line">ã€€ã€€ 1ï¼šæŠŠé”™è¯¯ä»¥å¼‚å¸¸çš„å½¢å¼æŠ›å‡º(ä¸èƒ½å®Œå…¨æŠ›å‡º)</span><br><span class="line">ã€€ã€€ã€€ã€€ç”±ä¸Šé¢çš„è®²è§£æˆ‘ä»¬çŸ¥é“ï¼Œphp ä¸­çš„é”™è¯¯æ˜¯ä¸èƒ½ä»¥å¼‚å¸¸çš„åƒæ˜¯æ•è·çš„ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦è®©ä»–ä»¬æŠ›å‡ºï¼Œå·²è¾¾åˆ°æ‰©å±• try-catch çš„å½±å“èŒƒå›´ï¼Œæˆ‘ä»¬å‰é¢è®²åˆ°è¿‡ set_error_handler() æ–¹æ³•ï¼Œä»–æ˜¯å¹²å˜›ç”¨çš„ï¼Œä»–æ˜¯æ•è·é”™è¯¯çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©ä»–æ¥å§é”™è¯¯æ•è·ï¼Œç„¶åå†ä»¥å¼‚å¸¸çš„å½¢å¼æŠ›å‡ºï¼Œokï¼Œè¯•è¯•ä¸‹é¢çš„å†™æ³•ï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>1 <?php2 set_error_handler('zyferror');3 function zyferror($type, $message, $file, $line)4 {5 throw new \Exception($message . 'zyfé”™è¯¯å½“åšå¼‚å¸¸'); 6     } 7  8     $num = 0;9 try {10 echo 1/$num;11 12     } catch (Exception $e){13 echo \$e->getMessage();14 }15 ?></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ã€€ã€€å¥½äº†ï¼Œè¯•ä¸€ä¸‹ï¼Œä¼šæ‰“å°å‡ºï¼š</span><br><span class="line"></span><br><span class="line">1 Division by zero zyf123</span><br><span class="line">ã€€ã€€æµç¨‹ï¼šæœ¬æ¥æ˜¯é™¤ 0 é”™è¯¯ï¼Œç„¶åè§¦å‘ set_error_handler()ï¼Œåœ¨ set_error_handler()ä¸­ç›¸å½“ä¸æ€äº†ä¸ªå›é©¬æªï¼Œå†æŠŠé”™è¯¯ä¿¡æ¯ä»¥å¼‚å¸¸çš„å½¢å¼æŠ›å‡ºæ¥ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°é”™è¯¯ä»¥å¼‚å¸¸çš„å½¢å¼æŠ›å‡ºã€‚å¤§å®¶è¦æ³¨æ„ï¼šè¿™æ ·åšæ˜¯æœ‰ç¼ºç‚¹çš„ï¼Œä¼šå—åˆ° set_error_handler()å‡½æ•°æ•è·çº§åˆ«çš„é™åˆ¶ã€‚</span><br><span class="line"></span><br><span class="line">     2ï¼šæ•è·æ‰€æœ‰çš„é”™è¯¯</span><br><span class="line">        ç”±set_error_handler()å¯çŸ¥ï¼Œä»–èƒ½å¤Ÿæ•è·ä¸€éƒ¨åˆ†é”™è¯¯ï¼Œä¸èƒ½æ•è·ç³»ç»Ÿçº§E_ERRORã€E_PARSEç­‰é”™è¯¯ï¼Œä½†æ˜¯è¿™éƒ¨åˆ†å¯ä»¥ç”±register_shutdown_function()æ•è·ã€‚æ‰€ä»¥ä¸¤è€…ç»“åˆèƒ½å‡ºç°å¾ˆå¥½çš„åŠŸèƒ½ã€‚</span><br><span class="line">        çœ‹ä¸‹é¢çš„ç¨‹åºï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>1 a.php å†…å®¹ï¼š<br>2 <?3 // æ¨¡æ‹Ÿ Fatal error é”™è¯¯4 //test();56 // æ¨¡æ‹Ÿç”¨æˆ·äº§ç”Ÿ ERROR é”™è¯¯7 //trigger_error('zyf-error', E_USER_ERROR);89 // æ¨¡æ‹Ÿè¯­æ³•é”™è¯¯10 var_dump(23+-+);1112 // æ¨¡æ‹Ÿ Notice é”™è¯¯13 //echo \$f;1415 // æ¨¡æ‹Ÿ Warning é”™è¯¯16 //echo '123';17 //ob_flush();18 //flush();19 //header("Content-type:text/html;charset=gb2312");20 ?></p><p>21 b.php å†…å®¹ï¼š<br>22 <?23 error_reporting(0);24 register_shutdown_function('zyfshutdownfunc');25 function zyfshutdownfunc()26 {27 if ($error = error_get_last()) {28             var_dump('<b>register_shutdown_function: Type:' . $error['type'] . ' Msg: ' . $error['message'] . ' in ' . $error['file'] . ' on line ' . $error['line'] . '');29         }30     }31 32     set_error_handler('zyferror');33     function zyferror($type, $message, $file, $line)34     {35         var_dump('<b>set_error_handler: ' . $type . ':' . $message . ' in ' . $file . ' on ' . \$line . ' line .</b><br>');36 }3738 require 'a.php';39 ?></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ã€€ã€€åˆ°æ­¤å°±å¯ä»¥è§£é‡Šå¼€å¤´çš„é‚£ä¸ªç¨‹åºäº†å§ï¼Œtest.php å¦‚æœæ˜¯å•æ–‡ä»¶æ‰§è¡Œæ˜¯ä¸èƒ½æ•è·åˆ°é”™è¯¯çš„ï¼Œå¦‚æœä½ åœ¨æ¡†æ¶ä¸­æ‰§è¡Œå°±æ˜¯å¯ä»¥çš„ï¼Œå½“ç„¶ä½ æŒ‰ç…§æˆ‘ä¸Šé¢ä»‹ç»çš„æ¥æ‰©å±•ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</span><br><span class="line"></span><br><span class="line">äº”ã€è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†å’Œå¼‚å¸¸åµŒå¥—</span><br><span class="line"></span><br><span class="line">1ï¼šè‡ªå®šä¹‰å¼‚å¸¸å¤„ç†</span><br><span class="line"></span><br><span class="line">åœ¨å¤æ‚çš„ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦è‡ªå·±æ•è·æˆ‘ä»¬éœ€è¦ç‰¹æ®Šå¤„ç†çš„å¼‚å¸¸ï¼Œè¿™äº›å¼‚å¸¸å¯èƒ½æ˜¯ç‰¹æ®Šæƒ…å†µä¸‹æŠ›å‡ºçš„ã€‚æ‰€ä»¥æˆ‘ä»¬å°±è‡ªå·±å®šä¹‰ä¸€ä¸ªå¼‚å¸¸æ•è·ç±»ï¼Œè¯¥ç±»å¿…é¡»æ˜¯ exception ç±»çš„ä¸€ä¸ªæ‰©å±•ï¼Œè¯¥ç±»ç»§æ‰¿äº† PHP çš„ exception ç±»çš„æ‰€æœ‰å±æ€§ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥æ·»åŠ è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œä½¿ç”¨çš„æ—¶å€™å…¶å®å’Œä¹‹å‰çš„ä¸€æ ·ï¼Œå¤§è‡´å†™æ³•å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>1 <?php2 class zyfException extends Exception3 {4 public function errorzyfMessage()5 {6 return 'Error line ' . $this->getLine().' in ' . $this->getFile()7 .': <b>' . $this->getMessage() . '</b> Must in (0 - 60)'; 8         } 9     }10 11     $age = 10;12 try {13 $age = intval($age);14 if($age > 60) {15             throw new zyfException($age);16 }1718 } catch (zyfException $e) {19         echo $e->errorzyfMessage();2021 }22 ?></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ã€€ã€€ 2ï¼šå¼‚å¸¸åµŒå¥—</span><br><span class="line"></span><br><span class="line">å¼‚å¸¸åµŒå¥—æ˜¯æ¯”è¾ƒå¸¸è§çš„å†™æ³•ï¼Œåœ¨è‡ªå®šä¹‰çš„å¼‚å¸¸å¤„ç†ä¸­ï¼Œtry å—ä¸­å¯ä»¥å®šä¹‰å¤šä¸ªå¼‚å¸¸æ•è·ï¼Œç„¶ååˆ†å±‚ä¼ é€’å¼‚å¸¸ï¼Œç†è§£å’Œå†’æ³¡å·®ä¸å¤šï¼Œçœ‹ä¸‹é¢çš„å®ç°ï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>1 <?php2 $age = 10; 3     try { 4         $age = intval($age); 5         if($age > 60) {6 throw new zyfException($age); 7         } 8  9         if ($age <= 10 0) { throw new exception($age . ' must> 0');11         }12 13     } catch (zyfException $e) {14 echo $e->errorzyfMessage();15 16     } catch(Exception $e) {17 echo \$e->getMessage();18 }19 ?></=></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ã€€ã€€å½“ç„¶ä¹Ÿå¯ä»¥åœ¨ catch ä¸­å†æŠ›å‡ºå¼‚å¸¸ç»™ä¸Šå±‚ï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>1 <?php2 $age = 100; 3     try { 4         try { 5             $age = intval($age); 6             if($age > 60) {7 throw new Exception($age); 8             } 9 10         } catch (Exception $e) {11 throw new zyfException($age);12 13         }14 15     } catch (zyfException $e) {16 echo \$e->errorzyfMessage();17 }18 ?></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å…­ã€PHP7 ä¸­çš„å¼‚å¸¸å¤„ç†</span><br><span class="line">ã€€ã€€ç°åœ¨å†™ PHP å¿…é¡»è€ƒè™‘ç‰ˆæœ¬æƒ…å†µï¼Œä¸Šé¢çš„å†™æ³•åœ¨ PHP7 ä¸­å¤§éƒ¨åˆ†éƒ½èƒ½å®ç°ï¼Œä½†æ˜¯ä¹Ÿä¼šæœ‰ä¸åŒç‚¹ï¼Œåœ¨ PHP7 æ›´æ–°ä¸­æœ‰ä¸€æ¡ï¼šæ›´å¤šçš„ Error å˜ä¸ºå¯æ•è·çš„ Exceptionï¼Œç°åœ¨çš„ PHP7 å®ç°äº†ä¸€ä¸ªå…¨å±€çš„ throwable æ¥å£ï¼ŒåŸæ¥è€çš„ Exception å’Œå…¶ä¸­ä¸€éƒ¨åˆ† Error å®ç°äº†è¿™ä¸ªæ¥å£(interface)ï¼ŒPHP7 ä¸­æ›´å¤šçš„ Error å˜ä¸ºå¯æ•è·çš„ Exception è¿”å›ç»™æ•æ‰å™¨ï¼Œè¿™æ ·å…¶å®å’Œå‰é¢æåˆ°çš„æ‰©å±• try-catch å½±å“èŒƒå›´ä¸€æ ·ï¼Œä½†æ˜¯å¦‚æœä¸æ•è·åˆ™è¿˜æ˜¯æŒ‰ç…§ Error å¯¹å¾…ï¼Œçœ‹ä¸‹é¢ä¸¤ä¸ªï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>1 <?php2 try {3 test();45 } catch(Throwable $e) { 6         echo $e->getMessage() . ' zyf';7 }89 try {10 test();1112 } catch(Error $e) {13         echo $e->getMessage() . ' zyf';14 }15 ?></p><pre><code>å› ä¸º PHP7 å®ç°äº† throwable æ¥å£ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨ç¬¬ä¸€ä¸ªè¿™ç§æ–¹å¼æ¥æ•è·å¼‚å¸¸ã€‚åˆå› ä¸ºéƒ¨åˆ† Error å®ç°äº†æ¥å£ï¼Œå¹¶ä¸”æ›´å¤šçš„ Error å˜ä¸ºå¯æ•è·çš„ Exceptionï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼æ¥æ•è·å¼‚å¸¸ã€‚ä¸‹é¢æ˜¯åœ¨ç½‘ä¸Šæ‰¾çš„ PHP7 çš„å¼‚å¸¸å±‚æ¬¡æ ‘ï¼šThrowableã€€ã€€ Exception å¼‚å¸¸ã€€ã€€ã€€ã€€...ã€€ã€€ Error é”™è¯¯ã€€ã€€ã€€ã€€ ArithmeticError ç®—æ•°é”™è¯¯ã€€ã€€ã€€ã€€ã€€ã€€ DivisionByZeroError é™¤æ•°ä¸º 0 çš„é”™è¯¯ã€€ã€€ã€€ã€€ AssertionError å£°æ˜é”™è¯¯ã€€ã€€ã€€ã€€ ParseError è§£æé”™è¯¯ã€€ã€€ã€€ã€€ TypeError ç±»å‹é”™è¯¯è½¬è½½ï¼šhttp://www.cnblogs.com/zyf-zhaoyafei/p/6928149.html</code></pre>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> å¼‚å¸¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-å·¥å‚æ¨¡å¼</title>
      <link href="/blog/2020/06/19/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
      <url>/blog/2020/06/19/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><blockquote><p>ç­‰å¾…æ›´æ–°</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¾…æ›´æ–° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼-å·¥å‚æ¨¡å¼</title>
      <link href="/blog/2020/06/19/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
      <url>/blog/2020/06/19/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><blockquote><p>ç­‰å¾…æ›´æ–°</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¾…æ›´æ–° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>httpä¸rpcåŒºåˆ«ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨rpc</title>
      <link href="/blog/2020/06/19/HTTP/%E5%BE%AE%E6%9C%8D%E5%8A%A1-http%E4%B8%8Erpc%E5%8C%BA%E5%88%AB%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8rpc/"/>
      <url>/blog/2020/06/19/HTTP/%E5%BE%AE%E6%9C%8D%E5%8A%A1-http%E4%B8%8Erpc%E5%8C%BA%E5%88%AB%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8rpc/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><blockquote><p>HTTPå°±æ˜¯ä¸€ç§RPC(Remote Procedure Call) ,httpæ˜¯ä¸ƒå±‚isoæ¨¡å‹ï¼Œè½¬æ¢æ­¥éª¤å¤šï¼Œä¸”åŸºäºhttpæœ‰æ›´å¤šçš„æŠ¥æ–‡</p></blockquote><p><strong>httpå¥½æ¯”æ™®é€šè¯ï¼Œrpcå¥½æ¯”å›¢ä¼™å†…éƒ¨é»‘è¯ã€‚</strong><br>åªè¦æ˜¯è¿œç¨‹è°ƒç”¨éƒ½å¯ä»¥å«RPC()ï¼Œå’Œæ˜¯ä¸æ˜¯é€šè¿‡httpæ²¡ä»€ä¹ˆå…³ç³»<br>è®²æ™®é€šè¯ï¼Œå¥½å¤„å°±æ˜¯è°éƒ½å¬å¾—æ‡‚ï¼Œè°éƒ½ä¼šè®²ã€‚<br>è®²é»‘è¯ï¼Œå¥½å¤„æ˜¯å¯ä»¥æ›´ç²¾ç®€ã€æ›´åŠ ä¿å¯†ã€æ›´åŠ å¯å®šåˆ¶ï¼Œåå¤„å°±æ˜¯è¦æ±‚â€œè¯´â€é»‘è¯çš„é‚£ä¸€æ–¹ï¼ˆclientç«¯ï¼‰ä¹Ÿè¦æ‡‚ï¼Œè€Œä¸”ä¸€æ—¦å¤§å®¶éƒ½è¯´ä¸€ç§é»‘è¯äº†ï¼Œæ¢é»‘è¯å°±å›°éš¾äº†ã€‚</p><blockquote><p>é¦–å…ˆ http å’Œ rpc å¹¶ä¸æ˜¯ä¸€ä¸ªå¹¶è¡Œæ¦‚å¿µã€‚</p></blockquote><p>rpcæ˜¯è¿œç«¯è¿‡ç¨‹è°ƒç”¨ï¼Œå…¶è°ƒç”¨åè®®é€šå¸¸åŒ…å«ä¼ è¾“åè®®å’Œåºåˆ—åŒ–åè®®ã€‚</p><p>ä¼ è¾“åè®®åŒ…å«: å¦‚è‘—åçš„ [gRPC](<a href="https://link.zhihu.com/?target=http://www.grpc.io/">grpc &#x2F; grpc.io</a>) ä½¿ç”¨çš„ http2 åè®®ï¼Œä¹Ÿæœ‰å¦‚dubboä¸€ç±»çš„è‡ªå®šä¹‰æŠ¥æ–‡çš„tcpåè®®ã€‚</p><p>åºåˆ—åŒ–åè®®åŒ…å«: å¦‚åŸºäºæ–‡æœ¬ç¼–ç çš„ xml jsonï¼Œä¹Ÿæœ‰äºŒè¿›åˆ¶ç¼–ç çš„ protobuf hessianç­‰ã€‚</p><p>å› æ­¤æˆ‘ç†è§£çš„é—®é¢˜åº”è¯¥æ˜¯ï¼š<strong>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨è‡ªå®šä¹‰ tcp åè®®çš„ rpc åšåç«¯è¿›ç¨‹é€šä¿¡ï¼Ÿ</strong></p><p>è§£å†³è¿™ä¸ªé—®é¢˜å°±åº”è¯¥ææ¸…æ¥š http ä½¿ç”¨çš„ tcp åè®®ï¼Œå’Œæˆ‘ä»¬è‡ªå®šä¹‰çš„ tcp åè®®åœ¨æŠ¥æ–‡ä¸Šçš„åŒºåˆ«ã€‚</p><p>é¦–å…ˆè¦å¦è®¤ä¸€ç‚¹ http åè®®ç›¸è¾ƒäºè‡ªå®šä¹‰tcpæŠ¥æ–‡åè®®ï¼Œå¢åŠ çš„å¼€é”€åœ¨äº<strong>è¿æ¥çš„å»ºç«‹ä¸æ–­å¼€</strong>ã€‚httpåè®®æ˜¯æ”¯æŒ<strong>è¿æ¥æ± å¤ç”¨</strong>çš„ï¼Œä¹Ÿå°±æ˜¯å»ºç«‹ä¸€å®šæ•°é‡çš„è¿æ¥ä¸æ–­å¼€ï¼Œå¹¶ä¸ä¼šé¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯è¿æ¥ã€‚è¦è¯´çš„æ˜¯httpä¹Ÿå¯ä»¥ä½¿ç”¨protobufè¿™ç§äºŒè¿›åˆ¶ç¼–ç åè®®å¯¹å†…å®¹è¿›è¡Œç¼–ç ï¼Œå› æ­¤äºŒè€…æœ€å¤§çš„åŒºåˆ«è¿˜æ˜¯åœ¨ä¼ è¾“åè®®ä¸Šã€‚</p><p>é€šç”¨å®šä¹‰çš„http1.1åè®®çš„tcpæŠ¥æ–‡åŒ…å«å¤ªå¤šåºŸä¿¡æ¯ï¼Œä¸€ä¸ªPOSTåè®®çš„æ ¼å¼å¤§è‡´å¦‚ä¸‹ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.0</span> <span class="number">200</span> OK </span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/plain</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>137582</span><br><span class="line"><span class="attribute">Expires</span><span class="punctuation">: </span>Thu, 05 Dec 1997 16:00:00 GMT</span><br><span class="line"><span class="attribute">Last-Modified</span><span class="punctuation">: </span>Wed, 5 August 1996 15:55:28 GMT</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>Apache 0.84</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">body</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>å³ä½¿ç¼–ç åè®®ä¹Ÿå°±æ˜¯bodyæ˜¯ä½¿ç”¨äºŒè¿›åˆ¶ç¼–ç åè®®ï¼ŒæŠ¥æ–‡å…ƒæ•°æ®ä¹Ÿå°±æ˜¯<strong>headerå¤´çš„é”®å€¼å¯¹å´ç”¨äº†æ–‡æœ¬ç¼–ç ï¼Œéå¸¸å å­—èŠ‚æ•°</strong>ã€‚å¦‚ä¸Šå›¾æ‰€ä½¿ç”¨çš„æŠ¥æ–‡ä¸­æœ‰æ•ˆå­—èŠ‚æ•°ä»…ä»…å çº¦ 30%ï¼Œ<strong>ä¹Ÿå°±æ˜¯70%çš„æ—¶é—´ç”¨äºä¼ è¾“å…ƒæ•°æ®åºŸç¼–ç </strong>ã€‚å½“ç„¶å®é™…æƒ…å†µä¸‹æŠ¥æ–‡å†…å®¹å¯èƒ½ä¼šæ¯”è¿™ä¸ªé•¿ï¼Œä½†æ˜¯æŠ¥å¤´æ‰€å çš„æ¯”ä¾‹ä¹Ÿæ˜¯éå¸¸å¯è§‚çš„ã€‚</p><p>é‚£ä¹ˆå‡å¦‚æˆ‘ä»¬ä½¿ç”¨è‡ªå®šä¹‰tcpåè®®çš„æŠ¥æ–‡å¦‚ä¸‹</p><p><img src="https://pic2.zhimg.com/80/v2-89c905b0806577471aa7789a25ac0d44_720w.jpg" alt="tcp"></p><p>æŠ¥å¤´å ç”¨çš„å­—èŠ‚æ•°ä¹Ÿå°±åªæœ‰16ä¸ªbyteï¼Œæå¤§åœ°ç²¾ç®€äº†ä¼ è¾“å†…å®¹ã€‚</p><p>è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆåç«¯è¿›ç¨‹é—´é€šå¸¸ä¼šé‡‡ç”¨è‡ªå®šä¹‰tcpåè®®çš„rpcæ¥è¿›è¡Œé€šä¿¡çš„åŸå› </p><p>ç®€å•æ¥è¯´æˆç†Ÿçš„rpcåº“ç›¸å¯¹httpå®¹å™¨ï¼Œæ›´å¤šçš„æ˜¯å°è£…äº†â€œæœåŠ¡å‘ç°â€ï¼Œâ€è´Ÿè½½å‡è¡¡â€ï¼Œâ€œç†”æ–­é™çº§â€ä¸€ç±»é¢å‘æœåŠ¡çš„é«˜çº§ç‰¹æ€§ã€‚å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œrpcæ¡†æ¶æ˜¯é¢å‘æœåŠ¡çš„æ›´é«˜çº§çš„å°è£…ã€‚å¦‚æœæŠŠä¸€ä¸ªhttp servletå®¹å™¨ä¸Šå°è£…ä¸€å±‚æœåŠ¡å‘ç°å’Œå‡½æ•°ä»£ç†è°ƒç”¨ï¼Œé‚£å®ƒå°±å·²ç»å¯ä»¥åšä¸€ä¸ªrpcæ¡†æ¶äº†ã€‚</p><blockquote><p>é‚£httpå’Œrpcå’Œwebsocketä¸‰è€…æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ</p></blockquote><p><a href="https://link.jianshu.com/?t=http://en.wikipedia.org/wiki/Web_Service">Web Service</a> ä¹Ÿæå‡ºäº†å¥½ä¹…äº†, é‚£ä¹ˆç©¶ç«Ÿä»€ä¹ˆæ˜¯ <a href="https://link.jianshu.com/?t=http://en.wikipedia.org/wiki/Web_Service">Web Service</a> ?<br> ç®€å•åœ°è¯´, ä¹Ÿå°±æ˜¯æœåŠ¡å™¨å¦‚ä½•å‘å®¢æˆ·ç«¯æä¾›æœåŠ¡.<br> å¸¸ç”¨çš„æ–¹æ³•æœ‰:<br> <a href="https://link.jianshu.com/?t=http://en.wikipedia.org/wiki/Remote_procedure_call">RPC</a> æ‰€è°“çš„è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ (é¢å‘æ–¹æ³•)<br> <a href="https://link.jianshu.com/?t=http://en.wikipedia.org/wiki/Service-oriented_architecture">SOA</a> æ‰€è°“çš„é¢å‘æœåŠ¡çš„æ¶æ„(é¢å‘æ¶ˆæ¯)<br> <a href="https://link.jianshu.com/?t=http://en.wikipedia.org/wiki/Representational_State_Transfer">REST</a> æ‰€è°“çš„ <strong>Representational state transfer</strong> (é¢å‘èµ„æº)</p><p>è½¬è½½æ•´ç†è‡ªï¼š<a href="https://www.zhihu.com/question/41609070/answer/191965937">https://www.zhihu.com/question/41609070/answer/191965937</a></p>]]></content>
      
      
      <categories>
          
          <category> HTTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rpc() </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GOLANGç¬”è®°1-åŸºç¡€æ•°æ®ç±»å‹</title>
      <link href="/blog/2020/06/09/GOLANG/GOLANG-%E7%AC%94%E8%AE%B01-%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
      <url>/blog/2020/06/09/GOLANG/GOLANG-%E7%AC%94%E8%AE%B01-%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h3><span id="int-å’Œ-uint">int  å’Œ uint</span></h3><p>uintç±»å‹é•¿åº¦å–å†³äº CPUï¼Œå¦‚æœæ˜¯32ä½CPUå°±æ˜¯4ä¸ªå­—èŠ‚ï¼Œå¦‚æœæ˜¯64ä½å°±æ˜¯8ä¸ªå­—èŠ‚ã€‚æˆ‘çš„ç”µè„‘æ˜¯64ä½çš„ï¼Œè€Œ playground æ˜¯32ä½çš„</p><blockquote><p>intæ˜¯å¸¦ç¬¦å·çš„ï¼Œè¡¨ç¤ºèŒƒå›´æ˜¯ï¼š-2147483648åˆ°2147483648ï¼Œå³-2^31åˆ°2^31æ¬¡æ–¹ã€‚</p></blockquote><blockquote><p>uintåˆ™æ˜¯ä¸å¸¦ç¬¦å·çš„ï¼Œè¡¨ç¤ºèŒƒå›´æ˜¯ï¼š2^32å³0åˆ°4294967295ã€‚</p></blockquote><blockquote><p>uintå¯ä»¥ä½¿ç”¨åè¿›åˆ¶ï¼ŒäºŒè¿›åˆ¶ï¼Œåå…­è¿›åˆ¶ã€‚å’Œlong,ulong,float,double,decimalç­‰é¢„å®šä¹‰å¯ä»¥è¿›è¡Œéšå¼è½¬æ¢ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„å€¼æ˜¯å¦åœ¨å¯è½¬æ¢çš„èŒƒå›´å†…ï¼Œä¸ç„¶ä¼šå‡ºç°å¼‚å¸¸ã€‚</p></blockquote><p>The Uint keyword signifies an integral type that stores calues according to the size and ranges shown in the following table.</p><blockquote><p>å…³é”®å­—è¡¨ç¤ºä¸€ç§æ•´å‹ç±»å‹ï¼Œè¯¥ç±»å‹æ ¹æ®ä¸‹è¡¨æ˜¾ç¤ºçš„å¤§å°å’ŒèŒƒå›´å­˜å‚¨å€¼ã€‚<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p></blockquote><h3><span id="golangæ•°æ®ç±»å‹">golangæ•°æ®ç±»å‹ï¼š</span></h3><h4><span id="å¸ƒå°”ç±»å‹">å¸ƒå°”ç±»å‹</span></h4><p>true false</p><h4><span id="æ•°å­—ç±»å‹-æ•´å½¢-æµ®ç‚¹å‹">æ•°å­—ç±»å‹ æ•´å½¢ æµ®ç‚¹å‹</span></h4><p><strong>æ•´å½¢ï¼š</strong></p><p>æ— ç¬¦å·ï¼šuint 8ã€uint 16ã€uint 32ã€uint 64ã€é•¿åº¦ï¼ˆ0~2æ¬¡æ–¹-1ï¼‰</p><p>æœ‰ç¬¦å·ï¼šint 8ã€int 16ã€int 32ã€int 64ã€é•¿åº¦:ä¾‹å¦‚int 8ï¼ˆè´Ÿçš„2^7~2^7-1ï¼‰</p><p>æœ‰æ— ç¬¦å·ï¼šæ²¡æœ‰ç¬¦å·ä½çš„æ•°å­—åª<strong>èƒ½æœ‰0å’Œæ­£å€¼</strong>,æœ‰ç¬¦å·ä½çš„æ•°å­—å¯ä»¥æœ‰<strong>æ­£é›¶,è´Ÿé›¶å’Œæ­£æ•°è´Ÿæ•°</strong>.</p><p><strong>æµ®ç‚¹å‹ï¼š</strong>floatï¼ˆ32å•ç²¾åº¦ï¼‰ floatï¼ˆ64åŒç²¾åº¦ï¼‰</p><table><thead><tr><th align="left">åºå·</th><th align="left">ç±»å‹å’Œæè¿°</th></tr></thead><tbody><tr><td align="left">1</td><td align="left"><strong>float32</strong> IEEE-754 32ä½æµ®ç‚¹å‹æ•°</td></tr><tr><td align="left">2</td><td align="left"><strong>float64</strong> IEEE-754 64ä½æµ®ç‚¹å‹æ•°</td></tr><tr><td align="left">3</td><td align="left"><strong>complex64</strong> 32 ä½å®æ•°å’Œè™šæ•°</td></tr><tr><td align="left">4</td><td align="left"><strong>complex128</strong> 64 ä½å®æ•°å’Œè™šæ•°</td></tr></tbody></table><h4><span id="å­—ç¬¦ä¸²ç±»å‹">å­—ç¬¦ä¸²ç±»å‹</span></h4><h4><span id="æ´¾ç”Ÿç±»å‹">æ´¾ç”Ÿç±»å‹</span></h4><p><strong>æ´¾ç”Ÿç±»å‹:</strong></p><ul><li>(a) æŒ‡é’ˆç±»å‹ï¼ˆPointerï¼‰</li><li>(b) æ•°ç»„ç±»å‹</li><li>(c) ç»“æ„åŒ–ç±»å‹(struct)</li><li>(d) Channel ç±»å‹</li><li>(e) å‡½æ•°ç±»å‹</li><li>(f) åˆ‡ç‰‡ç±»å‹</li><li>(g) æ¥å£ç±»å‹ï¼ˆinterfaceï¼‰</li><li>(h) Map ç±»å‹</li></ul><hr><p>è™šæ•°ï¼š<a href="https://www.ruanyifeng.com/blog/2012/09/imaginary_number.html">https://www.ruanyifeng.com/blog/2012/09/imaginary_number.html</a></p><p>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/janny_flower/article/details/81082424">https://blog.csdn.net/janny_flower/article/details/81082424</a></p>]]></content>
      
      
      <categories>
          
          <category> GOLANG </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Goå¹¶å‘ç¼–ç¨‹æ€»ç»“</title>
      <link href="/blog/2020/06/09/GOLANG/Go%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E6%80%BB%E7%BB%93/"/>
      <url>/blog/2020/06/09/GOLANG/Go%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>Golang :ä¸è¦é€šè¿‡å…±äº«å†…å­˜æ¥é€šä¿¡ï¼Œè€Œåº”è¯¥****é€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜****ã€‚è¿™å¥é£é¡åœ¨Goç¤¾åŒºçš„è¯,è¯´çš„å°±æ˜¯ goroutineä¸­çš„ channelã€‚ä»–åœ¨goå¹¶å‘ç¼–ç¨‹ä¸­å……å½“ç€ç±»å‹å®‰å…¨çš„ç®¡é“ä½œç”¨ã€‚</p><h1><span id="1-é€šè¿‡golangä¸­çš„-goroutine-ä¸syncmutexè¿›è¡Œ-å¹¶å‘åŒæ­¥">1ã€é€šè¿‡golangä¸­çš„ goroutine ä¸sync.Mutexè¿›è¡Œ å¹¶å‘åŒæ­¥</span></h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">package main</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">import</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function"><span class="string">&quot;fmt&quot;</span></span></span></span><br><span class="line"><span class="params"><span class="function"><span class="string">&quot;sync&quot;</span></span></span></span><br><span class="line"><span class="params"><span class="function"><span class="string">&quot;runtime&quot;</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">var</span> count <span class="built_in">int</span></span> = <span class="number">0</span>   <span class="comment">//å…¨å±€å…±äº«å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="function">func <span class="title">counter</span>(<span class="params"><span class="keyword">lock</span> * sync.Mutex</span>)</span>&#123;  <span class="comment">//goroutinueæ‰§è¡Œå‡½æ•°</span></span><br><span class="line"><span class="keyword">lock</span>.Lock()</span><br><span class="line">count++</span><br><span class="line">fmt.Println(count)</span><br><span class="line"><span class="keyword">lock</span>.Unlock()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">func <span class="title">main</span>()</span>&#123;</span><br><span class="line"><span class="keyword">lock</span> := &amp;sync.Mutex&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line"><span class="comment">//ä¼ é€’æŒ‡é’ˆæ˜¯ä¸ºäº†é˜²æ­¢ å‡½æ•°å†…çš„é”å’Œ è°ƒç”¨é”ä¸ä¸€è‡´    åˆ›å»º10ä¸ªåç¨‹å¯¹count++</span></span><br><span class="line"><span class="function">go <span class="title">counter</span>(<span class="params"><span class="keyword">lock</span></span>)</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">for</span></span> &#123;</span><br><span class="line"><span class="keyword">lock</span>.Lock()</span><br><span class="line">c := count</span><br><span class="line"><span class="keyword">lock</span>.Unlock()</span><br><span class="line"><span class="comment"><span class="doctag">///</span>æŠŠæ—¶é—´ç‰‡ç»™åˆ«çš„goroutine  æœªæ¥æŸä¸ªæ—¶åˆ»è¿è¡Œè¯¥routine</span></span><br><span class="line">runtime.Gosched()</span><br><span class="line"><span class="keyword">if</span> c &gt;=<span class="number">10</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;goroutine end&quot;</span>)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;  <span class="comment">//è¾“å‡ºç»“æœï¼š1 2 3 4 5 6 7 8 9 10    &quot;goroutine end&quot;</span></span><br></pre></td></tr></table></figure><h1><span id="2-goroutineä¹‹é—´é€šè¿‡-channelè¿›è¡Œé€šä¿¡channelæ˜¯å’Œç±»å‹ç›¸å…³çš„-å¯ä»¥ç†è§£ä¸º-æ˜¯ä¸€ç§ç±»å‹å®‰å…¨çš„ç®¡é“">2ã€goroutineä¹‹é—´é€šè¿‡ channelè¿›è¡Œé€šä¿¡,channelæ˜¯å’Œç±»å‹ç›¸å…³çš„ å¯ä»¥ç†è§£ä¸º  æ˜¯ä¸€ç§ç±»å‹å®‰å…¨çš„ç®¡é“ã€‚</span></h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function">func <span class="title">Count</span>(<span class="params">ch chan <span class="built_in">int</span></span>)</span> &#123;</span><br><span class="line">ch &lt;- <span class="number">1</span></span><br><span class="line">fmt.Println(<span class="string">&quot;Counting&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">func <span class="title">main</span>()</span> &#123;</span><br><span class="line">chs := make([]&lt;strong&gt;chan <span class="built_in">int</span>&lt;/strong&gt;, <span class="number">10</span>)   <span class="comment">//[]chan int è¡¨ç¤ºæ˜¯chan intç±»å‹çš„åˆ‡ç‰‡ å’Œ   chan []intåŒºåˆ«  æ ‡è¯†é€šé“ç±»å‹æ˜¯[]int</span></span><br><span class="line"><span class="comment">//c := make(chan []int)</span></span><br><span class="line"><span class="comment">//t := []int&#123;1,2,3&#125;</span></span><br><span class="line"><span class="comment">//c &lt;- t</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">chs[i] = make(chan <span class="built_in">int</span>)</span><br><span class="line"><span class="function">go <span class="title">Count</span>(<span class="params">chs[i]</span>)         <span class="comment">//åˆ›å»º10ä¸ªåç¨‹</span></span></span><br><span class="line"><span class="function">fmt.<span class="title">Println</span>(<span class="params"><span class="string">&quot;Count&quot;</span>,i</span>)</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">for</span> i, ch :</span>= range chs &#123;</span><br><span class="line">&lt;-ch</span><br><span class="line">fmt.Println(<span class="string">&quot;Counting&quot;</span>,i)</span><br><span class="line">&#125;</span><br><span class="line">&#125;       <span class="comment">//è°ƒåº¦çš„é¡ºåºä¸åŒï¼Œå¯èƒ½goroutinueæ‰§è¡Œçš„é¡ºåºä¸ä¸€æ ·</span></span><br></pre></td></tr></table></figure><h1><span id="3-goè¯­è¨€ä¸­çš„selectæ˜¯è¯­è¨€çº§å†…ç½®-éå µå¡">3ã€Goè¯­è¨€ä¸­çš„selectæ˜¯è¯­è¨€çº§å†…ç½®  éå µå¡</span></h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> &lt;-chan1: <span class="comment">// å¦‚æœchan1æˆåŠŸè¯»åˆ°æ•°æ®ï¼Œåˆ™è¿›è¡Œè¯¥caseå¤„ç†è¯­å¥  </span></span><br><span class="line"><span class="keyword">case</span> chan2 &lt;- <span class="number">1</span>: <span class="comment">// å¦‚æœæˆåŠŸå‘chan2å†™å…¥æ•°æ®ï¼Œåˆ™è¿›è¡Œè¯¥caseå¤„ç†è¯­å¥  </span></span><br><span class="line"><span class="literal">default</span>: <span class="comment">// å¦‚æœä¸Šé¢éƒ½æ²¡æœ‰æˆåŠŸï¼Œåˆ™è¿›å…¥defaultå¤„ç†æµç¨‹  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºï¼Œselectä¸åƒswitchï¼Œåé¢å¹¶ä¸å¸¦åˆ¤æ–­æ¡ä»¶ï¼Œè€Œæ˜¯ç›´æ¥å»æŸ¥çœ‹caseè¯­å¥ã€‚æ¯ä¸ªcaseè¯­å¥éƒ½å¿…é¡»æ˜¯ä¸€ä¸ªé¢å‘channelçš„æ“ä½œã€‚æ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç¬¬ä¸€ä¸ªcaseè¯•å›¾ä»chan1è¯»å–ä¸€ä¸ªæ•°æ®å¹¶ç›´æ¥å¿½ç•¥è¯»åˆ°çš„æ•°æ®ï¼Œè€Œç¬¬äºŒä¸ªcaseåˆ™æ˜¯è¯•å›¾å‘chan2ä¸­å†™å…¥ä¸€ä¸ªæ•´å‹æ•°1ï¼Œå¦‚æœè¿™ä¸¤è€…éƒ½æ²¡æœ‰æˆåŠŸï¼Œåˆ™åˆ°è¾¾defaultè¯­å¥ã€‚</p><h1><span id="4-channel-çš„å¸¦ç¼“å†²è¯»å–å†™å…¥">4ã€channel çš„å¸¦ç¼“å†²è¯»å–å†™å…¥</span></h1><p>è¦åˆ›å»ºä¸€ä¸ªå¸¦ç¼“å†²çš„channelï¼Œå…¶å®ä¹Ÿéå¸¸å®¹æ˜“ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">1024</span>)</span><br></pre></td></tr></table></figure><p>åœ¨è°ƒç”¨make()æ—¶å°†ç¼“å†²åŒºå¤§å°ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥å³å¯ï¼Œæ¯”å¦‚ä¸Šé¢è¿™ä¸ªä¾‹å­å°±åˆ›å»ºäº†ä¸€ä¸ªå¤§å°ä¸º1024çš„intç±»å‹channelï¼Œå³ä½¿æ²¡æœ‰è¯»å–æ–¹ï¼Œå†™å…¥æ–¹ä¹Ÿå¯ä»¥ä¸€ç›´å¾€channelé‡Œå†™å…¥ï¼Œåœ¨ç¼“å†²åŒºè¢«å¡«å®Œä¹‹å‰éƒ½ä¸ä¼šé˜»å¡ã€‚</p><p>ä»å¸¦ç¼“å†²çš„channelä¸­è¯»å–æ•°æ®å¯ä»¥ä½¿ç”¨ä¸å¸¸è§„éç¼“å†²channelå®Œå…¨ä¸€è‡´çš„æ–¹æ³•ï¼Œä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨rangeå…³é”®æ¥å®ç°æ›´ä¸ºç®€ä¾¿çš„å¾ªç¯è¯»å–ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i := <span class="keyword">range</span> c &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;Received:&quot;</span>, i)</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><h1><span id="5-ç”¨goroutineæ¨¡æ‹Ÿç”Ÿäº§æ¶ˆè´¹è€…">5ã€ç”¨goroutineæ¨¡æ‹Ÿç”Ÿäº§æ¶ˆè´¹è€…</span></h1><p>å› ä¸ºç¨‹åºä¼š****ä¼˜å…ˆæ‰§è¡Œä¸»çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹æ‰§è¡Œå®Œæˆåï¼Œç¨‹åºä¼šç«‹å³é€€å‡º****ï¼Œæ²¡æœ‰å¤šä½™çš„æ—¶é—´å»æ‰§è¡Œå­çº¿ç¨‹ã€‚å¦‚æœåœ¨ç¨‹åºçš„æœ€åè®©ä¸»çº¿ç¨‹ä¼‘çœ 1ç§’é’Ÿï¼Œé‚£ç¨‹åºå°±ä¼šæœ‰è¶³å¤Ÿçš„æ—¶é—´å»æ‰§è¡Œå­çº¿ç¨‹ã€‚ é€šé“åˆå«channelï¼Œé¡¾åæ€ä¹‰ï¼Œchannelçš„ä½œç”¨å°±æ˜¯åœ¨å¤šçº¿ç¨‹ä¹‹é—´ä¼ é€’æ•°æ®çš„ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">chreadandwrite :=<span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>)</span><br><span class="line">chonlyread := <span class="built_in">make</span>(&lt;-<span class="keyword">chan</span> <span class="type">int</span>) <span class="comment">//åˆ›å»ºåªè¯»channel    var read &lt;-chan int = chreadandwrite </span></span><br><span class="line">chonlywrite := <span class="built_in">make</span>(<span class="keyword">chan</span>&lt;- <span class="type">int</span>) <span class="comment">//åˆ›å»ºåªå†™channel   var write chan&lt;- int = chreadandwrite </span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Producer</span><span class="params">(p <span class="keyword">chan</span>&lt;- <span class="type">int</span>)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">p &lt;- i</span><br><span class="line">fmt.Println(<span class="string">&quot;send:&quot;</span>, i)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Consumer</span><span class="params">(c &lt;-<span class="keyword">chan</span> <span class="type">int</span>)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">v := &lt;-c</span><br><span class="line">fmt.Println(<span class="string">&quot;receive:&quot;</span>, v)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">queue := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>)</span><br><span class="line"><span class="comment">/*ch :=make(chan int)</span></span><br><span class="line"><span class="comment">ch &lt;- 1</span></span><br><span class="line"><span class="comment">è¿™ä¸ªé”™è¯¯çš„æ„æ€æ˜¯è¯´çº¿ç¨‹é™·å…¥äº†æ­»é”ï¼Œç¨‹åºæ— æ³•ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚é‚£ä¹ˆé€ æˆè¿™ç§é”™è¯¯çš„åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&lt;span style=&quot;white-space:pre;&quot;&gt;&lt;/span&gt;æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ— ç¼“å†²çš„channelï¼Œç„¶åç»™è¿™ä¸ªchannelèµ‹å€¼äº†ï¼Œç¨‹åºå°±æ˜¯åœ¨èµ‹å€¼å®Œæˆåé™·å…¥äº†æ­»é”ã€‚</span></span><br><span class="line"><span class="comment">&lt;span style=&quot;white-space:pre;&quot;&gt;&lt;/span&gt;å› ä¸ºæˆ‘ä»¬çš„channelæ˜¯æ— ç¼“å†²çš„ï¼Œå³åŒæ­¥çš„ï¼Œèµ‹å€¼å®Œæˆåæ¥ä¸åŠè¯»å–channelï¼Œç¨‹åºå°±å·²ç»é˜»å¡äº†ã€‚  =====    é¡ºåºæ‰§è¡Œæ»¡é˜»å¡</span></span><br><span class="line"><span class="comment">&lt;span style=&quot;white-space:pre;&quot;&gt;&lt;/span&gt;queue &lt;- 1</span></span><br><span class="line"><span class="comment">&lt;span style=&quot;white-space:pre;&quot;&gt;&lt;/span&gt;queue &lt;- 2   //æ»¡é˜»å¡</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> Producer(queue)     <span class="comment">//å¼€å¯åç¨‹æ‰§è¡Œå‡½æ•°å•ç‹¬å»æ‰§è¡Œï¼Œä¸»ç¨‹åºç›´æ¥å¾€ä¸‹æ‰§è¡Œ</span></span><br><span class="line">                       <span class="comment">//i = 0 çš„æ—¶å€™ï¼Œå†™å…¥é˜»å¡      ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œæ¶ˆè´¹è€…ä¼šå»è¯»å–channelå€¼ã€‚</span></span><br><span class="line"><span class="keyword">go</span> Consumer(queue)</span><br><span class="line">time.Sleep(<span class="number">1e9</span>)        <span class="comment">//è®©Producerä¸Consumerå®Œæˆ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºchannelæ˜¯æ²¡æœ‰ç¼“å†²çš„ï¼Œæ‰€ä»¥å½“ç”Ÿäº§è€…ç»™channelèµ‹å€¼åï¼Œç”Ÿäº§è€…è¿™ä¸ªçº¿ç¨‹ä¼šé˜»å¡ï¼Œ****ç›´åˆ°æ¶ˆè´¹è€…çº¿ç¨‹å°†channelä¸­çš„æ•°æ®å–å‡º****ã€‚æ¶ˆè´¹è€…ç¬¬ä¸€æ¬¡å°†æ•°æ®å–å‡ºåï¼Œè¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯æ—¶ï¼Œæ¶ˆè´¹è€…çš„çº¿ç¨‹ä¹Ÿä¼šé˜»å¡ï¼Œå› ä¸ºç”Ÿäº§è€…è¿˜æ²¡æœ‰å°†æ•°æ®å­˜å…¥ï¼Œè¿™æ—¶ç¨‹åºä¼šå»æ‰§è¡Œç”Ÿäº§è€…çš„çº¿ç¨‹ã€‚ç¨‹åºå°±è¿™æ ·åœ¨æ¶ˆè´¹è€…å’Œç”Ÿäº§è€…ä¸¤ä¸ªçº¿ç¨‹é—´ä¸æ–­åˆ‡æ¢ï¼Œç›´åˆ°å¾ªç¯ç»“æŸã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">produce</span><span class="params">(p <span class="keyword">chan</span>&lt;- <span class="type">int</span>)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">p &lt;- i</span><br><span class="line">fmt.Println(<span class="string">&quot;send:&quot;</span>, i)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">consumer</span><span class="params">(c &lt;-<span class="keyword">chan</span> <span class="type">int</span>)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">v := &lt;-c</span><br><span class="line">fmt.Println(<span class="string">&quot;receive:&quot;</span>, v)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">10</span>)  <span class="comment">//å¸¦ç¼“å†²çš„ä¾‹å­</span></span><br><span class="line"><span class="keyword">go</span> produce(ch)</span><br><span class="line"><span class="keyword">go</span> consumer(ch)</span><br><span class="line">time.Sleep(<span class="number">1</span> * time.Second)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¨‹åºä¸­ï¼Œç¼“å†²åŒºå¯ä»¥å­˜å‚¨10ä¸ªintç±»å‹çš„æ•´æ•°ï¼Œåœ¨æ‰§è¡Œç”Ÿäº§è€…çº¿ç¨‹çš„æ—¶å€™ï¼Œçº¿ç¨‹å°±ä¸ä¼šé˜»å¡ï¼Œä¸€æ¬¡æ€§å°†10ä¸ªæ•´æ•°å­˜å…¥channelï¼Œåœ¨è¯»å–çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯ä¸€æ¬¡æ€§è¯»å–ã€‚è¯»å–çš„è¯ï¼Œæ²¡æœ‰æ•°æ®å°±é˜»å¡ï¼Œæœ‰çš„è¯ä¾æ¬¡è¿›è¡Œè¯»å–æ“ä½œã€‚</p><h1><span id="6-é€šè¿‡make-åˆ›å»ºé€šé“">6ã€é€šè¿‡make åˆ›å»ºé€šé“</span></h1><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">make</span>(c1 <span class="keyword">chan</span> <span class="type">int</span>)       åˆ›å»ºçš„æ˜¯ åŒæ­¥channel ...è¯»å†™å®Œå…¨å¯¹åº”    å…ˆå†™æ»¡çš„è¯å°±ä¼šé˜»å¡  é¡ºåºç¨‹åºä¸ä¼šæ‰§è¡Œ</span><br><span class="line"><span class="built_in">make</span>(c1 <span class="keyword">chan</span> <span class="type">int</span> ,<span class="number">10</span>)   åˆ›å»ºå¸¦ç¼“å†²çš„é€šé“ ä¸Šæ¥å¯ä»¥å†™<span class="number">10</span>æ¬¡        </span><br></pre></td></tr></table></figure><h1><span id="7-éšæœºå‘é€šé“ä¸­å†™å…¥0æˆ–è€…1">7ã€éšæœºå‘é€šé“ä¸­å†™å…¥0æˆ–è€…1</span></h1><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line"><span class="comment">///ä¸åœå‘channelä¸­éšæœºå†™å…¥ 0 æˆ–è€…1</span></span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> ch &lt;- <span class="number">0</span>:</span><br><span class="line"><span class="keyword">case</span> ch &lt;- <span class="number">1</span>:</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä»é€šé“ä¸­å–å‡ºæ•°æ®</span></span><br><span class="line">i := &lt;-ch</span><br><span class="line">fmt.Println(<span class="string">&quot;Value received:&quot;</span>,i)</span><br><span class="line">time.Sleep(<span class="number">1e8</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1><span id="8-å¸¦ç¼“å†²çš„channel">8ã€å¸¦ç¼“å†²çš„channel</span></h1><p>ä¹‹å‰åˆ›å»ºçš„éƒ½æ˜¯ä¸å¸¦ç¼“å†²çš„channelï¼Œè¿™ç§åšæ³•å¯¹äºä¼ é€’å•ä¸ªæ•°æ®çš„åœºæ™¯å¯ä»¥æ¥å—ï¼Œä½†å¯¹äºéœ€è¦æŒç»­ä¼ è¾“å¤§é‡æ•°æ®çš„åœºæ™¯å°±æœ‰äº›ä¸åˆé€‚äº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç»å¦‚ä½•ç»™channelå¸¦ä¸Šç¼“å†²ï¼Œä»è€Œè¾¾åˆ°æ¶ˆæ¯é˜Ÿåˆ—çš„æ•ˆæœã€‚</p><p>è¦åˆ›å»ºä¸€ä¸ªå¸¦ç¼“å†²çš„channelï¼Œå…¶å®ä¹Ÿéå¸¸å®¹æ˜“ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">1024</span>)</span><br></pre></td></tr></table></figure><p>åœ¨è°ƒç”¨make()æ—¶å°†ç¼“å†²åŒºå¤§å°ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥å³å¯ï¼Œæ¯”å¦‚ä¸Šé¢è¿™ä¸ªä¾‹å­å°±åˆ›å»ºäº†ä¸€ä¸ªå¤§å°ä¸º1024çš„intç±»å‹channelï¼Œå³ä½¿æ²¡æœ‰è¯»å–æ–¹ï¼Œå†™å…¥æ–¹ä¹Ÿå¯ä»¥ä¸€ç›´å¾€channelé‡Œå†™å…¥ï¼Œåœ¨ç¼“å†²åŒºè¢«å¡«å®Œä¹‹å‰éƒ½ä¸ä¼šé˜»å¡ã€‚</p><p>ä»å¸¦ç¼“å†²çš„channelä¸­è¯»å–æ•°æ®å¯ä»¥ä½¿ç”¨ä¸å¸¸è§„éç¼“å†²channelå®Œå…¨ä¸€è‡´çš„æ–¹æ³•ï¼Œä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨rangeå…³é”®æ¥å®ç°æ›´ä¸ºç®€ä¾¿çš„å¾ªç¯è¯»å–ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i := <span class="keyword">range</span> c &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;Received:&quot;</span>, i)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">A</span><span class="params">(c <span class="keyword">chan</span> <span class="type">int</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++&#123;</span><br><span class="line">c&lt;- i</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">B</span><span class="params">(c <span class="keyword">chan</span> <span class="type">int</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span> val:=<span class="keyword">range</span> c &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;Value:&quot;</span>,val)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">chs:=<span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>,<span class="number">10</span>)</span><br><span class="line"><span class="comment">//åªè¦æœ‰é€šé“æ“ä½œä¸€å®šè¦æ”¾åˆ°goroutineä¸­å¦åˆ™ä¼šå µå¡å½“å‰çš„ä¸»çº¿ç¨‹ å¹¶ä¸”å¯¼è‡´ç¨‹åºé€€å‡º</span></span><br><span class="line"><span class="comment">//å¯¹äºåŒæ­¥é€šé“ æˆ–è€…å¸¦ç¼“å†²çš„é€šé“ ä¸€å®šè¦å°è£…æˆå‡½æ•° ä½¿ç”¨ goroutine åŒ…è£…</span></span><br><span class="line"><span class="keyword">go</span> A(chs)</span><br><span class="line"><span class="keyword">go</span> B(chs)</span><br><span class="line">time.Sleep(<span class="number">1e9</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1><span id="9-å…³äºåˆ›å»ºå¤šä¸ªgoroutineå…·ä½“åˆ°goè¯­è¨€ä¼šåˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹">9ã€å…³äºåˆ›å»ºå¤šä¸ªgoroutineå…·ä½“åˆ°goè¯­è¨€ä¼šåˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹</span></h1><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="comment">//&quot;fmt&quot;</span></span><br><span class="line"><span class="comment">//&quot;time&quot;</span></span><br><span class="line"><span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i:=<span class="number">0</span>; i&lt;<span class="number">20</span>; i++ &#123;</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">b:=<span class="built_in">make</span>([]<span class="type">byte</span>, <span class="number">10</span>)</span><br><span class="line">os.Stdin.Read(b) <span class="comment">// will block</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">select</span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼šäº§ç”Ÿ21ä¸ªçº¿ç¨‹ï¼š<br>runtime scheduler(src&#x2F;pkg&#x2F;runtime&#x2F;proc.c)ä¼š<em><strong>*ç»´æŠ¤ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå½“æŸä¸ªgoroutineè¢«blockåï¼Œschedulerä¼šåˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹ç»™å…¶ä»–readyçš„goroutineã€‚*</strong></em><br>GOMAXPROCSæ§åˆ¶çš„æ˜¯æœªè¢«é˜»å¡çš„æ‰€æœ‰goroutineè¢«multiplexåˆ°å¤šå°‘ä¸ªçº¿ç¨‹ä¸Šè¿è¡Œ</p><h1><span id="10-åœ¨channelä¸­ä¹Ÿæ˜¯å¯ä»¥ä¼ é€’channelçš„goè¯­è¨€çš„channelå’Œmap-sliceç­‰ä¸€æ ·éƒ½æ˜¯åŸç”Ÿç±»å‹">10ã€åœ¨channelä¸­ä¹Ÿæ˜¯å¯ä»¥ä¼ é€’channelçš„,Goè¯­è¨€çš„channelå’Œmap  sliceç­‰ä¸€æ ·éƒ½æ˜¯åŸç”Ÿç±»å‹</span></h1><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[]<span class="keyword">chan</span> <span class="type">int</span>   <span class="keyword">chan</span> <span class="type">int</span>åˆ‡ç‰‡    <span class="keyword">chan</span> []<span class="type">int</span> è¡¨ç¤ºçš„æ˜¯<span class="keyword">chan</span>é‡Œé¢å­˜çš„æ•°æ®æ—¶[]<span class="type">int</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨Goè¯­è¨€ä¸­channelæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªåŸç”Ÿç±»å‹ï¼Œä¸mapä¹‹ç±»çš„ç±»å‹åœ°ä½ä¸€æ ·ï¼Œå› æ­¤channelæœ¬èº«åœ¨å®šä¹‰åä¹Ÿå¯ä»¥é€šè¿‡channelæ¥ä¼ é€’ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªç‰¹æ€§æ¥å®ç°*nixä¸Šéå¸¸å¸¸è§çš„ç®¡é“ï¼ˆpipeï¼‰ç‰¹æ€§ã€‚ç®¡é“ä¹Ÿæ˜¯ä½¿ç”¨éå¸¸å¹¿æ³›çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œæ¯”å¦‚åœ¨å¤„ç†æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ç®¡é“è®¾è®¡ï¼Œè¿™æ ·å¯ä»¥æ¯”è¾ƒå®¹æ˜“ä»¥æ’ä»¶çš„æ–¹å¼å¢åŠ æ•°æ®çš„å¤„ç†æµç¨‹ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬****åˆ©ç”¨channelå¯è¢«ä¼ é€’çš„ç‰¹æ€§æ¥å®ç°æˆ‘ä»¬çš„ç®¡é“****ã€‚ ä¸ºäº†ç®€åŒ–è¡¨è¾¾ï¼Œ æˆ‘ä»¬å‡è®¾åœ¨ç®¡é“ä¸­ä¼ é€’çš„æ•°æ®åªæ˜¯ä¸€ä¸ªæ•´å‹æ•°ï¼Œåœ¨å®é™…çš„åº”ç”¨åœºæ™¯ä¸­è¿™é€šå¸¸ä¼šæ˜¯ä¸€ä¸ªæ•°æ®å—ã€‚</p><p>é¦–å…ˆé™å®šåŸºæœ¬çš„æ•°æ®ç»“æ„ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> PipeData <span class="keyword">struct</span> &#123;</span><br><span class="line">    value <span class="type">int</span></span><br><span class="line">    handler <span class="function"><span class="keyword">func</span><span class="params">(<span class="type">int</span>)</span></span> <span class="type">int</span></span><br><span class="line">    next <span class="keyword">chan</span> <span class="type">int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å†™ä¸€ä¸ªå¸¸è§„çš„å¤„ç†å‡½æ•°ã€‚æˆ‘ä»¬åªè¦å®šä¹‰ä¸€ç³»åˆ—PipeDataçš„æ•°æ®ç»“æ„å¹¶ä¸€èµ·ä¼ é€’ç»™ è¿™ä¸ªå‡½æ•°ï¼Œå°±å¯ä»¥è¾¾åˆ°æµå¼å¤„ç†æ•°æ®çš„ç›®çš„ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(queue <span class="keyword">chan</span> *PipeData)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> data := <span class="keyword">range</span> queue &#123;</span><br><span class="line">        data.next &lt;- data.handler(data.value)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1><span id="11-æˆ‘ä»¬é»˜è®¤åˆ›å»ºçš„æ˜¯åŒå‘é€šé“å•å‘é€šé“æ²¡æœ‰æ„ä¹‰ä½†æ˜¯æˆ‘ä»¬å´å¯ä»¥é€šè¿‡å¼ºåˆ¶è½¬æ¢-å°†åŒå‘é€šé“-è½¬æ¢æˆä¸ºå•å‘é€šé“">11ã€æˆ‘ä»¬é»˜è®¤åˆ›å»ºçš„æ˜¯åŒå‘é€šé“,å•å‘é€šé“æ²¡æœ‰æ„ä¹‰,ä½†æ˜¯æˆ‘ä»¬å´å¯ä»¥é€šè¿‡å¼ºåˆ¶è½¬æ¢ å°†åŒå‘é€šé“ è½¬æ¢æˆä¸ºå•å‘é€šé“</span></h1><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ch1 <span class="keyword">chan</span> <span class="type">int</span>  <span class="comment">// ch1æ˜¯ä¸€ä¸ªæ­£å¸¸çš„channelï¼Œä¸æ˜¯å•å‘çš„  </span></span><br><span class="line"><span class="keyword">var</span> ch2 <span class="keyword">chan</span>&lt;- <span class="type">float64</span><span class="comment">// ch2æ˜¯å•å‘channelï¼Œåªç”¨äºå†™float64æ•°æ®</span></span><br><span class="line"><span class="keyword">var</span> ch3 &lt;-<span class="keyword">chan</span> <span class="type">int</span> <span class="comment">// ch3æ˜¯å•å‘channelï¼Œåªç”¨äºè¯»å–intæ•°æ® </span></span><br></pre></td></tr></table></figure><p>channelæ˜¯ä¸€ä¸ªåŸç”Ÿç±»å‹ï¼Œå› æ­¤ä¸ä»…æ”¯æŒè¢«ä¼ é€’ï¼Œè¿˜æ”¯æŒç±»å‹è½¬æ¢ã€‚åªæœ‰åœ¨ä»‹ç»äº†å•å‘channelçš„æ¦‚å¿µåï¼Œè¯»è€…æ‰ä¼šæ˜ç™½ç±»å‹è½¬æ¢å¯¹äºchannelçš„æ„ä¹‰ï¼šå°±æ˜¯åœ¨å•å‘channelå’ŒåŒå‘channelä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚</p><p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ch4 := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>)</span><br><span class="line">ch5 := &lt;-<span class="keyword">chan</span> <span class="type">int</span>(ch4) <span class="comment">// ch5å°±æ˜¯ä¸€ä¸ªå•å‘çš„è¯»å–channel</span></span><br><span class="line">ch6 := <span class="keyword">chan</span>&lt;- <span class="type">int</span>(ch4) <span class="comment">// ch6 æ˜¯ä¸€ä¸ªå•å‘çš„å†™å…¥channel</span></span><br></pre></td></tr></table></figure><p>åŸºäºch4ï¼Œæˆ‘ä»¬é€šè¿‡ç±»å‹è½¬æ¢åˆå§‹åŒ–äº†ä¸¤ä¸ªå•å‘channelï¼šå•å‘è¯»çš„ch5å’Œå•å‘å†™çš„ch6ã€‚ </p><p>ä»è®¾è®¡çš„è§’åº¦è€ƒè™‘ï¼Œæ‰€æœ‰çš„ä»£ç åº”è¯¥éƒ½éµå¾ªâ€æœ€å°æƒé™åŸåˆ™â€ ï¼Œä»è€Œé¿å…æ²¡å¿…è¦åœ°ä½¿ç”¨æ³›æ»¥é—®é¢˜ï¼Œ è¿›è€Œå¯¼è‡´ç¨‹åºå¤±æ§ã€‚ å†™è¿‡C++ç¨‹åºçš„è¯»è€…è‚¯å®šå°±ä¼šè”æƒ³èµ·const æŒ‡é’ˆçš„ç”¨æ³•ã€‚éconstæŒ‡é’ˆå…·å¤‡constæŒ‡é’ˆçš„æ‰€æœ‰åŠŸèƒ½ï¼Œå°†ä¸€ä¸ªæŒ‡é’ˆè®¾å®šä¸ºconstå°±æ˜¯æ˜ç¡®å‘Šè¯‰ </p><p>****å‡½æ•°å®ç°è€…ä¸è¦è¯•å›¾å¯¹è¯¥æŒ‡é’ˆè¿›è¡Œä¿®æ”¹ã€‚å•å‘channelä¹Ÿæ˜¯èµ·åˆ°è¿™æ ·çš„ä¸€ç§å¥‘çº¦ä½œç”¨****ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å•å‘channelçš„ç”¨æ³•ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Parse</span><span class="params">(ch &lt;-<span class="keyword">chan</span> <span class="type">int</span>)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> value := <span class="keyword">range</span> ch &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;Parsing value&quot;</span>, value)  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™¤éè¿™ä¸ªå‡½æ•°çš„å®ç°è€…æ— è€»åœ°ä½¿ç”¨äº†ç±»å‹è½¬æ¢ï¼Œå¦åˆ™è¿™ä¸ªå‡½æ•°å°±ä¸ä¼šå› ä¸ºå„ç§åŸå› è€Œå¯¹ch è¿›è¡Œå†™ï¼Œé¿å…åœ¨chä¸­å‡ºç°éæœŸæœ›çš„æ•°æ®ï¼Œä»è€Œå¾ˆå¥½åœ°å®è·µæœ€å°æƒé™åŸåˆ™ã€‚</p><h1><span id="12-åªè¯»åªå†™-å•å‘-channel-ä»£ç ä¾‹å­-éµå¾ªæƒé™æœ€å°åŒ–çš„åŸåˆ™">12ã€åªè¯»åªå†™ å•å‘ channel ä»£ç ä¾‹å­   éµå¾ªæƒé™æœ€å°åŒ–çš„åŸåˆ™</span></h1><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">//æ¥å—ä¸€ä¸ªå‚æ•° æ˜¯åªå…è®¸è¯»å–é€šé“  é™¤éç›´æ¥å¼ºåˆ¶è½¬æ¢ è¦ä¹ˆä½ åªèƒ½ä»channelä¸­è¯»å–æ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sCh</span><span class="params">(ch &lt;-<span class="keyword">chan</span> <span class="type">int</span>)</span></span>&#123;</span><br><span class="line"><span class="keyword">for</span> val:= <span class="keyword">range</span> ch &#123;</span><br><span class="line">fmt.Println(val)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//åˆ›å»ºä¸€ä¸ªå¸¦100ç¼“å†²çš„é€šé“ å¯ä»¥ç›´æ¥å†™å…¥ è€Œä¸ä¼šå¯¼è‡´ ä¸»çº¿ç¨‹å µå¡</span></span><br><span class="line">dch:=<span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>,<span class="number">100</span>)</span><br><span class="line"><span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++&#123;</span><br><span class="line">dch&lt;- i</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä¼ é€’è¿›å» åªè¯»é€šé“</span></span><br><span class="line"><span class="keyword">go</span> sCh(dch)</span><br><span class="line">time.Sleep(<span class="number">1e9</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1><span id="13-channelçš„å…³é—­ä»¥åŠåˆ¤æ–­channelçš„å…³é—­">13ã€channelçš„å…³é—­,ä»¥åŠåˆ¤æ–­channelçš„å…³é—­</span></h1><p>å…³é—­channeléå¸¸ç®€å•ï¼Œç›´æ¥ä½¿ç”¨Goè¯­è¨€å†…ç½®çš„close()å‡½æ•°å³å¯ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">close</span>(ch)</span><br></pre></td></tr></table></figure><p>åœ¨ä»‹ç»äº†å¦‚ä½•å…³é—­channelä¹‹åï¼Œæˆ‘ä»¬å°±å¤šäº†ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•åˆ¤æ–­ä¸€ä¸ªchannelæ˜¯å¦å·²ç»è¢«å…³é—­ï¼Ÿæˆ‘ä»¬å¯ä»¥åœ¨è¯»å–çš„æ—¶å€™ä½¿ç”¨å¤šé‡è¿”å›å€¼çš„æ–¹å¼ï¼š</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">x</span>, ok := &lt;-ch</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç”¨æ³•ä¸mapä¸­çš„æŒ‰é”®è·å–valueçš„è¿‡ç¨‹æ¯”è¾ƒç±»ä¼¼ï¼Œåªéœ€è¦çœ‹ç¬¬äºŒä¸ªboolè¿”å›å€¼å³å¯ï¼Œå¦‚æœè¿”å›å€¼æ˜¯falseåˆ™è¡¨ç¤ºchå·²ç»è¢«å…³é—­ã€‚</p><h1><span id="14-goçš„å¤šæ ¸å¹¶è¡ŒåŒ–ç¼–ç¨‹-é«˜æ€§èƒ½å¹¶å‘ç¼–ç¨‹-å¿…é¡»è®¾ç½®gomaxprocs-ä¸ºæœ€å¤§æ ¸æ•°ç›®-è¿™ä¸ªå€¼ç”±runtimenumcpuè·å–">14ã€Goçš„å¤šæ ¸å¹¶è¡ŒåŒ–ç¼–ç¨‹   é«˜æ€§èƒ½å¹¶å‘ç¼–ç¨‹ å¿…é¡»è®¾ç½®GOMAXPROCS ä¸ºæœ€å¤§æ ¸æ•°ç›® è¿™ä¸ªå€¼ç”±runtime.NumCPU()è·å–</span></h1><p>åœ¨æ‰§è¡Œä¸€äº›æ˜‚è´µçš„è®¡ç®—ä»»åŠ¡æ—¶ï¼Œ æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿå°½é‡****åˆ©ç”¨ç°ä»£æœåŠ¡å™¨æ™®éå…·å¤‡çš„å¤šæ ¸ç‰¹æ€§æ¥å°½é‡å°†ä»»åŠ¡å¹¶è¡ŒåŒ–*<em><strong>ï¼Œä»è€Œè¾¾åˆ°é™ä½æ€»è®¡ç®—æ—¶é—´çš„ç›®çš„ã€‚æ­¤æ—¶æˆ‘ä»¬éœ€è¦äº†è§£</strong></em>*CPUæ ¸å¿ƒçš„æ•°é‡****ï¼Œå¹¶é’ˆå¯¹æ€§åœ°åˆ†è§£è®¡ç®—ä»»åŠ¡åˆ°å¤šä¸ªgoroutineä¸­å»å¹¶è¡Œè¿è¡Œã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ¥æ¨¡æ‹Ÿä¸€ä¸ªå®Œå…¨å¯ä»¥å¹¶è¡Œçš„è®¡ç®—ä»»åŠ¡ï¼šè®¡ç®—Nä¸ªæ•´å‹æ•°çš„æ€»å’Œã€‚æˆ‘ä»¬å¯ä»¥å°†****æ‰€æœ‰æ•´å‹æ•°åˆ†æˆMä»½ï¼ŒMå³CPUçš„ä¸ªæ•°****ã€‚è®©æ¯ä¸ªCPUå¼€å§‹è®¡ç®—åˆ†ç»™å®ƒçš„é‚£ä»½è®¡ç®—ä»»åŠ¡ï¼Œæœ€åå°†æ¯ä¸ªCPUçš„è®¡ç®—ç»“æœå†åšä¸€æ¬¡ç´¯åŠ ï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ°æ‰€æœ‰Nä¸ªæ•´å‹æ•°çš„æ€»å’Œï¼š</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">type</span> <span class="type">Vector</span> []float64</span></span><br><span class="line">// åˆ†é…ç»™æ¯ä¸ª<span class="type">CPU</span>çš„è®¡ç®—ä»»åŠ¡</span><br><span class="line"><span class="title">func</span> (v <span class="type">Vector</span>) <span class="type">DoSome</span>(i, n int, u <span class="type">Vector</span>, c chan int) &#123;</span><br><span class="line"><span class="title">for</span> ; i &lt; n; i++ &#123;</span><br><span class="line">         v[i] += u.<span class="type">Op</span>(v[i])</span><br><span class="line">     &#125;</span><br><span class="line">     c &lt;- <span class="number">1</span>       </span><br><span class="line">// å‘ä¿¡å·å‘Šè¯‰ä»»åŠ¡ç®¡ç†è€…æˆ‘å·²ç»è®¡ç®—å®Œæˆäº†</span><br><span class="line">&#125;</span><br><span class="line"><span class="title">const</span> <span class="type">NCPU</span> = <span class="number">16</span>     </span><br><span class="line">// å‡è®¾æ€»å…±æœ‰<span class="number">16</span>æ ¸   </span><br><span class="line"><span class="title">func</span> (v <span class="type">Vector</span>) <span class="type">DoAll</span>(u <span class="type">Vector</span>) &#123;   </span><br><span class="line">    c := make(chan int, <span class="type">NCPU</span>)  // ç”¨äºæ¥æ”¶æ¯ä¸ª<span class="type">CPU</span>çš„ä»»åŠ¡å®Œæˆä¿¡å·   </span><br><span class="line">    for i := <span class="number">0</span>; i &lt; <span class="type">NCPU</span>; i++ &#123;   </span><br><span class="line">            go v.<span class="type">DoSome</span>(i*len(v)/<span class="type">NCPU</span>, (i+<span class="number">1</span>)*len(v)/<span class="type">NCPU</span>, u, c)</span><br><span class="line">    &#125; </span><br><span class="line">    // ç­‰å¾…æ‰€æœ‰<span class="type">CPU</span>çš„ä»»åŠ¡å®Œæˆ</span><br><span class="line">    for i := <span class="number">0</span>; i &lt; <span class="type">NCPU</span>; i++ &#123;   </span><br><span class="line">         &lt;-c    // è·å–åˆ°ä¸€ä¸ªæ•°æ®ï¼Œè¡¨ç¤ºä¸€ä¸ª<span class="type">CPU</span>è®¡ç®—å®Œæˆäº†</span><br><span class="line">    &#125;</span><br><span class="line">// åˆ°è¿™é‡Œè¡¨ç¤ºæ‰€æœ‰è®¡ç®—å·²ç»ç»“æŸ</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªå‡½æ•°çœ‹èµ·æ¥è®¾è®¡éå¸¸åˆç†ã€‚****DoAll()ä¼šæ ¹æ®CPUæ ¸å¿ƒçš„æ•°ç›®å¯¹ä»»åŠ¡è¿›è¡Œåˆ†å‰²*<em><strong>ï¼Œç„¶åå¼€è¾Ÿå¤šä¸ªgoroutineæ¥å¹¶è¡Œæ‰§è¡Œè¿™äº›è®¡ç®—ä»»åŠ¡ã€‚æ˜¯å¦å¯ä»¥å°†æ€»çš„è®¡ç®—æ—¶é—´é™åˆ°æ¥è¿‘åŸæ¥çš„1&#x2F;Nå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä¸ä¸€å®šã€‚å¦‚æœæç§’è¡¨ï¼ˆæ­£å¸¸ç‚¹çš„è¯ï¼Œåº”è¯¥ç”¨7.8èŠ‚ä¸­ä»‹ç»çš„Benchmarkæ–¹æ³•ï¼‰ ï¼Œä¼šå‘ç°æ€»çš„æ‰§è¡Œæ—¶é—´æ²¡æœ‰æ˜æ˜¾ç¼©çŸ­ã€‚å†å»è§‚å¯ŸCPUè¿è¡ŒçŠ¶æ€ï¼Œ ä½ ä¼šå‘ç°</strong></em>*å°½ç®¡æˆ‘ä»¬æœ‰16ä¸ªCPUæ ¸å¿ƒï¼Œ ä½†åœ¨è®¡ç®—è¿‡ç¨‹ä¸­å…¶å®åªæœ‰ä¸€ä¸ªCPUæ ¸å¿ƒå¤„äºç¹å¿™çŠ¶æ€****ï¼Œè¿™æ˜¯ä¼šè®©å¾ˆå¤šGoè¯­è¨€åˆå­¦è€…è¿·æƒ‘çš„é—®é¢˜ã€‚</p><p>å®˜æ–¹çš„ç­”æ¡ˆæ˜¯ï¼Œè¿™æ˜¯å½“å‰ç‰ˆæœ¬çš„Goç¼–è¯‘å™¨è¿˜ä¸èƒ½å¾ˆæ™ºèƒ½åœ°å»å‘ç°å’Œåˆ©ç”¨å¤šæ ¸çš„ä¼˜åŠ¿ã€‚è™½ç„¶æˆ‘ä»¬ç¡®å®åˆ›å»ºäº†å¤šä¸ªgoroutineï¼Œå¹¶ä¸”ä»è¿è¡ŒçŠ¶æ€çœ‹è¿™äº›goroutineä¹Ÿéƒ½åœ¨å¹¶è¡Œè¿è¡Œï¼Œä½†å®é™…ä¸Š****æ‰€æœ‰è¿™äº›goroutineéƒ½è¿è¡Œåœ¨åŒä¸€ä¸ªCPUæ ¸å¿ƒä¸Šï¼Œ åœ¨ä¸€ä¸ªgoroutineå¾—åˆ°æ—¶é—´ç‰‡æ‰§è¡Œçš„æ—¶å€™ï¼Œ å…¶ä»–goroutineéƒ½ä¼šå¤„äºç­‰å¾…çŠ¶æ€****ã€‚ä»è¿™ä¸€ç‚¹å¯ä»¥çœ‹å‡ºï¼Œè™½ç„¶goroutineç®€åŒ–äº†æˆ‘ä»¬å†™å¹¶è¡Œä»£ç çš„è¿‡ç¨‹ï¼Œä½†å®é™…ä¸Šæ•´ä½“è¿è¡Œæ•ˆç‡å¹¶ä¸çœŸæ­£é«˜äºå•çº¿ç¨‹ç¨‹åºã€‚</p><p>åœ¨Goè¯­è¨€å‡çº§åˆ°é»˜è®¤æ”¯æŒå¤šCPUçš„æŸä¸ªç‰ˆæœ¬ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡</p><p>GOMAXPROCSçš„å€¼æ¥æ§åˆ¶ä½¿ç”¨å¤šå°‘ä¸ªCPUæ ¸å¿ƒã€‚å…·ä½“æ“ä½œæ–¹æ³•æ˜¯é€šè¿‡ç›´æ¥è®¾ç½®ç¯å¢ƒå˜é‡GOMAXPROCSçš„å€¼ï¼Œæˆ–è€…åœ¨ä»£ç ä¸­å¯åŠ¨goroutineä¹‹å‰å…ˆè°ƒç”¨ä»¥ä¸‹è¿™ä¸ªè¯­å¥ä»¥è®¾ç½®ä½¿ç”¨16ä¸ªCPUæ ¸å¿ƒï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">runtime.GOMAXPROCS(16)</span><br></pre></td></tr></table></figure><p>åˆ°åº•åº”è¯¥è®¾ç½®å¤šå°‘ä¸ªCPUæ ¸å¿ƒå‘¢ï¼Œå…¶å®runtimeåŒ…ä¸­è¿˜æä¾›äº†å¦å¤–ä¸€ä¸ª****å‡½æ•°NumCPU()æ¥è·å–æ ¸å¿ƒæ•°****ã€‚å¯ä»¥çœ‹åˆ°ï¼ŒGoè¯­è¨€å…¶å®å·²ç»æ„ŸçŸ¥åˆ°æ‰€æœ‰çš„ç¯å¢ƒä¿¡æ¯ï¼Œä¸‹ä¸€ç‰ˆæœ¬ä¸­å®Œå…¨å¯ä»¥åˆ©ç”¨è¿™äº›ä¿¡æ¯å°†goroutineè°ƒåº¦åˆ°æ‰€æœ‰CPUæ ¸å¿ƒä¸Šï¼Œä»è€Œæœ€å¤§åŒ–åœ°åˆ©ç”¨æœåŠ¡å™¨çš„å¤šæ ¸è®¡ç®—èƒ½åŠ›ã€‚æŠ›å¼ƒGOMAXPROCSåªæ˜¯ä¸ªæ—¶é—´é—®é¢˜ã€‚</p><h1><span id="15-ä¸»åŠ¨å‡ºè®©æ—¶é—´ç‰‡ç»™å…¶ä»–-goroutine-åœ¨æœªæ¥çš„æŸä¸€æ—¶åˆ»å†æ¥æ‰§è¡Œå½“å‰goroutine">15ã€ä¸»åŠ¨å‡ºè®©æ—¶é—´ç‰‡ç»™å…¶ä»– goroutine åœ¨æœªæ¥çš„æŸä¸€æ—¶åˆ»å†æ¥æ‰§è¡Œå½“å‰goroutine</span></h1><p>æˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸ªgoroutineä¸­æ§åˆ¶ä½•æ—¶ä¸»åŠ¨å‡ºè®©æ—¶é—´ç‰‡ç»™å…¶ä»–goroutineï¼Œè¿™å¯ä»¥ä½¿ç”¨****runtimeåŒ…ä¸­çš„Gosched()å‡½æ•°****å®ç°ã€‚<br>å®é™…ä¸Šï¼Œå¦‚æœè¦æ¯”è¾ƒç²¾ç»†åœ°æ§åˆ¶goroutineçš„è¡Œä¸ºï¼Œå°±å¿…é¡»æ¯”è¾ƒæ·±å…¥åœ°äº†è§£Goè¯­è¨€å¼€å‘åŒ…ä¸­runtimeåŒ…æ‰€æä¾›çš„å…·ä½“åŠŸèƒ½ã€‚</p><h1><span id="16-goä¸­çš„åŒæ­¥åŠåŒæ­¥é”">16ã€Goä¸­çš„åŒæ­¥åŠåŒæ­¥é”</span></h1><p>å€¡å¯¼ç”¨é€šä¿¡æ¥å…±äº«æ•°æ®ï¼Œè€Œä¸æ˜¯é€šè¿‡å…±äº«æ•°æ®æ¥è¿›è¡Œé€šä¿¡ï¼Œä½†è€ƒè™‘åˆ°å³ä½¿æˆåŠŸåœ°ç”¨channelæ¥ä½œä¸ºé€šä¿¡æ‰‹æ®µï¼Œè¿˜æ˜¯****é¿å…ä¸äº†å¤šä¸ªgoroutineä¹‹é—´å…±äº«æ•°æ®çš„é—®é¢˜*<em><strong>ï¼ŒGoè¯­è¨€çš„è®¾è®¡è€…è™½ç„¶å¯¹channelæœ‰æé«˜çš„æœŸæœ›ï¼Œä½†ä¹Ÿæä¾›äº†å¦¥å–„çš„</strong></em>*èµ„æºé”æ–¹æ¡ˆ****ã€‚</p><p>å¯¹äºè¿™ä¸¤ç§é”ç±»å‹ï¼Œ ä»»ä½•ä¸€ä¸ªLock()æˆ–RLock()å‡éœ€è¦ä¿è¯å¯¹åº”æœ‰Unlock()æˆ–RUnlock()è°ƒç”¨ä¸ä¹‹å¯¹åº”ï¼Œ<em><strong>*å¦åˆ™å¯èƒ½å¯¼è‡´ç­‰å¾…è¯¥é”çš„*</strong></em>****æ‰€æœ‰goroutineå¤„äºé¥¥é¥¿çŠ¶æ€ï¼Œç”šè‡³å¯èƒ½å¯¼è‡´æ­»é”****ã€‚é”çš„å…¸å‹ä½¿ç”¨æ¨¡å¼å¦‚ä¸‹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> l sync.<span class="type">Mutex</span>  </span><br><span class="line"><span class="keyword">func</span> <span class="title function_">foo</span>() &#123;</span><br><span class="line">l.<span class="type">Lock</span>()  </span><br><span class="line"><span class="comment">//å»¶&lt;strong&gt;è¿Ÿè°ƒç”¨ åœ¨å‡½æ•°é€€å‡º å¹¶ä¸”å±€éƒ¨èµ„æºè¢«é‡Šæ”¾çš„æ—¶å€™ è°ƒç”¨&lt;/strong&gt;</span></span><br><span class="line"><span class="keyword">defer</span> l.<span class="type">Unlock</span>()  </span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å†ä¸€æ¬¡è§è¯äº†Goè¯­è¨€deferå…³é”®å­—å¸¦æ¥çš„ä¼˜é›…ã€‚</p><h1><span id="17-å…¨å±€å”¯ä¸€æ“ä½œ-synconcedo-syncatomicåŸå­æ“ä½œå­åŒ…">17ã€å…¨å±€å”¯ä¸€æ“ä½œ sync.Once.Do() sync.atomicåŸå­æ“ä½œå­åŒ…</span></h1><p>å¯¹äºä»å…¨å±€çš„è§’åº¦åªéœ€è¦è¿è¡Œä¸€æ¬¡çš„ä»£ç ï¼Œæ¯”å¦‚å…¨å±€åˆå§‹åŒ–æ“ä½œï¼ŒGoè¯­è¨€æä¾›äº†ä¸€ä¸ª****Onceç±»å‹æ¥ä¿è¯å…¨å±€çš„å”¯ä¸€æ€§æ“ä½œ****ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a <span class="type">string</span></span><br><span class="line"><span class="keyword">var</span> once sync.Once  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">    a = <span class="string">&quot;hello, world&quot;</span></span><br><span class="line">&#125;  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">doprint</span><span class="params">()</span></span> &#123;</span><br><span class="line">    once.Do(setup)</span><br><span class="line">    <span class="built_in">print</span>(a)  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">twoprint</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">go</span> doprint()</span><br><span class="line">    <span class="keyword">go</span> doprint()  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœè¿™æ®µä»£ç æ²¡æœ‰å¼•å…¥Onceï¼Œ setup()å°†ä¼šè¢«æ¯ä¸€ä¸ªgoroutineå…ˆè°ƒç”¨ä¸€æ¬¡ï¼Œ è¿™è‡³å°‘å¯¹äºè¿™ä¸ªä¾‹å­æ˜¯å¤šä½™çš„ã€‚åœ¨ç°å®ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µã€‚Goè¯­è¨€æ ‡å‡†åº“ä¸ºæˆ‘ä»¬å¼•å…¥äº†Onceç±»å‹ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚****onceçš„Do()æ–¹æ³•å¯ä»¥ä¿è¯åœ¨å…¨å±€èŒƒå›´å†…åªè°ƒç”¨æŒ‡å®šçš„å‡½æ•°ä¸€æ¬¡****ï¼ˆè¿™é‡ŒæŒ‡setup()å‡½æ•°ï¼‰ï¼Œè€Œä¸”æ‰€æœ‰å…¶ä»–goroutineåœ¨è°ƒç”¨åˆ°æ­¤è¯­å¥æ—¶ï¼Œå°†ä¼šå…ˆè¢«é˜»å¡ï¼Œç›´è‡³å…¨å±€å”¯ä¸€çš„once.Do()è°ƒç”¨ç»“æŸåæ‰ç»§ç»­ã€‚</p><p>è¿™ä¸ªæœºåˆ¶æ¯”è¾ƒè½»å·§åœ°è§£å†³äº†ä½¿ç”¨å…¶ä»–è¯­è¨€æ—¶å¼€å‘è€…ä¸å¾—ä¸è‡ªè¡Œè®¾è®¡å’Œå®ç°è¿™ç§Onceæ•ˆæœçš„éš¾é¢˜ï¼Œä¹Ÿæ˜¯Goè¯­è¨€ä¸ºå¹¶å‘æ€§ç¼–ç¨‹åšäº†å°½é‡å¤šè€ƒè™‘çš„ä¸€ç§ä½“ç°ã€‚</p><p>å¦‚æœæ²¡æœ‰once.Do()ï¼Œæˆ‘ä»¬å¾ˆå¯èƒ½åªèƒ½æ·»åŠ ä¸€ä¸ªå…¨å±€çš„boolå˜é‡ï¼Œåœ¨å‡½æ•°setup()çš„æœ€åä¸€è¡Œå°†è¯¥boolå˜é‡è®¾ç½®ä¸ºtrueã€‚åœ¨å¯¹setup()çš„æ‰€æœ‰è°ƒç”¨ä¹‹å‰ï¼Œéœ€è¦å…ˆåˆ¤æ–­è¯¥boolå˜é‡æ˜¯å¦å·²ç»è¢«è®¾ç½®ä¸ºtrueï¼Œå¦‚æœè¯¥å€¼ä»ç„¶æ˜¯falseï¼Œåˆ™è°ƒç”¨ä¸€æ¬¡setup()ï¼Œå¦åˆ™åº”è·³è¿‡è¯¥è¯­å¥ã€‚å®ç°ä»£ç </p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> done <span class="type">bool</span> = <span class="literal">false</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">    a = <span class="string">&quot;hello, world&quot;</span> </span><br><span class="line">    done = <span class="literal">true</span></span><br><span class="line">&#125;     </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">doprint</span><span class="params">()</span></span> &#123; </span><br><span class="line">    <span class="keyword">if</span> !done &#123;</span><br><span class="line">        setup()</span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="built_in">print</span>(a)  </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç åˆçœ‹èµ·æ¥æ¯”è¾ƒåˆç†ï¼Œ ä½†æ˜¯ç»†çœ‹è¿˜æ˜¯ä¼šæœ‰é—®é¢˜ï¼Œ å› ä¸º****setup()å¹¶ä¸æ˜¯ä¸€ä¸ªåŸå­æ€§æ“ä½œ****ï¼Œè¿™ç§å†™æ³•å¯èƒ½å¯¼è‡´setup()å‡½æ•°è¢«å¤šæ¬¡è°ƒç”¨ï¼Œä»è€Œæ— æ³•è¾¾åˆ°å…¨å±€åªæ‰§è¡Œä¸€æ¬¡çš„ç›®æ ‡ã€‚è¿™ä¸ªé—®é¢˜çš„å¤æ‚æ€§ä¹Ÿæ›´åŠ ä½“ç°äº†Onceç±»å‹çš„ä»·å€¼ã€‚ &#x2F;&#x2F;è¿˜æ²¡æœ‰æ‰§è¡Œåˆ°done&#x3D;trueçš„æ—¶å€™  å¦å¤–è°ƒç”¨doprintå·²ç»æ‰§è¡Œèµ·æ¥ã€‚</p><p>ä¸ºäº†æ›´å¥½åœ°æ§åˆ¶å¹¶è¡Œä¸­çš„åŸå­æ€§æ“ä½œï¼ŒsyncåŒ…ä¸­è¿˜åŒ…å«ä¸€ä¸ªatomicå­åŒ…ï¼Œå®ƒæä¾›äº†å¯¹äºä¸€äº›åŸºç¡€æ•°æ®ç±»å‹çš„åŸå­æ“ä½œå‡½æ•°ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªå‡½æ•°ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CompareAndSwapUint64</span><span class="params">(val *<span class="type">uint64</span>, old, <span class="built_in">new</span> <span class="type">uint64</span>)</span></span> (swapped <span class="type">bool</span>)</span><br></pre></td></tr></table></figure><p>å°±æä¾›äº†æ¯”è¾ƒå’Œäº¤æ¢ä¸¤ä¸ªuint64ç±»å‹æ•°æ®çš„æ“ä½œã€‚è¿™è®©å¼€å‘è€…æ— éœ€å†ä¸ºè¿™æ ·çš„æ“ä½œä¸“é—¨æ·»åŠ Lockæ“ä½œã€‚</p><p>è½¬è½½é“¾æ¥ï¼š<a href="http://lib.csdn.net/article/53/36140?knId=1441">http://lib.csdn.net/article/53/36140?knId=1441</a></p>]]></content>
      
      
      <categories>
          
          <category> GOLANG </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>HEXOå¿«æ·æ–¹å¼</title>
      <link href="/blog/2020/06/09/%E5%BB%BA%E7%AB%99/%E5%BB%BA%E7%AB%99-HEXO-%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F/"/>
      <url>/blog/2020/06/09/%E5%BB%BA%E7%AB%99/%E5%BB%BA%E7%AB%99-HEXO-%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p><a href="https://www.jianshu.com/p/1c888a6b8297?utm_source=oschina-app">https://www.jianshu.com/p/1c888a6b8297?utm_source=oschina-app</a></p><h3><span id="æ–°ç¼–å†™blog">æ–°ç¼–å†™BLOG</span></h3><p>hexo new [layout] <title></title></p><h3><span id="pushåˆ°github">pushåˆ°githubï¼š</span></h3><p>hexo deploy</p><p>hexo clean</p><p>hexo deploy</p><h3><span id="æ¯æ¬¡éƒ½è¦æ‰§è¡Œ-hexo-clean-å’Œ-hexo-deployä¸å¦‚å†™ä¸ªæ–°çš„è„šæœ¬">æ¯æ¬¡éƒ½è¦æ‰§è¡Œ hexo clean å’Œ hexo deployï¼Œä¸å¦‚å†™ä¸ªæ–°çš„è„šæœ¬</span></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// package.json</span><br><span class="line">&quot;dev&quot;: &quot;hexo s&quot;,</span><br><span class="line">&quot;build&quot;: &quot;hexo clean &amp; hexo deploy&quot;</span><br></pre></td></tr></table></figure><p>npm run build</p>]]></content>
      
      
      <categories>
          
          <category> å»ºç«™ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>MYSQlç´¢å¼•</title>
      <link href="/blog/2020/06/09/MSYQL/MYSQl-%E7%B4%A2%E5%BC%95/"/>
      <url>/blog/2020/06/09/MSYQL/MYSQl-%E7%B4%A2%E5%BC%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>docker logs -t -f â€“tail 100 im4<br>å¤„ç†inité—®é¢˜</p><p>ä¸€ã€æŸ¥è¯¢å’Œæ›´æ–°ä¸Šçš„åŒºåˆ«<br>è¿™ä¸¤ç±»ç´¢å¼•åœ¨æŸ¥è¯¢èƒ½åŠ›ä¸Šæ˜¯æ²¡å·®åˆ«çš„ï¼Œä¸»è¦è€ƒè™‘çš„æ˜¯å¯¹æ›´æ–°æ€§èƒ½çš„å½±å“ã€‚å»ºè®®å°½é‡é€‰æ‹©æ™®é€šç´¢å¼•ã€‚<br>1.1 MySQL çš„æŸ¥è¯¢æ“ä½œ<br>æ™®é€šç´¢å¼•<br>æŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è®°å½•åï¼Œç»§ç»­å‘åéå†ï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•ã€‚<br>å”¯ä¸€ç´¢å¼•<br>ç”±äºç´¢å¼•å®šä¹‰äº†å”¯ä¸€æ€§ï¼ŒæŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è®°å½•åï¼Œç›´æ¥åœæ­¢ç»§ç»­æ£€ç´¢ã€‚<br>æ™®é€šç´¢å¼•ä¼šå¤šæ£€ç´¢ä¸€æ¬¡ï¼Œå‡ ä¹æ²¡æœ‰å½±å“ã€‚å› ä¸º InnoDB çš„æ•°æ®æ˜¯æŒ‰ç…§æ•°æ®é¡µä¸ºå•ä½è¿›è¡Œè¯»å†™çš„ï¼Œéœ€è¦è¯»å–æ•°æ®æ—¶ï¼Œå¹¶ä¸æ˜¯ç›´æ¥ä»ç£ç›˜è¯»å–è®°å½•ï¼Œè€Œæ˜¯å…ˆæŠŠæ•°æ®é¡µè¯»åˆ°å†…å­˜ï¼Œå†å»æ•°æ®é¡µä¸­æ£€ç´¢ã€‚<br>ä¸€ä¸ªæ•°æ®é¡µé»˜è®¤Â 16 KBï¼Œå¯¹äºæ•´å‹å­—æ®µï¼Œä¸€ä¸ªæ•°æ®é¡µå¯ä»¥æ”¾è¿‘åƒä¸ªÂ keyï¼Œé™¤éè¦è¯»å–çš„æ•°æ®åœ¨æ•°æ®é¡µçš„æœ€åä¸€æ¡è®°å½•ï¼Œå°±éœ€è¦å†è¯»ä¸€ä¸ªæ•°æ®é¡µï¼Œè¿™ç§æƒ…å†µå¾ˆå°‘ï¼Œå¯¹CPUçš„æ¶ˆè€—åŸºæœ¬å¯ä»¥å¿½ç•¥äº†ã€‚<br>å› æ­¤è¯´ï¼Œåœ¨æŸ¥è¯¢æ•°æ®æ–¹é¢ï¼Œæ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•æ²¡å·®åˆ«ã€‚</p><p>1.2 MySQL çš„æ›´æ–°æ“ä½œ<br>æ›´æ–°æ“ä½œå¹¶ä¸æ˜¯ç›´æ¥å¯¹ç£ç›˜ä¸­çš„æ•°æ®è¿›è¡Œæ›´æ–°ï¼Œæ˜¯å…ˆæŠŠæ•°æ®é¡µä»ç£ç›˜è¯»å…¥å†…å­˜ï¼Œå†æ›´æ–°æ•°æ®é¡µã€‚<br>æ™®é€šç´¢å¼•<br>å°†æ•°æ®é¡µä»ç£ç›˜è¯»å…¥å†…å­˜ï¼Œæ›´æ–°æ•°æ®é¡µã€‚<br>å”¯ä¸€ç´¢å¼•<br>å°†æ•°æ®é¡µä»ç£ç›˜è¯»å…¥å†…å­˜ï¼Œåˆ¤æ–­æ˜¯å¦å”¯ä¸€ï¼Œå†æ›´æ–°æ•°æ®é¡µã€‚<br>ç”±äº MySQL ä¸­æœ‰ä¸ªÂ change bufferÂ çš„æœºåˆ¶ï¼Œä¼šå¯¼è‡´æ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•åœ¨æ›´æ–°ä¸Šæœ‰ä¸€å®šçš„åŒºåˆ«ã€‚<br>change bufferçš„ä½œç”¨æ˜¯ä¸ºäº†é™ä½IO æ“ä½œï¼Œé¿å…ç³»ç»Ÿè´Ÿè½½è¿‡é«˜ã€‚change bufferå°†æ•°æ®å†™å…¥æ•°æ®é¡µçš„è¿‡ç¨‹ï¼Œå«åšmergeã€‚<br>å¦‚æœéœ€è¦æ›´æ–°çš„æ•°æ®é¡µåœ¨å†…å­˜ä¸­æ—¶ï¼Œä¼šç›´æ¥æ›´æ–°æ•°æ®é¡µï¼›å¦‚æœæ•°æ®ä¸åœ¨å†…å­˜ä¸­ï¼Œä¼šå…ˆå°†æ›´æ–°æ“ä½œè®°å…¥change bufferï¼Œå½“ä¸‹ä¸€æ¬¡è¯»å–æ•°æ®é¡µæ—¶ï¼Œé¡ºå¸¦mergeåˆ°æ•°æ®é¡µä¸­ï¼Œchange bufferä¹Ÿæœ‰å®šæœŸmergeç­–ç•¥ã€‚æ•°æ®åº“æ­£å¸¸å…³é—­çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šè§¦å‘mergeã€‚<br>å¯¹äºå”¯ä¸€ç´¢å¼•ï¼Œæ›´æ–°å‰éœ€è¦åˆ¤æ–­æ•°æ®æ˜¯å¦å”¯ä¸€ï¼ˆä¸èƒ½å’Œè¡¨ä¸­æ•°æ®é‡å¤ï¼‰ï¼Œå¦‚æœæ•°æ®é¡µåœ¨å†…å­˜ä¸­ï¼Œå°±å¯ä»¥ç›´æ¥åˆ¤æ–­å¹¶ä¸”æ›´æ–°ï¼Œå¦‚æœä¸åœ¨å†…å­˜ä¸­ï¼Œå°±éœ€è¦å»ç£ç›˜ä¸­è¯»å‡ºæ¥ï¼Œåˆ¤æ–­ä¸€ä¸‹æ˜¯å¦å”¯ä¸€ï¼Œæ˜¯çš„è¯å°±æ›´æ–°ã€‚change bufferæ˜¯ç”¨ä¸åˆ°çš„ã€‚å³ä½¿æ•°æ®é¡µä¸åœ¨å†…å­˜ä¸­ï¼Œè¿˜æ˜¯è¦è¯»å‡ºæ¥ã€‚<br>change bufferÂ ç”¨çš„æ˜¯Â buffer poolÂ é‡Œçš„å†…å­˜ï¼Œå› æ­¤ä¸èƒ½æ— é™å¢å¤§ã€‚change buffer çš„å¤§å°ï¼Œå¯ä»¥é€šè¿‡å‚æ•°Â innodb_change_buffer_max_sizeÂ æ¥åŠ¨æ€è®¾ç½®ã€‚è¿™ä¸ªå‚æ•°è®¾ç½®ä¸º 50 çš„æ—¶å€™ï¼Œè¡¨ç¤º change buffer çš„å¤§å°æœ€å¤šåªèƒ½å ç”¨ buffer pool çš„ 50%ã€‚</p><p>ç»“è®ºï¼šå”¯ä¸€ç´¢å¼•ç”¨ä¸äº†change bufferï¼Œåªæœ‰æ™®é€šç´¢å¼•å¯ä»¥ç”¨ã€‚</p><p>äºŒã€change buffer å’Œ redo logçš„åŒºåˆ«<br>2.1 change buffer çš„é€‚ç”¨åœºæ™¯<br>change bufferÂ çš„ä½œç”¨æ˜¯é™ä½æ›´æ–°æ“ä½œçš„é¢‘ç‡ï¼Œç¼“å­˜æ›´æ–°æ“ä½œã€‚è¿™æ ·ä¼šæœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯æ›´æ–°ä¸åŠæ—¶ï¼Œå¯¹äºè¯»æ“ä½œæ¯”è¾ƒé¢‘ç¹çš„è¡¨ï¼Œä¸å»ºè®®ä½¿ç”¨ change bufferã€‚<br>å› ä¸ºæ›´æ–°æ“ä½œåˆšè®°å½•è¿›change bufferä¸­ï¼Œå°±è¯»å–äº†è¯¥è¡¨ï¼Œæ•°æ®é¡µè¢«è¯»åˆ°äº†å†…å­˜ä¸­ï¼Œæ•°æ®é©¬ä¸Šå°±mergeåˆ°æ•°æ®é¡µä¸­äº†ã€‚è¿™æ ·ä¸ä»…ä¸ä¼šé™ä½æ€§èƒ½æ¶ˆè€—ï¼Œåè€Œä¼šå¢åŠ ç»´æŠ¤change bufferçš„æˆæœ¬ã€‚<br>é€‚ç”¨äºå†™å¤šè¯»å°‘çš„è¡¨ã€‚</p><p>2.2 change buffer å’Œ redo log åŒºåˆ«<br>æˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­ç”¨æ¥ç†è§£Â redo logÂ å’ŒÂ change bufferã€‚æˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹ SQL è¯­å¥ï¼š<br>mysql&gt; insert into t(id,k) values(id1,k1),(id2,k2);</p><p>å‡è®¾ï¼Œ(id1,k1)Â åœ¨æ•°æ®é¡µ Page 1 ä¸­ï¼Œ(id2,k2)Â åœ¨æ•°æ®é¡µ Page 2 ä¸­ã€‚å¹¶ä¸” Page 1 åœ¨å†…å­˜ä¸­ï¼ŒPage 2 ä¸åœ¨å†…å­˜ä¸­ã€‚<br>æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š<br>ç›´æ¥å‘ Page 1 ä¸­å†™å…¥Â (id1,k1)ï¼›<br>åœ¨change bufferÂ ä¸­è®°ä¸‹â€å‘ Page 2 ä¸­å†™å…¥(id2,k2)â€è¿™æ¡ä¿¡æ¯ï¼›<br>å°†ä»¥ä¸Šä¸¤ä¸ªåŠ¨ä½œè®°å…¥redo logã€‚<br>åšå®Œä¸Šé¢è¿™äº›ï¼Œäº‹åŠ¡å°±å¯ä»¥å®Œæˆäº†ã€‚æ‰§è¡Œè¿™æ¡æ›´æ–°è¯­å¥çš„æˆæœ¬å¾ˆä½ï¼Œå°±æ˜¯å†™äº†ä¸¤å¤„å†…å­˜ï¼Œç„¶åå†™äº†ä¸€å¤„ç£ç›˜ï¼ˆä¸¤æ¬¡æ“ä½œåˆåœ¨ä¸€èµ·å†™äº†ä¸€æ¬¡ç£ç›˜ï¼‰ï¼Œè€Œä¸”è¿˜æ˜¯é¡ºåºå†™çš„ã€‚<br>è¿™æ¡æ›´æ–°è¯­å¥ï¼Œæ¶‰åŠäº†å››ä¸ªéƒ¨åˆ†ï¼šå†…å­˜ã€redo logï¼ˆib_log_fileXï¼‰ã€ æ•°æ®è¡¨ç©ºé—´ï¼ˆt.ibdï¼‰ã€ç³»ç»Ÿè¡¨ç©ºé—´ï¼ˆibdata1ï¼‰ã€‚<br>å¦‚æœè¦è¯»æ•°æ®çš„è¯ï¼Œè¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ<br>mysql&gt; select * from t where k in (k1, k2);</p><p>å‡è®¾è¯»æ“ä½œåœ¨æ›´æ–°åä¸ä¹…ï¼Œæ­¤æ—¶å†…å­˜ä¸­è¿˜æœ‰ Page 1ï¼Œæ²¡æœ‰ Page 2ï¼Œé‚£ä¹ˆè¯»æ“ä½œå°±å’ŒÂ redo logÂ ä»¥åŠÂ ibdata1Â æ— å…³äº†ã€‚<br>ä»å†…å­˜ä¸­è·å–åˆ° Page 1 ä¸Šçš„æœ€æ–°æ•°æ®Â (id1,k1)ï¼›<br>å°†æ•°æ®é¡µ Page 2 è¯»å…¥å†…å­˜ï¼Œæ‰§è¡ŒmergeÂ æ“ä½œï¼Œæ­¤æ—¶å†…å­˜ä¸­çš„ Page 2 ä¹Ÿæœ‰æœ€æ–°æ•°æ®(id2,k2)ï¼›<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<br>redo logä¸­çš„æ•°æ®ï¼Œå¯èƒ½è¿˜æ²¡æœ‰ flush åˆ°ç£ç›˜ï¼Œç£ç›˜ä¸­çš„ Page 1 å’Œ Page 2 ä¸­å¹¶æ²¡æœ‰æœ€æ–°æ•°æ®ï¼Œä½†æˆ‘ä»¬ä¾ç„¶å¯ä»¥æ‹¿åˆ°æœ€æ–°æ•°æ®ï¼ˆå†…å­˜ä¸­çš„ Page 1 å°±æ˜¯æœ€æ–°çš„ï¼ŒPage 2 è™½ç„¶ä¸æ˜¯æœ€æ–°çš„ï¼Œä½†æ˜¯ä»ç£ç›˜è¯»åˆ°å†…å­˜ä¸­åï¼Œæ‰§è¡Œäº†mergeæ“ä½œï¼Œå†…å­˜ä¸­çš„ Page 2 å°±æ˜¯æœ€æ–°çš„äº†ã€‚ï¼‰<br>å¦‚æœæ­¤æ—¶ MySQL å¼‚å¸¸å®•æœºäº†ï¼Œæ¯”å¦‚æœåŠ¡å™¨å¼‚å¸¸æ‰ç”µï¼Œchange buffer ä¸­çš„æ•°æ®ä¼šä¸ä¼šä¸¢ï¼Ÿ</p><p>change bufferÂ ä¸­çš„æ•°æ®åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯å·²ç»mergeåˆ°ibdata1ä¸­çš„æ•°æ®ï¼Œè¿™éƒ¨åˆ†æ•°æ®å·²ç»æŒä¹…åŒ–ï¼Œä¸ä¼šä¸¢å¤±ã€‚å¦ä¸€éƒ¨åˆ†æ•°æ®ï¼Œè¿˜åœ¨Â change bufferÂ ä¸­ï¼Œæ²¡æœ‰mergeÂ åˆ°ibdata1ï¼Œåˆ† 3 ç§æƒ…å†µï¼š</p><p>ï¼ˆ1ï¼‰change buffer å†™å…¥æ•°æ®åˆ°å†…å­˜ï¼Œredo log ä¹Ÿå·²ç»å†™å…¥ï¼ˆib-log-filexï¼‰ï¼Œä½†æ˜¯æœªÂ commitï¼Œbinlogä¸­ä¹Ÿæ²¡æœ‰fsyncåˆ°ç£ç›˜ï¼Œè¿™éƒ¨åˆ†æ•°æ®ä¼šä¸¢å¤±ï¼›<br>ï¼ˆ2ï¼‰change buffer å†™å…¥æ•°æ®åˆ°å†…å­˜ï¼Œredo log ä¹Ÿå·²ç»å†™å…¥ï¼ˆib-log-filexï¼‰ï¼Œä½†æ˜¯æœªÂ commitï¼Œbinlog å·²å†™å…¥åˆ°ç£ç›˜ï¼Œè¿™éƒ¨åˆ†ä¸ä¼šå¤šä¸¢å¤±ï¼Œå¼‚å¸¸é‡å¯åä¼šå…ˆä» binlog æ¢å¤ redo logï¼Œå†ä» redo log æ¢å¤ change bufferï¼›<br>ï¼ˆ3ï¼‰change buffer å†™å…¥æ•°æ®åˆ°å†…å­˜ï¼Œredo log å’Œ binlog éƒ½å·²ç»fsyncï¼Œç›´æ¥ä»redo log æ¢å¤ï¼Œä¸ä¼šä¸¢å¤±ã€‚<br>redo log ä¸»è¦èŠ‚çœçš„æ˜¯éšæœºå†™ç£ç›˜çš„ IO æ¶ˆè€—ï¼ˆè½¬æˆé¡ºåºå†™ï¼‰ï¼Œè€Œ change buffer ä¸»è¦èŠ‚çœçš„åˆ™æ˜¯éšæœºè¯»ç£ç›˜çš„ IO æ¶ˆè€—</p><p>è½¬è½½è‡ªï¼š<a href="https://www.cnblogs.com/hhhhuanzi/p/12318504.html">https://www.cnblogs.com/hhhhuanzi/p/12318504.html</a></p>]]></content>
      
      
      <categories>
          
          <category> MYSQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç´¢å¼• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MYSQL_æ’åº</title>
      <link href="/blog/2020/01/20/MSYQL/MYSQL-%E6%8E%92%E5%BA%8F/"/>
      <url>/blog/2020/01/20/MSYQL/MYSQL-%E6%8E%92%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script>]]></content>
      
      
      <categories>
          
          <category> MYSQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MSYQL </tag>
            
            <tag> æ’åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ—¥å¿—</title>
      <link href="/blog/2019/12/27/MSYQL/MYSQL-%E6%97%A5%E5%BF%97/"/>
      <url>/blog/2019/12/27/MSYQL/MYSQL-%E6%97%A5%E5%BF%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h3><span id="mysql">MYSQL</span></h3><ul><li><p>é¦–å…ˆåˆ†äº«ä¸€ä¸ªæŸ¥çœ‹å¤§æ—¥å¿—çš„å·¥å…·ï¼Œåªæœ‰å‡ ç™¾k,é€‚åˆç”¨æ¥å®æ—¶æŸ¥çœ‹mysqlçš„æ—¥å¿—</p><p><code>BareTail </code></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> MYSQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¥å¿— </tag>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redisåŸºç¡€çŸ¥è¯†</title>
      <link href="/blog/2019/12/27/REDIS/REDIS-redis%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
      <url>/blog/2019/12/27/REDIS/REDIS-redis%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h3><span id="redis-pubsub-å‘å¸ƒå’Œè®¢é˜…">redis pubsub å‘å¸ƒå’Œè®¢é˜…</span></h3><p>å¸¸ç”¨å‘½ä»¤ï¼š</p><blockquote><p>æŸ¥çœ‹å‘å¸ƒçš„é¢‘é“ï¼šPUBSUB CHANNELS</p></blockquote><blockquote><p>æ–°å»ºé¢‘é“ï¼š PUBLISH mychannel â€œhello worldâ€</p></blockquote><blockquote><p>è®¢é˜…é¢‘é“ï¼šSUBSCRIBE mychannel |   Psubscribe å¤šä¸ªchannel |æ”¯æŒ channel* æ ¼å¼</p></blockquote><blockquote><p>é€€è®¢é¢‘é“ï¼šUNSUBSCRIBE mychannel | Punsubscribe  å¤šä¸ªchannel  |æ”¯æŒ channel* æ ¼å¼</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pubsub </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redisTips</title>
      <link href="/blog/2019/12/27/REDIS/REDIS-TIPS/"/>
      <url>/blog/2019/12/27/REDIS/REDIS-TIPS/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h2><span id="æ¦‚è¿°">æ¦‚è¿°</span></h2><h3><span id="ä»€ä¹ˆæ˜¯redis">ä»€ä¹ˆæ˜¯Redis</span></h3><p>Redis(Remote Dictionary Server) æ˜¯ä¸€ä¸ªä½¿ç”¨ C è¯­è¨€ç¼–å†™çš„ï¼Œå¼€æºçš„ï¼ˆBSDè®¸å¯ï¼‰é«˜æ€§èƒ½éå…³ç³»å‹ï¼ˆNoSQLï¼‰çš„é”®å€¼å¯¹æ•°æ®åº“ã€‚</p><p>Redis å¯ä»¥å­˜å‚¨é”®å’Œäº”ç§ä¸åŒç±»å‹çš„å€¼ä¹‹é—´çš„æ˜ å°„ã€‚é”®çš„ç±»å‹åªèƒ½ä¸ºå­—ç¬¦ä¸²ï¼Œå€¼æ”¯æŒäº”ç§æ•°æ®ç±»å‹ï¼šå­—ç¬¦ä¸²ã€åˆ—è¡¨ã€é›†åˆã€æ•£åˆ—è¡¨ã€æœ‰åºé›†åˆã€‚</p><p>ä¸ä¼ ç»Ÿæ•°æ®åº“ä¸åŒçš„æ˜¯ Redis çš„æ•°æ®æ˜¯å­˜åœ¨å†…å­˜ä¸­çš„ï¼Œæ‰€ä»¥è¯»å†™é€Ÿåº¦éå¸¸å¿«ï¼Œå› æ­¤ redis è¢«å¹¿æ³›åº”ç”¨äºç¼“å­˜æ–¹å‘ï¼Œæ¯ç§’å¯ä»¥å¤„ç†è¶…è¿‡ 10ä¸‡æ¬¡è¯»å†™æ“ä½œï¼Œæ˜¯å·²çŸ¥æ€§èƒ½æœ€å¿«çš„Key-Value DBã€‚å¦å¤–ï¼ŒRedis ä¹Ÿç»å¸¸ç”¨æ¥åšåˆ†å¸ƒå¼é”ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒRedis æ”¯æŒäº‹åŠ¡ ã€æŒä¹…åŒ–ã€LUAè„šæœ¬ã€LRUé©±åŠ¨äº‹ä»¶ã€å¤šç§é›†ç¾¤æ–¹æ¡ˆã€‚</p><h3><span id="redisæœ‰å“ªäº›ä¼˜ç¼ºç‚¹">Redisæœ‰å“ªäº›ä¼˜ç¼ºç‚¹</span></h3><p>ä¼˜ç‚¹</p><ul><li>è¯»å†™æ€§èƒ½ä¼˜å¼‚ï¼Œ Redisèƒ½è¯»çš„é€Ÿåº¦æ˜¯110000æ¬¡&#x2F;sï¼Œå†™çš„é€Ÿåº¦æ˜¯81000æ¬¡&#x2F;sã€‚</li><li>æ”¯æŒæ•°æ®æŒä¹…åŒ–ï¼Œæ”¯æŒAOFå’ŒRDBä¸¤ç§æŒä¹…åŒ–æ–¹å¼ã€‚</li><li>æ”¯æŒäº‹åŠ¡ï¼ŒRedisçš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ï¼ŒåŒæ—¶Redisè¿˜æ”¯æŒå¯¹å‡ ä¸ªæ“ä½œåˆå¹¶åçš„åŸå­æ€§æ‰§è¡Œã€‚</li><li>æ•°æ®ç»“æ„ä¸°å¯Œï¼Œé™¤äº†æ”¯æŒstringç±»å‹çš„valueå¤–è¿˜æ”¯æŒhashã€setã€zsetã€listç­‰æ•°æ®ç»“æ„ã€‚</li><li>æ”¯æŒä¸»ä»å¤åˆ¶ï¼Œä¸»æœºä¼šè‡ªåŠ¨å°†æ•°æ®åŒæ­¥åˆ°ä»æœºï¼Œå¯ä»¥è¿›è¡Œè¯»å†™åˆ†ç¦»ã€‚</li></ul><p>ç¼ºç‚¹</p><ul><li>æ•°æ®åº“å®¹é‡å—åˆ°ç‰©ç†å†…å­˜çš„é™åˆ¶ï¼Œä¸èƒ½ç”¨ä½œæµ·é‡æ•°æ®çš„é«˜æ€§èƒ½è¯»å†™ï¼Œå› æ­¤Redisé€‚åˆçš„åœºæ™¯ä¸»è¦å±€é™åœ¨è¾ƒå°æ•°æ®é‡çš„é«˜æ€§èƒ½æ“ä½œå’Œè¿ç®—ä¸Šã€‚</li><li>Redis ä¸å…·å¤‡è‡ªåŠ¨å®¹é”™å’Œæ¢å¤åŠŸèƒ½ï¼Œä¸»æœºä»æœºçš„å®•æœºéƒ½ä¼šå¯¼è‡´å‰ç«¯éƒ¨åˆ†è¯»å†™è¯·æ±‚å¤±è´¥ï¼Œéœ€è¦ç­‰å¾…æœºå™¨é‡å¯æˆ–è€…æ‰‹åŠ¨åˆ‡æ¢å‰ç«¯çš„IPæ‰èƒ½æ¢å¤ã€‚</li><li>ä¸»æœºå®•æœºï¼Œå®•æœºå‰æœ‰éƒ¨åˆ†æ•°æ®æœªèƒ½åŠæ—¶åŒæ­¥åˆ°ä»æœºï¼Œåˆ‡æ¢IPåè¿˜ä¼šå¼•å…¥æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œé™ä½äº†ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚</li><li>Redis è¾ƒéš¾æ”¯æŒåœ¨çº¿æ‰©å®¹ï¼Œåœ¨é›†ç¾¤å®¹é‡è¾¾åˆ°ä¸Šé™æ—¶åœ¨çº¿æ‰©å®¹ä¼šå˜å¾—å¾ˆå¤æ‚ã€‚ä¸ºé¿å…è¿™ä¸€é—®é¢˜ï¼Œè¿ç»´äººå‘˜åœ¨ç³»ç»Ÿä¸Šçº¿æ—¶å¿…é¡»ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œè¿™å¯¹èµ„æºé€ æˆäº†å¾ˆå¤§çš„æµªè´¹ã€‚</li></ul><h3><span id="ä¸ºä»€ä¹ˆè¦ç”¨-redis-x2fä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜">ä¸ºä»€ä¹ˆè¦ç”¨ Redis &#x2F;ä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜</span></h3><p>ä¸»è¦ä»â€œé«˜æ€§èƒ½â€å’Œâ€œé«˜å¹¶å‘â€è¿™ä¸¤ç‚¹æ¥çœ‹å¾…è¿™ä¸ªé—®é¢˜ã€‚</p><h4><span id="é«˜æ€§èƒ½">é«˜æ€§èƒ½ï¼š</span></h4><p>å‡å¦‚ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®æ•°æ®åº“ä¸­çš„æŸäº›æ•°æ®ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šæ¯”è¾ƒæ…¢ï¼Œå› ä¸ºæ˜¯ä»ç¡¬ç›˜ä¸Šè¯»å–çš„ã€‚å°†è¯¥ç”¨æˆ·è®¿é—®çš„æ•°æ®å­˜åœ¨æ•°ç¼“å­˜ä¸­ï¼Œè¿™æ ·ä¸‹ä¸€æ¬¡å†è®¿é—®è¿™äº›æ•°æ®çš„æ—¶å€™å°±å¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­è·å–äº†ã€‚æ“ä½œç¼“å­˜å°±æ˜¯ç›´æ¥æ“ä½œå†…å­˜ï¼Œæ‰€ä»¥é€Ÿåº¦ç›¸å½“å¿«ã€‚å¦‚æœæ•°æ®åº“ä¸­çš„å¯¹åº”æ•°æ®æ”¹å˜çš„ä¹‹åï¼ŒåŒæ­¥æ”¹å˜ç¼“å­˜ä¸­ç›¸åº”çš„æ•°æ®å³å¯ï¼</p><p><img src="https://www.javazhiyin.com/wp-content/uploads/2020/10/java6-1602932967.png" alt="Redis å¸¸è§é¢è¯•é¢˜ï¼ˆ2020æœ€æ–°ç‰ˆï¼‰">img</p><h4><span id="é«˜å¹¶å‘">é«˜å¹¶å‘ï¼š</span></h4><p>ç›´æ¥æ“ä½œç¼“å­˜èƒ½å¤Ÿæ‰¿å—çš„è¯·æ±‚æ˜¯è¿œè¿œå¤§äºç›´æ¥è®¿é—®æ•°æ®åº“çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠæ•°æ®åº“ä¸­çš„éƒ¨åˆ†æ•°æ®è½¬ç§»åˆ°ç¼“å­˜ä¸­å»ï¼Œè¿™æ ·ç”¨æˆ·çš„ä¸€éƒ¨åˆ†è¯·æ±‚ä¼šç›´æ¥åˆ°ç¼“å­˜è¿™é‡Œè€Œä¸ç”¨ç»è¿‡æ•°æ®åº“ã€‚</p><p><img src="https://www.javazhiyin.com/wp-content/uploads/2020/10/java0-1602932967.png" alt="Redis å¸¸è§é¢è¯•é¢˜ï¼ˆ2020æœ€æ–°ç‰ˆï¼‰">img</p><h3><span id="ä¸ºä»€ä¹ˆè¦ç”¨-redis-è€Œä¸ç”¨-mapx2fguava-åšç¼“å­˜">ä¸ºä»€ä¹ˆè¦ç”¨ Redis è€Œä¸ç”¨ map&#x2F;guava åšç¼“å­˜?</span></h3><p>ç¼“å­˜åˆ†ä¸ºæœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜ã€‚ä»¥ Java ä¸ºä¾‹ï¼Œä½¿ç”¨è‡ªå¸¦çš„ map æˆ–è€… guava å®ç°çš„æ˜¯æœ¬åœ°ç¼“å­˜ï¼Œæœ€ä¸»è¦çš„ç‰¹ç‚¹æ˜¯è½»é‡ä»¥åŠå¿«é€Ÿï¼Œç”Ÿå‘½å‘¨æœŸéšç€ jvm çš„é”€æ¯è€Œç»“æŸï¼Œå¹¶ä¸”åœ¨å¤šå®ä¾‹çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªå®ä¾‹éƒ½éœ€è¦å„è‡ªä¿å­˜ä¸€ä»½ç¼“å­˜ï¼Œç¼“å­˜ä¸å…·æœ‰ä¸€è‡´æ€§ã€‚</p><p>ä½¿ç”¨ redis æˆ– memcached ä¹‹ç±»çš„ç§°ä¸ºåˆ†å¸ƒå¼ç¼“å­˜ï¼Œåœ¨å¤šå®ä¾‹çš„æƒ…å†µä¸‹ï¼Œå„å®ä¾‹å…±ç”¨ä¸€ä»½ç¼“å­˜æ•°æ®ï¼Œç¼“å­˜å…·æœ‰ä¸€è‡´æ€§ã€‚ç¼ºç‚¹æ˜¯éœ€è¦ä¿æŒ redis æˆ– memcachedæœåŠ¡çš„é«˜å¯ç”¨ï¼Œæ•´ä¸ªç¨‹åºæ¶æ„ä¸Šè¾ƒä¸ºå¤æ‚ã€‚</p><h3><span id="redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«">Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«</span></h3><p>1ã€å®Œå…¨åŸºäºå†…å­˜ï¼Œç»å¤§éƒ¨åˆ†è¯·æ±‚æ˜¯çº¯ç²¹çš„å†…å­˜æ“ä½œï¼Œéå¸¸å¿«é€Ÿã€‚æ•°æ®å­˜åœ¨å†…å­˜ä¸­ï¼Œç±»ä¼¼äº HashMapï¼ŒHashMap çš„ä¼˜åŠ¿å°±æ˜¯æŸ¥æ‰¾å’Œæ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(1)ï¼›</p><p>2ã€æ•°æ®ç»“æ„ç®€å•ï¼Œå¯¹æ•°æ®æ“ä½œä¹Ÿç®€å•ï¼ŒRedis ä¸­çš„æ•°æ®ç»“æ„æ˜¯ä¸“é—¨è¿›è¡Œè®¾è®¡çš„ï¼›</p><p>3ã€é‡‡ç”¨å•çº¿ç¨‹ï¼Œé¿å…äº†ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œç«äº‰æ¡ä»¶ï¼Œä¹Ÿä¸å­˜åœ¨å¤šè¿›ç¨‹æˆ–è€…å¤šçº¿ç¨‹å¯¼è‡´çš„åˆ‡æ¢è€Œæ¶ˆè€— CPUï¼Œä¸ç”¨å»è€ƒè™‘å„ç§é”çš„é—®é¢˜ï¼Œä¸å­˜åœ¨åŠ é”é‡Šæ”¾é”æ“ä½œï¼Œæ²¡æœ‰å› ä¸ºå¯èƒ½å‡ºç°æ­»é”è€Œå¯¼è‡´çš„æ€§èƒ½æ¶ˆè€—ï¼›</p><p>4ã€ä½¿ç”¨å¤šè·¯ I&#x2F;O å¤ç”¨æ¨¡å‹ï¼Œéé˜»å¡ IOï¼›</p><p>5ã€ä½¿ç”¨åº•å±‚æ¨¡å‹ä¸åŒï¼Œå®ƒä»¬ä¹‹é—´åº•å±‚å®ç°æ–¹å¼ä»¥åŠä¸å®¢æˆ·ç«¯ä¹‹é—´é€šä¿¡çš„åº”ç”¨åè®®ä¸ä¸€æ ·ï¼ŒRedis ç›´æ¥è‡ªå·±æ„å»ºäº† VM æœºåˆ¶ ï¼Œå› ä¸ºä¸€èˆ¬çš„ç³»ç»Ÿè°ƒç”¨ç³»ç»Ÿå‡½æ•°çš„è¯ï¼Œä¼šæµªè´¹ä¸€å®šçš„æ—¶é—´å»ç§»åŠ¨å’Œè¯·æ±‚ï¼›</p><h2><span id="æ•°æ®ç±»å‹">æ•°æ®ç±»å‹</span></h2><h3><span id="redisæœ‰å“ªäº›æ•°æ®ç±»å‹">Redisæœ‰å“ªäº›æ•°æ®ç±»å‹</span></h3><p>Redisä¸»è¦æœ‰5ç§æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬Stringï¼ŒListï¼ŒSetï¼ŒZsetï¼ŒHashï¼Œæ»¡è¶³å¤§éƒ¨åˆ†çš„ä½¿ç”¨è¦æ±‚</p><p><img src="https://www.javazhiyin.com/wp-content/uploads/2020/10/java3-1602932967.png" alt="Redis å¸¸è§é¢è¯•é¢˜ï¼ˆ2020æœ€æ–°ç‰ˆï¼‰"></p><h3><span id="redisçš„åº”ç”¨åœºæ™¯">Redisçš„åº”ç”¨åœºæ™¯</span></h3><h3><span id="æ€»ç»“ä¸€">æ€»ç»“ä¸€</span></h3><ul><li>è®¡æ•°å™¨</li></ul><p>å¯ä»¥å¯¹ String è¿›è¡Œè‡ªå¢è‡ªå‡è¿ç®—ï¼Œä»è€Œå®ç°è®¡æ•°å™¨åŠŸèƒ½ã€‚Redis è¿™ç§å†…å­˜å‹æ•°æ®åº“çš„è¯»å†™æ€§èƒ½éå¸¸é«˜ï¼Œå¾ˆé€‚åˆå­˜å‚¨é¢‘ç¹è¯»å†™çš„è®¡æ•°é‡ã€‚</p><ul><li>ç¼“å­˜</li></ul><p>å°†çƒ­ç‚¹æ•°æ®æ”¾åˆ°å†…å­˜ä¸­ï¼Œè®¾ç½®å†…å­˜çš„æœ€å¤§ä½¿ç”¨é‡ä»¥åŠæ·˜æ±°ç­–ç•¥æ¥ä¿è¯ç¼“å­˜çš„å‘½ä¸­ç‡ã€‚</p><ul><li>ä¼šè¯ç¼“å­˜</li></ul><p>å¯ä»¥ä½¿ç”¨ Redis æ¥ç»Ÿä¸€å­˜å‚¨å¤šå°åº”ç”¨æœåŠ¡å™¨çš„ä¼šè¯ä¿¡æ¯ã€‚å½“åº”ç”¨æœåŠ¡å™¨ä¸å†å­˜å‚¨ç”¨æˆ·çš„ä¼šè¯ä¿¡æ¯ï¼Œä¹Ÿå°±ä¸å†å…·æœ‰çŠ¶æ€ï¼Œä¸€ä¸ªç”¨æˆ·å¯ä»¥è¯·æ±‚ä»»æ„ä¸€ä¸ªåº”ç”¨æœåŠ¡å™¨ï¼Œä»è€Œæ›´å®¹æ˜“å®ç°é«˜å¯ç”¨æ€§ä»¥åŠå¯ä¼¸ç¼©æ€§ã€‚</p><ul><li>å…¨é¡µç¼“å­˜ï¼ˆFPCï¼‰</li></ul><p>é™¤åŸºæœ¬çš„ä¼šè¯tokenä¹‹å¤–ï¼ŒRedisè¿˜æä¾›å¾ˆç®€ä¾¿çš„FPCå¹³å°ã€‚ä»¥Magentoä¸ºä¾‹ï¼ŒMagentoæä¾›ä¸€ä¸ªæ’ä»¶æ¥ä½¿ç”¨Redisä½œä¸ºå…¨é¡µç¼“å­˜åç«¯ã€‚æ­¤å¤–ï¼Œå¯¹WordPressçš„ç”¨æˆ·æ¥è¯´ï¼ŒPantheonæœ‰ä¸€ä¸ªéå¸¸å¥½çš„æ’ä»¶ wp-redisï¼Œè¿™ä¸ªæ’ä»¶èƒ½å¸®åŠ©ä½ ä»¥æœ€å¿«é€Ÿåº¦åŠ è½½ä½ æ›¾æµè§ˆè¿‡çš„é¡µé¢ã€‚</p><ul><li>æŸ¥æ‰¾è¡¨</li></ul><p>ä¾‹å¦‚ DNS è®°å½•å°±å¾ˆé€‚åˆä½¿ç”¨ Redis è¿›è¡Œå­˜å‚¨ã€‚æŸ¥æ‰¾è¡¨å’Œç¼“å­˜ç±»ä¼¼ï¼Œä¹Ÿæ˜¯åˆ©ç”¨äº† Redis å¿«é€Ÿçš„æŸ¥æ‰¾ç‰¹æ€§ã€‚ä½†æ˜¯æŸ¥æ‰¾è¡¨çš„å†…å®¹ä¸èƒ½å¤±æ•ˆï¼Œè€Œç¼“å­˜çš„å†…å®¹å¯ä»¥å¤±æ•ˆï¼Œå› ä¸ºç¼“å­˜ä¸ä½œä¸ºå¯é çš„æ•°æ®æ¥æºã€‚</p><ul><li>æ¶ˆæ¯é˜Ÿåˆ—(å‘å¸ƒ&#x2F;è®¢é˜…åŠŸèƒ½)</li></ul><p>List æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œå¯ä»¥é€šè¿‡ lpush å’Œ rpop å†™å…¥å’Œè¯»å–æ¶ˆæ¯ã€‚ä¸è¿‡æœ€å¥½ä½¿ç”¨ Kafkaã€RabbitMQ ç­‰æ¶ˆæ¯ä¸­é—´ä»¶ã€‚</p><ul><li>åˆ†å¸ƒå¼é”å®ç°</li></ul><p>åœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œæ— æ³•ä½¿ç”¨å•æœºç¯å¢ƒä¸‹çš„é”æ¥å¯¹å¤šä¸ªèŠ‚ç‚¹ä¸Šçš„è¿›ç¨‹è¿›è¡ŒåŒæ­¥ã€‚å¯ä»¥ä½¿ç”¨ Redis è‡ªå¸¦çš„ SETNX å‘½ä»¤å®ç°åˆ†å¸ƒå¼é”ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å®˜æ–¹æä¾›çš„ RedLock åˆ†å¸ƒå¼é”å®ç°ã€‚</p><ul><li>å…¶å®ƒ</li></ul><p>Set å¯ä»¥å®ç°äº¤é›†ã€å¹¶é›†ç­‰æ“ä½œï¼Œä»è€Œå®ç°å…±åŒå¥½å‹ç­‰åŠŸèƒ½ã€‚ZSet å¯ä»¥å®ç°æœ‰åºæ€§æ“ä½œï¼Œä»è€Œå®ç°æ’è¡Œæ¦œç­‰åŠŸèƒ½ã€‚</p><h4><span id="æ€»ç»“äºŒ">æ€»ç»“äºŒ</span></h4><p>Redisç›¸æ¯”å…¶ä»–ç¼“å­˜ï¼Œæœ‰ä¸€ä¸ªéå¸¸å¤§çš„ä¼˜åŠ¿ï¼Œå°±æ˜¯æ”¯æŒå¤šç§æ•°æ®ç±»å‹ã€‚</p><p>æ•°æ®ç±»å‹è¯´æ˜stringå­—ç¬¦ä¸²ï¼Œæœ€ç®€å•çš„k-vå­˜å‚¨hashhashæ ¼å¼ï¼Œvalueä¸ºfieldå’Œvalueï¼Œé€‚åˆID-Detailè¿™æ ·çš„åœºæ™¯ã€‚listç®€å•çš„listï¼Œé¡ºåºåˆ—è¡¨ï¼Œæ”¯æŒé¦–ä½æˆ–è€…æœ«å°¾æ’å…¥æ•°æ®setæ— åºlistï¼ŒæŸ¥æ‰¾é€Ÿåº¦å¿«ï¼Œé€‚åˆäº¤é›†ã€å¹¶é›†ã€å·®é›†å¤„ç†sorted setæœ‰åºçš„set</p><p>å…¶å®ï¼Œé€šè¿‡ä¸Šé¢çš„æ•°æ®ç±»å‹çš„ç‰¹æ€§ï¼ŒåŸºæœ¬å°±èƒ½æƒ³åˆ°åˆé€‚çš„åº”ç”¨åœºæ™¯äº†ã€‚</p><p><img src="https://www.javazhiyin.com/wp-content/uploads/2020/10/java8-1602932967.png" alt="Redis å¸¸è§é¢è¯•é¢˜ï¼ˆ2020æœ€æ–°ç‰ˆï¼‰"></p><p>å¦‚ä¸Šæ‰€è¿°ï¼Œè™½ç„¶Redisä¸åƒå…³ç³»æ•°æ®åº“é‚£ä¹ˆå¤æ‚çš„æ•°æ®ç»“æ„ï¼Œä½†æ˜¯ï¼Œä¹Ÿèƒ½é€‚åˆå¾ˆå¤šåœºæ™¯ï¼Œæ¯”ä¸€èˆ¬çš„ç¼“å­˜æ•°æ®ç»“æ„è¦å¤šã€‚äº†è§£æ¯ç§æ•°æ®ç»“æ„é€‚åˆçš„ä¸šåŠ¡åœºæ™¯ï¼Œä¸ä»…æœ‰åˆ©äºæå‡å¼€å‘æ•ˆç‡ï¼Œä¹Ÿèƒ½æœ‰æ•ˆåˆ©ç”¨Redisçš„æ€§èƒ½ã€‚</p><h2><span id="æŒä¹…åŒ–">æŒä¹…åŒ–</span></h2><h3><span id="ä»€ä¹ˆæ˜¯redisæŒä¹…åŒ–">ä»€ä¹ˆæ˜¯RedisæŒä¹…åŒ–ï¼Ÿ</span></h3><p>æŒä¹…åŒ–å°±æ˜¯æŠŠå†…å­˜çš„æ•°æ®å†™åˆ°ç£ç›˜ä¸­å»ï¼Œé˜²æ­¢æœåŠ¡å®•æœºäº†å†…å­˜æ•°æ®ä¸¢å¤±ã€‚</p><h3><span id="redis-çš„æŒä¹…åŒ–æœºåˆ¶æ˜¯ä»€ä¹ˆå„è‡ªçš„ä¼˜ç¼ºç‚¹">Redis çš„æŒä¹…åŒ–æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿå„è‡ªçš„ä¼˜ç¼ºç‚¹ï¼Ÿ</span></h3><p>Redis æä¾›ä¸¤ç§æŒä¹…åŒ–æœºåˆ¶ RDBï¼ˆé»˜è®¤ï¼‰ å’Œ AOF æœºåˆ¶:</p><p><strong>RDBï¼šæ˜¯Redis DataBaseç¼©å†™å¿«ç…§</strong></p><p>RDBæ˜¯Redisé»˜è®¤çš„æŒä¹…åŒ–æ–¹å¼ã€‚æŒ‰ç…§ä¸€å®šçš„æ—¶é—´å°†å†…å­˜çš„æ•°æ®ä»¥å¿«ç…§çš„å½¢å¼ä¿å­˜åˆ°ç¡¬ç›˜ä¸­ï¼Œå¯¹åº”äº§ç”Ÿçš„æ•°æ®æ–‡ä»¶ä¸ºdump.rdbã€‚é€šè¿‡é…ç½®æ–‡ä»¶ä¸­çš„saveå‚æ•°æ¥å®šä¹‰å¿«ç…§çš„å‘¨æœŸã€‚</p><p><img src="https://www.javazhiyin.com/wp-content/uploads/2020/10/java0-1602932967-1.png" alt="Redis å¸¸è§é¢è¯•é¢˜ï¼ˆ2020æœ€æ–°ç‰ˆï¼‰">img</p><p>ä¼˜ç‚¹ï¼š</p><ul><li>1ã€åªæœ‰ä¸€ä¸ªæ–‡ä»¶ dump.rdbï¼Œæ–¹ä¾¿æŒä¹…åŒ–ã€‚</li><li>2ã€å®¹ç¾æ€§å¥½ï¼Œä¸€ä¸ªæ–‡ä»¶å¯ä»¥ä¿å­˜åˆ°å®‰å…¨çš„ç£ç›˜ã€‚</li><li>3ã€æ€§èƒ½æœ€å¤§åŒ–ï¼Œfork å­è¿›ç¨‹æ¥å®Œæˆå†™æ“ä½œï¼Œè®©ä¸»è¿›ç¨‹ç»§ç»­å¤„ç†å‘½ä»¤ï¼Œæ‰€ä»¥æ˜¯ IO æœ€å¤§åŒ–ã€‚ä½¿ç”¨å•ç‹¬å­è¿›ç¨‹æ¥è¿›è¡ŒæŒä¹…åŒ–ï¼Œä¸»è¿›ç¨‹ä¸ä¼šè¿›è¡Œä»»ä½• IO æ“ä½œï¼Œä¿è¯äº† redis çš„é«˜æ€§èƒ½</li><li>4.ç›¸å¯¹äºæ•°æ®é›†å¤§æ—¶ï¼Œæ¯” AOF çš„å¯åŠ¨æ•ˆç‡æ›´é«˜ã€‚</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>1ã€æ•°æ®å®‰å…¨æ€§ä½ã€‚RDB æ˜¯é—´éš”ä¸€æ®µæ—¶é—´è¿›è¡ŒæŒä¹…åŒ–ï¼Œå¦‚æœæŒä¹…åŒ–ä¹‹é—´ redis å‘ç”Ÿæ•…éšœï¼Œä¼šå‘ç”Ÿæ•°æ®ä¸¢å¤±ã€‚æ‰€ä»¥è¿™ç§æ–¹å¼æ›´é€‚åˆæ•°æ®è¦æ±‚ä¸ä¸¥è°¨çš„æ—¶å€™)</li><li>2ã€AOFï¼ˆAppend-only file)æŒä¹…åŒ–æ–¹å¼ï¼šæ˜¯æŒ‡æ‰€æœ‰çš„å‘½ä»¤è¡Œè®°å½•ä»¥ redis å‘½ä»¤è¯· æ±‚åè®®çš„æ ¼å¼å®Œå…¨æŒä¹…åŒ–å­˜å‚¨)ä¿å­˜ä¸º aof æ–‡ä»¶ã€‚</li></ul><p><strong>AOFï¼šæŒä¹…åŒ–</strong></p><p>AOFæŒä¹…åŒ–(å³Append Only FileæŒä¹…åŒ–)ï¼Œåˆ™æ˜¯å°†Redisæ‰§è¡Œçš„æ¯æ¬¡å†™å‘½ä»¤è®°å½•åˆ°å•ç‹¬çš„æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œå½“é‡å¯Redisä¼šé‡æ–°å°†æŒä¹…åŒ–çš„æ—¥å¿—ä¸­æ–‡ä»¶æ¢å¤æ•°æ®ã€‚</p><p>å½“ä¸¤ç§æ–¹å¼åŒæ—¶å¼€å¯æ—¶ï¼Œæ•°æ®æ¢å¤Redisä¼šä¼˜å…ˆé€‰æ‹©AOFæ¢å¤ã€‚</p><p><img src="https://www.javazhiyin.com/wp-content/uploads/2020/10/java6-1602932967-1.png" alt="Redis å¸¸è§é¢è¯•é¢˜ï¼ˆ2020æœ€æ–°ç‰ˆï¼‰">img</p><p>ä¼˜ç‚¹ï¼š</p><ul><li>1ã€æ•°æ®å®‰å…¨ï¼Œaof æŒä¹…åŒ–å¯ä»¥é…ç½® appendfsync å±æ€§ï¼Œæœ‰ alwaysï¼Œæ¯è¿›è¡Œä¸€æ¬¡ å‘½ä»¤æ“ä½œå°±è®°å½•åˆ° aof æ–‡ä»¶ä¸­ä¸€æ¬¡ã€‚</li><li>2ã€é€šè¿‡ append æ¨¡å¼å†™æ–‡ä»¶ï¼Œå³ä½¿ä¸­é€”æœåŠ¡å™¨å®•æœºï¼Œå¯ä»¥é€šè¿‡ redis-check-aof å·¥å…·è§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚</li><li>3ã€AOF æœºåˆ¶çš„ rewrite æ¨¡å¼ã€‚AOF æ–‡ä»¶æ²¡è¢« rewrite ä¹‹å‰ï¼ˆæ–‡ä»¶è¿‡å¤§æ—¶ä¼šå¯¹å‘½ä»¤ è¿›è¡Œåˆå¹¶é‡å†™ï¼‰ï¼Œå¯ä»¥åˆ é™¤å…¶ä¸­çš„æŸäº›å‘½ä»¤ï¼ˆæ¯”å¦‚è¯¯æ“ä½œçš„ flushallï¼‰)</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>1ã€AOF æ–‡ä»¶æ¯” RDB æ–‡ä»¶å¤§ï¼Œä¸”æ¢å¤é€Ÿåº¦æ…¢ã€‚</li><li>2ã€æ•°æ®é›†å¤§çš„æ—¶å€™ï¼Œæ¯” rdb å¯åŠ¨æ•ˆç‡ä½ã€‚</li></ul><p>ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</p><ul><li>AOFæ–‡ä»¶æ¯”RDBæ›´æ–°é¢‘ç‡é«˜ï¼Œä¼˜å…ˆä½¿ç”¨AOFè¿˜åŸæ•°æ®ã€‚</li><li>AOFæ¯”RDBæ›´å®‰å…¨ä¹Ÿæ›´å¤§</li><li>RDBæ€§èƒ½æ¯”AOFå¥½</li><li>å¦‚æœä¸¤ä¸ªéƒ½é…äº†ä¼˜å…ˆåŠ è½½AOF</li></ul><h3><span id="å¦‚ä½•é€‰æ‹©åˆé€‚çš„æŒä¹…åŒ–æ–¹å¼">å¦‚ä½•é€‰æ‹©åˆé€‚çš„æŒä¹…åŒ–æ–¹å¼</span></h3><ul><li>ä¸€èˆ¬æ¥è¯´ï¼Œ å¦‚æœæƒ³è¾¾åˆ°è¶³ä»¥åª²ç¾PostgreSQLçš„æ•°æ®å®‰å…¨æ€§ï¼Œä½ åº”è¯¥åŒæ—¶ä½¿ç”¨ä¸¤ç§æŒä¹…åŒ–åŠŸèƒ½ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“ Redis é‡å¯çš„æ—¶å€™ä¼šä¼˜å…ˆè½½å…¥AOFæ–‡ä»¶æ¥æ¢å¤åŸå§‹çš„æ•°æ®ï¼Œå› ä¸ºåœ¨é€šå¸¸æƒ…å†µä¸‹AOFæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦æ¯”RDBæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦å®Œæ•´ã€‚</li><li>å¦‚æœä½ éå¸¸å…³å¿ƒä½ çš„æ•°æ®ï¼Œ ä½†ä»ç„¶å¯ä»¥æ‰¿å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±ï¼Œé‚£ä¹ˆä½ å¯ä»¥åªä½¿ç”¨RDBæŒä¹…åŒ–ã€‚</li><li>æœ‰å¾ˆå¤šç”¨æˆ·éƒ½åªä½¿ç”¨AOFæŒä¹…åŒ–ï¼Œä½†å¹¶ä¸æ¨èè¿™ç§æ–¹å¼ï¼Œå› ä¸ºå®šæ—¶ç”ŸæˆRDBå¿«ç…§ï¼ˆsnapshotï¼‰éå¸¸ä¾¿äºè¿›è¡Œæ•°æ®åº“å¤‡ä»½ï¼Œ å¹¶ä¸” RDB æ¢å¤æ•°æ®é›†çš„é€Ÿåº¦ä¹Ÿè¦æ¯”AOFæ¢å¤çš„é€Ÿåº¦è¦å¿«ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œä½¿ç”¨RDBè¿˜å¯ä»¥é¿å…AOFç¨‹åºçš„bugã€‚</li><li>å¦‚æœä½ åªå¸Œæœ›ä½ çš„æ•°æ®åœ¨æœåŠ¡å™¨è¿è¡Œçš„æ—¶å€™å­˜åœ¨ï¼Œä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ä»»ä½•æŒä¹…åŒ–æ–¹å¼ã€‚</li></ul><h3><span id="redisæŒä¹…åŒ–æ•°æ®å’Œç¼“å­˜æ€ä¹ˆåšæ‰©å®¹">RedisæŒä¹…åŒ–æ•°æ®å’Œç¼“å­˜æ€ä¹ˆåšæ‰©å®¹ï¼Ÿ</span></h3><ul><li>å¦‚æœRedisè¢«å½“åšç¼“å­˜ä½¿ç”¨ï¼Œä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œå®ç°åŠ¨æ€æ‰©å®¹ç¼©å®¹ã€‚</li><li>å¦‚æœRedisè¢«å½“åšä¸€ä¸ªæŒä¹…åŒ–å­˜å‚¨ä½¿ç”¨ï¼Œå¿…é¡»ä½¿ç”¨å›ºå®šçš„keys-to-nodesæ˜ å°„å…³ç³»ï¼ŒèŠ‚ç‚¹çš„æ•°é‡ä¸€æ—¦ç¡®å®šä¸èƒ½å˜åŒ–ã€‚å¦åˆ™çš„è¯(å³RedisèŠ‚ç‚¹éœ€è¦åŠ¨æ€å˜åŒ–çš„æƒ…å†µï¼‰ï¼Œå¿…é¡»ä½¿ç”¨å¯ä»¥åœ¨è¿è¡Œæ—¶è¿›è¡Œæ•°æ®å†å¹³è¡¡çš„ä¸€å¥—ç³»ç»Ÿï¼Œè€Œå½“å‰åªæœ‰Redisé›†ç¾¤å¯ä»¥åšåˆ°è¿™æ ·ã€‚</li></ul><p>æœç´¢å…¬ä¼—å· Javaé¢è¯•é¢˜ç²¾é€‰ï¼Œå›å¤â€œé¢è¯•èµ„æ–™â€ï¼Œé€ä½ ä¸€ä»½Javaé¢è¯•å®å…¸.pdf</p><h2><span id="è¿‡æœŸé”®çš„åˆ é™¤ç­–ç•¥">è¿‡æœŸé”®çš„åˆ é™¤ç­–ç•¥</span></h2><h3><span id="redisçš„è¿‡æœŸé”®çš„åˆ é™¤ç­–ç•¥">Redisçš„è¿‡æœŸé”®çš„åˆ é™¤ç­–ç•¥</span></h3><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒRedisæ˜¯key-valueæ•°æ®åº“ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®Redisä¸­ç¼“å­˜çš„keyçš„è¿‡æœŸæ—¶é—´ã€‚Redisçš„è¿‡æœŸç­–ç•¥å°±æ˜¯æŒ‡å½“Redisä¸­ç¼“å­˜çš„keyè¿‡æœŸäº†ï¼ŒRediså¦‚ä½•å¤„ç†ã€‚</p><p>è¿‡æœŸç­–ç•¥é€šå¸¸æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š</p><ul><li>å®šæ—¶è¿‡æœŸï¼šæ¯ä¸ªè®¾ç½®è¿‡æœŸæ—¶é—´çš„keyéƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œåˆ°è¿‡æœŸæ—¶é—´å°±ä¼šç«‹å³æ¸…é™¤ã€‚è¯¥ç­–ç•¥å¯ä»¥ç«‹å³æ¸…é™¤è¿‡æœŸçš„æ•°æ®ï¼Œå¯¹å†…å­˜å¾ˆå‹å¥½ï¼›ä½†æ˜¯ä¼šå ç”¨å¤§é‡çš„CPUèµ„æºå»å¤„ç†è¿‡æœŸçš„æ•°æ®ï¼Œä»è€Œå½±å“ç¼“å­˜çš„å“åº”æ—¶é—´å’Œååé‡ã€‚</li><li>æƒ°æ€§è¿‡æœŸï¼šåªæœ‰å½“è®¿é—®ä¸€ä¸ªkeyæ—¶ï¼Œæ‰ä¼šåˆ¤æ–­è¯¥keyæ˜¯å¦å·²è¿‡æœŸï¼Œè¿‡æœŸåˆ™æ¸…é™¤ã€‚è¯¥ç­–ç•¥å¯ä»¥æœ€å¤§åŒ–åœ°èŠ‚çœCPUèµ„æºï¼Œå´å¯¹å†…å­˜éå¸¸ä¸å‹å¥½ã€‚æç«¯æƒ…å†µå¯èƒ½å‡ºç°å¤§é‡çš„è¿‡æœŸkeyæ²¡æœ‰å†æ¬¡è¢«è®¿é—®ï¼Œä»è€Œä¸ä¼šè¢«æ¸…é™¤ï¼Œå ç”¨å¤§é‡å†…å­˜ã€‚</li><li>å®šæœŸè¿‡æœŸï¼šæ¯éš”ä¸€å®šçš„æ—¶é—´ï¼Œä¼šæ‰«æä¸€å®šæ•°é‡çš„æ•°æ®åº“çš„expireså­—å…¸ä¸­ä¸€å®šæ•°é‡çš„keyï¼Œå¹¶æ¸…é™¤å…¶ä¸­å·²è¿‡æœŸçš„keyã€‚è¯¥ç­–ç•¥æ˜¯å‰ä¸¤è€…çš„ä¸€ä¸ªæŠ˜ä¸­æ–¹æ¡ˆã€‚é€šè¿‡è°ƒæ•´å®šæ—¶æ‰«æçš„æ—¶é—´é—´éš”å’Œæ¯æ¬¡æ‰«æçš„é™å®šè€—æ—¶ï¼Œå¯ä»¥åœ¨ä¸åŒæƒ…å†µä¸‹ä½¿å¾—CPUå’Œå†…å­˜èµ„æºè¾¾åˆ°æœ€ä¼˜çš„å¹³è¡¡æ•ˆæœã€‚<br>(expireså­—å…¸ä¼šä¿å­˜æ‰€æœ‰è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyçš„è¿‡æœŸæ—¶é—´æ•°æ®ï¼Œå…¶ä¸­ï¼Œkeyæ˜¯æŒ‡å‘é”®ç©ºé—´ä¸­çš„æŸä¸ªé”®çš„æŒ‡é’ˆï¼Œvalueæ˜¯è¯¥é”®çš„æ¯«ç§’ç²¾åº¦çš„UNIXæ—¶é—´æˆ³è¡¨ç¤ºçš„è¿‡æœŸæ—¶é—´ã€‚é”®ç©ºé—´æ˜¯æŒ‡è¯¥Redisé›†ç¾¤ä¸­ä¿å­˜çš„æ‰€æœ‰é”®ã€‚)</li></ul><p>Redisä¸­åŒæ—¶ä½¿ç”¨äº†æƒ°æ€§è¿‡æœŸå’Œå®šæœŸè¿‡æœŸä¸¤ç§è¿‡æœŸç­–ç•¥ã€‚</p><h3><span id="redis-keyçš„è¿‡æœŸæ—¶é—´å’Œæ°¸ä¹…æœ‰æ•ˆåˆ†åˆ«æ€ä¹ˆè®¾ç½®">Redis keyçš„è¿‡æœŸæ—¶é—´å’Œæ°¸ä¹…æœ‰æ•ˆåˆ†åˆ«æ€ä¹ˆè®¾ç½®ï¼Ÿ</span></h3><p>EXPIREå’ŒPERSISTå‘½ä»¤ã€‚</p><h3><span id="æˆ‘ä»¬çŸ¥é“é€šè¿‡expireæ¥è®¾ç½®key-çš„è¿‡æœŸæ—¶é—´é‚£ä¹ˆå¯¹è¿‡æœŸçš„æ•°æ®æ€ä¹ˆå¤„ç†å‘¢">æˆ‘ä»¬çŸ¥é“é€šè¿‡expireæ¥è®¾ç½®key çš„è¿‡æœŸæ—¶é—´ï¼Œé‚£ä¹ˆå¯¹è¿‡æœŸçš„æ•°æ®æ€ä¹ˆå¤„ç†å‘¢?</span></h3><p>é™¤äº†ç¼“å­˜æœåŠ¡å™¨è‡ªå¸¦çš„ç¼“å­˜å¤±æ•ˆç­–ç•¥ä¹‹å¤–ï¼ˆRedisé»˜è®¤çš„æœ‰6ä¸­ç­–ç•¥å¯ä¾›é€‰æ‹©ï¼‰ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ ¹æ®å…·ä½“çš„ä¸šåŠ¡éœ€æ±‚è¿›è¡Œè‡ªå®šä¹‰çš„ç¼“å­˜æ·˜æ±°ï¼Œå¸¸è§çš„ç­–ç•¥æœ‰ä¸¤ç§ï¼š</p><ol><li>å®šæ—¶å»æ¸…ç†è¿‡æœŸçš„ç¼“å­˜ï¼›</li><li>å½“æœ‰ç”¨æˆ·è¯·æ±‚è¿‡æ¥æ—¶ï¼Œå†åˆ¤æ–­è¿™ä¸ªè¯·æ±‚æ‰€ç”¨åˆ°çš„ç¼“å­˜æ˜¯å¦è¿‡æœŸï¼Œè¿‡æœŸçš„è¯å°±å»åº•å±‚ç³»ç»Ÿå¾—åˆ°æ–°æ•°æ®å¹¶æ›´æ–°ç¼“å­˜ã€‚</li></ol><p>ä¸¤è€…å„æœ‰ä¼˜åŠ£ï¼Œç¬¬ä¸€ç§çš„ç¼ºç‚¹æ˜¯ç»´æŠ¤å¤§é‡ç¼“å­˜çš„keyæ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œç¬¬äºŒç§çš„ç¼ºç‚¹å°±æ˜¯æ¯æ¬¡ç”¨æˆ·è¯·æ±‚è¿‡æ¥éƒ½è¦åˆ¤æ–­ç¼“å­˜å¤±æ•ˆï¼Œé€»è¾‘ç›¸å¯¹æ¯”è¾ƒå¤æ‚ï¼å…·ä½“ç”¨å“ªç§æ–¹æ¡ˆï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„åº”ç”¨åœºæ™¯æ¥æƒè¡¡ã€‚</p><h2><span id="å†…å­˜ç›¸å…³">å†…å­˜ç›¸å…³</span></h2><h3><span id="mysqlé‡Œæœ‰2000wæ•°æ®redisä¸­åªå­˜20wçš„æ•°æ®å¦‚ä½•ä¿è¯redisä¸­çš„æ•°æ®éƒ½æ˜¯çƒ­ç‚¹æ•°æ®">MySQLé‡Œæœ‰2000wæ•°æ®ï¼Œredisä¸­åªå­˜20wçš„æ•°æ®ï¼Œå¦‚ä½•ä¿è¯redisä¸­çš„æ•°æ®éƒ½æ˜¯çƒ­ç‚¹æ•°æ®</span></h3><p>rediså†…å­˜æ•°æ®é›†å¤§å°ä¸Šå‡åˆ°ä¸€å®šå¤§å°çš„æ—¶å€™ï¼Œå°±ä¼šæ–½è¡Œæ•°æ®æ·˜æ±°ç­–ç•¥ã€‚</p><h3><span id="redisçš„å†…å­˜æ·˜æ±°ç­–ç•¥æœ‰å“ªäº›">Redisçš„å†…å­˜æ·˜æ±°ç­–ç•¥æœ‰å“ªäº›</span></h3><p>Redisçš„å†…å­˜æ·˜æ±°ç­–ç•¥æ˜¯æŒ‡åœ¨Redisçš„ç”¨äºç¼“å­˜çš„å†…å­˜ä¸è¶³æ—¶ï¼Œæ€ä¹ˆå¤„ç†éœ€è¦æ–°å†™å…¥ä¸”éœ€è¦ç”³è¯·é¢å¤–ç©ºé—´çš„æ•°æ®ã€‚</p><p>å…¨å±€çš„é”®ç©ºé—´é€‰æ‹©æ€§ç§»é™¤</p><ul><li>noevictionï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œæ–°å†™å…¥æ“ä½œä¼šæŠ¥é”™ã€‚</li><li>allkeys-lruï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œåœ¨é”®ç©ºé—´ä¸­ï¼Œç§»é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„keyã€‚ï¼ˆè¿™ä¸ªæ˜¯æœ€å¸¸ç”¨çš„ï¼‰</li><li>allkeys-randomï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œåœ¨é”®ç©ºé—´ä¸­ï¼Œéšæœºç§»é™¤æŸä¸ªkeyã€‚</li></ul><p>è®¾ç½®è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´é€‰æ‹©æ€§ç§»é™¤</p><ul><li>volatile-lruï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œåœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œç§»é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„keyã€‚</li><li>volatile-randomï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œåœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œéšæœºç§»é™¤æŸä¸ªkeyã€‚</li><li>volatile-ttlï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œåœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œæœ‰æ›´æ—©è¿‡æœŸæ—¶é—´çš„keyä¼˜å…ˆç§»é™¤ã€‚</li></ul><p><strong>æ€»ç»“</strong></p><p>Redisçš„å†…å­˜æ·˜æ±°ç­–ç•¥çš„é€‰å–å¹¶ä¸ä¼šå½±å“è¿‡æœŸçš„keyçš„å¤„ç†ã€‚å†…å­˜æ·˜æ±°ç­–ç•¥ç”¨äºå¤„ç†å†…å­˜ä¸è¶³æ—¶çš„éœ€è¦ç”³è¯·é¢å¤–ç©ºé—´çš„æ•°æ®ï¼›è¿‡æœŸç­–ç•¥ç”¨äºå¤„ç†è¿‡æœŸçš„ç¼“å­˜æ•°æ®ã€‚</p><h3><span id="redisä¸»è¦æ¶ˆè€—ä»€ä¹ˆç‰©ç†èµ„æº">Redisä¸»è¦æ¶ˆè€—ä»€ä¹ˆç‰©ç†èµ„æºï¼Ÿ</span></h3><p>å†…å­˜ã€‚</p><h3><span id="redisçš„å†…å­˜ç”¨å®Œäº†ä¼šå‘ç”Ÿä»€ä¹ˆ">Redisçš„å†…å­˜ç”¨å®Œäº†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</span></h3><p>å¦‚æœè¾¾åˆ°è®¾ç½®çš„ä¸Šé™ï¼ŒRedisçš„å†™å‘½ä»¤ä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼ˆä½†æ˜¯è¯»å‘½ä»¤è¿˜å¯ä»¥æ­£å¸¸è¿”å›ã€‚ï¼‰æˆ–è€…ä½ å¯ä»¥é…ç½®å†…å­˜æ·˜æ±°æœºåˆ¶ï¼Œå½“Redisè¾¾åˆ°å†…å­˜ä¸Šé™æ—¶ä¼šå†²åˆ·æ‰æ—§çš„å†…å®¹ã€‚</p><h3><span id="rediså¦‚ä½•åšå†…å­˜ä¼˜åŒ–">Rediså¦‚ä½•åšå†…å­˜ä¼˜åŒ–ï¼Ÿ</span></h3><p>å¯ä»¥å¥½å¥½åˆ©ç”¨Hash,list,sorted set,setç­‰é›†åˆç±»å‹æ•°æ®ï¼Œå› ä¸ºé€šå¸¸æƒ…å†µä¸‹å¾ˆå¤šå°çš„Key-Valueå¯ä»¥ç”¨æ›´ç´§å‡‘çš„æ–¹å¼å­˜æ”¾åˆ°ä¸€èµ·ã€‚å°½å¯èƒ½ä½¿ç”¨æ•£åˆ—è¡¨ï¼ˆhashesï¼‰ï¼Œæ•£åˆ—è¡¨ï¼ˆæ˜¯è¯´æ•£åˆ—è¡¨é‡Œé¢å­˜å‚¨çš„æ•°å°‘ï¼‰ä½¿ç”¨çš„å†…å­˜éå¸¸å°ï¼Œæ‰€ä»¥ä½ åº”è¯¥å°½å¯èƒ½çš„å°†ä½ çš„æ•°æ®æ¨¡å‹æŠ½è±¡åˆ°ä¸€ä¸ªæ•£åˆ—è¡¨é‡Œé¢ã€‚æ¯”å¦‚ä½ çš„webç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªç”¨æˆ·å¯¹è±¡ï¼Œä¸è¦ä¸ºè¿™ä¸ªç”¨æˆ·çš„åç§°ï¼Œå§“æ°ï¼Œé‚®ç®±ï¼Œå¯†ç è®¾ç½®å•ç‹¬çš„keyï¼Œè€Œæ˜¯åº”è¯¥æŠŠè¿™ä¸ªç”¨æˆ·çš„æ‰€æœ‰ä¿¡æ¯å­˜å‚¨åˆ°ä¸€å¼ æ•£åˆ—è¡¨é‡Œé¢</p><h2><span id="çº¿ç¨‹æ¨¡å‹">çº¿ç¨‹æ¨¡å‹</span></h2><h3><span id="redisçº¿ç¨‹æ¨¡å‹">Redisçº¿ç¨‹æ¨¡å‹</span></h3><p>RedisåŸºäºReactoræ¨¡å¼å¼€å‘äº†ç½‘ç»œäº‹ä»¶å¤„ç†å™¨ï¼Œè¿™ä¸ªå¤„ç†å™¨è¢«ç§°ä¸ºæ–‡ä»¶äº‹ä»¶å¤„ç†å™¨ï¼ˆfile event handlerï¼‰ã€‚å®ƒçš„ç»„æˆç»“æ„ä¸º4éƒ¨åˆ†ï¼šå¤šä¸ªå¥—æ¥å­—ã€IOå¤šè·¯å¤ç”¨ç¨‹åºã€æ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ã€äº‹ä»¶å¤„ç†å™¨ã€‚å› ä¸ºæ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨é˜Ÿåˆ—çš„æ¶ˆè´¹æ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥Redisæ‰å«å•çº¿ç¨‹æ¨¡å‹ã€‚</p><ul><li>æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨ä½¿ç”¨ I&#x2F;O å¤šè·¯å¤ç”¨ï¼ˆmultiplexingï¼‰ç¨‹åºæ¥åŒæ—¶ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œ å¹¶æ ¹æ®å¥—æ¥å­—ç›®å‰æ‰§è¡Œçš„ä»»åŠ¡æ¥ä¸ºå¥—æ¥å­—å…³è”ä¸åŒçš„äº‹ä»¶å¤„ç†å™¨ã€‚</li><li>å½“è¢«ç›‘å¬çš„å¥—æ¥å­—å‡†å¤‡å¥½æ‰§è¡Œè¿æ¥åº”ç­”ï¼ˆacceptï¼‰ã€è¯»å–ï¼ˆreadï¼‰ã€å†™å…¥ï¼ˆwriteï¼‰ã€å…³é—­ï¼ˆcloseï¼‰ç­‰æ“ä½œæ—¶ï¼Œ ä¸æ“ä½œç›¸å¯¹åº”çš„æ–‡ä»¶äº‹ä»¶å°±ä¼šäº§ç”Ÿï¼Œ è¿™æ—¶æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨å°±ä¼šè°ƒç”¨å¥—æ¥å­—ä¹‹å‰å…³è”å¥½çš„äº‹ä»¶å¤„ç†å™¨æ¥å¤„ç†è¿™äº›äº‹ä»¶ã€‚</li></ul><p>è™½ç„¶æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨ä»¥å•çº¿ç¨‹æ–¹å¼è¿è¡Œï¼Œ ä½†é€šè¿‡ä½¿ç”¨ I&#x2F;O å¤šè·¯å¤ç”¨ç¨‹åºæ¥ç›‘å¬å¤šä¸ªå¥—æ¥å­—ï¼Œ æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨æ—¢å®ç°äº†é«˜æ€§èƒ½çš„ç½‘ç»œé€šä¿¡æ¨¡å‹ï¼Œ åˆå¯ä»¥å¾ˆå¥½åœ°ä¸ redis æœåŠ¡å™¨ä¸­å…¶ä»–åŒæ ·ä»¥å•çº¿ç¨‹æ–¹å¼è¿è¡Œçš„æ¨¡å—è¿›è¡Œå¯¹æ¥ï¼Œ è¿™ä¿æŒäº† Redis å†…éƒ¨å•çº¿ç¨‹è®¾è®¡çš„ç®€å•æ€§ã€‚</p><h2><span id="äº‹åŠ¡">äº‹åŠ¡</span></h2><h3><span id="ä»€ä¹ˆæ˜¯äº‹åŠ¡">ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ</span></h3><p>äº‹åŠ¡æ˜¯ä¸€ä¸ªå•ç‹¬çš„éš”ç¦»æ“ä½œï¼šäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šåºåˆ—åŒ–ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œã€‚äº‹åŠ¡åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘é€æ¥çš„å‘½ä»¤è¯·æ±‚æ‰€æ‰“æ–­ã€‚</p><p>äº‹åŠ¡æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼šäº‹åŠ¡ä¸­çš„å‘½ä»¤è¦ä¹ˆå…¨éƒ¨è¢«æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨éƒ½ä¸æ‰§è¡Œã€‚</p><h3><span id="redisäº‹åŠ¡çš„æ¦‚å¿µ">Redisäº‹åŠ¡çš„æ¦‚å¿µ</span></h3><p>Redis äº‹åŠ¡çš„æœ¬è´¨æ˜¯é€šè¿‡MULTIã€EXECã€WATCHç­‰ä¸€ç»„å‘½ä»¤çš„é›†åˆã€‚äº‹åŠ¡æ”¯æŒä¸€æ¬¡æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸­æ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¢«åºåˆ—åŒ–ã€‚åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ï¼Œä¼šæŒ‰ç…§é¡ºåºä¸²è¡ŒåŒ–æ‰§è¡Œé˜Ÿåˆ—ä¸­çš„å‘½ä»¤ï¼Œå…¶ä»–å®¢æˆ·ç«¯æäº¤çš„å‘½ä»¤è¯·æ±‚ä¸ä¼šæ’å…¥åˆ°äº‹åŠ¡æ‰§è¡Œå‘½ä»¤åºåˆ—ä¸­ã€‚</p><p>æ€»ç»“è¯´ï¼šredisäº‹åŠ¡å°±æ˜¯ä¸€æ¬¡æ€§ã€é¡ºåºæ€§ã€æ’ä»–æ€§çš„æ‰§è¡Œä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„ä¸€ç³»åˆ—å‘½ä»¤ã€‚</p><p>æœç´¢å…¬ä¼—å· Javaé¢è¯•é¢˜ç²¾é€‰ï¼Œå›å¤â€œé¢è¯•èµ„æ–™â€ï¼Œé€ä½ ä¸€ä»½Javaé¢è¯•å®å…¸.pdf</p><h3><span id="redisäº‹åŠ¡çš„ä¸‰ä¸ªé˜¶æ®µ">Redisäº‹åŠ¡çš„ä¸‰ä¸ªé˜¶æ®µ</span></h3><ol><li>äº‹åŠ¡å¼€å§‹ MULTI</li><li>å‘½ä»¤å…¥é˜Ÿ</li><li>äº‹åŠ¡æ‰§è¡Œ EXEC</li></ol><p>äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœåŠ¡ç«¯æ”¶åˆ°æœ‰EXECã€DISCARDã€WATCHã€MULTIä¹‹å¤–çš„è¯·æ±‚ï¼Œå°†ä¼šæŠŠè¯·æ±‚æ”¾å…¥é˜Ÿåˆ—ä¸­æ’</p><h3><span id="äº‹åŠ¡ç®¡ç†acidæ¦‚è¿°">äº‹åŠ¡ç®¡ç†ï¼ˆACIDï¼‰æ¦‚è¿°</span></h3><ul><li>åŸå­æ€§ï¼ˆAtomicityï¼‰</li></ul><p>åŸå­æ€§æ˜¯æŒ‡äº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆéƒ½å‘ç”Ÿï¼Œè¦ä¹ˆéƒ½ä¸å‘ç”Ÿã€‚</p><ul><li>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰</li></ul><p>äº‹åŠ¡å‰åæ•°æ®çš„å®Œæ•´æ€§å¿…é¡»ä¿æŒä¸€è‡´ã€‚</p><ul><li>éš”ç¦»æ€§ï¼ˆIsolationï¼‰</li></ul><p>å¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶ï¼Œä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸åº”å½±å“å…¶ä»–äº‹åŠ¡çš„æ‰§è¡Œ</p><ul><li>æŒä¹…æ€§ï¼ˆDurabilityï¼‰</li></ul><p>æŒä¹…æ€§æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦è¢«æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼Œæ¥ä¸‹æ¥å³ä½¿æ•°æ®åº“å‘ç”Ÿæ•…éšœä¹Ÿä¸åº”è¯¥å¯¹å…¶æœ‰ä»»ä½•å½±å“</p><p>Redisçš„äº‹åŠ¡æ€»æ˜¯å…·æœ‰ACIDä¸­çš„ä¸€è‡´æ€§å’Œéš”ç¦»æ€§ï¼Œå…¶ä»–ç‰¹æ€§æ˜¯ä¸æ”¯æŒçš„ã€‚å½“æœåŠ¡å™¨è¿è¡Œåœ¨_AOF_æŒä¹…åŒ–æ¨¡å¼ä¸‹ï¼Œå¹¶ä¸”appendfsyncé€‰é¡¹çš„å€¼ä¸ºalwaysæ—¶ï¼Œäº‹åŠ¡ä¹Ÿå…·æœ‰è€ä¹…æ€§ã€‚</p><h3><span id="redisäº‹åŠ¡æ”¯æŒéš”ç¦»æ€§å—">Redisäº‹åŠ¡æ”¯æŒéš”ç¦»æ€§å—</span></h3><p>Redis æ˜¯å•è¿›ç¨‹ç¨‹åºï¼Œå¹¶ä¸”å®ƒä¿è¯åœ¨æ‰§è¡Œäº‹åŠ¡æ—¶ï¼Œä¸ä¼šå¯¹äº‹åŠ¡è¿›è¡Œä¸­æ–­ï¼Œäº‹åŠ¡å¯ä»¥è¿è¡Œç›´åˆ°æ‰§è¡Œå®Œæ‰€æœ‰äº‹åŠ¡é˜Ÿåˆ—ä¸­çš„å‘½ä»¤ä¸ºæ­¢ã€‚å› æ­¤ï¼ŒRedis çš„äº‹åŠ¡æ˜¯æ€»æ˜¯å¸¦æœ‰éš”ç¦»æ€§çš„ã€‚</p><h3><span id="redisäº‹åŠ¡ä¿è¯åŸå­æ€§å—æ”¯æŒå›æ»šå—">Redisäº‹åŠ¡ä¿è¯åŸå­æ€§å—ï¼Œæ”¯æŒå›æ»šå—</span></h3><p>Redisä¸­ï¼Œå•æ¡å‘½ä»¤æ˜¯åŸå­æ€§æ‰§è¡Œçš„ï¼Œä½†äº‹åŠ¡ä¸ä¿è¯åŸå­æ€§ï¼Œä¸”æ²¡æœ‰å›æ»šã€‚äº‹åŠ¡ä¸­ä»»æ„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå…¶ä½™çš„å‘½ä»¤ä»ä¼šè¢«æ‰§è¡Œã€‚</p><h3><span id="redisäº‹åŠ¡å…¶ä»–å®ç°">Redisäº‹åŠ¡å…¶ä»–å®ç°</span></h3><ul><li>åŸºäºLuaè„šæœ¬ï¼ŒRediså¯ä»¥ä¿è¯è„šæœ¬å†…çš„å‘½ä»¤ä¸€æ¬¡æ€§ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œï¼Œ<br>å…¶åŒæ—¶ä¹Ÿä¸æä¾›äº‹åŠ¡è¿è¡Œé”™è¯¯çš„å›æ»šï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­å¦‚æœéƒ¨åˆ†å‘½ä»¤è¿è¡Œé”™è¯¯ï¼Œå‰©ä¸‹çš„å‘½ä»¤è¿˜æ˜¯ä¼šç»§ç»­è¿è¡Œå®Œ</li><li>åŸºäºä¸­é—´æ ‡è®°å˜é‡ï¼Œé€šè¿‡å¦å¤–çš„æ ‡è®°å˜é‡æ¥æ ‡è¯†äº‹åŠ¡æ˜¯å¦æ‰§è¡Œå®Œæˆï¼Œè¯»å–æ•°æ®æ—¶å…ˆè¯»å–è¯¥æ ‡è®°å˜é‡åˆ¤æ–­æ˜¯å¦äº‹åŠ¡æ‰§è¡Œå®Œæˆã€‚ä½†è¿™æ ·ä¼šéœ€è¦é¢å¤–å†™ä»£ç å®ç°ï¼Œæ¯”è¾ƒç¹ç</li></ul><h2><span id="é›†ç¾¤æ–¹æ¡ˆ">é›†ç¾¤æ–¹æ¡ˆ</span></h2><h3><span id="å“¨å…µæ¨¡å¼">å“¨å…µæ¨¡å¼</span></h3><p><img src="https://www.javazhiyin.com/wp-content/uploads/2020/10/java7-1602932968.png" alt="Redis å¸¸è§é¢è¯•é¢˜ï¼ˆ2020æœ€æ–°ç‰ˆï¼‰"></p><p>å“¨å…µçš„ä»‹ç»</p><p>sentinelï¼Œä¸­æ–‡åæ˜¯å“¨å…µã€‚å“¨å…µæ˜¯ redis é›†ç¾¤æœºæ„ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªç»„ä»¶ï¼Œä¸»è¦æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li>é›†ç¾¤ç›‘æ§ï¼šè´Ÿè´£ç›‘æ§ redis master å’Œ slave è¿›ç¨‹æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</li><li>æ¶ˆæ¯é€šçŸ¥ï¼šå¦‚æœæŸä¸ª redis å®ä¾‹æœ‰æ•…éšœï¼Œé‚£ä¹ˆå“¨å…µè´Ÿè´£å‘é€æ¶ˆæ¯ä½œä¸ºæŠ¥è­¦é€šçŸ¥ç»™ç®¡ç†å‘˜ã€‚</li><li>æ•…éšœè½¬ç§»ï¼šå¦‚æœ master node æŒ‚æ‰äº†ï¼Œä¼šè‡ªåŠ¨è½¬ç§»åˆ° slave node ä¸Šã€‚</li><li>é…ç½®ä¸­å¿ƒï¼šå¦‚æœæ•…éšœè½¬ç§»å‘ç”Ÿäº†ï¼Œé€šçŸ¥ client å®¢æˆ·ç«¯æ–°çš„ master åœ°å€ã€‚</li></ul><p>å“¨å…µç”¨äºå®ç° redis é›†ç¾¤çš„é«˜å¯ç”¨ï¼Œæœ¬èº«ä¹Ÿæ˜¯åˆ†å¸ƒå¼çš„ï¼Œä½œä¸ºä¸€ä¸ªå“¨å…µé›†ç¾¤å»è¿è¡Œï¼Œäº’ç›¸ååŒå·¥ä½œã€‚</p><ul><li>æ•…éšœè½¬ç§»æ—¶ï¼Œåˆ¤æ–­ä¸€ä¸ª master node æ˜¯å¦å®•æœºäº†ï¼Œéœ€è¦å¤§éƒ¨åˆ†çš„å“¨å…µéƒ½åŒæ„æ‰è¡Œï¼Œæ¶‰åŠåˆ°äº†åˆ†å¸ƒå¼é€‰ä¸¾çš„é—®é¢˜ã€‚</li><li>å³ä½¿éƒ¨åˆ†å“¨å…µèŠ‚ç‚¹æŒ‚æ‰äº†ï¼Œå“¨å…µé›†ç¾¤è¿˜æ˜¯èƒ½æ­£å¸¸å·¥ä½œçš„ï¼Œå› ä¸ºå¦‚æœä¸€ä¸ªä½œä¸ºé«˜å¯ç”¨æœºåˆ¶é‡è¦ç»„æˆéƒ¨åˆ†çš„æ•…éšœè½¬ç§»ç³»ç»Ÿæœ¬èº«æ˜¯å•ç‚¹çš„ï¼Œé‚£å°±å¾ˆå‘çˆ¹äº†ã€‚</li></ul><p>å“¨å…µçš„æ ¸å¿ƒçŸ¥è¯†</p><ul><li>å“¨å…µè‡³å°‘éœ€è¦ 3 ä¸ªå®ä¾‹ï¼Œæ¥ä¿è¯è‡ªå·±çš„å¥å£®æ€§ã€‚</li><li>å“¨å…µ + redis ä¸»ä»çš„éƒ¨ç½²æ¶æ„ï¼Œæ˜¯ä¸ä¿è¯æ•°æ®é›¶ä¸¢å¤±çš„ï¼Œåªèƒ½ä¿è¯ redis é›†ç¾¤çš„é«˜å¯ç”¨æ€§ã€‚</li><li>å¯¹äºå“¨å…µ + redis ä¸»ä»è¿™ç§å¤æ‚çš„éƒ¨ç½²æ¶æ„ï¼Œå°½é‡åœ¨æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒï¼Œéƒ½è¿›è¡Œå……è¶³çš„æµ‹è¯•å’Œæ¼”ç»ƒã€‚</li></ul><h3><span id="å®˜æ–¹redis-cluster-æ–¹æ¡ˆæœåŠ¡ç«¯è·¯ç”±æŸ¥è¯¢">å®˜æ–¹Redis Cluster æ–¹æ¡ˆ(æœåŠ¡ç«¯è·¯ç”±æŸ¥è¯¢)</span></h3><p><img src="https://www.javazhiyin.com/wp-content/uploads/2020/10/java9-1602932968.png" alt="Redis å¸¸è§é¢è¯•é¢˜ï¼ˆ2020æœ€æ–°ç‰ˆï¼‰"></p><p>redis é›†ç¾¤æ¨¡å¼çš„å·¥ä½œåŸç†èƒ½è¯´ä¸€ä¸‹ä¹ˆï¼Ÿåœ¨é›†ç¾¤æ¨¡å¼ä¸‹ï¼Œredis çš„ key æ˜¯å¦‚ä½•å¯»å€çš„ï¼Ÿåˆ†å¸ƒå¼å¯»å€éƒ½æœ‰å“ªäº›ç®—æ³•ï¼Ÿäº†è§£ä¸€è‡´æ€§ hash ç®—æ³•å—ï¼Ÿ</p><p><strong>ç®€ä»‹</strong></p><p>Redis Clusteræ˜¯ä¸€ç§æœåŠ¡ç«¯ShardingæŠ€æœ¯ï¼Œ3.0ç‰ˆæœ¬å¼€å§‹æ­£å¼æä¾›ã€‚Redis Clusterå¹¶æ²¡æœ‰ä½¿ç”¨ä¸€è‡´æ€§hashï¼Œè€Œæ˜¯é‡‡ç”¨slot(æ§½)çš„æ¦‚å¿µï¼Œä¸€å…±åˆ†æˆ16384ä¸ªæ§½ã€‚å°†è¯·æ±‚å‘é€åˆ°ä»»æ„èŠ‚ç‚¹ï¼Œæ¥æ”¶åˆ°è¯·æ±‚çš„èŠ‚ç‚¹ä¼šå°†æŸ¥è¯¢è¯·æ±‚å‘é€åˆ°æ­£ç¡®çš„èŠ‚ç‚¹ä¸Šæ‰§è¡Œ</p><p><strong>æ–¹æ¡ˆè¯´æ˜</strong></p><ol><li>é€šè¿‡å“ˆå¸Œçš„æ–¹å¼ï¼Œå°†æ•°æ®åˆ†ç‰‡ï¼Œæ¯ä¸ªèŠ‚ç‚¹å‡åˆ†å­˜å‚¨ä¸€å®šå“ˆå¸Œæ§½(å“ˆå¸Œå€¼)åŒºé—´çš„æ•°æ®ï¼Œé»˜è®¤åˆ†é…äº†16384 ä¸ªæ§½ä½</li><li>æ¯ä»½æ•°æ®åˆ†ç‰‡ä¼šå­˜å‚¨åœ¨å¤šä¸ªäº’ä¸ºä¸»ä»çš„å¤šèŠ‚ç‚¹ä¸Š</li><li>æ•°æ®å†™å…¥å…ˆå†™ä¸»èŠ‚ç‚¹ï¼Œå†åŒæ­¥åˆ°ä»èŠ‚ç‚¹(æ”¯æŒé…ç½®ä¸ºé˜»å¡åŒæ­¥)</li><li>åŒä¸€åˆ†ç‰‡å¤šä¸ªèŠ‚ç‚¹é—´çš„æ•°æ®ä¸ä¿æŒä¸€è‡´æ€§</li><li>è¯»å–æ•°æ®æ—¶ï¼Œå½“å®¢æˆ·ç«¯æ“ä½œçš„keyæ²¡æœ‰åˆ†é…åœ¨è¯¥èŠ‚ç‚¹ä¸Šæ—¶ï¼Œredisä¼šè¿”å›è½¬å‘æŒ‡ä»¤ï¼ŒæŒ‡å‘æ­£ç¡®çš„èŠ‚ç‚¹</li><li>æ‰©å®¹æ—¶æ—¶éœ€è¦éœ€è¦æŠŠæ—§èŠ‚ç‚¹çš„æ•°æ®è¿ç§»ä¸€éƒ¨åˆ†åˆ°æ–°èŠ‚ç‚¹</li></ol><p>åœ¨ redis cluster æ¶æ„ä¸‹ï¼Œæ¯ä¸ª redis è¦æ”¾å¼€ä¸¤ä¸ªç«¯å£å·ï¼Œæ¯”å¦‚ä¸€ä¸ªæ˜¯ 6379ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯ åŠ 1w çš„ç«¯å£å·ï¼Œæ¯”å¦‚ 16379ã€‚</p><p>16379 ç«¯å£å·æ˜¯ç”¨æ¥è¿›è¡ŒèŠ‚ç‚¹é—´é€šä¿¡çš„ï¼Œä¹Ÿå°±æ˜¯ cluster bus çš„ä¸œè¥¿ï¼Œcluster bus çš„é€šä¿¡ï¼Œç”¨æ¥è¿›è¡Œæ•…éšœæ£€æµ‹ã€é…ç½®æ›´æ–°ã€æ•…éšœè½¬ç§»æˆæƒã€‚cluster bus ç”¨äº†å¦å¤–ä¸€ç§äºŒè¿›åˆ¶çš„åè®®ï¼Œ<code>gossip</code> åè®®ï¼Œç”¨äºèŠ‚ç‚¹é—´è¿›è¡Œé«˜æ•ˆçš„æ•°æ®äº¤æ¢ï¼Œå ç”¨æ›´å°‘çš„ç½‘ç»œå¸¦å®½å’Œå¤„ç†æ—¶é—´ã€‚</p><p>èŠ‚ç‚¹é—´çš„å†…éƒ¨é€šä¿¡æœºåˆ¶</p><p>åŸºæœ¬é€šä¿¡åŸç†</p><p>é›†ç¾¤å…ƒæ•°æ®çš„ç»´æŠ¤æœ‰ä¸¤ç§æ–¹å¼ï¼šé›†ä¸­å¼ã€Gossip åè®®ã€‚redis cluster èŠ‚ç‚¹é—´é‡‡ç”¨ gossip åè®®è¿›è¡Œé€šä¿¡ã€‚</p><p>åˆ†å¸ƒå¼å¯»å€ç®—æ³•</p><ul><li>hash ç®—æ³•ï¼ˆå¤§é‡ç¼“å­˜é‡å»ºï¼‰</li><li>ä¸€è‡´æ€§ hash ç®—æ³•ï¼ˆè‡ªåŠ¨ç¼“å­˜è¿ç§»ï¼‰+ è™šæ‹ŸèŠ‚ç‚¹ï¼ˆè‡ªåŠ¨è´Ÿè½½å‡è¡¡ï¼‰</li><li>redis cluster çš„ hash slot ç®—æ³•</li></ul><p>ä¼˜ç‚¹</p><ul><li>æ— ä¸­å¿ƒæ¶æ„ï¼Œæ”¯æŒåŠ¨æ€æ‰©å®¹ï¼Œå¯¹ä¸šåŠ¡é€æ˜</li><li>å…·å¤‡Sentinelçš„ç›‘æ§å’Œè‡ªåŠ¨Failover(æ•…éšœè½¬ç§»)èƒ½åŠ›</li><li>å®¢æˆ·ç«¯ä¸éœ€è¦è¿æ¥é›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹ï¼Œè¿æ¥é›†ç¾¤ä¸­ä»»ä½•ä¸€ä¸ªå¯ç”¨èŠ‚ç‚¹å³å¯</li><li>é«˜æ€§èƒ½ï¼Œå®¢æˆ·ç«¯ç›´è¿redisæœåŠ¡ï¼Œå…å»äº†proxyä»£ç†çš„æŸè€—</li></ul><p>ç¼ºç‚¹</p><ul><li>è¿ç»´ä¹Ÿå¾ˆå¤æ‚ï¼Œæ•°æ®è¿ç§»éœ€è¦äººå·¥å¹²é¢„</li><li>åªèƒ½ä½¿ç”¨0å·æ•°æ®åº“</li><li>ä¸æ”¯æŒæ‰¹é‡æ“ä½œ(pipelineç®¡é“æ“ä½œ)</li><li>åˆ†å¸ƒå¼é€»è¾‘å’Œå­˜å‚¨æ¨¡å—è€¦åˆç­‰</li></ul><h3><span id="åŸºäºå®¢æˆ·ç«¯åˆ†é…">åŸºäºå®¢æˆ·ç«¯åˆ†é…</span></h3><p><img src="https://www.javazhiyin.com/wp-content/uploads/2020/10/java0-1602932968.jpeg" alt="Redis å¸¸è§é¢è¯•é¢˜ï¼ˆ2020æœ€æ–°ç‰ˆï¼‰"></p><p><strong>ç®€ä»‹</strong></p><p>Redis Shardingæ˜¯Redis Clusterå‡ºæ¥ä¹‹å‰ï¼Œä¸šç•Œæ™®éä½¿ç”¨çš„å¤šRediså®ä¾‹é›†ç¾¤æ–¹æ³•ã€‚å…¶ä¸»è¦æ€æƒ³æ˜¯é‡‡ç”¨å“ˆå¸Œç®—æ³•å°†Redisæ•°æ®çš„keyè¿›è¡Œæ•£åˆ—ï¼Œé€šè¿‡hashå‡½æ•°ï¼Œç‰¹å®šçš„keyä¼šæ˜ å°„åˆ°ç‰¹å®šçš„RedisèŠ‚ç‚¹ä¸Šã€‚Java rediså®¢æˆ·ç«¯é©±åŠ¨jedisï¼Œæ”¯æŒRedis ShardingåŠŸèƒ½ï¼Œå³ShardedJedisä»¥åŠç»“åˆç¼“å­˜æ± çš„ShardedJedisPool</p><p>ä¼˜ç‚¹</p><ul><li>ä¼˜åŠ¿åœ¨äºéå¸¸ç®€å•ï¼ŒæœåŠ¡ç«¯çš„Rediså®ä¾‹å½¼æ­¤ç‹¬ç«‹ï¼Œç›¸äº’æ— å…³è”ï¼Œæ¯ä¸ªRediså®ä¾‹åƒå•æœåŠ¡å™¨ä¸€æ ·è¿è¡Œï¼Œéå¸¸å®¹æ˜“çº¿æ€§æ‰©å±•ï¼Œç³»ç»Ÿçš„çµæ´»æ€§å¾ˆå¼º</li></ul><p>ç¼ºç‚¹</p><ul><li>ç”±äºshardingå¤„ç†æ”¾åˆ°å®¢æˆ·ç«¯ï¼Œè§„æ¨¡è¿›ä¸€æ­¥æ‰©å¤§æ—¶ç»™è¿ç»´å¸¦æ¥æŒ‘æˆ˜ã€‚</li><li>å®¢æˆ·ç«¯shardingä¸æ”¯æŒåŠ¨æ€å¢åˆ èŠ‚ç‚¹ã€‚æœåŠ¡ç«¯Rediså®ä¾‹ç¾¤æ‹“æ‰‘ç»“æ„æœ‰å˜åŒ–æ—¶ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯éƒ½éœ€è¦æ›´æ–°è°ƒæ•´ã€‚è¿æ¥ä¸èƒ½å…±äº«ï¼Œå½“åº”ç”¨è§„æ¨¡å¢å¤§æ—¶ï¼Œèµ„æºæµªè´¹åˆ¶çº¦ä¼˜åŒ–</li></ul><h3><span id="åŸºäºä»£ç†æœåŠ¡å™¨åˆ†ç‰‡">åŸºäºä»£ç†æœåŠ¡å™¨åˆ†ç‰‡</span></h3><p><img src="https://www.javazhiyin.com/wp-content/uploads/2020/10/java5-1602932968.jpeg" alt="Redis å¸¸è§é¢è¯•é¢˜ï¼ˆ2020æœ€æ–°ç‰ˆï¼‰"></p><p><strong>ç®€ä»‹</strong></p><p>å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ°ä¸€ä¸ªä»£ç†ç»„ä»¶ï¼Œä»£ç†è§£æå®¢æˆ·ç«¯çš„æ•°æ®ï¼Œå¹¶å°†è¯·æ±‚è½¬å‘è‡³æ­£ç¡®çš„èŠ‚ç‚¹ï¼Œæœ€åå°†ç»“æœå›å¤ç»™å®¢æˆ·ç«¯</p><p><strong>ç‰¹å¾</strong></p><ul><li>é€æ˜æ¥å…¥ï¼Œä¸šåŠ¡ç¨‹åºä¸ç”¨å…³å¿ƒåç«¯Rediså®ä¾‹ï¼Œåˆ‡æ¢æˆæœ¬ä½</li><li>Proxy çš„é€»è¾‘å’Œå­˜å‚¨çš„é€»è¾‘æ˜¯éš”ç¦»çš„</li><li>ä»£ç†å±‚å¤šäº†ä¸€æ¬¡è½¬å‘ï¼Œæ€§èƒ½æœ‰æ‰€æŸè€—</li></ul><p><strong>ä¸šç•Œå¼€æºæ–¹æ¡ˆ</strong></p><ul><li>Twtterå¼€æºçš„Twemproxy</li><li>è±Œè±†èšå¼€æºçš„Codis</li></ul><h3><span id="redis-ä¸»ä»æ¶æ„">Redis ä¸»ä»æ¶æ„</span></h3><p>å•æœºçš„ redisï¼Œèƒ½å¤Ÿæ‰¿è½½çš„ QPS å¤§æ¦‚å°±åœ¨ä¸Šä¸‡åˆ°å‡ ä¸‡ä¸ç­‰ã€‚å¯¹äºç¼“å­˜æ¥è¯´ï¼Œä¸€èˆ¬éƒ½æ˜¯ç”¨æ¥æ”¯æ’‘è¯»é«˜å¹¶å‘çš„ã€‚å› æ­¤æ¶æ„åšæˆä¸»ä»(master-slave)æ¶æ„ï¼Œä¸€ä¸»å¤šä»ï¼Œä¸»è´Ÿè´£å†™ï¼Œå¹¶ä¸”å°†æ•°æ®å¤åˆ¶åˆ°å…¶å®ƒçš„ slave èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹è´Ÿè´£è¯»ã€‚æ‰€æœ‰çš„è¯»è¯·æ±‚å…¨éƒ¨èµ°ä»èŠ‚ç‚¹ã€‚è¿™æ ·ä¹Ÿå¯ä»¥å¾ˆè½»æ¾å®ç°æ°´å¹³æ‰©å®¹ï¼Œæ”¯æ’‘è¯»é«˜å¹¶å‘ã€‚</p><p><img src="https://www.javazhiyin.com/wp-content/uploads/2020/10/java1-1602932968.png" alt="Redis å¸¸è§é¢è¯•é¢˜ï¼ˆ2020æœ€æ–°ç‰ˆï¼‰">redis-master-slave</p><p>redis replication -&gt; ä¸»ä»æ¶æ„ -&gt; è¯»å†™åˆ†ç¦» -&gt; æ°´å¹³æ‰©å®¹æ”¯æ’‘è¯»é«˜å¹¶å‘</p><p>redis replication çš„æ ¸å¿ƒæœºåˆ¶</p><ul><li>redis é‡‡ç”¨å¼‚æ­¥æ–¹å¼å¤åˆ¶æ•°æ®åˆ° slave èŠ‚ç‚¹ï¼Œä¸è¿‡ redis2.8 å¼€å§‹ï¼Œslave node ä¼šå‘¨æœŸæ€§åœ°ç¡®è®¤è‡ªå·±æ¯æ¬¡å¤åˆ¶çš„æ•°æ®é‡ï¼›</li><li>ä¸€ä¸ª master node æ˜¯å¯ä»¥é…ç½®å¤šä¸ª slave node çš„ï¼›</li><li>slave node ä¹Ÿå¯ä»¥è¿æ¥å…¶ä»–çš„ slave nodeï¼›</li><li>slave node åšå¤åˆ¶çš„æ—¶å€™ï¼Œä¸ä¼š block master node çš„æ­£å¸¸å·¥ä½œï¼›</li><li>slave node åœ¨åšå¤åˆ¶çš„æ—¶å€™ï¼Œä¹Ÿä¸ä¼š block å¯¹è‡ªå·±çš„æŸ¥è¯¢æ“ä½œï¼Œå®ƒä¼šç”¨æ—§çš„æ•°æ®é›†æ¥æä¾›æœåŠ¡ï¼›ä½†æ˜¯å¤åˆ¶å®Œæˆçš„æ—¶å€™ï¼Œéœ€è¦åˆ é™¤æ—§æ•°æ®é›†ï¼ŒåŠ è½½æ–°æ•°æ®é›†ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šæš‚åœå¯¹å¤–æœåŠ¡äº†ï¼›</li><li>slave node ä¸»è¦ç”¨æ¥è¿›è¡Œæ¨ªå‘æ‰©å®¹ï¼Œåšè¯»å†™åˆ†ç¦»ï¼Œæ‰©å®¹çš„ slave node å¯ä»¥æé«˜è¯»çš„ååé‡ã€‚</li></ul><p>æ³¨æ„ï¼Œå¦‚æœé‡‡ç”¨äº†ä¸»ä»æ¶æ„ï¼Œé‚£ä¹ˆå»ºè®®å¿…é¡»å¼€å¯ master node çš„æŒä¹…åŒ–ï¼Œä¸å»ºè®®ç”¨ slave node ä½œä¸º master node çš„æ•°æ®çƒ­å¤‡ï¼Œå› ä¸ºé‚£æ ·çš„è¯ï¼Œå¦‚æœä½ å…³æ‰ master çš„æŒä¹…åŒ–ï¼Œå¯èƒ½åœ¨ master å®•æœºé‡å¯çš„æ—¶å€™æ•°æ®æ˜¯ç©ºçš„ï¼Œç„¶åå¯èƒ½ä¸€ç»è¿‡å¤åˆ¶ï¼Œ slave node çš„æ•°æ®ä¹Ÿä¸¢äº†ã€‚</p><p>å¦å¤–ï¼Œmaster çš„å„ç§å¤‡ä»½æ–¹æ¡ˆï¼Œä¹Ÿéœ€è¦åšã€‚ä¸‡ä¸€æœ¬åœ°çš„æ‰€æœ‰æ–‡ä»¶ä¸¢å¤±äº†ï¼Œä»å¤‡ä»½ä¸­æŒ‘é€‰ä¸€ä»½ rdb å»æ¢å¤ masterï¼Œè¿™æ ·æ‰èƒ½ç¡®ä¿å¯åŠ¨çš„æ—¶å€™ï¼Œæ˜¯æœ‰æ•°æ®çš„ï¼Œå³ä½¿é‡‡ç”¨äº†åç»­è®²è§£çš„é«˜å¯ç”¨æœºåˆ¶ï¼Œslave node å¯ä»¥è‡ªåŠ¨æ¥ç®¡ master nodeï¼Œä½†ä¹Ÿå¯èƒ½ sentinel è¿˜æ²¡æ£€æµ‹åˆ° master failureï¼Œmaster node å°±è‡ªåŠ¨é‡å¯äº†ï¼Œè¿˜æ˜¯å¯èƒ½å¯¼è‡´ä¸Šé¢æ‰€æœ‰çš„ slave node æ•°æ®è¢«æ¸…ç©ºã€‚</p><p>å¾€æœŸé¢è¯•é¢˜æ±‡æ€»ï¼š<a href="http://mp.weixin.qq.com/s?__biz=MzIyNDU2ODA4OQ==&mid=2247485351&idx=2&sn=214225ab4345f4d9c562900cb42a52ba&chksm=e80db1d1df7a38c741137246bf020a5f8970f74cd03530ccc4cb2258c1ced68e66e600e9e059&scene=21#wechat_redirect">001æœŸ~150æœŸæ±‡æ€»</a></p><h4><span id="redis-ä¸»ä»å¤åˆ¶çš„æ ¸å¿ƒåŸç†">redis ä¸»ä»å¤åˆ¶çš„æ ¸å¿ƒåŸç†</span></h4><p>å½“å¯åŠ¨ä¸€ä¸ª slave node çš„æ—¶å€™ï¼Œå®ƒä¼šå‘é€ä¸€ä¸ª <code>PSYNC</code> å‘½ä»¤ç»™ master nodeã€‚</p><p>å¦‚æœè¿™æ˜¯ slave node åˆæ¬¡è¿æ¥åˆ° master nodeï¼Œé‚£ä¹ˆä¼šè§¦å‘ä¸€æ¬¡ <code>full resynchronization</code> å…¨é‡å¤åˆ¶ã€‚æ­¤æ—¶ master ä¼šå¯åŠ¨ä¸€ä¸ªåå°çº¿ç¨‹ï¼Œå¼€å§‹ç”Ÿæˆä¸€ä»½ <code>RDB</code> å¿«ç…§æ–‡ä»¶ï¼Œ</p><p>åŒæ—¶è¿˜ä¼šå°†ä»å®¢æˆ·ç«¯ client æ–°æ”¶åˆ°çš„æ‰€æœ‰å†™å‘½ä»¤ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚<code>RDB</code> æ–‡ä»¶ç”Ÿæˆå®Œæ¯•åï¼Œ master ä¼šå°†è¿™ä¸ª <code>RDB</code> å‘é€ç»™ slaveï¼Œslave ä¼šå…ˆå†™å…¥æœ¬åœ°ç£ç›˜ï¼Œç„¶åå†ä»æœ¬åœ°ç£ç›˜åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œ</p><p>æ¥ç€ master ä¼šå°†å†…å­˜ä¸­ç¼“å­˜çš„å†™å‘½ä»¤å‘é€åˆ° slaveï¼Œslave ä¹Ÿä¼šåŒæ­¥è¿™äº›æ•°æ®ã€‚</p><p>slave node å¦‚æœè·Ÿ master node æœ‰ç½‘ç»œæ•…éšœï¼Œæ–­å¼€äº†è¿æ¥ï¼Œä¼šè‡ªåŠ¨é‡è¿ï¼Œè¿æ¥ä¹‹å master node ä»…ä¼šå¤åˆ¶ç»™ slave éƒ¨åˆ†ç¼ºå°‘çš„æ•°æ®ã€‚</p><p><img src="https://www.javazhiyin.com/wp-content/uploads/2020/10/java6-1602932968.png" alt="Redis å¸¸è§é¢è¯•é¢˜ï¼ˆ2020æœ€æ–°ç‰ˆï¼‰">redis-master-slave-replication</p><h4><span id="è¿‡ç¨‹åŸç†">è¿‡ç¨‹åŸç†</span></h4><ol><li>å½“ä»åº“å’Œä¸»åº“å»ºç«‹MSå…³ç³»åï¼Œä¼šå‘ä¸»æ•°æ®åº“å‘é€SYNCå‘½ä»¤</li><li>ä¸»åº“æ¥æ”¶åˆ°SYNCå‘½ä»¤åä¼šå¼€å§‹åœ¨åå°ä¿å­˜å¿«ç…§(RDBæŒä¹…åŒ–è¿‡ç¨‹)ï¼Œå¹¶å°†æœŸé—´æ¥æ”¶åˆ°çš„å†™å‘½ä»¤ç¼“å­˜èµ·æ¥</li><li>å½“å¿«ç…§å®Œæˆåï¼Œä¸»Redisä¼šå°†å¿«ç…§æ–‡ä»¶å’Œæ‰€æœ‰ç¼“å­˜çš„å†™å‘½ä»¤å‘é€ç»™ä»Redis</li><li>ä»Redisæ¥æ”¶åˆ°åï¼Œä¼šè½½å…¥å¿«ç…§æ–‡ä»¶å¹¶ä¸”æ‰§è¡Œæ”¶åˆ°çš„ç¼“å­˜çš„å‘½ä»¤</li><li>ä¹‹åï¼Œä¸»Redisæ¯å½“æ¥æ”¶åˆ°å†™å‘½ä»¤æ—¶å°±ä¼šå°†å‘½ä»¤å‘é€ä»Redisï¼Œä»è€Œä¿è¯æ•°æ®çš„ä¸€è‡´</li></ol><p>ç¼ºç‚¹</p><ul><li>æ‰€æœ‰çš„slaveèŠ‚ç‚¹æ•°æ®çš„å¤åˆ¶å’ŒåŒæ­¥éƒ½ç”±masterèŠ‚ç‚¹æ¥å¤„ç†ï¼Œä¼šç…§æˆmasterèŠ‚ç‚¹å‹åŠ›å¤ªå¤§ï¼Œä½¿ç”¨ä¸»ä»ä»ç»“æ„æ¥è§£å†³</li></ul><h3><span id="redisé›†ç¾¤çš„ä¸»ä»å¤åˆ¶æ¨¡å‹æ˜¯æ€æ ·çš„">Redisé›†ç¾¤çš„ä¸»ä»å¤åˆ¶æ¨¡å‹æ˜¯æ€æ ·çš„ï¼Ÿ</span></h3><p>ä¸ºäº†ä½¿åœ¨éƒ¨åˆ†èŠ‚ç‚¹å¤±è´¥æˆ–è€…å¤§éƒ¨åˆ†èŠ‚ç‚¹æ— æ³•é€šä¿¡çš„æƒ…å†µä¸‹é›†ç¾¤ä»ç„¶å¯ç”¨ï¼Œæ‰€ä»¥é›†ç¾¤ä½¿ç”¨äº†ä¸»ä»å¤åˆ¶æ¨¡å‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šæœ‰N-1ä¸ªå¤åˆ¶å“</p><h3><span id="ç”Ÿäº§ç¯å¢ƒä¸­çš„-redis-æ˜¯æ€ä¹ˆéƒ¨ç½²çš„">ç”Ÿäº§ç¯å¢ƒä¸­çš„ redis æ˜¯æ€ä¹ˆéƒ¨ç½²çš„ï¼Ÿ</span></h3><p>redis clusterï¼Œ10 å°æœºå™¨ï¼Œ5 å°æœºå™¨éƒ¨ç½²äº† redis ä¸»å®ä¾‹ï¼Œå¦å¤– 5 å°æœºå™¨éƒ¨ç½²äº† redis çš„ä»å®ä¾‹ï¼Œæ¯ä¸ªä¸»å®ä¾‹æŒ‚äº†ä¸€ä¸ªä»å®ä¾‹ï¼Œ5 ä¸ªèŠ‚ç‚¹å¯¹å¤–æä¾›è¯»å†™æœåŠ¡ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„è¯»å†™é«˜å³°qpså¯èƒ½å¯ä»¥è¾¾åˆ°æ¯ç§’ 5 ä¸‡ï¼Œ5 å°æœºå™¨æœ€å¤šæ˜¯ 25 ä¸‡è¯»å†™è¯·æ±‚&#x2F;sã€‚</p><p>æœºå™¨æ˜¯ä»€ä¹ˆé…ç½®ï¼Ÿ32G å†…å­˜+ 8 æ ¸ CPU + 1T ç£ç›˜ï¼Œä½†æ˜¯åˆ†é…ç»™ redis è¿›ç¨‹çš„æ˜¯10gå†…å­˜ï¼Œä¸€èˆ¬çº¿ä¸Šç”Ÿäº§ç¯å¢ƒï¼Œredis çš„å†…å­˜å°½é‡ä¸è¦è¶…è¿‡ 10gï¼Œè¶…è¿‡ 10g å¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚</p><p>5 å°æœºå™¨å¯¹å¤–æä¾›è¯»å†™ï¼Œä¸€å…±æœ‰ 50g å†…å­˜ã€‚</p><p>å› ä¸ºæ¯ä¸ªä¸»å®ä¾‹éƒ½æŒ‚äº†ä¸€ä¸ªä»å®ä¾‹ï¼Œæ‰€ä»¥æ˜¯é«˜å¯ç”¨çš„ï¼Œä»»ä½•ä¸€ä¸ªä¸»å®ä¾‹å®•æœºï¼Œéƒ½ä¼šè‡ªåŠ¨æ•…éšœè¿ç§»ï¼Œredis ä»å®ä¾‹ä¼šè‡ªåŠ¨å˜æˆä¸»å®ä¾‹ç»§ç»­æä¾›è¯»å†™æœåŠ¡ã€‚</p><p>ä½ å¾€å†…å­˜é‡Œå†™çš„æ˜¯ä»€ä¹ˆæ•°æ®ï¼Ÿæ¯æ¡æ•°æ®çš„å¤§å°æ˜¯å¤šå°‘ï¼Ÿå•†å“æ•°æ®ï¼Œæ¯æ¡æ•°æ®æ˜¯ 10kbã€‚100 æ¡æ•°æ®æ˜¯ 1mbï¼Œ10 ä¸‡æ¡æ•°æ®æ˜¯ 1gã€‚å¸¸é©»å†…å­˜çš„æ˜¯ 200 ä¸‡æ¡å•†å“æ•°æ®ï¼Œå ç”¨å†…å­˜æ˜¯ 20gï¼Œä»…ä»…ä¸åˆ°æ€»å†…å­˜çš„ 50%ã€‚ç›®å‰é«˜å³°æœŸæ¯ç§’å°±æ˜¯ 3500 å·¦å³çš„è¯·æ±‚é‡ã€‚</p><p>å…¶å®å¤§å‹çš„å…¬å¸ï¼Œä¼šæœ‰åŸºç¡€æ¶æ„çš„ team è´Ÿè´£ç¼“å­˜é›†ç¾¤çš„è¿ç»´ã€‚</p><h3><span id="è¯´è¯´rediså“ˆå¸Œæ§½çš„æ¦‚å¿µ">è¯´è¯´Rediså“ˆå¸Œæ§½çš„æ¦‚å¿µï¼Ÿ</span></h3><p>Redisé›†ç¾¤æ²¡æœ‰ä½¿ç”¨ä¸€è‡´æ€§hash,è€Œæ˜¯å¼•å…¥äº†å“ˆå¸Œæ§½çš„æ¦‚å¿µï¼ŒRedisé›†ç¾¤æœ‰16384ä¸ªå“ˆå¸Œæ§½ï¼Œæ¯ä¸ªkeyé€šè¿‡CRC16æ ¡éªŒåå¯¹16384å–æ¨¡æ¥å†³å®šæ”¾ç½®å“ªä¸ªæ§½ï¼Œé›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹è´Ÿè´£ä¸€éƒ¨åˆ†hashæ§½ã€‚</p><h3><span id="redisé›†ç¾¤ä¼šæœ‰å†™æ“ä½œä¸¢å¤±å—ä¸ºä»€ä¹ˆ">Redisé›†ç¾¤ä¼šæœ‰å†™æ“ä½œä¸¢å¤±å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</span></h3><p>Rediså¹¶ä¸èƒ½ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼Œè¿™æ„å‘³è¿™åœ¨å®é™…ä¸­é›†ç¾¤åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹å¯èƒ½ä¼šä¸¢å¤±å†™æ“ä½œã€‚</p><h3><span id="redisé›†ç¾¤ä¹‹é—´æ˜¯å¦‚ä½•å¤åˆ¶çš„">Redisé›†ç¾¤ä¹‹é—´æ˜¯å¦‚ä½•å¤åˆ¶çš„ï¼Ÿ</span></h3><p>å¼‚æ­¥å¤åˆ¶</p><h3><span id="redisé›†ç¾¤æœ€å¤§èŠ‚ç‚¹ä¸ªæ•°æ˜¯å¤šå°‘">Redisé›†ç¾¤æœ€å¤§èŠ‚ç‚¹ä¸ªæ•°æ˜¯å¤šå°‘ï¼Ÿ</span></h3><p>16384ä¸ª</p><h3><span id="redisé›†ç¾¤å¦‚ä½•é€‰æ‹©æ•°æ®åº“">Redisé›†ç¾¤å¦‚ä½•é€‰æ‹©æ•°æ®åº“ï¼Ÿ</span></h3><p>Redisé›†ç¾¤ç›®å‰æ— æ³•åšæ•°æ®åº“é€‰æ‹©ï¼Œé»˜è®¤åœ¨0æ•°æ®åº“ã€‚</p><h2><span id="åˆ†åŒº">åˆ†åŒº</span></h2><h3><span id="redisæ˜¯å•çº¿ç¨‹çš„å¦‚ä½•æé«˜å¤šæ ¸cpuçš„åˆ©ç”¨ç‡">Redisæ˜¯å•çº¿ç¨‹çš„ï¼Œå¦‚ä½•æé«˜å¤šæ ¸CPUçš„åˆ©ç”¨ç‡ï¼Ÿ</span></h3><p>å¯ä»¥åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨éƒ¨ç½²å¤šä¸ªRedisçš„å®ä¾‹ï¼Œå¹¶æŠŠä»–ä»¬å½“ä½œä¸åŒçš„æœåŠ¡å™¨æ¥ä½¿ç”¨ï¼Œåœ¨æŸäº›æ—¶å€™ï¼Œæ— è®ºå¦‚ä½•ä¸€ä¸ªæœåŠ¡å™¨æ˜¯ä¸å¤Ÿçš„ï¼Œ æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨å¤šä¸ªCPUï¼Œä½ å¯ä»¥è€ƒè™‘ä¸€ä¸‹åˆ†ç‰‡ï¼ˆshardï¼‰ã€‚</p><h3><span id="ä¸ºä»€ä¹ˆè¦åšredisåˆ†åŒº">ä¸ºä»€ä¹ˆè¦åšRedisåˆ†åŒºï¼Ÿ</span></h3><p>åˆ†åŒºå¯ä»¥è®©Redisç®¡ç†æ›´å¤§çš„å†…å­˜ï¼ŒRediså°†å¯ä»¥ä½¿ç”¨æ‰€æœ‰æœºå™¨çš„å†…å­˜ã€‚å¦‚æœæ²¡æœ‰åˆ†åŒºï¼Œä½ æœ€å¤šåªèƒ½ä½¿ç”¨ä¸€å°æœºå™¨çš„å†…å­˜ã€‚åˆ†åŒºä½¿Redisçš„è®¡ç®—èƒ½åŠ›é€šè¿‡ç®€å•åœ°å¢åŠ è®¡ç®—æœºå¾—åˆ°æˆå€æå‡ï¼ŒRedisçš„ç½‘ç»œå¸¦å®½ä¹Ÿä¼šéšç€è®¡ç®—æœºå’Œç½‘å¡çš„å¢åŠ è€Œæˆå€å¢é•¿ã€‚</p><h3><span id="ä½ çŸ¥é“æœ‰å“ªäº›redisåˆ†åŒºå®ç°æ–¹æ¡ˆ">ä½ çŸ¥é“æœ‰å“ªäº›Redisåˆ†åŒºå®ç°æ–¹æ¡ˆï¼Ÿ</span></h3><ul><li>å®¢æˆ·ç«¯åˆ†åŒºå°±æ˜¯åœ¨å®¢æˆ·ç«¯å°±å·²ç»å†³å®šæ•°æ®ä¼šè¢«å­˜å‚¨åˆ°å“ªä¸ªredisèŠ‚ç‚¹æˆ–è€…ä»å“ªä¸ªredisèŠ‚ç‚¹è¯»å–ã€‚å¤§å¤šæ•°å®¢æˆ·ç«¯å·²ç»å®ç°äº†å®¢æˆ·ç«¯åˆ†åŒºã€‚</li><li>ä»£ç†åˆ†åŒº æ„å‘³ç€å®¢æˆ·ç«¯å°†è¯·æ±‚å‘é€ç»™ä»£ç†ï¼Œç„¶åä»£ç†å†³å®šå»å“ªä¸ªèŠ‚ç‚¹å†™æ•°æ®æˆ–è€…è¯»æ•°æ®ã€‚ä»£ç†æ ¹æ®åˆ†åŒºè§„åˆ™å†³å®šè¯·æ±‚å“ªäº›Rediså®ä¾‹ï¼Œç„¶åæ ¹æ®Redisçš„å“åº”ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚rediså’Œmemcachedçš„ä¸€ç§ä»£ç†å®ç°å°±æ˜¯Twemproxy</li><li>æŸ¥è¯¢è·¯ç”±(Query routing) çš„æ„æ€æ˜¯å®¢æˆ·ç«¯éšæœºåœ°è¯·æ±‚ä»»æ„ä¸€ä¸ªrediså®ä¾‹ï¼Œç„¶åç”±Rediså°†è¯·æ±‚è½¬å‘ç»™æ­£ç¡®çš„RedisèŠ‚ç‚¹ã€‚Redis Clusterå®ç°äº†ä¸€ç§æ··åˆå½¢å¼çš„æŸ¥è¯¢è·¯ç”±ï¼Œä½†å¹¶ä¸æ˜¯ç›´æ¥å°†è¯·æ±‚ä»ä¸€ä¸ªredisèŠ‚ç‚¹è½¬å‘åˆ°å¦ä¸€ä¸ªredisèŠ‚ç‚¹ï¼Œè€Œæ˜¯åœ¨å®¢æˆ·ç«¯çš„å¸®åŠ©ä¸‹ç›´æ¥redirectedåˆ°æ­£ç¡®çš„redisèŠ‚ç‚¹ã€‚</li></ul><h3><span id="redisåˆ†åŒºæœ‰ä»€ä¹ˆç¼ºç‚¹">Redisåˆ†åŒºæœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ</span></h3><ul><li>æ¶‰åŠå¤šä¸ªkeyçš„æ“ä½œé€šå¸¸ä¸ä¼šè¢«æ”¯æŒã€‚ä¾‹å¦‚ä½ ä¸èƒ½å¯¹ä¸¤ä¸ªé›†åˆæ±‚äº¤é›†ï¼Œå› ä¸ºä»–ä»¬å¯èƒ½è¢«å­˜å‚¨åˆ°ä¸åŒçš„Rediså®ä¾‹ï¼ˆå®é™…ä¸Šè¿™ç§æƒ…å†µä¹Ÿæœ‰åŠæ³•ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥ä½¿ç”¨äº¤é›†æŒ‡ä»¤ï¼‰ã€‚</li><li>åŒæ—¶æ“ä½œå¤šä¸ªkey,åˆ™ä¸èƒ½ä½¿ç”¨Redisäº‹åŠ¡.</li><li>åˆ†åŒºä½¿ç”¨çš„ç²’åº¦æ˜¯keyï¼Œä¸èƒ½ä½¿ç”¨ä¸€ä¸ªéå¸¸é•¿çš„æ’åºkeyå­˜å‚¨ä¸€ä¸ªæ•°æ®é›†ï¼ˆThe partitioning granularity is the key, so it is not possible to shard a dataset with a single huge key like a very big sorted setï¼‰</li><li>å½“ä½¿ç”¨åˆ†åŒºçš„æ—¶å€™ï¼Œæ•°æ®å¤„ç†ä¼šéå¸¸å¤æ‚ï¼Œä¾‹å¦‚ä¸ºäº†å¤‡ä»½ä½ å¿…é¡»ä»ä¸åŒçš„Rediså®ä¾‹å’Œä¸»æœºåŒæ—¶æ”¶é›†RDB &#x2F; AOFæ–‡ä»¶ã€‚</li><li>åˆ†åŒºæ—¶åŠ¨æ€æ‰©å®¹æˆ–ç¼©å®¹å¯èƒ½éå¸¸å¤æ‚ã€‚Redisé›†ç¾¤åœ¨è¿è¡Œæ—¶å¢åŠ æˆ–è€…åˆ é™¤RedisèŠ‚ç‚¹ï¼Œèƒ½åšåˆ°æœ€å¤§ç¨‹åº¦å¯¹ç”¨æˆ·é€æ˜åœ°æ•°æ®å†å¹³è¡¡ï¼Œä½†å…¶ä»–ä¸€äº›å®¢æˆ·ç«¯åˆ†åŒºæˆ–è€…ä»£ç†åˆ†åŒºæ–¹æ³•åˆ™ä¸æ”¯æŒè¿™ç§ç‰¹æ€§ã€‚ç„¶è€Œï¼Œæœ‰ä¸€ç§é¢„åˆ†ç‰‡çš„æŠ€æœ¯ä¹Ÿå¯ä»¥è¾ƒå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</li></ul><h2><span id="åˆ†å¸ƒå¼é—®é¢˜">åˆ†å¸ƒå¼é—®é¢˜</span></h2><h3><span id="rediså®ç°åˆ†å¸ƒå¼é”">Rediså®ç°åˆ†å¸ƒå¼é”</span></h3><p>Redisä¸ºå•è¿›ç¨‹å•çº¿ç¨‹æ¨¡å¼ï¼Œé‡‡ç”¨é˜Ÿåˆ—æ¨¡å¼å°†å¹¶å‘è®¿é—®å˜æˆä¸²è¡Œè®¿é—®ï¼Œä¸”å¤šå®¢æˆ·ç«¯å¯¹Redisçš„è¿æ¥å¹¶ä¸å­˜åœ¨ç«äº‰å…³ç³»Redisä¸­å¯ä»¥ä½¿ç”¨SETNXå‘½ä»¤å®ç°åˆ†å¸ƒå¼é”ã€‚</p><p>å½“ä¸”ä»…å½“ key ä¸å­˜åœ¨ï¼Œå°† key çš„å€¼è®¾ä¸º valueã€‚è‹¥ç»™å®šçš„ key å·²ç»å­˜åœ¨ï¼Œåˆ™ SETNX ä¸åšä»»ä½•åŠ¨ä½œ</p><p>SETNX æ˜¯ã€SET if Not eXistsã€(å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ SET)çš„ç®€å†™ã€‚</p><p>è¿”å›å€¼ï¼šè®¾ç½®æˆåŠŸï¼Œè¿”å› 1 ã€‚è®¾ç½®å¤±è´¥ï¼Œè¿”å› 0 ã€‚</p><p><img src="https://www.javazhiyin.com/wp-content/uploads/2020/10/java10-1602932968.png" alt="Redis å¸¸è§é¢è¯•é¢˜ï¼ˆ2020æœ€æ–°ç‰ˆï¼‰">img</p><p>ä½¿ç”¨SETNXå®ŒæˆåŒæ­¥é”çš„æµç¨‹åŠäº‹é¡¹å¦‚ä¸‹ï¼š</p><p>ä½¿ç”¨SETNXå‘½ä»¤è·å–é”ï¼Œè‹¥è¿”å›0ï¼ˆkeyå·²å­˜åœ¨ï¼Œé”å·²å­˜åœ¨ï¼‰åˆ™è·å–å¤±è´¥ï¼Œåä¹‹è·å–æˆåŠŸ</p><p>ä¸ºäº†é˜²æ­¢è·å–é”åç¨‹åºå‡ºç°å¼‚å¸¸ï¼Œå¯¼è‡´å…¶ä»–çº¿ç¨‹&#x2F;è¿›ç¨‹è°ƒç”¨SETNXå‘½ä»¤æ€»æ˜¯è¿”å›0è€Œè¿›å…¥æ­»é”çŠ¶æ€ï¼Œéœ€è¦ä¸ºè¯¥keyè®¾ç½®ä¸€ä¸ªâ€œåˆç†â€çš„è¿‡æœŸæ—¶é—´</p><p>é‡Šæ”¾é”ï¼Œä½¿ç”¨DELå‘½ä»¤å°†é”æ•°æ®åˆ é™¤</p><h3><span id="å¦‚ä½•è§£å†³-redis-çš„å¹¶å‘ç«äº‰-key-é—®é¢˜">å¦‚ä½•è§£å†³ Redis çš„å¹¶å‘ç«äº‰ Key é—®é¢˜</span></h3><p>æ‰€è°“ Redis çš„å¹¶å‘ç«äº‰ Key çš„é—®é¢˜ä¹Ÿå°±æ˜¯å¤šä¸ªç³»ç»ŸåŒæ—¶å¯¹ä¸€ä¸ª key è¿›è¡Œæ“ä½œï¼Œä½†æ˜¯æœ€åæ‰§è¡Œçš„é¡ºåºå’Œæˆ‘ä»¬æœŸæœ›çš„é¡ºåºä¸åŒï¼Œè¿™æ ·ä¹Ÿå°±å¯¼è‡´äº†ç»“æœçš„ä¸åŒï¼</p><p>æ¨èä¸€ç§æ–¹æ¡ˆï¼šåˆ†å¸ƒå¼é”ï¼ˆzookeeper å’Œ redis éƒ½å¯ä»¥å®ç°åˆ†å¸ƒå¼é”ï¼‰ã€‚ï¼ˆå¦‚æœä¸å­˜åœ¨ Redis çš„å¹¶å‘ç«äº‰ Key é—®é¢˜ï¼Œä¸è¦ä½¿ç”¨åˆ†å¸ƒå¼é”ï¼Œè¿™æ ·ä¼šå½±å“æ€§èƒ½ï¼‰</p><p>åŸºäºzookeeperä¸´æ—¶æœ‰åºèŠ‚ç‚¹å¯ä»¥å®ç°çš„åˆ†å¸ƒå¼é”ã€‚å¤§è‡´æ€æƒ³ä¸ºï¼šæ¯ä¸ªå®¢æˆ·ç«¯å¯¹æŸä¸ªæ–¹æ³•åŠ é”æ—¶ï¼Œåœ¨zookeeperä¸Šçš„ä¸è¯¥æ–¹æ³•å¯¹åº”çš„æŒ‡å®šèŠ‚ç‚¹çš„ç›®å½•ä¸‹ï¼Œç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ç¬æ—¶æœ‰åºèŠ‚ç‚¹ã€‚åˆ¤æ–­æ˜¯å¦è·å–é”çš„æ–¹å¼å¾ˆç®€å•ï¼Œåªéœ€è¦åˆ¤æ–­æœ‰åºèŠ‚ç‚¹ä¸­åºå·æœ€å°çš„ä¸€ä¸ªã€‚å½“é‡Šæ”¾é”çš„æ—¶å€™ï¼Œåªéœ€å°†è¿™ä¸ªç¬æ—¶èŠ‚ç‚¹åˆ é™¤å³å¯ã€‚åŒæ—¶ï¼Œå…¶å¯ä»¥é¿å…æœåŠ¡å®•æœºå¯¼è‡´çš„é”æ— æ³•é‡Šæ”¾ï¼Œè€Œäº§ç”Ÿçš„æ­»é”é—®é¢˜ã€‚å®Œæˆä¸šåŠ¡æµç¨‹åï¼Œåˆ é™¤å¯¹åº”çš„å­èŠ‚ç‚¹é‡Šæ”¾é”ã€‚</p><p>åœ¨å®è·µä¸­ï¼Œå½“ç„¶æ˜¯ä»ä»¥å¯é æ€§ä¸ºä¸»ã€‚æ‰€ä»¥é¦–æ¨Zookeeperã€‚</p><p>å‚è€ƒï¼š<a href="https://www.jianshu.com/p/8bddd381de06">https://www.jianshu.com/p/8bddd381de06</a></p><h3><span id="åˆ†å¸ƒå¼redisæ˜¯å‰æœŸåšè¿˜æ˜¯åæœŸè§„æ¨¡ä¸Šæ¥äº†å†åšå¥½ä¸ºä»€ä¹ˆ">åˆ†å¸ƒå¼Redisæ˜¯å‰æœŸåšè¿˜æ˜¯åæœŸè§„æ¨¡ä¸Šæ¥äº†å†åšå¥½ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</span></h3><p>æ—¢ç„¶Redisæ˜¯å¦‚æ­¤çš„è½»é‡ï¼ˆå•å®ä¾‹åªä½¿ç”¨1Må†…å­˜ï¼‰ï¼Œä¸ºé˜²æ­¢ä»¥åçš„æ‰©å®¹ï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯ä¸€å¼€å§‹å°±å¯åŠ¨è¾ƒå¤šå®ä¾‹ã€‚å³ä¾¿ä½ åªæœ‰ä¸€å°æœåŠ¡å™¨ï¼Œä½ ä¹Ÿå¯ä»¥ä¸€å¼€å§‹å°±è®©Redisä»¥åˆ†å¸ƒå¼çš„æ–¹å¼è¿è¡Œï¼Œä½¿ç”¨åˆ†åŒºï¼Œåœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šå¯åŠ¨å¤šä¸ªå®ä¾‹ã€‚</p><p>ä¸€å¼€å§‹å°±å¤šè®¾ç½®å‡ ä¸ªRediså®ä¾‹ï¼Œä¾‹å¦‚32æˆ–è€…64ä¸ªå®ä¾‹ï¼Œå¯¹å¤§å¤šæ•°ç”¨æˆ·æ¥è¯´è¿™æ“ä½œèµ·æ¥å¯èƒ½æ¯”è¾ƒéº»çƒ¦ï¼Œä½†æ˜¯ä»é•¿ä¹…æ¥çœ‹åšè¿™ç‚¹ç‰ºç‰²æ˜¯å€¼å¾—çš„ã€‚</p><p>è¿™æ ·çš„è¯ï¼Œå½“ä½ çš„æ•°æ®ä¸æ–­å¢é•¿ï¼Œéœ€è¦æ›´å¤šçš„RedisæœåŠ¡å™¨æ—¶ï¼Œä½ éœ€è¦åšçš„å°±æ˜¯ä»…ä»…å°†Rediså®ä¾‹ä»ä¸€å°æœåŠ¡è¿ç§»åˆ°å¦å¤–ä¸€å°æœåŠ¡å™¨è€Œå·²ï¼ˆè€Œä¸ç”¨è€ƒè™‘é‡æ–°åˆ†åŒºçš„é—®é¢˜ï¼‰ã€‚ä¸€æ—¦ä½ æ·»åŠ äº†å¦ä¸€å°æœåŠ¡å™¨ï¼Œä½ éœ€è¦å°†ä½ ä¸€åŠçš„Rediså®ä¾‹ä»ç¬¬ä¸€å°æœºå™¨è¿ç§»åˆ°ç¬¬äºŒå°æœºå™¨ã€‚</p><h3><span id="ä»€ä¹ˆæ˜¯-redlock">ä»€ä¹ˆæ˜¯ RedLock</span></h3><p>Redis å®˜æ–¹ç«™æå‡ºäº†ä¸€ç§æƒå¨çš„åŸºäº Redis å®ç°åˆ†å¸ƒå¼é”çš„æ–¹å¼åå« <em>Redlock</em>ï¼Œæ­¤ç§æ–¹å¼æ¯”åŸå…ˆçš„å•èŠ‚ç‚¹çš„æ–¹æ³•æ›´å®‰å…¨ã€‚å®ƒå¯ä»¥ä¿è¯ä»¥ä¸‹ç‰¹æ€§ï¼š</p><ol><li>å®‰å…¨ç‰¹æ€§ï¼šäº’æ–¥è®¿é—®ï¼Œå³æ°¸è¿œåªæœ‰ä¸€ä¸ª client èƒ½æ‹¿åˆ°é”</li><li>é¿å…æ­»é”ï¼šæœ€ç»ˆ client éƒ½å¯èƒ½æ‹¿åˆ°é”ï¼Œä¸ä¼šå‡ºç°æ­»é”çš„æƒ…å†µï¼Œå³ä½¿åŸæœ¬é”ä½æŸèµ„æºçš„ client crash äº†æˆ–è€…å‡ºç°äº†ç½‘ç»œåˆ†åŒº</li><li>å®¹é”™æ€§ï¼šåªè¦å¤§éƒ¨åˆ† Redis èŠ‚ç‚¹å­˜æ´»å°±å¯ä»¥æ­£å¸¸æä¾›æœåŠ¡</li></ol><p>å¾€æœŸé¢è¯•é¢˜æ±‡æ€»ï¼š<a href="http://mp.weixin.qq.com/s?__biz=MzIyNDU2ODA4OQ==&mid=2247485351&idx=2&sn=214225ab4345f4d9c562900cb42a52ba&chksm=e80db1d1df7a38c741137246bf020a5f8970f74cd03530ccc4cb2258c1ced68e66e600e9e059&scene=21#wechat_redirect">001æœŸ~150æœŸæ±‡æ€»</a></p><h2><span id="ç¼“å­˜å¼‚å¸¸">ç¼“å­˜å¼‚å¸¸</span></h2><h3><span id="ç¼“å­˜é›ªå´©">ç¼“å­˜é›ªå´©</span></h3><p>ç¼“å­˜é›ªå´©æ˜¯æŒ‡ç¼“å­˜åŒä¸€æ—¶é—´å¤§é¢ç§¯çš„å¤±æ•ˆï¼Œæ‰€ä»¥ï¼Œåé¢çš„è¯·æ±‚éƒ½ä¼šè½åˆ°æ•°æ®åº“ä¸Šï¼Œé€ æˆæ•°æ®åº“çŸ­æ—¶é—´å†…æ‰¿å—å¤§é‡è¯·æ±‚è€Œå´©æ‰ã€‚</p><p>è§£å†³æ–¹æ¡ˆ</p><ol><li>ç¼“å­˜æ•°æ®çš„è¿‡æœŸæ—¶é—´è®¾ç½®éšæœºï¼Œé˜²æ­¢åŒä¸€æ—¶é—´å¤§é‡æ•°æ®è¿‡æœŸç°è±¡å‘ç”Ÿã€‚</li><li>ä¸€èˆ¬å¹¶å‘é‡ä¸æ˜¯ç‰¹åˆ«å¤šçš„æ—¶å€™ï¼Œä½¿ç”¨æœ€å¤šçš„è§£å†³æ–¹æ¡ˆæ˜¯åŠ é”æ’é˜Ÿã€‚</li><li>ç»™æ¯ä¸€ä¸ªç¼“å­˜æ•°æ®å¢åŠ ç›¸åº”çš„ç¼“å­˜æ ‡è®°ï¼Œè®°å½•ç¼“å­˜çš„æ˜¯å¦å¤±æ•ˆï¼Œå¦‚æœç¼“å­˜æ ‡è®°å¤±æ•ˆï¼Œåˆ™æ›´æ–°æ•°æ®ç¼“å­˜ã€‚</li></ol><h3><span id="ç¼“å­˜ç©¿é€">ç¼“å­˜ç©¿é€</span></h3><p>ç¼“å­˜ç©¿é€æ˜¯æŒ‡ç¼“å­˜å’Œæ•°æ®åº“ä¸­éƒ½æ²¡æœ‰çš„æ•°æ®ï¼Œå¯¼è‡´æ‰€æœ‰çš„è¯·æ±‚éƒ½è½åˆ°æ•°æ®åº“ä¸Šï¼Œé€ æˆæ•°æ®åº“çŸ­æ—¶é—´å†…æ‰¿å—å¤§é‡è¯·æ±‚è€Œå´©æ‰ã€‚</p><p>è§£å†³æ–¹æ¡ˆ</p><ol><li>æ¥å£å±‚å¢åŠ æ ¡éªŒï¼Œå¦‚ç”¨æˆ·é‰´æƒæ ¡éªŒï¼ŒidåšåŸºç¡€æ ¡éªŒï¼Œid&lt;&#x3D;0çš„ç›´æ¥æ‹¦æˆªï¼›</li><li>ä»ç¼“å­˜å–ä¸åˆ°çš„æ•°æ®ï¼Œåœ¨æ•°æ®åº“ä¸­ä¹Ÿæ²¡æœ‰å–åˆ°ï¼Œè¿™æ—¶ä¹Ÿå¯ä»¥å°†key-valueå¯¹å†™ä¸ºkey-nullï¼Œç¼“å­˜æœ‰æ•ˆæ—¶é—´å¯ä»¥è®¾ç½®çŸ­ç‚¹ï¼Œå¦‚30ç§’ï¼ˆè®¾ç½®å¤ªé•¿ä¼šå¯¼è‡´æ­£å¸¸æƒ…å†µä¹Ÿæ²¡æ³•ä½¿ç”¨ï¼‰ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢æ”»å‡»ç”¨æˆ·åå¤ç”¨åŒä¸€ä¸ªidæš´åŠ›æ”»å‡»</li><li>é‡‡ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå°†æ‰€æœ‰å¯èƒ½å­˜åœ¨çš„æ•°æ®å“ˆå¸Œåˆ°ä¸€ä¸ªè¶³å¤Ÿå¤§çš„ bitmap ä¸­ï¼Œä¸€ä¸ªä¸€å®šä¸å­˜åœ¨çš„æ•°æ®ä¼šè¢«è¿™ä¸ª bitmap æ‹¦æˆªæ‰ï¼Œä»è€Œé¿å…äº†å¯¹åº•å±‚å­˜å‚¨ç³»ç»Ÿçš„æŸ¥è¯¢å‹åŠ›</li></ol><h3><span id="é™„åŠ ">é™„åŠ </span></h3><p>å¯¹äºç©ºé—´çš„åˆ©ç”¨åˆ°è¾¾äº†ä¸€ç§æè‡´ï¼Œé‚£å°±æ˜¯Bitmapå’Œå¸ƒéš†è¿‡æ»¤å™¨(Bloom Filter)ã€‚</p><p>Bitmapï¼šå…¸å‹çš„å°±æ˜¯å“ˆå¸Œè¡¨</p><p>ç¼ºç‚¹æ˜¯ï¼ŒBitmapå¯¹äºæ¯ä¸ªå…ƒç´ åªèƒ½è®°å½•1bitä¿¡æ¯ï¼Œå¦‚æœè¿˜æƒ³å®Œæˆé¢å¤–çš„åŠŸèƒ½ï¼Œææ€•åªèƒ½é ç‰ºç‰²æ›´å¤šçš„ç©ºé—´ã€æ—¶é—´æ¥å®Œæˆäº†ã€‚</p><p><strong>å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆæ¨èï¼‰</strong></p><p>å°±æ˜¯å¼•å…¥äº†k(k&gt;1)k(k&gt;1)ä¸ªç›¸äº’ç‹¬ç«‹çš„å“ˆå¸Œå‡½æ•°ï¼Œä¿è¯åœ¨ç»™å®šçš„ç©ºé—´ã€è¯¯åˆ¤ç‡ä¸‹ï¼Œå®Œæˆå…ƒç´ åˆ¤é‡çš„è¿‡ç¨‹ã€‚</p><p>å®ƒçš„ä¼˜ç‚¹æ˜¯ç©ºé—´æ•ˆç‡å’ŒæŸ¥è¯¢æ—¶é—´éƒ½è¿œè¿œè¶…è¿‡ä¸€èˆ¬çš„ç®—æ³•ï¼Œç¼ºç‚¹æ˜¯æœ‰ä¸€å®šçš„è¯¯è¯†åˆ«ç‡å’Œåˆ é™¤å›°éš¾ã€‚</p><p>Bloom-Filterç®—æ³•çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯åˆ©ç”¨å¤šä¸ªä¸åŒçš„Hashå‡½æ•°æ¥è§£å†³â€œå†²çªâ€ã€‚</p><p>Hashå­˜åœ¨ä¸€ä¸ªå†²çªï¼ˆç¢°æ’ï¼‰çš„é—®é¢˜ï¼Œç”¨åŒä¸€ä¸ªHashå¾—åˆ°çš„ä¸¤ä¸ªURLçš„å€¼æœ‰å¯èƒ½ç›¸åŒã€‚ä¸ºäº†å‡å°‘å†²çªï¼Œæˆ‘ä»¬å¯ä»¥å¤šå¼•å…¥å‡ ä¸ªHashï¼Œå¦‚æœé€šè¿‡å…¶ä¸­çš„ä¸€ä¸ªHashå€¼æˆ‘ä»¬å¾—å‡ºæŸå…ƒç´ ä¸åœ¨é›†åˆä¸­ï¼Œé‚£ä¹ˆè¯¥å…ƒç´ è‚¯å®šä¸åœ¨é›†åˆä¸­ã€‚åªæœ‰åœ¨æ‰€æœ‰çš„Hashå‡½æ•°å‘Šè¯‰æˆ‘ä»¬è¯¥å…ƒç´ åœ¨é›†åˆä¸­æ—¶ï¼Œæ‰èƒ½ç¡®å®šè¯¥å…ƒç´ å­˜åœ¨äºé›†åˆä¸­ã€‚è¿™ä¾¿æ˜¯Bloom-Filterçš„åŸºæœ¬æ€æƒ³ã€‚</p><p>Bloom-Filterä¸€èˆ¬ç”¨äºåœ¨å¤§æ•°æ®é‡çš„é›†åˆä¸­åˆ¤å®šæŸå…ƒç´ æ˜¯å¦å­˜åœ¨ã€‚</p><h3><span id="ç¼“å­˜å‡»ç©¿">ç¼“å­˜å‡»ç©¿</span></h3><p>ç¼“å­˜å‡»ç©¿æ˜¯æŒ‡ç¼“å­˜ä¸­æ²¡æœ‰ä½†æ•°æ®åº“ä¸­æœ‰çš„æ•°æ®ï¼ˆä¸€èˆ¬æ˜¯ç¼“å­˜æ—¶é—´åˆ°æœŸï¼‰ï¼Œè¿™æ—¶ç”±äºå¹¶å‘ç”¨æˆ·ç‰¹åˆ«å¤šï¼ŒåŒæ—¶è¯»ç¼“å­˜æ²¡è¯»åˆ°æ•°æ®ï¼ŒåˆåŒæ—¶å»æ•°æ®åº“å»å–æ•°æ®ï¼Œå¼•èµ·æ•°æ®åº“å‹åŠ›ç¬é—´å¢å¤§ï¼Œé€ æˆè¿‡å¤§å‹åŠ›ã€‚å’Œç¼“å­˜é›ªå´©ä¸åŒçš„æ˜¯ï¼Œç¼“å­˜å‡»ç©¿æŒ‡å¹¶å‘æŸ¥åŒä¸€æ¡æ•°æ®ï¼Œç¼“å­˜é›ªå´©æ˜¯ä¸åŒæ•°æ®éƒ½è¿‡æœŸäº†ï¼Œå¾ˆå¤šæ•°æ®éƒ½æŸ¥ä¸åˆ°ä»è€ŒæŸ¥æ•°æ®åº“ã€‚</p><p>è§£å†³æ–¹æ¡ˆ</p><ol><li>è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸã€‚</li><li>åŠ äº’æ–¥é”ï¼Œäº’æ–¥é”</li></ol><h3><span id="ç¼“å­˜é¢„çƒ­">ç¼“å­˜é¢„çƒ­</span></h3><p>ç¼“å­˜é¢„çƒ­å°±æ˜¯ç³»ç»Ÿä¸Šçº¿åï¼Œå°†ç›¸å…³çš„ç¼“å­˜æ•°æ®ç›´æ¥åŠ è½½åˆ°ç¼“å­˜ç³»ç»Ÿã€‚è¿™æ ·å°±å¯ä»¥é¿å…åœ¨ç”¨æˆ·è¯·æ±‚çš„æ—¶å€™ï¼Œå…ˆæŸ¥è¯¢æ•°æ®åº“ï¼Œç„¶åå†å°†æ•°æ®ç¼“å­˜çš„é—®é¢˜ï¼ç”¨æˆ·ç›´æ¥æŸ¥è¯¢äº‹å…ˆè¢«é¢„çƒ­çš„ç¼“å­˜æ•°æ®ï¼</p><p>è§£å†³æ–¹æ¡ˆ</p><ol><li>ç›´æ¥å†™ä¸ªç¼“å­˜åˆ·æ–°é¡µé¢ï¼Œä¸Šçº¿æ—¶æ‰‹å·¥æ“ä½œä¸€ä¸‹ï¼›</li><li>æ•°æ®é‡ä¸å¤§ï¼Œå¯ä»¥åœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨è¿›è¡ŒåŠ è½½ï¼›</li><li>å®šæ—¶åˆ·æ–°ç¼“å­˜ï¼›</li></ol><h3><span id="ç¼“å­˜é™çº§">ç¼“å­˜é™çº§</span></h3><p>å½“è®¿é—®é‡å‰§å¢ã€æœåŠ¡å‡ºç°é—®é¢˜ï¼ˆå¦‚å“åº”æ—¶é—´æ…¢æˆ–ä¸å“åº”ï¼‰æˆ–éæ ¸å¿ƒæœåŠ¡å½±å“åˆ°æ ¸å¿ƒæµç¨‹çš„æ€§èƒ½æ—¶ï¼Œä»ç„¶éœ€è¦ä¿è¯æœåŠ¡è¿˜æ˜¯å¯ç”¨çš„ï¼Œå³ä½¿æ˜¯æœ‰æŸæœåŠ¡ã€‚ç³»ç»Ÿå¯ä»¥æ ¹æ®ä¸€äº›å…³é”®æ•°æ®è¿›è¡Œè‡ªåŠ¨é™çº§ï¼Œä¹Ÿå¯ä»¥é…ç½®å¼€å…³å®ç°äººå·¥é™çº§ã€‚</p><p>ç¼“å­˜é™çº§çš„æœ€ç»ˆç›®çš„æ˜¯ä¿è¯æ ¸å¿ƒæœåŠ¡å¯ç”¨ï¼Œå³ä½¿æ˜¯æœ‰æŸçš„ã€‚è€Œä¸”æœ‰äº›æœåŠ¡æ˜¯æ— æ³•é™çº§çš„ï¼ˆå¦‚åŠ å…¥è´­ç‰©è½¦ã€ç»“ç®—ï¼‰ã€‚</p><p>åœ¨è¿›è¡Œé™çº§ä¹‹å‰è¦å¯¹ç³»ç»Ÿè¿›è¡Œæ¢³ç†ï¼Œçœ‹çœ‹ç³»ç»Ÿæ˜¯ä¸æ˜¯å¯ä»¥ä¸¢å’ä¿å¸…ï¼›ä»è€Œæ¢³ç†å‡ºå“ªäº›å¿…é¡»èª“æ­»ä¿æŠ¤ï¼Œå“ªäº›å¯é™çº§ï¼›æ¯”å¦‚å¯ä»¥å‚è€ƒæ—¥å¿—çº§åˆ«è®¾ç½®é¢„æ¡ˆï¼š</p><ol><li>ä¸€èˆ¬ï¼šæ¯”å¦‚æœ‰äº›æœåŠ¡å¶å°”å› ä¸ºç½‘ç»œæŠ–åŠ¨æˆ–è€…æœåŠ¡æ­£åœ¨ä¸Šçº¿è€Œè¶…æ—¶ï¼Œå¯ä»¥è‡ªåŠ¨é™çº§ï¼›</li><li>è­¦å‘Šï¼šæœ‰äº›æœåŠ¡åœ¨ä¸€æ®µæ—¶é—´å†…æˆåŠŸç‡æœ‰æ³¢åŠ¨ï¼ˆå¦‚åœ¨95~100%ä¹‹é—´ï¼‰ï¼Œå¯ä»¥è‡ªåŠ¨é™çº§æˆ–äººå·¥é™çº§ï¼Œå¹¶å‘é€å‘Šè­¦ï¼›</li><li>é”™è¯¯ï¼šæ¯”å¦‚å¯ç”¨ç‡ä½äº90%ï¼Œæˆ–è€…æ•°æ®åº“è¿æ¥æ± è¢«æ‰“çˆ†äº†ï¼Œæˆ–è€…è®¿é—®é‡çªç„¶çŒ›å¢åˆ°ç³»ç»Ÿèƒ½æ‰¿å—çš„æœ€å¤§é˜€å€¼ï¼Œæ­¤æ—¶å¯ä»¥æ ¹æ®æƒ…å†µè‡ªåŠ¨é™çº§æˆ–è€…äººå·¥é™çº§ï¼›</li><li>ä¸¥é‡é”™è¯¯ï¼šæ¯”å¦‚å› ä¸ºç‰¹æ®ŠåŸå› æ•°æ®é”™è¯¯äº†ï¼Œæ­¤æ—¶éœ€è¦ç´§æ€¥äººå·¥é™çº§ã€‚</li></ol><p>æœåŠ¡é™çº§çš„ç›®çš„ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢RedisæœåŠ¡æ•…éšœï¼Œå¯¼è‡´æ•°æ®åº“è·Ÿç€ä¸€èµ·å‘ç”Ÿé›ªå´©é—®é¢˜ã€‚å› æ­¤ï¼Œå¯¹äºä¸é‡è¦çš„ç¼“å­˜æ•°æ®ï¼Œå¯ä»¥é‡‡å–æœåŠ¡é™çº§ç­–ç•¥ï¼Œä¾‹å¦‚ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„åšæ³•å°±æ˜¯ï¼ŒRediså‡ºç°é—®é¢˜ï¼Œä¸å»æ•°æ®åº“æŸ¥è¯¢ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›é»˜è®¤å€¼ç»™ç”¨æˆ·ã€‚</p><h3><span id="çƒ­ç‚¹æ•°æ®å’Œå†·æ•°æ®">çƒ­ç‚¹æ•°æ®å’Œå†·æ•°æ®</span></h3><p>çƒ­ç‚¹æ•°æ®ï¼Œç¼“å­˜æ‰æœ‰ä»·å€¼</p><p>å¯¹äºå†·æ•°æ®è€Œè¨€ï¼Œå¤§éƒ¨åˆ†æ•°æ®å¯èƒ½è¿˜æ²¡æœ‰å†æ¬¡è®¿é—®åˆ°å°±å·²ç»è¢«æŒ¤å‡ºå†…å­˜ï¼Œä¸ä»…å ç”¨å†…å­˜ï¼Œè€Œä¸”ä»·å€¼ä¸å¤§ã€‚é¢‘ç¹ä¿®æ”¹çš„æ•°æ®ï¼Œçœ‹æƒ…å†µè€ƒè™‘ä½¿ç”¨ç¼“å­˜</p><p>å¯¹äºçƒ­ç‚¹æ•°æ®ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„æŸIMäº§å“ï¼Œç”Ÿæ—¥ç¥ç¦æ¨¡å—ï¼Œå½“å¤©çš„å¯¿æ˜Ÿåˆ—è¡¨ï¼Œç¼“å­˜ä»¥åå¯èƒ½è¯»å–æ•°åä¸‡æ¬¡ã€‚å†ä¸¾ä¸ªä¾‹å­ï¼ŒæŸå¯¼èˆªäº§å“ï¼Œæˆ‘ä»¬å°†å¯¼èˆªä¿¡æ¯ï¼Œç¼“å­˜ä»¥åå¯èƒ½è¯»å–æ•°ç™¾ä¸‡æ¬¡ã€‚</p><p>æ•°æ®æ›´æ–°å‰è‡³å°‘è¯»å–ä¸¤æ¬¡ï¼Œç¼“å­˜æ‰æœ‰æ„ä¹‰ã€‚è¿™ä¸ªæ˜¯æœ€åŸºæœ¬çš„ç­–ç•¥ï¼Œå¦‚æœç¼“å­˜è¿˜æ²¡æœ‰èµ·ä½œç”¨å°±å¤±æ•ˆäº†ï¼Œé‚£å°±æ²¡æœ‰å¤ªå¤§ä»·å€¼äº†ã€‚</p><p>é‚£å­˜ä¸å­˜åœ¨ï¼Œä¿®æ”¹é¢‘ç‡å¾ˆé«˜ï¼Œä½†æ˜¯åˆä¸å¾—ä¸è€ƒè™‘ç¼“å­˜çš„åœºæ™¯å‘¢ï¼Ÿæœ‰ï¼æ¯”å¦‚ï¼Œè¿™ä¸ªè¯»å–æ¥å£å¯¹æ•°æ®åº“çš„å‹åŠ›å¾ˆå¤§ï¼Œä½†æ˜¯åˆæ˜¯çƒ­ç‚¹æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦è€ƒè™‘é€šè¿‡ç¼“å­˜æ‰‹æ®µï¼Œå‡å°‘æ•°æ®åº“çš„å‹åŠ›ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„æŸåŠ©æ‰‹äº§å“çš„ï¼Œç‚¹èµæ•°ï¼Œæ”¶è—æ•°ï¼Œåˆ†äº«æ•°ç­‰æ˜¯éå¸¸å…¸å‹çš„çƒ­ç‚¹æ•°æ®ï¼Œä½†æ˜¯åˆä¸æ–­å˜åŒ–ï¼Œæ­¤æ—¶å°±éœ€è¦å°†æ•°æ®åŒæ­¥ä¿å­˜åˆ°Redisç¼“å­˜ï¼Œå‡å°‘æ•°æ®åº“å‹åŠ›ã€‚</p><h3><span id="ç¼“å­˜çƒ­ç‚¹key">ç¼“å­˜çƒ­ç‚¹key</span></h3><p>ç¼“å­˜ä¸­çš„ä¸€ä¸ªKey(æ¯”å¦‚ä¸€ä¸ªä¿ƒé”€å•†å“)ï¼Œåœ¨æŸä¸ªæ—¶é—´ç‚¹è¿‡æœŸçš„æ—¶å€™ï¼Œæ°å¥½åœ¨è¿™ä¸ªæ—¶é—´ç‚¹å¯¹è¿™ä¸ªKeyæœ‰å¤§é‡çš„å¹¶å‘è¯·æ±‚è¿‡æ¥ï¼Œè¿™äº›è¯·æ±‚å‘ç°ç¼“å­˜è¿‡æœŸä¸€èˆ¬éƒ½ä¼šä»åç«¯DBåŠ è½½æ•°æ®å¹¶å›è®¾åˆ°ç¼“å­˜ï¼Œè¿™ä¸ªæ—¶å€™å¤§å¹¶å‘çš„è¯·æ±‚å¯èƒ½ä¼šç¬é—´æŠŠåç«¯DBå‹å®ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong></p><p>å¯¹ç¼“å­˜æŸ¥è¯¢åŠ é”ï¼Œå¦‚æœKEYä¸å­˜åœ¨ï¼Œå°±åŠ é”ï¼Œç„¶åæŸ¥DBå…¥ç¼“å­˜ï¼Œç„¶åè§£é”ï¼›å…¶ä»–è¿›ç¨‹å¦‚æœå‘ç°æœ‰é”å°±ç­‰å¾…ï¼Œç„¶åç­‰è§£é”åè¿”å›æ•°æ®æˆ–è€…è¿›å…¥DBæŸ¥è¯¢</p><h2><span id="å¸¸ç”¨å·¥å…·">å¸¸ç”¨å·¥å…·</span></h2><h3><span id="redisæ”¯æŒçš„javaå®¢æˆ·ç«¯éƒ½æœ‰å“ªäº›å®˜æ–¹æ¨èç”¨å“ªä¸ª">Redisæ”¯æŒçš„Javaå®¢æˆ·ç«¯éƒ½æœ‰å“ªäº›ï¼Ÿå®˜æ–¹æ¨èç”¨å“ªä¸ªï¼Ÿ</span></h3><p>Redissonã€Jedisã€lettuceç­‰ç­‰ï¼Œå®˜æ–¹æ¨èä½¿ç”¨Redissonã€‚</p><h3><span id="rediså’Œredissonæœ‰ä»€ä¹ˆå…³ç³»">Rediså’ŒRedissonæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</span></h3><p>Redissonæ˜¯ä¸€ä¸ªé«˜çº§çš„åˆ†å¸ƒå¼åè°ƒRediså®¢æœç«¯ï¼Œèƒ½å¸®åŠ©ç”¨æˆ·åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­è½»æ¾å®ç°ä¸€äº›Javaçš„å¯¹è±¡ (Bloom filter, BitSet, Set, SetMultimap, ScoredSortedSet, SortedSet, Map, ConcurrentMap, List, ListMultimap, Queue, BlockingQueue, Deque, BlockingDeque, Semaphore, Lock, ReadWriteLock, AtomicLong, CountDownLatch, Publish &#x2F; Subscribe, HyperLogLog)ã€‚</p><h3><span id="jedisä¸redissonå¯¹æ¯”æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹">Jedisä¸Redissonå¯¹æ¯”æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</span></h3><p>Jedisæ˜¯Redisçš„Javaå®ç°çš„å®¢æˆ·ç«¯ï¼Œå…¶APIæä¾›äº†æ¯”è¾ƒå…¨é¢çš„Rediså‘½ä»¤çš„æ”¯æŒï¼›Redissonå®ç°äº†åˆ†å¸ƒå¼å’Œå¯æ‰©å±•çš„Javaæ•°æ®ç»“æ„ï¼Œå’ŒJedisç›¸æ¯”ï¼ŒåŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œä¸æ”¯æŒå­—ç¬¦ä¸²æ“ä½œï¼Œä¸æ”¯æŒæ’åºã€äº‹åŠ¡ã€ç®¡é“ã€åˆ†åŒºç­‰Redisç‰¹æ€§ã€‚Redissonçš„å®—æ—¨æ˜¯ä¿ƒè¿›ä½¿ç”¨è€…å¯¹Redisçš„å…³æ³¨åˆ†ç¦»ï¼Œä»è€Œè®©ä½¿ç”¨è€…èƒ½å¤Ÿå°†ç²¾åŠ›æ›´é›†ä¸­åœ°æ”¾åœ¨å¤„ç†ä¸šåŠ¡é€»è¾‘ä¸Šã€‚</p><p>å¾€æœŸé¢è¯•é¢˜æ±‡æ€»ï¼š<a href="http://mp.weixin.qq.com/s?__biz=MzIyNDU2ODA4OQ==&mid=2247485351&idx=2&sn=214225ab4345f4d9c562900cb42a52ba&chksm=e80db1d1df7a38c741137246bf020a5f8970f74cd03530ccc4cb2258c1ced68e66e600e9e059&scene=21#wechat_redirect">001æœŸ~150æœŸæ±‡æ€»</a></p><h2><span id="å…¶ä»–é—®é¢˜">å…¶ä»–é—®é¢˜</span></h2><h3><span id="redisä¸memcachedçš„åŒºåˆ«">Redisä¸Memcachedçš„åŒºåˆ«</span></h3><p>ä¸¤è€…éƒ½æ˜¯éå…³ç³»å‹å†…å­˜é”®å€¼æ•°æ®åº“ï¼Œç°åœ¨å…¬å¸ä¸€èˆ¬éƒ½æ˜¯ç”¨ Redis æ¥å®ç°ç¼“å­˜ï¼Œè€Œä¸” Redis è‡ªèº«ä¹Ÿè¶Šæ¥è¶Šå¼ºå¤§äº†ï¼Redis ä¸ Memcached ä¸»è¦æœ‰ä»¥ä¸‹ä¸åŒï¼š</p><p><img src="https://www.javazhiyin.com/wp-content/uploads/2020/10/java2-1602932968.png" alt="Redis å¸¸è§é¢è¯•é¢˜ï¼ˆ2020æœ€æ–°ç‰ˆï¼‰"></p><p>(1) memcachedæ‰€æœ‰çš„å€¼å‡æ˜¯ç®€å•çš„å­—ç¬¦ä¸²ï¼Œredisä½œä¸ºå…¶æ›¿ä»£è€…ï¼Œæ”¯æŒæ›´ä¸ºä¸°å¯Œçš„æ•°æ®ç±»å‹</p><p>(2) redisçš„é€Ÿåº¦æ¯”memcachedå¿«å¾ˆå¤š</p><p>(3) rediså¯ä»¥æŒä¹…åŒ–å…¶æ•°æ®</p><h3><span id="å¦‚ä½•ä¿è¯ç¼“å­˜ä¸æ•°æ®åº“åŒå†™æ—¶çš„æ•°æ®ä¸€è‡´æ€§">å¦‚ä½•ä¿è¯ç¼“å­˜ä¸æ•°æ®åº“åŒå†™æ—¶çš„æ•°æ®ä¸€è‡´æ€§ï¼Ÿ</span></h3><p>ä½ åªè¦ç”¨ç¼“å­˜ï¼Œå°±å¯èƒ½ä¼šæ¶‰åŠåˆ°ç¼“å­˜ä¸æ•°æ®åº“åŒå­˜å‚¨åŒå†™ï¼Œä½ åªè¦æ˜¯åŒå†™ï¼Œå°±ä¸€å®šä¼šæœ‰æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œé‚£ä¹ˆä½ å¦‚ä½•è§£å†³ä¸€è‡´æ€§é—®é¢˜ï¼Ÿ</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œå°±æ˜¯å¦‚æœä½ çš„ç³»ç»Ÿä¸æ˜¯ä¸¥æ ¼è¦æ±‚ç¼“å­˜+æ•°æ®åº“å¿…é¡»ä¸€è‡´æ€§çš„è¯ï¼Œç¼“å­˜å¯ä»¥ç¨å¾®çš„è·Ÿæ•°æ®åº“å¶å°”æœ‰ä¸ä¸€è‡´çš„æƒ…å†µï¼Œæœ€å¥½ä¸è¦åšè¿™ä¸ªæ–¹æ¡ˆï¼Œè¯»è¯·æ±‚å’Œå†™è¯·æ±‚ä¸²è¡ŒåŒ–ï¼Œä¸²åˆ°ä¸€ä¸ªå†…å­˜é˜Ÿåˆ—é‡Œå»ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯ä¸€å®šä¸ä¼šå‡ºç°ä¸ä¸€è‡´çš„æƒ…å†µ</p><p>ä¸²è¡ŒåŒ–ä¹‹åï¼Œå°±ä¼šå¯¼è‡´ç³»ç»Ÿçš„ååé‡ä¼šå¤§å¹…åº¦çš„é™ä½ï¼Œç”¨æ¯”æ­£å¸¸æƒ…å†µä¸‹å¤šå‡ å€çš„æœºå™¨å»æ”¯æ’‘çº¿ä¸Šçš„ä¸€ä¸ªè¯·æ±‚ã€‚</p><p>è¿˜æœ‰ä¸€ç§æ–¹å¼å°±æ˜¯å¯èƒ½ä¼šæš‚æ—¶äº§ç”Ÿä¸ä¸€è‡´çš„æƒ…å†µï¼Œä½†æ˜¯å‘ç”Ÿçš„å‡ ç‡ç‰¹åˆ«å°ï¼Œå°±æ˜¯<strong>å…ˆæ›´æ–°æ•°æ®åº“ï¼Œç„¶åå†åˆ é™¤ç¼“å­˜ã€‚</strong></p><p><img src="https://www.javazhiyin.com/wp-content/uploads/2020/10/java10-1602932968-1.png" alt="Redis å¸¸è§é¢è¯•é¢˜ï¼ˆ2020æœ€æ–°ç‰ˆï¼‰"></p><h3><span id="rediså¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ">Rediså¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Ÿ</span></h3><ol><li>Masteræœ€å¥½ä¸è¦åšä»»ä½•æŒä¹…åŒ–å·¥ä½œï¼ŒåŒ…æ‹¬å†…å­˜å¿«ç…§å’ŒAOFæ—¥å¿—æ–‡ä»¶ï¼Œç‰¹åˆ«æ˜¯ä¸è¦å¯ç”¨å†…å­˜å¿«ç…§åšæŒä¹…åŒ–ã€‚</li><li>å¦‚æœæ•°æ®æ¯”è¾ƒå…³é”®ï¼ŒæŸä¸ªSlaveå¼€å¯AOFå¤‡ä»½æ•°æ®ï¼Œç­–ç•¥ä¸ºæ¯ç§’åŒæ­¥ä¸€æ¬¡ã€‚</li><li>ä¸ºäº†ä¸»ä»å¤åˆ¶çš„é€Ÿåº¦å’Œè¿æ¥çš„ç¨³å®šæ€§ï¼ŒSlaveå’ŒMasteræœ€å¥½åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…ã€‚</li><li>å°½é‡é¿å…åœ¨å‹åŠ›è¾ƒå¤§çš„ä¸»åº“ä¸Šå¢åŠ ä»åº“</li><li>Masterè°ƒç”¨BGREWRITEAOFé‡å†™AOFæ–‡ä»¶ï¼ŒAOFåœ¨é‡å†™çš„æ—¶å€™ä¼šå å¤§é‡çš„CPUå’Œå†…å­˜èµ„æºï¼Œå¯¼è‡´æœåŠ¡loadè¿‡é«˜ï¼Œå‡ºç°çŸ­æš‚æœåŠ¡æš‚åœç°è±¡ã€‚</li><li>ä¸ºäº†Masterçš„ç¨³å®šæ€§ï¼Œä¸»ä»å¤åˆ¶ä¸è¦ç”¨å›¾çŠ¶ç»“æ„ï¼Œç”¨å•å‘é“¾è¡¨ç»“æ„æ›´ç¨³å®šï¼Œå³ä¸»ä»å…³ç³»ä¸ºï¼šMaster&lt;â€“Slave1&lt;â€“Slave2&lt;â€“Slave3â€¦ï¼Œè¿™æ ·çš„ç»“æ„ä¹Ÿæ–¹ä¾¿è§£å†³å•ç‚¹æ•…éšœé—®é¢˜ï¼Œå®ç°Slaveå¯¹Masterçš„æ›¿æ¢ï¼Œä¹Ÿå³ï¼Œå¦‚æœMasteræŒ‚äº†ï¼Œå¯ä»¥ç«‹é©¬å¯ç”¨Slave1åšMasterï¼Œå…¶ä»–ä¸å˜ã€‚</li></ol><h3><span id="rediså®˜æ–¹ä¸ºä»€ä¹ˆä¸æä¾›windowsç‰ˆæœ¬">Rediså®˜æ–¹ä¸ºä»€ä¹ˆä¸æä¾›Windowsç‰ˆæœ¬ï¼Ÿ</span></h3><p>å› ä¸ºç›®å‰Linuxç‰ˆæœ¬å·²ç»ç›¸å½“ç¨³å®šï¼Œè€Œä¸”ç”¨æˆ·é‡å¾ˆå¤§ï¼Œæ— éœ€å¼€å‘windowsç‰ˆæœ¬ï¼Œåè€Œä¼šå¸¦æ¥å…¼å®¹æ€§ç­‰é—®é¢˜ã€‚</p><h3><span id="ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å€¼èƒ½å­˜å‚¨æœ€å¤§å®¹é‡æ˜¯å¤šå°‘">ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å€¼èƒ½å­˜å‚¨æœ€å¤§å®¹é‡æ˜¯å¤šå°‘ï¼Ÿ</span></h3><p>512M</p><h3><span id="rediså¦‚ä½•åšå¤§é‡æ•°æ®æ’å…¥">Rediså¦‚ä½•åšå¤§é‡æ•°æ®æ’å…¥ï¼Ÿ</span></h3><p>Redis2.6å¼€å§‹redis-cliæ”¯æŒä¸€ç§æ–°çš„è¢«ç§°ä¹‹ä¸ºpipe modeçš„æ–°æ¨¡å¼ç”¨äºæ‰§è¡Œå¤§é‡æ•°æ®æ’å…¥å·¥ä½œã€‚</p><h3><span id="å‡å¦‚redisé‡Œé¢æœ‰1äº¿ä¸ªkeyå…¶ä¸­æœ‰10wä¸ªkeyæ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„å¦‚æœå°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥">å‡å¦‚Redisé‡Œé¢æœ‰1äº¿ä¸ªkeyï¼Œå…¶ä¸­æœ‰10wä¸ªkeyæ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„ï¼Œå¦‚æœå°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥ï¼Ÿ</span></h3><p>ä½¿ç”¨keysæŒ‡ä»¤å¯ä»¥æ‰«å‡ºæŒ‡å®šæ¨¡å¼çš„keyåˆ—è¡¨ã€‚</p><p>å¯¹æ–¹æ¥ç€è¿½é—®ï¼šå¦‚æœè¿™ä¸ªredisæ­£åœ¨ç»™çº¿ä¸Šçš„ä¸šåŠ¡æä¾›æœåŠ¡ï¼Œé‚£ä½¿ç”¨keysæŒ‡ä»¤ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p><p>è¿™ä¸ªæ—¶å€™ä½ è¦å›ç­”rediså…³é”®çš„ä¸€ä¸ªç‰¹æ€§ï¼šredisçš„å•çº¿ç¨‹çš„ã€‚keysæŒ‡ä»¤ä¼šå¯¼è‡´çº¿ç¨‹é˜»å¡ä¸€æ®µæ—¶é—´ï¼Œçº¿ä¸ŠæœåŠ¡ä¼šåœé¡¿ï¼Œç›´åˆ°æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•ï¼ŒæœåŠ¡æ‰èƒ½æ¢å¤ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨scanæŒ‡ä»¤ï¼ŒscanæŒ‡ä»¤å¯ä»¥æ— é˜»å¡çš„æå–å‡ºæŒ‡å®šæ¨¡å¼çš„keyåˆ—è¡¨ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€å®šçš„é‡å¤æ¦‚ç‡ï¼Œåœ¨å®¢æˆ·ç«¯åšä¸€æ¬¡å»é‡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯æ•´ä½“æ‰€èŠ±è´¹çš„æ—¶é—´ä¼šæ¯”ç›´æ¥ç”¨keysæŒ‡ä»¤é•¿ã€‚</p><h3><span id="ä½¿ç”¨redisåšè¿‡å¼‚æ­¥é˜Ÿåˆ—å—æ˜¯å¦‚ä½•å®ç°çš„">ä½¿ç”¨Redisåšè¿‡å¼‚æ­¥é˜Ÿåˆ—å—ï¼Œæ˜¯å¦‚ä½•å®ç°çš„</span></h3><p>ä½¿ç”¨listç±»å‹ä¿å­˜æ•°æ®ä¿¡æ¯ï¼Œrpushç”Ÿäº§æ¶ˆæ¯ï¼Œlpopæ¶ˆè´¹æ¶ˆæ¯ï¼Œå½“lpopæ²¡æœ‰æ¶ˆæ¯æ—¶ï¼Œå¯ä»¥sleepä¸€æ®µæ—¶é—´ï¼Œç„¶åå†æ£€æŸ¥æœ‰æ²¡æœ‰ä¿¡æ¯ï¼Œå¦‚æœä¸æƒ³sleepçš„è¯ï¼Œå¯ä»¥ä½¿ç”¨blpop, åœ¨æ²¡æœ‰ä¿¡æ¯çš„æ—¶å€™ï¼Œä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°ä¿¡æ¯çš„åˆ°æ¥ã€‚rediså¯ä»¥é€šè¿‡pub&#x2F;subä¸»é¢˜è®¢é˜…æ¨¡å¼å®ç°ä¸€ä¸ªç”Ÿäº§è€…ï¼Œå¤šä¸ªæ¶ˆè´¹è€…ï¼Œå½“ç„¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„ç¼ºç‚¹ï¼Œå½“æ¶ˆè´¹è€…ä¸‹çº¿æ—¶ï¼Œç”Ÿäº§çš„æ¶ˆæ¯ä¼šä¸¢å¤±ã€‚</p><h3><span id="rediså¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—">Rediså¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—</span></h3><p>ä½¿ç”¨sortedsetï¼Œä½¿ç”¨æ—¶é—´æˆ³åšscore, æ¶ˆæ¯å†…å®¹ä½œä¸ºkey,è°ƒç”¨zaddæ¥ç”Ÿäº§æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ä½¿ç”¨zrangbyscoreè·å–nç§’ä¹‹å‰çš„æ•°æ®åšè½®è¯¢å¤„ç†ã€‚</p><h3><span id="rediså›æ”¶è¿›ç¨‹å¦‚ä½•å·¥ä½œçš„">Rediså›æ”¶è¿›ç¨‹å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</span></h3><ol><li>ä¸€ä¸ªå®¢æˆ·ç«¯è¿è¡Œäº†æ–°çš„å‘½ä»¤ï¼Œæ·»åŠ äº†æ–°çš„æ•°æ®ã€‚</li><li>Redisæ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå¦‚æœå¤§äºmaxmemoryçš„é™åˆ¶ï¼Œ åˆ™æ ¹æ®è®¾å®šå¥½çš„ç­–ç•¥è¿›è¡Œå›æ”¶ã€‚</li><li>ä¸€ä¸ªæ–°çš„å‘½ä»¤è¢«æ‰§è¡Œï¼Œç­‰ç­‰ã€‚</li><li>æ‰€ä»¥æˆ‘ä»¬ä¸æ–­åœ°ç©¿è¶Šå†…å­˜é™åˆ¶çš„è¾¹ç•Œï¼Œé€šè¿‡ä¸æ–­è¾¾åˆ°è¾¹ç•Œç„¶åä¸æ–­åœ°å›æ”¶å›åˆ°è¾¹ç•Œä»¥ä¸‹ã€‚</li></ol><p>å¦‚æœä¸€ä¸ªå‘½ä»¤çš„ç»“æœå¯¼è‡´å¤§é‡å†…å­˜è¢«ä½¿ç”¨ï¼ˆä¾‹å¦‚å¾ˆå¤§çš„é›†åˆçš„äº¤é›†ä¿å­˜åˆ°ä¸€ä¸ªæ–°çš„é”®ï¼‰ï¼Œä¸ç”¨å¤šä¹…å†…å­˜é™åˆ¶å°±ä¼šè¢«è¿™ä¸ªå†…å­˜ä½¿ç”¨é‡è¶…è¶Šã€‚</p><h3><span id="rediså›æ”¶ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆç®—æ³•">Rediså›æ”¶ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆç®—æ³•ï¼Ÿ</span></h3><p>LRUç®—æ³•</p><p><strong>END</strong></p><p><em>æ¥æºï¼š</em>thinkwon.blog.csdn.net&#x2F;article&#x2F;details&#x2F;103522351</p>]]></content>
      
      
      <categories>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redisè¿›é˜¶çŸ¥è¯†</title>
      <link href="/blog/2019/12/27/REDIS/REDIS-redis%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/blog/2019/12/27/REDIS/REDIS-redis%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h3><span id="å…³äºredis-ä¸€äº›åŸºæœ¬çŸ¥è¯†ç‚¹">å…³äºredis ä¸€äº›åŸºæœ¬çŸ¥è¯†ç‚¹</span></h3><h4><span id="redisåŸºæœ¬ä»‹ç»">redisåŸºæœ¬ä»‹ç»</span></h4><p>remote Dictionary Serer (è¿œç¨‹å­—å…¸æœåŠ¡) ANSI C ç¼–å†™ æ”¯æŒç½‘ç»œ åŸºäºå†…å­˜å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ key&#x3D;&gt;value æ•°æ®åº“</p><p>å®˜ç½‘ redis.io   ä½œè€…ï¼šSalvatore Sanfilippo æ„å¤§åˆ©äºº ç½‘å antirez</p><h4><span id="redisè¢«ä½¿ç”¨çš„åŸå› ">redisè¢«ä½¿ç”¨çš„åŸå› </span></h4><p>  ä¼ ç»Ÿå‹å…³ç³»å‹æ•°æ®åº“å¦‚mysql å·²ç»ä¸èƒ½é€‚ç”¨æ‰€æœ‰åœºæ™¯ï¼Œç§’æ€åº“å­˜ appé¦–é¡µæµé‡è®¿é—®é«˜å³°  æ‰€ä»¥è€ƒè™‘ç¼“å­˜ä¸­é—´ä»¶ï¼Œç›®å‰å¸‚é¢ä¸Šæ¯”è¾ƒå¸¸ç”¨çš„å°±æ˜¯redis å’Œmemcached </p><h4><span id="redis-åŸºæœ¬çš„æ•°æ®ç»“æ„">redis åŸºæœ¬çš„æ•°æ®ç»“æ„</span></h4><p>String ã€å­—å…¸Hashã€åˆ—è¡¨Listã€é›†åˆSetã€æœ‰åºé›†åˆ SortedSetã€ HyperLogLogã€Geoã€Pub&#x2F;Sub</p><h5><span id="bloomfilter-å¸ƒéš†è¿‡æ»¤å™¨">BloomFilter å¸ƒéš†è¿‡æ»¤å™¨</span></h5><p><a href="https://link.zhihu.com/?target=https://juejin.im/post/5db69365518825645656c0de">é¿å…ç¼“å­˜å‡»ç©¿çš„åˆ©å™¨ä¹‹BloomFilter</a></p><h4><span id="redisåˆ†å¸ƒå¼é”">redisåˆ†å¸ƒå¼é”</span></h4><p>-å…ˆæ‹¿setnxæ¥äº‰æŠ¢é”ï¼ŒæŠ¢åˆ°ä¹‹åï¼Œå†ç”¨expireç»™é”åŠ ä¸€ä¸ªè¿‡æœŸæ—¶é—´é˜²æ­¢é”å¿˜è®°äº†é‡Šæ”¾</p><h4><span id="rediså…³é”®çš„ä¸€ä¸ªç‰¹æ€§">rediså…³é”®çš„ä¸€ä¸ªç‰¹æ€§ï¼š</span></h4><p>redisçš„å•çº¿ç¨‹çš„ã€‚keysæŒ‡ä»¤ä¼šå¯¼è‡´çº¿ç¨‹é˜»å¡ä¸€æ®µæ—¶é—´ï¼Œçº¿ä¸ŠæœåŠ¡ä¼šåœé¡¿ï¼Œç›´åˆ°æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•ï¼ŒæœåŠ¡æ‰èƒ½æ¢å¤ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨<code>scan</code>æŒ‡ä»¤ï¼Œ<code>scan</code>æŒ‡ä»¤å¯ä»¥æ— é˜»å¡çš„æå–å‡ºæŒ‡å®šæ¨¡å¼çš„keyåˆ—è¡¨ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€å®šçš„é‡å¤æ¦‚ç‡ï¼Œåœ¨å®¢æˆ·ç«¯åšä¸€æ¬¡å»é‡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯æ•´ä½“æ‰€èŠ±è´¹çš„æ—¶é—´ä¼šæ¯”ç›´æ¥ç”¨keysæŒ‡ä»¤é•¿</p><h4><span id="ä½¿ç”¨redisåšå¼‚æ­¥é˜Ÿåˆ—">ä½¿ç”¨Redisåšå¼‚æ­¥é˜Ÿåˆ—</span></h4><p>ä¸€èˆ¬ä½¿ç”¨listç»“æ„ä½œä¸ºé˜Ÿåˆ—ï¼Œ<code>rpush</code>ç”Ÿäº§æ¶ˆæ¯ï¼Œ<code>lpop</code>æ¶ˆè´¹æ¶ˆæ¯ã€‚å½“lpopæ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œè¦é€‚å½“sleepä¸€ä¼šå†é‡è¯•ã€‚</p><p>listè¿˜æœ‰ä¸ªæŒ‡ä»¤å«<code>blpop</code>ï¼Œåœ¨æ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œå®ƒä¼šé˜»å¡ä½ç›´åˆ°æ¶ˆæ¯åˆ°æ¥ã€‚</p><h4><span id="å®ç°å»¶æ—¶é˜Ÿåˆ—">å®ç°å»¶æ—¶é˜Ÿåˆ—</span></h4><p>ä½¿ç”¨sortedsetï¼Œæ‹¿æ—¶é—´æˆ³ä½œä¸ºscoreï¼Œæ¶ˆæ¯å†…å®¹ä½œä¸ºkeyè°ƒç”¨zaddæ¥ç”Ÿäº§æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ç”¨<code>zrangebyscore</code>æŒ‡ä»¤è·å–Nç§’ä¹‹å‰çš„æ•°æ®è½®è¯¢è¿›è¡Œå¤„ç†ã€‚</p><h4><span id="ç”Ÿäº§ä¸€æ¬¡æ¶ˆè´¹å¤šæ¬¡">ç”Ÿäº§ä¸€æ¬¡æ¶ˆè´¹å¤šæ¬¡</span></h4><p>ä½¿ç”¨pub&#x2F;subä¸»é¢˜è®¢é˜…è€…æ¨¡å¼ï¼Œå¯ä»¥å®ç° 1:N çš„æ¶ˆæ¯é˜Ÿåˆ—</p><p>ç¼ºç‚¹ï¼šæ¶ˆè´¹è€…ä¸‹çº¿çš„è¯ ç”Ÿäº§è€…ä¼šæ¶ˆå¤±ï¼Œä½¿ç”¨MQ</p><h4><span id="redisæ˜¯æ€ä¹ˆæŒä¹…åŒ–">Redisæ˜¯æ€ä¹ˆæŒä¹…åŒ–</span></h4><p>RDBåšé•œåƒå…¨é‡æŒä¹…åŒ–ï¼ŒAOFåšå¢é‡æŒä¹…åŒ–ã€‚å› ä¸ºRDBä¼šè€—è´¹è¾ƒé•¿æ—¶é—´ï¼Œä¸å¤Ÿå®æ—¶ï¼Œåœ¨åœæœºçš„æ—¶å€™ä¼šå¯¼è‡´å¤§é‡ä¸¢å¤±æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦AOFæ¥é…åˆä½¿ç”¨ã€‚åœ¨rediså®ä¾‹é‡å¯æ—¶ï¼Œä¼šä½¿ç”¨RDBæŒä¹…åŒ–æ–‡ä»¶é‡æ–°æ„å»ºå†…å­˜ï¼Œå†ä½¿ç”¨AOFé‡æ”¾è¿‘æœŸçš„æ“ä½œæŒ‡ä»¤æ¥å®ç°å®Œæ•´æ¢å¤é‡å¯ä¹‹å‰çš„çŠ¶æ€ã€‚</p><p>RDBçš„åŸç†: forkå’Œcowã€‚forkæ˜¯æŒ‡redisé€šè¿‡åˆ›å»ºå­è¿›ç¨‹æ¥è¿›è¡ŒRDBæ“ä½œï¼ŒcowæŒ‡çš„æ˜¯copy on writeï¼Œå­è¿›ç¨‹åˆ›å»ºåï¼Œçˆ¶å­è¿›ç¨‹å…±äº«æ•°æ®æ®µï¼Œçˆ¶è¿›ç¨‹ç»§ç»­æä¾›è¯»å†™æœåŠ¡ï¼Œå†™è„çš„é¡µé¢æ•°æ®ä¼šé€æ¸å’Œå­è¿›ç¨‹åˆ†ç¦»å¼€æ¥ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿™é‡Œå¾ˆå¥½ç†è§£ï¼ŒæŠŠRDBç†è§£ä¸ºä¸€æ•´ä¸ªè¡¨å…¨é‡çš„æ•°æ®ï¼ŒAOFç†è§£ä¸ºæ¯æ¬¡æ“ä½œçš„æ—¥å¿—å°±å¥½äº†ï¼ŒæœåŠ¡å™¨é‡å¯çš„æ—¶å€™å…ˆæŠŠè¡¨çš„æ•°æ®å…¨éƒ¨æè¿›å»ï¼Œä½†æ˜¯ä»–å¯èƒ½ä¸å®Œæ•´ï¼Œä½ å†å›æ”¾ä¸€ä¸‹æ—¥å¿—ï¼Œæ•°æ®ä¸å°±å®Œæ•´äº†å˜›ã€‚ä¸è¿‡Redisæœ¬èº«çš„æœºåˆ¶æ˜¯ AOFæŒä¹…åŒ–å¼€å¯ä¸”å­˜åœ¨AOFæ–‡ä»¶æ—¶ï¼Œä¼˜å…ˆåŠ è½½AOFæ–‡ä»¶ï¼›AOFå…³é—­æˆ–è€…AOFæ–‡ä»¶ä¸å­˜åœ¨æ—¶ï¼ŒåŠ è½½RDBæ–‡ä»¶ï¼›åŠ è½½AOF/RDBæ–‡ä»¶åŸåï¼ŒRediså¯åŠ¨æˆåŠŸï¼› AOF/RDBæ–‡ä»¶å­˜åœ¨é”™è¯¯æ—¶ï¼ŒRediså¯åŠ¨å¤±è´¥å¹¶æ‰“å°é”™è¯¯ä¿¡æ¯</span><br></pre></td></tr></table></figure><h4><span id="pipelineæœ‰ä»€ä¹ˆå¥½å¤„">Pipelineæœ‰ä»€ä¹ˆå¥½å¤„</span></h4><p>å¯ä»¥å°†å¤šæ¬¡IOå¾€è¿”çš„æ—¶é—´ç¼©å‡ä¸ºä¸€æ¬¡ï¼Œå‰ææ˜¯pipelineæ‰§è¡Œçš„æŒ‡ä»¤ä¹‹é—´æ²¡æœ‰å› æœç›¸å…³æ€§ã€‚ä½¿ç”¨redis-benchmarkè¿›è¡Œå‹æµ‹çš„æ—¶å€™å¯ä»¥å‘ç°å½±å“redisçš„QPSå³°å€¼çš„ä¸€ä¸ªé‡è¦å› ç´ æ˜¯pipelineæ‰¹æ¬¡æŒ‡ä»¤çš„æ•°ç›®ã€‚</p><h4><span id="redisçš„åŒæ­¥æœºåˆ¶">Redisçš„åŒæ­¥æœºåˆ¶</span></h4><p>Rediså¯ä»¥ä½¿ç”¨ä¸»ä»åŒæ­¥ï¼Œä»ä»åŒæ­¥ã€‚ç¬¬ä¸€æ¬¡åŒæ­¥æ—¶ï¼Œä¸»èŠ‚ç‚¹åšä¸€æ¬¡bgsaveï¼Œå¹¶åŒæ—¶å°†åç»­ä¿®æ”¹æ“ä½œè®°å½•åˆ°å†…å­˜bufferï¼Œå¾…å®Œæˆåå°†RDBæ–‡ä»¶å…¨é‡åŒæ­¥åˆ°å¤åˆ¶èŠ‚ç‚¹ï¼Œå¤åˆ¶èŠ‚ç‚¹æ¥å—å®Œæˆåå°†RDBé•œåƒåŠ è½½åˆ°å†…å­˜ã€‚åŠ è½½å®Œæˆåï¼Œå†é€šçŸ¥ä¸»èŠ‚ç‚¹å°†æœŸé—´ä¿®æ”¹çš„æ“ä½œè®°å½•åŒæ­¥åˆ°å¤åˆ¶èŠ‚ç‚¹è¿›è¡Œé‡æ”¾å°±å®Œæˆäº†åŒæ­¥è¿‡ç¨‹ã€‚åç»­çš„å¢é‡æ•°æ®é€šè¿‡AOFæ—¥å¿—åŒæ­¥å³å¯ï¼Œæœ‰ç‚¹ç±»ä¼¼æ•°æ®åº“çš„binlogã€‚</p>]]></content>
      
      
      <categories>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>redisè¿›é˜¶çŸ¥è¯†</title>
      <link href="/blog/2019/12/27/REDIS/REDIS-redis%E8%BF%9B%E9%98%B6%E7%9F%A5%E8%AF%86/"/>
      <url>/blog/2019/12/27/REDIS/REDIS-redis%E8%BF%9B%E9%98%B6%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h3><span id="å…³äºredis-ä¸€äº›åŸºæœ¬çŸ¥è¯†ç‚¹">å…³äºredis ä¸€äº›åŸºæœ¬çŸ¥è¯†ç‚¹</span></h3><h4><span id="redisåŸºæœ¬ä»‹ç»">redisåŸºæœ¬ä»‹ç»</span></h4><p>remote Dictionary Serer (è¿œç¨‹å­—å…¸æœåŠ¡) ANSI C ç¼–å†™ æ”¯æŒç½‘ç»œ åŸºäºå†…å­˜å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ key&#x3D;&gt;value æ•°æ®åº“</p><p>å®˜ç½‘ redis.io   ä½œè€…ï¼šSalvatore Sanfilippo æ„å¤§åˆ©äºº ç½‘å antirez</p><h4><span id="redisè¢«ä½¿ç”¨çš„åŸå› ">redisè¢«ä½¿ç”¨çš„åŸå› </span></h4><p>  ä¼ ç»Ÿå‹å…³ç³»å‹æ•°æ®åº“å¦‚mysql å·²ç»ä¸èƒ½é€‚ç”¨æ‰€æœ‰åœºæ™¯ï¼Œç§’æ€åº“å­˜ appé¦–é¡µæµé‡è®¿é—®é«˜å³°  æ‰€ä»¥è€ƒè™‘ç¼“å­˜ä¸­é—´ä»¶ï¼Œç›®å‰å¸‚é¢ä¸Šæ¯”è¾ƒå¸¸ç”¨çš„å°±æ˜¯redis å’Œmemcached </p><h4><span id="redis-åŸºæœ¬çš„æ•°æ®ç»“æ„">redis åŸºæœ¬çš„æ•°æ®ç»“æ„</span></h4><p>String ã€å­—å…¸Hashã€åˆ—è¡¨Listã€é›†åˆSetã€æœ‰åºé›†åˆ SortedSetã€ HyperLogLogã€Geoã€Pub&#x2F;Sub</p><h5><span id="bloomfilter-å¸ƒéš†è¿‡æ»¤å™¨">BloomFilter å¸ƒéš†è¿‡æ»¤å™¨</span></h5><p><a href="https://link.zhihu.com/?target=https://juejin.im/post/5db69365518825645656c0de">é¿å…ç¼“å­˜å‡»ç©¿çš„åˆ©å™¨ä¹‹BloomFilter</a></p><h4><span id="redisåˆ†å¸ƒå¼é”">redisåˆ†å¸ƒå¼é”</span></h4><p>-å…ˆæ‹¿setnxæ¥äº‰æŠ¢é”ï¼ŒæŠ¢åˆ°ä¹‹åï¼Œå†ç”¨expireç»™é”åŠ ä¸€ä¸ªè¿‡æœŸæ—¶é—´é˜²æ­¢é”å¿˜è®°äº†é‡Šæ”¾</p><h4><span id="rediså…³é”®çš„ä¸€ä¸ªç‰¹æ€§">rediså…³é”®çš„ä¸€ä¸ªç‰¹æ€§ï¼š</span></h4><p>redisçš„å•çº¿ç¨‹çš„ã€‚keysæŒ‡ä»¤ä¼šå¯¼è‡´çº¿ç¨‹é˜»å¡ä¸€æ®µæ—¶é—´ï¼Œçº¿ä¸ŠæœåŠ¡ä¼šåœé¡¿ï¼Œç›´åˆ°æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•ï¼ŒæœåŠ¡æ‰èƒ½æ¢å¤ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨<code>scan</code>æŒ‡ä»¤ï¼Œ<code>scan</code>æŒ‡ä»¤å¯ä»¥æ— é˜»å¡çš„æå–å‡ºæŒ‡å®šæ¨¡å¼çš„keyåˆ—è¡¨ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€å®šçš„é‡å¤æ¦‚ç‡ï¼Œåœ¨å®¢æˆ·ç«¯åšä¸€æ¬¡å»é‡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯æ•´ä½“æ‰€èŠ±è´¹çš„æ—¶é—´ä¼šæ¯”ç›´æ¥ç”¨keysæŒ‡ä»¤é•¿</p><h4><span id="ä½¿ç”¨redisåšå¼‚æ­¥é˜Ÿåˆ—">ä½¿ç”¨Redisåšå¼‚æ­¥é˜Ÿåˆ—</span></h4><p>ä¸€èˆ¬ä½¿ç”¨listç»“æ„ä½œä¸ºé˜Ÿåˆ—ï¼Œ<code>rpush</code>ç”Ÿäº§æ¶ˆæ¯ï¼Œ<code>lpop</code>æ¶ˆè´¹æ¶ˆæ¯ã€‚å½“lpopæ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œè¦é€‚å½“sleepä¸€ä¼šå†é‡è¯•ã€‚</p><p>listè¿˜æœ‰ä¸ªæŒ‡ä»¤å«<code>blpop</code>ï¼Œåœ¨æ²¡æœ‰æ¶ˆæ¯çš„æ—¶å€™ï¼Œå®ƒä¼šé˜»å¡ä½ç›´åˆ°æ¶ˆæ¯åˆ°æ¥ã€‚</p><h4><span id="å®ç°å»¶æ—¶é˜Ÿåˆ—">å®ç°å»¶æ—¶é˜Ÿåˆ—</span></h4><p>ä½¿ç”¨sortedsetï¼Œæ‹¿æ—¶é—´æˆ³ä½œä¸ºscoreï¼Œæ¶ˆæ¯å†…å®¹ä½œä¸ºkeyè°ƒç”¨zaddæ¥ç”Ÿäº§æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ç”¨<code>zrangebyscore</code>æŒ‡ä»¤è·å–Nç§’ä¹‹å‰çš„æ•°æ®è½®è¯¢è¿›è¡Œå¤„ç†ã€‚</p><h4><span id="ç”Ÿäº§ä¸€æ¬¡æ¶ˆè´¹å¤šæ¬¡">ç”Ÿäº§ä¸€æ¬¡æ¶ˆè´¹å¤šæ¬¡</span></h4><p>ä½¿ç”¨pub&#x2F;subä¸»é¢˜è®¢é˜…è€…æ¨¡å¼ï¼Œå¯ä»¥å®ç° 1:N çš„æ¶ˆæ¯é˜Ÿåˆ—</p><p>ç¼ºç‚¹ï¼šæ¶ˆè´¹è€…ä¸‹çº¿çš„è¯ ç”Ÿäº§è€…ä¼šæ¶ˆå¤±ï¼Œä½¿ç”¨MQ</p><h4><span id="redisæ˜¯æ€ä¹ˆæŒä¹…åŒ–">Redisæ˜¯æ€ä¹ˆæŒä¹…åŒ–</span></h4><p>RDBåšé•œåƒå…¨é‡æŒä¹…åŒ–ï¼ŒAOFåšå¢é‡æŒä¹…åŒ–ã€‚å› ä¸ºRDBä¼šè€—è´¹è¾ƒé•¿æ—¶é—´ï¼Œä¸å¤Ÿå®æ—¶ï¼Œåœ¨åœæœºçš„æ—¶å€™ä¼šå¯¼è‡´å¤§é‡ä¸¢å¤±æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦AOFæ¥é…åˆä½¿ç”¨ã€‚åœ¨rediså®ä¾‹é‡å¯æ—¶ï¼Œä¼šä½¿ç”¨RDBæŒä¹…åŒ–æ–‡ä»¶é‡æ–°æ„å»ºå†…å­˜ï¼Œå†ä½¿ç”¨AOFé‡æ”¾è¿‘æœŸçš„æ“ä½œæŒ‡ä»¤æ¥å®ç°å®Œæ•´æ¢å¤é‡å¯ä¹‹å‰çš„çŠ¶æ€ã€‚</p><p>RDBçš„åŸç†: forkå’Œcowã€‚forkæ˜¯æŒ‡redisé€šè¿‡åˆ›å»ºå­è¿›ç¨‹æ¥è¿›è¡ŒRDBæ“ä½œï¼ŒcowæŒ‡çš„æ˜¯copy on writeï¼Œå­è¿›ç¨‹åˆ›å»ºåï¼Œçˆ¶å­è¿›ç¨‹å…±äº«æ•°æ®æ®µï¼Œçˆ¶è¿›ç¨‹ç»§ç»­æä¾›è¯»å†™æœåŠ¡ï¼Œå†™è„çš„é¡µé¢æ•°æ®ä¼šé€æ¸å’Œå­è¿›ç¨‹åˆ†ç¦»å¼€æ¥ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿™é‡Œå¾ˆå¥½ç†è§£ï¼ŒæŠŠRDBç†è§£ä¸ºä¸€æ•´ä¸ªè¡¨å…¨é‡çš„æ•°æ®ï¼ŒAOFç†è§£ä¸ºæ¯æ¬¡æ“ä½œçš„æ—¥å¿—å°±å¥½äº†ï¼ŒæœåŠ¡å™¨é‡å¯çš„æ—¶å€™å…ˆæŠŠè¡¨çš„æ•°æ®å…¨éƒ¨æè¿›å»ï¼Œä½†æ˜¯ä»–å¯èƒ½ä¸å®Œæ•´ï¼Œä½ å†å›æ”¾ä¸€ä¸‹æ—¥å¿—ï¼Œæ•°æ®ä¸å°±å®Œæ•´äº†å˜›ã€‚ä¸è¿‡Redisæœ¬èº«çš„æœºåˆ¶æ˜¯ AOFæŒä¹…åŒ–å¼€å¯ä¸”å­˜åœ¨AOFæ–‡ä»¶æ—¶ï¼Œä¼˜å…ˆåŠ è½½AOFæ–‡ä»¶ï¼›AOFå…³é—­æˆ–è€…AOFæ–‡ä»¶ä¸å­˜åœ¨æ—¶ï¼ŒåŠ è½½RDBæ–‡ä»¶ï¼›åŠ è½½AOF/RDBæ–‡ä»¶åŸåï¼ŒRediså¯åŠ¨æˆåŠŸï¼› AOF/RDBæ–‡ä»¶å­˜åœ¨é”™è¯¯æ—¶ï¼ŒRediså¯åŠ¨å¤±è´¥å¹¶æ‰“å°é”™è¯¯ä¿¡æ¯</span><br></pre></td></tr></table></figure><h4><span id="pipelineæœ‰ä»€ä¹ˆå¥½å¤„">Pipelineæœ‰ä»€ä¹ˆå¥½å¤„</span></h4><p>å¯ä»¥å°†å¤šæ¬¡IOå¾€è¿”çš„æ—¶é—´ç¼©å‡ä¸ºä¸€æ¬¡ï¼Œå‰ææ˜¯pipelineæ‰§è¡Œçš„æŒ‡ä»¤ä¹‹é—´æ²¡æœ‰å› æœç›¸å…³æ€§ã€‚ä½¿ç”¨redis-benchmarkè¿›è¡Œå‹æµ‹çš„æ—¶å€™å¯ä»¥å‘ç°å½±å“redisçš„QPSå³°å€¼çš„ä¸€ä¸ªé‡è¦å› ç´ æ˜¯pipelineæ‰¹æ¬¡æŒ‡ä»¤çš„æ•°ç›®ã€‚</p><h4><span id="redisçš„åŒæ­¥æœºåˆ¶">Redisçš„åŒæ­¥æœºåˆ¶</span></h4><p>Rediså¯ä»¥ä½¿ç”¨ä¸»ä»åŒæ­¥ï¼Œä»ä»åŒæ­¥ã€‚ç¬¬ä¸€æ¬¡åŒæ­¥æ—¶ï¼Œä¸»èŠ‚ç‚¹åšä¸€æ¬¡bgsaveï¼Œå¹¶åŒæ—¶å°†åç»­ä¿®æ”¹æ“ä½œè®°å½•åˆ°å†…å­˜bufferï¼Œå¾…å®Œæˆåå°†RDBæ–‡ä»¶å…¨é‡åŒæ­¥åˆ°å¤åˆ¶èŠ‚ç‚¹ï¼Œå¤åˆ¶èŠ‚ç‚¹æ¥å—å®Œæˆåå°†RDBé•œåƒåŠ è½½åˆ°å†…å­˜ã€‚åŠ è½½å®Œæˆåï¼Œå†é€šçŸ¥ä¸»èŠ‚ç‚¹å°†æœŸé—´ä¿®æ”¹çš„æ“ä½œè®°å½•åŒæ­¥åˆ°å¤åˆ¶èŠ‚ç‚¹è¿›è¡Œé‡æ”¾å°±å®Œæˆäº†åŒæ­¥è¿‡ç¨‹ã€‚åç»­çš„å¢é‡æ•°æ®é€šè¿‡AOFæ—¥å¿—åŒæ­¥å³å¯ï¼Œæœ‰ç‚¹ç±»ä¼¼æ•°æ®åº“çš„binlogã€‚</p>]]></content>
      
      
      <categories>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HEXO-butteryly</title>
      <link href="/blog/2019/12/18/%E5%BB%BA%E7%AB%99/%E5%BB%BA%E7%AB%99-HEXO-butteryly/"/>
      <url>/blog/2019/12/18/%E5%BB%BA%E7%AB%99/%E5%BB%BA%E7%AB%99-HEXO-butteryly/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><h3><span id="ä¸»é¢˜æ–‡æ¡£">ä¸»é¢˜Â·æ–‡æ¡£</span></h3><p><a href="https://jerryc.me/">https://jerryc.me/</a></p><h3><span id="è¯„è®ºç³»ç»Ÿ">è¯„è®ºç³»ç»Ÿ</span></h3><p>gittalk<br><a href="https://github.com/settings/applications/1190035">https://github.com/settings/applications/1190035</a><br>ç™»å½•GitHubè¿›è¡Œè¯„è®ºï¼Œä¼šç”Ÿæˆissue<br>Valine<br><a href="https://leancloud.cn/dashboard/applist.html#/apps">https://leancloud.cn/dashboard/applist.html#/apps</a><br>ç‰¹ç‚¹åœ¨äºå¯ä»¥å…ç™»é™†è¿›è¡Œè¯„è®ºï¼Œè¾“å…¥éªŒè¯ç è¯„è®º</p><p>Laibiliï¼ˆæ¥å¿…åŠ›ï¼‰<br>åŸŸååˆ°æœŸä¸ç¨³å®š<br>Disqus<br>æš‚æ—¶æœªæµ‹è¯•ä½¿ç”¨åˆ°æœŸ</p><p>è¿˜æ˜¯å‡†å¤‡ç”¨valineåšç¬¬ä¸€æœŸ</p>]]></content>
      
      
      <categories>
          
          <category> å»ºç«™ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HEXO </tag>
            
            <tag> ä¸»é¢˜ </tag>
            
            <tag> æ•™ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¯æ¡</title>
      <link href="/blog/2019/12/18/Wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86-%E8%AF%8D%E6%9D%A1/"/>
      <url>/blog/2019/12/18/Wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86-%E8%AF%8D%E6%9D%A1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>rss:</p><p>ç®€æ˜“ä¿¡æ¯èšåˆï¼ˆä¹Ÿå«èšåˆå†…å®¹ï¼‰æ˜¯ä¸€ç§RSSåŸºäºXMLæ ‡å‡†ï¼Œåœ¨äº’è”ç½‘ä¸Šè¢«å¹¿æ³›é‡‡ç”¨çš„å†…å®¹åŒ…è£…å’ŒæŠ•é€’åè®®ã€‚RSS(Really Simple Syndication)æ˜¯ä¸€ç§æè¿°å’ŒåŒæ­¥ç½‘ç«™å†…å®¹çš„æ ¼å¼ï¼Œæ˜¯ä½¿ç”¨æœ€å¹¿æ³›çš„XMLåº”ç”¨ã€‚RSSæ­å»ºäº†ä¿¡æ¯è¿…é€Ÿä¼ æ’­çš„ä¸€ä¸ªæŠ€æœ¯å¹³å°ï¼Œä½¿å¾—æ¯ä¸ªäººéƒ½æˆä¸ºæ½œåœ¨çš„ä¿¡æ¯æä¾›è€…ã€‚å‘å¸ƒä¸€ä¸ªRSSæ–‡ä»¶åï¼Œè¿™ä¸ªRSS Feedä¸­åŒ…å«çš„ä¿¡æ¯å°±èƒ½ç›´æ¥è¢«å…¶ä»–ç«™ç‚¹è°ƒç”¨ï¼Œè€Œä¸”ç”±äºè¿™äº›æ•°æ®éƒ½æ˜¯æ ‡å‡†çš„XMLæ ¼å¼ï¼Œæ‰€ä»¥ä¹Ÿèƒ½åœ¨å…¶ä»–çš„ç»ˆç«¯å’ŒæœåŠ¡ä¸­ä½¿ç”¨ï¼Œæ˜¯ä¸€ç§æè¿°å’ŒåŒæ­¥ç½‘ç«™å†…å®¹çš„æ ¼å¼ã€‚ [1]  RSSå¯ä»¥æ˜¯ä»¥ä¸‹ä¸‰ä¸ªè§£é‡Šçš„å…¶ä¸­ä¸€ä¸ªï¼š Really Simple Syndicationï¼›RDF (Resource Description Framework) Site Summaryï¼› Rich Site Summaryã€‚ä½†å…¶å®è¿™ä¸‰ä¸ªè§£é‡Šéƒ½æ˜¯æŒ‡åŒä¸€ç§Syndicationçš„æŠ€æœ¯ã€‚<br>RSSå¹¿æ³›ç”¨äºç½‘ä¸Šæ–°é—»é¢‘é“ï¼Œblogå’Œwikiï¼Œä¸»è¦çš„ç‰ˆæœ¬æœ‰0.91, 1.0, 2.0ã€‚ä½¿ç”¨RSSè®¢é˜…èƒ½æ›´å¿«åœ°è·å–ä¿¡æ¯ï¼Œç½‘ç«™æä¾›RSSè¾“å‡ºï¼Œæœ‰åˆ©äºè®©ç”¨æˆ·è·å–ç½‘ç«™å†…å®¹çš„æœ€æ–°æ›´æ–°ã€‚ç½‘ç»œç”¨æˆ·å¯ä»¥åœ¨å®¢æˆ·ç«¯å€ŸåŠ©äºæ”¯æŒRSSçš„èšåˆå·¥å…·è½¯ä»¶ï¼Œåœ¨ä¸æ‰“å¼€ç½‘ç«™å†…å®¹é¡µé¢çš„æƒ…å†µä¸‹é˜…è¯»æ”¯æŒRSSè¾“å‡ºçš„ç½‘ç«™å†…å®¹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºåŸºç¡€çŸ¥è¯† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wiki </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–ç </title>
      <link href="/blog/2019/12/17/Wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86-%E7%BC%96%E7%A0%81/"/>
      <url>/blog/2019/12/17/Wiki/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86-%E7%BC%96%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>å‡ºç°%20 æˆ–è€…%%çš„é—®é¢˜</p><p><a href="http://www.soupan.info/tool/utf-8.php">http://www.soupan.info/tool/utf-8.php</a><br>%20&#x2F;</p><p>ç¼–ç ç©ºæ ¼å­—ç¬¦çš„URLï¼š+æˆ–%20ï¼Ÿ</p><p>å½“URLä¸­çš„ç©ºæ ¼ç¼–ç ä¸º+ï¼Œä»€ä¹ˆæ—¶å€™ç¼–ç åˆ°%20?</p><p>%7C%7C%20</p><p>||</p><p>æŒ‰â€œè½¬æ¢â€å³å¯å°†å…¶è½¬æ¢ä¸ºUTF-8å­—ç¬¦ã€‚å†æŒ‰â€œè¿˜åŸâ€å³å¯å°†å…¶è¿˜åŸä¸ºç®€ä½“ä¸­æ–‡ã€‚</p><blockquote><p>ã€è½¬ã€‘utf-8çš„ä¸­æ–‡æ˜¯ä¸€ä¸ªæ±‰å­—å ä¸‰ä¸ªå­—èŠ‚é•¿åº¦<br>è‹±æ–‡å­—æ¯å’Œä¸­æ–‡æ±‰å­—åœ¨ä¸åŒå­—ç¬¦é›†ç¼–ç ä¸‹çš„å­—èŠ‚æ•°<br>è‹±æ–‡å­—æ¯ï¼š</p></blockquote><p>å­—èŠ‚æ•° : 1;ç¼–ç ï¼šGB2312</p><p>å­—èŠ‚æ•° : 1;ç¼–ç ï¼šGBK</p><p>å­—èŠ‚æ•° : 1;ç¼–ç ï¼šGB18030</p><p>å­—èŠ‚æ•° : 1;ç¼–ç ï¼šISO-8859-1</p><p>å­—èŠ‚æ•° : 1;ç¼–ç ï¼šUTF-8</p><p>å­—èŠ‚æ•° : 4;ç¼–ç ï¼šUTF-16</p><p>å­—èŠ‚æ•° : 2;ç¼–ç ï¼šUTF-16BE</p><p>å­—èŠ‚æ•° : 2;ç¼–ç ï¼šUTF-16LE</p><p>ä¸­æ–‡æ±‰å­—ï¼š</p><p>å­—èŠ‚æ•° : 2;ç¼–ç ï¼šGB2312</p><p>å­—èŠ‚æ•° : 2;ç¼–ç ï¼šGBK</p><p>å­—èŠ‚æ•° : 2;ç¼–ç ï¼šGB18030</p><p>å­—èŠ‚æ•° : 1;ç¼–ç ï¼šISO-8859-1</p><p>å­—èŠ‚æ•° : 3;ç¼–ç ï¼šUTF-8</p><p>å­—èŠ‚æ•° : 4;ç¼–ç ï¼šUTF-16</p><p>å­—èŠ‚æ•° : 2;ç¼–ç ï¼šUTF-16BE</p><p>å­—èŠ‚æ•° : 2;ç¼–ç ï¼šUTF-16LE</p><p>1ã€ç¾å›½äººé¦–å…ˆå¯¹å…¶è‹±æ–‡å­—ç¬¦è¿›è¡Œäº†ç¼–ç ï¼Œä¹Ÿå°±æ˜¯æœ€æ—©çš„asciiç ï¼Œç”¨ä¸€ä¸ªå­—èŠ‚çš„ä½7ä½æ¥è¡¨ç¤ºè‹±æ–‡çš„128ä¸ªå­—ç¬¦ï¼Œé«˜1ä½ç»Ÿä¸€ä¸º0ï¼›</p><p>2ã€åæ¥æ¬§æ´²äººå‘ç°å°¼ç›ä½ è¿™128ä½å“ªå¤Ÿç”¨ï¼Œæ¯”å¦‚æˆ‘é«˜è´µçš„æ³•å›½äººå­—æ¯ä¸Šé¢çš„è¿˜æœ‰æ³¨éŸ³ç¬¦ï¼Œè¿™ä¸ªæ€ä¹ˆåŒºåˆ†ï¼Œå¾—ï¼ŒæŠŠé«˜1ä½ç¼–è¿›æ¥å§ï¼Œè¿™æ ·æ¬§æ´²æ™®éä½¿ç”¨ä¸€ä¸ªå…¨å­—èŠ‚è¿›è¡Œç¼–ç ï¼Œæœ€å¤šå¯è¡¨ç¤º256ä½ã€‚æ¬§ç¾äººå°±æ˜¯å–œæ¬¢ç›´æ¥ç›´å»ï¼Œå­—ç¬¦å°‘ï¼Œç¼–ç ç”¨å¾—ä½æ•°å°‘ï¼›</p><p>3ã€ä½†æ˜¯å³ä½¿ä½æ•°å°‘ï¼Œä¸åŒå›½å®¶åœ°åŒºç”¨ä¸åŒçš„å­—ç¬¦ç¼–ç ï¼Œè™½ç„¶0â€“127è¡¨ç¤ºçš„ç¬¦å·æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯128â€“255è¿™ä¸€æ®µçš„è§£é‡Šå®Œå…¨ä¹±å¥—äº†ï¼Œå³ä½¿2è¿›åˆ¶å®Œå…¨ä¸€æ ·ï¼Œè¡¨ç¤ºçš„å­—ç¬¦å®Œå…¨ä¸ä¸€æ ·ï¼Œæ¯”å¦‚135åœ¨æ³•è¯­ï¼Œå¸Œä¼¯æ¥è¯­ï¼Œä¿„è¯­ç¼–ç ä¸­å®Œå…¨æ˜¯ä¸åŒçš„ç¬¦å·ï¼›</p><p>4ã€æ›´éº»çƒ¦çš„æ˜¯ï¼Œå°¼ç›è¿™ç”µè„‘é«˜ç§‘æŠ€ä¼ åˆ°ä¸­å›½åï¼Œä¸­å›½äººå‘ç°æˆ‘ä»¬æœ‰10ä¸‡å¤šä¸ªæ±‰å­—ï¼Œä½ ä»¬æ¬§ç¾è¿™256å­—å¡ç‰™ç¼éƒ½ä¸å¤Ÿã€‚äºæ˜¯å°±å‘æ˜äº†GB2312è¿™äº›æ±‰å­—ç¼–ç ï¼Œå…¸å‹çš„ç”¨2ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºç»å¤§éƒ¨åˆ†çš„å¸¸ç”¨æ±‰å­—ï¼Œæœ€å¤šå¯ä»¥è¡¨ç¤º65536ä¸ªæ±‰å­—å­—ç¬¦ï¼Œè¿™æ ·å°±ä¸éš¾ç†è§£æœ‰äº›æ±‰å­—ä½ åœ¨æ–°åå­—å…¸é‡ŒæŸ¥å¾—åˆ°ï¼Œä½†æ˜¯ç”µè„‘ä¸Šå¦‚æœä¸å¤„ç†ä¸€ä¸‹ä½ æ˜¯æ˜¾ç¤ºä¸å‡ºæ¥çš„äº†å§ã€‚</p><p>5ã€è¿™ä¸‹å„ç”¨å„çš„å­—ç¬¦é›†ç¼–ç ï¼Œè¿™ä¸–ç•Œå’‹ç»Ÿä¸€ï¼Ÿä¿„å›½äººå‘å°emailç»™ä¸­å›½äººï¼Œä¸¤è¾¹å­—ç¬¦é›†ç¼–ç ä¸åŒï¼Œå°¼ç›æ˜¾ç¤ºéƒ½æ˜¯ä¹±ç å•Šã€‚ä¸ºäº†ç»Ÿä¸€ï¼Œäºæ˜¯å°±å‘æ˜äº†unicodeï¼Œå°†ä¸–ç•Œä¸Šæ‰€æœ‰çš„ç¬¦å·éƒ½çº³å…¥å…¶ä¸­ï¼Œæ¯ä¸€ä¸ªç¬¦å·éƒ½ç»™äºˆä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ç¼–ç ï¼Œç°åœ¨unicodeå¯ä»¥å®¹çº³100å¤šä¸‡ä¸ªç¬¦å·ï¼Œæ¯ä¸ªç¬¦å·çš„ç¼–ç éƒ½ä¸ä¸€æ ·ï¼Œè¿™ä¸‹å¯ç»Ÿä¸€äº†ï¼Œæ‰€æœ‰è¯­è¨€éƒ½å¯ä»¥äº’é€šï¼Œä¸€ä¸ªç½‘é¡µé¡µé¢é‡Œå¯ä»¥åŒæ—¶æ˜¾ç¤ºå„å›½æ–‡å­—ã€‚</p><p>6ã€ç„¶è€Œï¼Œunicodeè™½ç„¶ç»Ÿä¸€äº†å…¨ä¸–ç•Œå­—ç¬¦çš„äºŒè¿›åˆ¶ç¼–ç ï¼Œä½†æ²¡æœ‰è§„å®šå¦‚ä½•å­˜å‚¨å•Šï¼Œäº²ã€‚x86å’Œamdä½“ç³»ç»“æ„çš„ç”µè„‘å°ç«¯åºå’Œå¤§ç«¯åºéƒ½åˆ†ä¸æ¸…ï¼Œåˆ«æè®¡ç®—æœºå¦‚ä½•è¯†åˆ«åˆ°åº•æ˜¯unicodeè¿˜æ˜¯acsiiäº†ã€‚å¦‚æœUnicodeç»Ÿä¸€è§„å®šï¼Œæ¯ä¸ªç¬¦å·ç”¨ä¸‰ä¸ªæˆ–å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œé‚£ä¹ˆæ¯ä¸ªè‹±æ–‡å­—æ¯å‰éƒ½å¿…ç„¶æœ‰äºŒåˆ°ä¸‰ä¸ªå­—èŠ‚æ˜¯0ï¼Œæ–‡æœ¬æ–‡ä»¶çš„å¤§å°ä¼šå› æ­¤å¤§å‡ºäºŒä¸‰å€ï¼Œè¿™å¯¹äºå­˜å‚¨æ¥è¯´æ˜¯æå¤§çš„æµªè´¹ã€‚è¿™æ ·å¯¼è‡´ä¸€ä¸ªåæœï¼šå‡ºç°äº†Unicodeçš„å¤šç§å­˜å‚¨æ–¹å¼ã€‚</p><p>7ã€äº’è”ç½‘çš„å…´èµ·ï¼Œç½‘é¡µä¸Šè¦æ˜¾ç¤ºå„ç§å­—ç¬¦ï¼Œå¿…é¡»ç»Ÿä¸€å•Šï¼Œäº²ã€‚utf-8å°±æ˜¯Unicodeæœ€é‡è¦çš„å®ç°æ–¹å¼ä¹‹ä¸€ã€‚å¦å¤–è¿˜æœ‰utf-16ã€utf-32ç­‰ã€‚UTF-8ä¸æ˜¯å›ºå®šå­—é•¿ç¼–ç çš„ï¼Œè€Œæ˜¯ä¸€ç§å˜é•¿çš„ç¼–ç æ–¹å¼ã€‚å®ƒå¯ä»¥ä½¿ç”¨1~4ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œæ ¹æ®ä¸åŒçš„ç¬¦å·è€Œå˜åŒ–å­—èŠ‚é•¿åº¦ã€‚è¿™æ˜¯ç§æ¯”è¾ƒå·§å¦™çš„è®¾è®¡ï¼Œå¦‚æœä¸€ä¸ªå­—èŠ‚çš„ç¬¬ä¸€ä½æ˜¯0ï¼Œåˆ™è¿™ä¸ªå­—èŠ‚å•ç‹¬å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼›å¦‚æœç¬¬ä¸€ä½æ˜¯1ï¼Œåˆ™è¿ç»­æœ‰å¤šå°‘ä¸ª1ï¼Œå°±è¡¨ç¤ºå½“å‰å­—ç¬¦å ç”¨å¤šå°‘ä¸ªå­—èŠ‚ã€‚</p><p>8ã€æ³¨æ„unicodeçš„å­—ç¬¦ç¼–ç å’Œutf-8çš„å­˜å‚¨ç¼–ç è¡¨ç¤ºæ˜¯ä¸åŒçš„ï¼Œä¾‹å¦‚â€ä¸¥â€å­—çš„Unicodeç æ˜¯4E25ï¼ŒUTF-8ç¼–ç æ˜¯E4B8A5ï¼Œè¿™ä¸ª7é‡Œé¢è§£é‡Šäº†çš„ï¼ŒUTF-8ç¼–ç ä¸ä»…è€ƒè™‘äº†ç¼–ç ï¼Œè¿˜è€ƒè™‘äº†å­˜å‚¨ï¼ŒE4B8A5æ˜¯åœ¨å­˜å‚¨è¯†åˆ«ç¼–ç çš„åŸºç¡€ä¸Šå¡è¿›äº†4E25ã€‚</p><p>9ã€UTF-8 ä½¿ç”¨ä¸€è‡³å››ä¸ªå­—èŠ‚ä¸ºæ¯ä¸ªå­—ç¬¦ç¼–ç ã€‚128 ä¸ª ASCII å­—ç¬¦ï¼ˆUnicode èŒƒå›´ç”± U+0000 è‡³ U+007Fï¼‰åªéœ€ä¸€ä¸ªå­—èŠ‚ï¼Œå¸¦æœ‰å˜éŸ³ç¬¦å·çš„æ‹‰ä¸æ–‡ã€å¸Œè…Šæ–‡ã€è¥¿é‡Œå°”å­—æ¯ã€äºšç¾å°¼äºšè¯­ã€å¸Œä¼¯æ¥æ–‡ã€é˜¿æ‹‰ä¼¯æ–‡ã€å™åˆ©äºšæ–‡åŠé©¬å°”ä»£å¤«è¯­ï¼ˆUnicode èŒƒå›´ç”± U+0080 è‡³ U+07FFï¼‰éœ€è¦äºŒä¸ªå­—èŠ‚ï¼Œå…¶ä»–åŸºæœ¬å¤šæ–‡ç§å¹³é¢ï¼ˆBMPï¼‰ä¸­çš„å­—ç¬¦ï¼ˆCJKå±äºæ­¤ç±»-Qieqieæ³¨ï¼‰ä½¿ç”¨ä¸‰ä¸ªå­—èŠ‚ï¼Œå…¶ä»– Unicode è¾…åŠ©å¹³é¢çš„å­—ç¬¦ä½¿ç”¨å››å­—èŠ‚ç¼–ç ã€‚</p><p>10ã€æœ€åï¼Œè¦å›ç­”ä½ çš„é—®é¢˜ï¼Œå¸¸è§„æ¥çœ‹ï¼Œä¸­æ–‡æ±‰å­—åœ¨utf-8ä¸­åˆ°åº•å å‡ ä¸ªå­—èŠ‚ï¼Œä¸€èˆ¬æ˜¯3ä¸ªå­—èŠ‚ï¼Œæœ€å¸¸è§çš„ç¼–ç æ–¹å¼æ˜¯1110xxxx 10xxxxxx 10xxxxxxã€‚</p><hr><blockquote><p>çŸ¥ä¹è§£ç­” <a href="https://www.zhihu.com/question/23374078">https://www.zhihu.com/question/23374078</a><br>Unicode æ˜¯ã€Œå­—ç¬¦é›†ã€<br>UTF-8 æ˜¯ã€Œç¼–ç è§„åˆ™ã€<br>å…¶ä¸­ï¼š<br>å­—ç¬¦é›†ï¼šä¸ºæ¯ä¸€ä¸ªã€Œå­—ç¬¦ã€åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ IDï¼ˆå­¦åä¸ºç ä½ &#x2F; ç ç‚¹ &#x2F; Code Pointï¼‰<br>ç¼–ç è§„åˆ™ï¼šå°†ã€Œç ä½ã€è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—çš„è§„åˆ™ï¼ˆç¼–ç &#x2F;è§£ç  å¯ä»¥ç†è§£ä¸º åŠ å¯†&#x2F;è§£å¯† çš„è¿‡ç¨‹ï¼‰<br>å¹¿ä¹‰çš„ Unicode æ˜¯ä¸€ä¸ªæ ‡å‡†ï¼Œå®šä¹‰äº†ä¸€ä¸ªå­—ç¬¦é›†ä»¥åŠä¸€ç³»åˆ—çš„ç¼–ç è§„åˆ™ï¼Œå³ Unicode å­—ç¬¦é›†å’ŒUTF-8ã€UTF-16ã€UTF-32 ç­‰ç­‰ç¼–ç â€¦â€¦<br>Unicode å­—ç¬¦é›†ä¸ºæ¯ä¸€ä¸ªå­—ç¬¦åˆ†é…ä¸€ä¸ªç ä½ï¼Œä¾‹å¦‚ã€ŒçŸ¥ã€çš„ç ä½æ˜¯ 30693ï¼Œè®°ä½œ U+77E5ï¼ˆ30693çš„åå…­è¿›åˆ¶ä¸º 0x77E5ï¼‰ã€‚</p></blockquote><p>UTF-8 é¡¾åæ€ä¹‰ï¼Œæ˜¯ä¸€å¥—ä»¥ 8 ä½ä¸ºä¸€ä¸ªç¼–ç å•ä½çš„å¯å˜é•¿ç¼–ç ã€‚ä¼šå°†ä¸€ä¸ªç ä½ç¼–ç ä¸º 1 åˆ° 4 ä¸ªå­—èŠ‚ï¼š</p>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºåŸºç¡€çŸ¥è¯† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wiki </tag>
            
            <tag> ç¼–ç  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/blog/2019/12/16/%E5%BB%BA%E7%AB%99/%E5%BB%BA%E7%AB%99-HEXO-hello-world/"/>
      <url>/blog/2019/12/16/%E5%BB%BA%E7%AB%99/%E5%BB%BA%E7%AB%99-HEXO-hello-world/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2><span id="quick-start">Quick Start</span></h2><h3><span id="create-a-new-post">Create a new post</span></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3><span id="run-server">Run server</span></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3><span id="generate-static-files">Generate static files</span></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3><span id="deploy-to-remote-sites">Deploy to remote sites</span></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      <categories>
          
          <category> å»ºç«™ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å›¾ç‰‡é“¾æ¥</title>
      <link href="/blog/2019/12/16/%E5%BB%BA%E7%AB%99/%E5%BB%BA%E7%AB%99-%E5%9B%BE%E7%89%87%E9%93%BE%E6%8E%A5/"/>
      <url>/blog/2019/12/16/%E5%BB%BA%E7%AB%99/%E5%BB%BA%E7%AB%99-%E5%9B%BE%E7%89%87%E9%93%BE%E6%8E%A5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>githubå¤´åƒåœ°å€é“¾æ¥<br> <a href="https://avatars0.githubusercontent.com/u/23631580?s=400&u=8adfff85bef758535f26ec7c91204d21da557643&v=4">https://avatars0.githubusercontent.com/u/23631580?s=400&amp;u=8adfff85bef758535f26ec7c91204d21da557643&amp;v=4</a><br> å¾®ä¿¡å¤´åƒåœ°å€<br> <a href="http://s2-cdn.oneitfarm.com/e12ece12233b4059860acf48637d830a.jpg">http://s2-cdn.oneitfarm.com/e12ece12233b4059860acf48637d830a.jpg</a><br> åŠ¨æ€å£çº¸é“¾æ¥ï¼š<br> <a href="https://source.unsplash.com/collection/collectionid/1600x900">https://source.unsplash.com/collection/collectionid/1600x900</a><br> <a href="https://uploadbeta.com/api/pictures/random/?key=BingEverydayWallpaperPicture">https://uploadbeta.com/api/pictures/random/?key=BingEverydayWallpaperPicture</a><br> <a href="https://api.dujin.org/bing/1920.php">https://api.dujin.org/bing/1920.php</a><br> <a href="https://api.dujin.org/bing/1366.php">https://api.dujin.org/bing/1366.php</a></p><p>blogèƒŒæ™¯é“¾æ¥ï¼š<br>wechat:<br><a href="http://s2-cdn.oneitfarm.com/ec13d36268ae41d7aaf87d5505324b6a.png">http://s2-cdn.oneitfarm.com/ec13d36268ae41d7aaf87d5505324b6a.png</a>   (è¿·ä½ ç‰ˆæœ¬)<br><a href="http://s2-cdn.oneitfarm.com/fc44dd8d7da4467da3831cd9e6229e19.jpg">http://s2-cdn.oneitfarm.com/fc44dd8d7da4467da3831cd9e6229e19.jpg</a><br>alipay:<br><a href="http://s2-cdn.oneitfarm.com/2eef3a681187495aa43ff8bbe1173c09.png">http://s2-cdn.oneitfarm.com/2eef3a681187495aa43ff8bbe1173c09.png</a>   (è¿·ä½ ç‰ˆæœ¬)<br><a href="http://s2-cdn.oneitfarm.com/96c2b14feb774e49ae2d110bb500770c.jpg">http://s2-cdn.oneitfarm.com/96c2b14feb774e49ae2d110bb500770c.jpg</a></p><p>ç½‘ç«™é»˜è®¤èƒŒæ™¯ï¼š<br><a href="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/top_img_index.jpg">https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/top_img_index.jpg</a></p><p>æ–‡å­—é»˜è®¤å›¾ç‰‡ï¼š<br>default_cover: <a href="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png">https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png</a></p><p>é˜…è¯»èƒŒæ™¯ï¼š<br>archive_img: <a href="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/archive.jpg">https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/archive.jpg</a></p><p>tagèƒŒæ™¯ï¼š<br>tag_img: <a href="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/tag-bg.png">https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/tag-bg.png</a></p><p>ç›®å½•èƒŒæ™¯ï¼š<br>category_img: <a href="https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/category-bg">https://cdn.jsdelivr.net/gh/jerryc127/CDN/img/category-bg</a></p><p>å¦‚æœä½ æœ‰ä½¿ç”¨hexo-doubanå»ç”Ÿæˆmovieç•Œé¢ï¼Œå¯é…ç½®é€™å€‹<br><a href="https://cdn.jsdelivr.net/gh/jerryc127/CDN/Photo/movie.jpg">https://cdn.jsdelivr.net/gh/jerryc127/CDN/Photo/movie.jpg</a></p><p>è¯„è®ºèƒŒæ™¯<br><a href="http://s2-cdn.oneitfarm.com/94f489ea603c42ed854f035fe491222d.png">http://s2-cdn.oneitfarm.com/94f489ea603c42ed854f035fe491222d.png</a></p><p>404èƒŒæ™¯<br><a href="http://s2-cdn.oneitfarm.com/b09dd72b0fb94cbaab76bdfbb121c4d6.jpg">http://s2-cdn.oneitfarm.com/b09dd72b0fb94cbaab76bdfbb121c4d6.jpg</a><br>icpèƒŒæ™¯<br><a href="http://s2-cdn.oneitfarm.com/850aa332dae84b7c8f82f5d0631aa154.png">http://s2-cdn.oneitfarm.com/850aa332dae84b7c8f82f5d0631aa154.png</a></p><p>loading çš„svg<br><a href="http://s2-cdn.oneitfarm.com/7ab2d4e7a3a34c81912580725f45c393.svg">http://s2-cdn.oneitfarm.com/7ab2d4e7a3a34c81912580725f45c393.svg</a></p><p>algoliaçš„svg<br><a href="http://s2-cdn.oneitfarm.com/0339c65e9ab74f3e919624ed02755dba.svg">http://s2-cdn.oneitfarm.com/0339c65e9ab74f3e919624ed02755dba.svg</a></p><p>ç§æœ‰çš„bg<br><a href="https://s2-cdn.oneitfarm.com/92b19077218b48d8b6c1f8726d736c9f.jpg">https://s2-cdn.oneitfarm.com/92b19077218b48d8b6c1f8726d736c9f.jpg</a></p>]]></content>
      
      
      <categories>
          
          <category> å»ºç«™ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> photo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PV,UV</title>
      <link href="/blog/2019/12/16/%E5%BB%BA%E7%AB%99/%E5%BB%BA%E7%AB%99-My-New-Post/"/>
      <url>/blog/2019/12/16/%E5%BB%BA%E7%AB%99/%E5%BB%BA%E7%AB%99-My-New-Post/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\blog\assets\js\Meting.min.js"></script><p>PVï¼šé¡µé¢è®¿é—®é‡ï¼Œå³PageViewï¼Œç”¨æˆ·æ¯æ¬¡å¯¹ç½‘ç«™çš„è®¿é—®å‡è¢«è®°å½•ï¼Œç”¨æˆ·å¯¹åŒä¸€é¡µé¢çš„å¤šæ¬¡è®¿é—®ï¼Œè®¿é—®é‡ç´¯è®¡ã€‚ UVï¼šç‹¬ç«‹è®¿é—®ç”¨æˆ·æ•°ï¼šå³UniqueVisitorï¼Œè®¿é—®ç½‘ç«™çš„ä¸€å°ç”µè„‘å®¢æˆ·ç«¯ä¸ºä¸€ä¸ªè®¿å®¢ã€‚00:00-24:00å†…ç›¸åŒçš„å®¢æˆ·ç«¯åªè¢«è®¡ç®—ä¸€æ¬¡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Diary </category>
          
          <category> PlayStation </category>
          
          <category> Games </category>
          
          <category> Life </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
